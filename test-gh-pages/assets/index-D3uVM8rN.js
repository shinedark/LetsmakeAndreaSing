var Ez=Object.defineProperty;var wS=e=>{throw TypeError(e)};var _z=(e,t,n)=>t in e?Ez(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var it=(e,t,n)=>_z(e,typeof t!="symbol"?t+"":t,n),R0=(e,t,n)=>t.has(e)||wS("Cannot "+n);var Z=(e,t,n)=>(R0(e,t,"read from private field"),n?n.call(e):t.get(e)),Xt=(e,t,n)=>t.has(e)?wS("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Et=(e,t,n,s)=>(R0(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n),Cn=(e,t,n)=>(R0(e,t,"access private method"),n);var Pf=(e,t,n,s)=>({set _(r){Et(e,t,r,n)},get _(){return Z(e,t,s)}});function SN(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in e)){const o=Object.getOwnPropertyDescriptor(s,r);o&&Object.defineProperty(e,r,o.get?o:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var pl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function q1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Rz(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var r=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return e[s]}})}),n}var IN={exports:{}},bg={},$N={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ih=Symbol.for("react.element"),Dz=Symbol.for("react.portal"),Az=Symbol.for("react.fragment"),Oz=Symbol.for("react.strict_mode"),Fz=Symbol.for("react.profiler"),Pz=Symbol.for("react.provider"),Mz=Symbol.for("react.context"),Lz=Symbol.for("react.forward_ref"),zz=Symbol.for("react.suspense"),Bz=Symbol.for("react.memo"),Vz=Symbol.for("react.lazy"),kS=Symbol.iterator;function Wz(e){return e===null||typeof e!="object"?null:(e=kS&&e[kS]||e["@@iterator"],typeof e=="function"?e:null)}var TN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},NN=Object.assign,EN={};function Gc(e,t,n){this.props=e,this.context=t,this.refs=EN,this.updater=n||TN}Gc.prototype.isReactComponent={};Gc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Gc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function _N(){}_N.prototype=Gc.prototype;function Y1(e,t,n){this.props=e,this.context=t,this.refs=EN,this.updater=n||TN}var Q1=Y1.prototype=new _N;Q1.constructor=Y1;NN(Q1,Gc.prototype);Q1.isPureReactComponent=!0;var CS=Array.isArray,RN=Object.prototype.hasOwnProperty,Z1={current:null},DN={key:!0,ref:!0,__self:!0,__source:!0};function AN(e,t,n){var s,r={},o=null,i=null;if(t!=null)for(s in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)RN.call(t,s)&&!DN.hasOwnProperty(s)&&(r[s]=t[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(e&&e.defaultProps)for(s in a=e.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:ih,type:e,key:o,ref:i,props:r,_owner:Z1.current}}function Uz(e,t){return{$$typeof:ih,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function J1(e){return typeof e=="object"&&e!==null&&e.$$typeof===ih}function jz(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var SS=/\/+/g;function D0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?jz(""+e.key):t.toString(36)}function Dp(e,t,n,s,r){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case ih:case Dz:i=!0}}if(i)return i=e,r=r(i),e=s===""?"."+D0(i,0):s,CS(r)?(n="",e!=null&&(n=e.replace(SS,"$&/")+"/"),Dp(r,t,n,"",function(c){return c})):r!=null&&(J1(r)&&(r=Uz(r,n+(!r.key||i&&i.key===r.key?"":(""+r.key).replace(SS,"$&/")+"/")+e)),t.push(r)),1;if(i=0,s=s===""?".":s+":",CS(e))for(var a=0;a<e.length;a++){o=e[a];var l=s+D0(o,a);i+=Dp(o,t,n,l,r)}else if(l=Wz(e),typeof l=="function")for(e=l.call(e),a=0;!(o=e.next()).done;)o=o.value,l=s+D0(o,a++),i+=Dp(o,t,n,l,r);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Mf(e,t,n){if(e==null)return e;var s=[],r=0;return Dp(e,s,"","",function(o){return t.call(n,o,r++)}),s}function Gz(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Zn={current:null},Ap={transition:null},Hz={ReactCurrentDispatcher:Zn,ReactCurrentBatchConfig:Ap,ReactCurrentOwner:Z1};function ON(){throw Error("act(...) is not supported in production builds of React.")}Ft.Children={map:Mf,forEach:function(e,t,n){Mf(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Mf(e,function(){t++}),t},toArray:function(e){return Mf(e,function(t){return t})||[]},only:function(e){if(!J1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ft.Component=Gc;Ft.Fragment=Az;Ft.Profiler=Fz;Ft.PureComponent=Y1;Ft.StrictMode=Oz;Ft.Suspense=zz;Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hz;Ft.act=ON;Ft.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=NN({},e.props),r=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Z1.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)RN.call(t,l)&&!DN.hasOwnProperty(l)&&(s[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:ih,type:e.type,key:r,ref:o,props:s,_owner:i}};Ft.createContext=function(e){return e={$$typeof:Mz,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Pz,_context:e},e.Consumer=e};Ft.createElement=AN;Ft.createFactory=function(e){var t=AN.bind(null,e);return t.type=e,t};Ft.createRef=function(){return{current:null}};Ft.forwardRef=function(e){return{$$typeof:Lz,render:e}};Ft.isValidElement=J1;Ft.lazy=function(e){return{$$typeof:Vz,_payload:{_status:-1,_result:e},_init:Gz}};Ft.memo=function(e,t){return{$$typeof:Bz,type:e,compare:t===void 0?null:t}};Ft.startTransition=function(e){var t=Ap.transition;Ap.transition={};try{e()}finally{Ap.transition=t}};Ft.unstable_act=ON;Ft.useCallback=function(e,t){return Zn.current.useCallback(e,t)};Ft.useContext=function(e){return Zn.current.useContext(e)};Ft.useDebugValue=function(){};Ft.useDeferredValue=function(e){return Zn.current.useDeferredValue(e)};Ft.useEffect=function(e,t){return Zn.current.useEffect(e,t)};Ft.useId=function(){return Zn.current.useId()};Ft.useImperativeHandle=function(e,t,n){return Zn.current.useImperativeHandle(e,t,n)};Ft.useInsertionEffect=function(e,t){return Zn.current.useInsertionEffect(e,t)};Ft.useLayoutEffect=function(e,t){return Zn.current.useLayoutEffect(e,t)};Ft.useMemo=function(e,t){return Zn.current.useMemo(e,t)};Ft.useReducer=function(e,t,n){return Zn.current.useReducer(e,t,n)};Ft.useRef=function(e){return Zn.current.useRef(e)};Ft.useState=function(e){return Zn.current.useState(e)};Ft.useSyncExternalStore=function(e,t,n){return Zn.current.useSyncExternalStore(e,t,n)};Ft.useTransition=function(){return Zn.current.useTransition()};Ft.version="18.3.1";$N.exports=Ft;var D=$N.exports;const si=q1(D),Kz=SN({__proto__:null,default:si},[D]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xz=D,qz=Symbol.for("react.element"),Yz=Symbol.for("react.fragment"),Qz=Object.prototype.hasOwnProperty,Zz=Xz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jz={key:!0,ref:!0,__self:!0,__source:!0};function FN(e,t,n){var s,r={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)Qz.call(t,s)&&!Jz.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)r[s]===void 0&&(r[s]=t[s]);return{$$typeof:qz,type:e,key:o,ref:i,props:r,_owner:Zz.current}}bg.Fragment=Yz;bg.jsx=FN;bg.jsxs=FN;IN.exports=bg;var N=IN.exports,PN={exports:{}},Ds={},MN={exports:{}},LN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,z){var H=R.length;R.push(z);t:for(;0<H;){var X=H-1>>>1,Q=R[X];if(0<r(Q,z))R[X]=z,R[H]=Q,H=X;else break t}}function n(R){return R.length===0?null:R[0]}function s(R){if(R.length===0)return null;var z=R[0],H=R.pop();if(H!==z){R[0]=H;t:for(var X=0,Q=R.length,J=Q>>>1;X<J;){var nt=2*(X+1)-1,st=R[nt],ot=nt+1,dt=R[ot];if(0>r(st,H))ot<Q&&0>r(dt,st)?(R[X]=dt,R[ot]=H,X=ot):(R[X]=st,R[nt]=H,X=nt);else if(ot<Q&&0>r(dt,H))R[X]=dt,R[ot]=H,X=ot;else break t}}return z}function r(R,z){var H=R.sortIndex-z.sortIndex;return H!==0?H:R.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(R){for(var z=n(c);z!==null;){if(z.callback===null)s(c);else if(z.startTime<=R)s(c),z.sortIndex=z.expirationTime,t(l,z);else break;z=n(c)}}function v(R){if(m=!1,b(R),!p)if(n(l)!==null)p=!0,M(w);else{var z=n(c);z!==null&&U(v,z.startTime-R)}}function w(R,z){p=!1,m&&(m=!1,x(S),S=-1),f=!0;var H=h;try{for(b(z),d=n(l);d!==null&&(!(d.expirationTime>z)||R&&!E());){var X=d.callback;if(typeof X=="function"){d.callback=null,h=d.priorityLevel;var Q=X(d.expirationTime<=z);z=e.unstable_now(),typeof Q=="function"?d.callback=Q:d===n(l)&&s(l),b(z)}else s(l);d=n(l)}if(d!==null)var J=!0;else{var nt=n(c);nt!==null&&U(v,nt.startTime-z),J=!1}return J}finally{d=null,h=H,f=!1}}var k=!1,C=null,S=-1,I=5,$=-1;function E(){return!(e.unstable_now()-$<I)}function A(){if(C!==null){var R=e.unstable_now();$=R;var z=!0;try{z=C(!0,R)}finally{z?L():(k=!1,C=null)}}else k=!1}var L;if(typeof y=="function")L=function(){y(A)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,P=O.port2;O.port1.onmessage=A,L=function(){P.postMessage(null)}}else L=function(){g(A,0)};function M(R){C=R,k||(k=!0,L())}function U(R,z){S=g(function(){R(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,M(w))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(R){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var H=h;h=z;try{return R()}finally{h=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,z){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var H=h;h=R;try{return z()}finally{h=H}},e.unstable_scheduleCallback=function(R,z,H){var X=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?X+H:X):H=X,R){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=H+Q,R={id:u++,callback:z,priorityLevel:R,startTime:H,expirationTime:Q,sortIndex:-1},H>X?(R.sortIndex=H,t(c,R),n(l)===null&&R===n(c)&&(m?(x(S),S=-1):m=!0,U(v,H-X))):(R.sortIndex=Q,t(l,R),p||f||(p=!0,M(w))),R},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(R){var z=h;return function(){var H=h;h=z;try{return R.apply(this,arguments)}finally{h=H}}}})(LN);MN.exports=LN;var tB=MN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eB=D,Es=tB;function rt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zN=new Set,xd={};function ml(e,t){bc(e,t),bc(e+"Capture",t)}function bc(e,t){for(xd[e]=t,e=0;e<t.length;e++)zN.add(t[e])}var Ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jy=Object.prototype.hasOwnProperty,nB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,IS={},$S={};function sB(e){return jy.call($S,e)?!0:jy.call(IS,e)?!1:nB.test(e)?$S[e]=!0:(IS[e]=!0,!1)}function rB(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function oB(e,t,n,s){if(t===null||typeof t>"u"||rB(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Jn(e,t,n,s,r,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var gn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gn[e]=new Jn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gn[t]=new Jn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gn[e]=new Jn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gn[e]=new Jn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gn[e]=new Jn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gn[e]=new Jn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gn[e]=new Jn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gn[e]=new Jn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gn[e]=new Jn(e,5,!1,e.toLowerCase(),null,!1,!1)});var tv=/[\-:]([a-z])/g;function ev(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(tv,ev);gn[t]=new Jn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(tv,ev);gn[t]=new Jn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(tv,ev);gn[t]=new Jn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gn[e]=new Jn(e,1,!1,e.toLowerCase(),null,!1,!1)});gn.xlinkHref=new Jn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gn[e]=new Jn(e,1,!1,e.toLowerCase(),null,!0,!0)});function nv(e,t,n,s){var r=gn.hasOwnProperty(t)?gn[t]:null;(r!==null?r.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(oB(t,n,r,s)&&(n=null),s||r===null?sB(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=n===null?r.type===3?!1:"":n:(t=r.attributeName,s=r.attributeNamespace,n===null?e.removeAttribute(t):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var Vo=eB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lf=Symbol.for("react.element"),Ml=Symbol.for("react.portal"),Ll=Symbol.for("react.fragment"),sv=Symbol.for("react.strict_mode"),Gy=Symbol.for("react.profiler"),BN=Symbol.for("react.provider"),VN=Symbol.for("react.context"),rv=Symbol.for("react.forward_ref"),Hy=Symbol.for("react.suspense"),Ky=Symbol.for("react.suspense_list"),ov=Symbol.for("react.memo"),oi=Symbol.for("react.lazy"),WN=Symbol.for("react.offscreen"),TS=Symbol.iterator;function yu(e){return e===null||typeof e!="object"?null:(e=TS&&e[TS]||e["@@iterator"],typeof e=="function"?e:null)}var Ne=Object.assign,A0;function Mu(e){if(A0===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);A0=t&&t[1]||""}return`
`+A0+e}var O0=!1;function F0(e,t){if(!e||O0)return"";O0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var s=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){s=c}e.call(t.prototype)}else{try{throw Error()}catch(c){s=c}e()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),o=s.stack.split(`
`),i=r.length-1,a=o.length-1;1<=i&&0<=a&&r[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(r[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||r[i]!==o[a]){var l=`
`+r[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=a);break}}}finally{O0=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Mu(e):""}function iB(e){switch(e.tag){case 5:return Mu(e.type);case 16:return Mu("Lazy");case 13:return Mu("Suspense");case 19:return Mu("SuspenseList");case 0:case 2:case 15:return e=F0(e.type,!1),e;case 11:return e=F0(e.type.render,!1),e;case 1:return e=F0(e.type,!0),e;default:return""}}function Xy(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ll:return"Fragment";case Ml:return"Portal";case Gy:return"Profiler";case sv:return"StrictMode";case Hy:return"Suspense";case Ky:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case VN:return(e.displayName||"Context")+".Consumer";case BN:return(e._context.displayName||"Context")+".Provider";case rv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ov:return t=e.displayName||null,t!==null?t:Xy(e.type)||"Memo";case oi:t=e._payload,e=e._init;try{return Xy(e(t))}catch{}}return null}function aB(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xy(t);case 8:return t===sv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Li(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function UN(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function lB(e){var t=UN(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(i){s=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function zf(e){e._valueTracker||(e._valueTracker=lB(e))}function jN(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=UN(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function om(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function qy(e,t){var n=t.checked;return Ne({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function NS(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Li(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function GN(e,t){t=t.checked,t!=null&&nv(e,"checked",t,!1)}function Yy(e,t){GN(e,t);var n=Li(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Qy(e,t.type,n):t.hasOwnProperty("defaultValue")&&Qy(e,t.type,Li(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ES(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Qy(e,t,n){(t!=="number"||om(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Lu=Array.isArray;function Yl(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Li(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,s&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Zy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(rt(91));return Ne({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function _S(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(rt(92));if(Lu(n)){if(1<n.length)throw Error(rt(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Li(n)}}function HN(e,t){var n=Li(t.value),s=Li(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function RS(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function KN(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jy(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?KN(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Bf,XN=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,r){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Bf=Bf||document.createElement("div"),Bf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Bf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function yd(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var td={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cB=["Webkit","ms","Moz","O"];Object.keys(td).forEach(function(e){cB.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),td[t]=td[e]})});function qN(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||td.hasOwnProperty(e)&&td[e]?(""+t).trim():t+"px"}function YN(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=qN(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,r):e[n]=r}}var uB=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tb(e,t){if(t){if(uB[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(rt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(rt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(rt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(rt(62))}}function eb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nb=null;function iv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var sb=null,Ql=null,Zl=null;function DS(e){if(e=ch(e)){if(typeof sb!="function")throw Error(rt(280));var t=e.stateNode;t&&(t=Sg(t),sb(e.stateNode,e.type,t))}}function QN(e){Ql?Zl?Zl.push(e):Zl=[e]:Ql=e}function ZN(){if(Ql){var e=Ql,t=Zl;if(Zl=Ql=null,DS(e),t)for(e=0;e<t.length;e++)DS(t[e])}}function JN(e,t){return e(t)}function tE(){}var P0=!1;function eE(e,t,n){if(P0)return e(t,n);P0=!0;try{return JN(e,t,n)}finally{P0=!1,(Ql!==null||Zl!==null)&&(tE(),ZN())}}function bd(e,t){var n=e.stateNode;if(n===null)return null;var s=Sg(n);if(s===null)return null;n=s[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break t;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(rt(231,t,typeof n));return n}var rb=!1;if(Ro)try{var bu={};Object.defineProperty(bu,"passive",{get:function(){rb=!0}}),window.addEventListener("test",bu,bu),window.removeEventListener("test",bu,bu)}catch{rb=!1}function dB(e,t,n,s,r,o,i,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var ed=!1,im=null,am=!1,ob=null,hB={onError:function(e){ed=!0,im=e}};function fB(e,t,n,s,r,o,i,a,l){ed=!1,im=null,dB.apply(hB,arguments)}function pB(e,t,n,s,r,o,i,a,l){if(fB.apply(this,arguments),ed){if(ed){var c=im;ed=!1,im=null}else throw Error(rt(198));am||(am=!0,ob=c)}}function gl(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function nE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function AS(e){if(gl(e)!==e)throw Error(rt(188))}function mB(e){var t=e.alternate;if(!t){if(t=gl(e),t===null)throw Error(rt(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return AS(r),e;if(o===s)return AS(r),t;o=o.sibling}throw Error(rt(188))}if(n.return!==s.return)n=r,s=o;else{for(var i=!1,a=r.child;a;){if(a===n){i=!0,n=r,s=o;break}if(a===s){i=!0,s=r,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,s=r;break}if(a===s){i=!0,s=o,n=r;break}a=a.sibling}if(!i)throw Error(rt(189))}}if(n.alternate!==s)throw Error(rt(190))}if(n.tag!==3)throw Error(rt(188));return n.stateNode.current===n?e:t}function sE(e){return e=mB(e),e!==null?rE(e):null}function rE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=rE(e);if(t!==null)return t;e=e.sibling}return null}var oE=Es.unstable_scheduleCallback,OS=Es.unstable_cancelCallback,gB=Es.unstable_shouldYield,xB=Es.unstable_requestPaint,ze=Es.unstable_now,yB=Es.unstable_getCurrentPriorityLevel,av=Es.unstable_ImmediatePriority,iE=Es.unstable_UserBlockingPriority,lm=Es.unstable_NormalPriority,bB=Es.unstable_LowPriority,aE=Es.unstable_IdlePriority,vg=null,Kr=null;function vB(e){if(Kr&&typeof Kr.onCommitFiberRoot=="function")try{Kr.onCommitFiberRoot(vg,e,void 0,(e.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:CB,wB=Math.log,kB=Math.LN2;function CB(e){return e>>>=0,e===0?32:31-(wB(e)/kB|0)|0}var Vf=64,Wf=4194304;function zu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function cm(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,r=e.suspendedLanes,o=e.pingedLanes,i=n&268435455;if(i!==0){var a=i&~r;a!==0?s=zu(a):(o&=i,o!==0&&(s=zu(o)))}else i=n&~r,i!==0?s=zu(i):o!==0&&(s=zu(o));if(s===0)return 0;if(t!==0&&t!==s&&!(t&r)&&(r=s&-s,o=t&-t,r>=o||r===16&&(o&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-br(t),r=1<<n,s|=e[n],t&=~r;return s}function SB(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IB(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-br(o),a=1<<i,l=r[i];l===-1?(!(a&n)||a&s)&&(r[i]=SB(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}function ib(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function lE(){var e=Vf;return Vf<<=1,!(Vf&4194240)&&(Vf=64),e}function M0(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ah(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-br(t),e[t]=n}function $B(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-br(n),o=1<<r;t[r]=0,s[r]=-1,e[r]=-1,n&=~o}}function lv(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-br(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}var Jt=0;function cE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var uE,cv,dE,hE,fE,ab=!1,Uf=[],Ii=null,$i=null,Ti=null,vd=new Map,wd=new Map,li=[],TB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function FS(e,t){switch(e){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":Ti=null;break;case"pointerover":case"pointerout":vd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wd.delete(t.pointerId)}}function vu(e,t,n,s,r,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:o,targetContainers:[r]},t!==null&&(t=ch(t),t!==null&&cv(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function NB(e,t,n,s,r){switch(t){case"focusin":return Ii=vu(Ii,e,t,n,s,r),!0;case"dragenter":return $i=vu($i,e,t,n,s,r),!0;case"mouseover":return Ti=vu(Ti,e,t,n,s,r),!0;case"pointerover":var o=r.pointerId;return vd.set(o,vu(vd.get(o)||null,e,t,n,s,r)),!0;case"gotpointercapture":return o=r.pointerId,wd.set(o,vu(wd.get(o)||null,e,t,n,s,r)),!0}return!1}function pE(e){var t=Ia(e.target);if(t!==null){var n=gl(t);if(n!==null){if(t=n.tag,t===13){if(t=nE(n),t!==null){e.blockedOn=t,fE(e.priority,function(){dE(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Op(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=lb(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);nb=s,n.target.dispatchEvent(s),nb=null}else return t=ch(n),t!==null&&cv(t),e.blockedOn=n,!1;t.shift()}return!0}function PS(e,t,n){Op(e)&&n.delete(t)}function EB(){ab=!1,Ii!==null&&Op(Ii)&&(Ii=null),$i!==null&&Op($i)&&($i=null),Ti!==null&&Op(Ti)&&(Ti=null),vd.forEach(PS),wd.forEach(PS)}function wu(e,t){e.blockedOn===t&&(e.blockedOn=null,ab||(ab=!0,Es.unstable_scheduleCallback(Es.unstable_NormalPriority,EB)))}function kd(e){function t(r){return wu(r,e)}if(0<Uf.length){wu(Uf[0],e);for(var n=1;n<Uf.length;n++){var s=Uf[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Ii!==null&&wu(Ii,e),$i!==null&&wu($i,e),Ti!==null&&wu(Ti,e),vd.forEach(t),wd.forEach(t),n=0;n<li.length;n++)s=li[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<li.length&&(n=li[0],n.blockedOn===null);)pE(n),n.blockedOn===null&&li.shift()}var Jl=Vo.ReactCurrentBatchConfig,um=!0;function _B(e,t,n,s){var r=Jt,o=Jl.transition;Jl.transition=null;try{Jt=1,uv(e,t,n,s)}finally{Jt=r,Jl.transition=o}}function RB(e,t,n,s){var r=Jt,o=Jl.transition;Jl.transition=null;try{Jt=4,uv(e,t,n,s)}finally{Jt=r,Jl.transition=o}}function uv(e,t,n,s){if(um){var r=lb(e,t,n,s);if(r===null)K0(e,t,s,dm,n),FS(e,s);else if(NB(r,e,t,n,s))s.stopPropagation();else if(FS(e,s),t&4&&-1<TB.indexOf(e)){for(;r!==null;){var o=ch(r);if(o!==null&&uE(o),o=lb(e,t,n,s),o===null&&K0(e,t,s,dm,n),o===r)break;r=o}r!==null&&s.stopPropagation()}else K0(e,t,s,null,n)}}var dm=null;function lb(e,t,n,s){if(dm=null,e=iv(s),e=Ia(e),e!==null)if(t=gl(e),t===null)e=null;else if(n=t.tag,n===13){if(e=nE(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return dm=e,null}function mE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yB()){case av:return 1;case iE:return 4;case lm:case bB:return 16;case aE:return 536870912;default:return 16}default:return 16}}var mi=null,dv=null,Fp=null;function gE(){if(Fp)return Fp;var e,t=dv,n=t.length,s,r="value"in mi?mi.value:mi.textContent,o=r.length;for(e=0;e<n&&t[e]===r[e];e++);var i=n-e;for(s=1;s<=i&&t[n-s]===r[o-s];s++);return Fp=r.slice(e,1<s?1-s:void 0)}function Pp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jf(){return!0}function MS(){return!1}function As(e){function t(n,s,r,o,i){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?jf:MS,this.isPropagationStopped=MS,this}return Ne(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jf)},persist:function(){},isPersistent:jf}),t}var Hc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hv=As(Hc),lh=Ne({},Hc,{view:0,detail:0}),DB=As(lh),L0,z0,ku,wg=Ne({},lh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ku&&(ku&&e.type==="mousemove"?(L0=e.screenX-ku.screenX,z0=e.screenY-ku.screenY):z0=L0=0,ku=e),L0)},movementY:function(e){return"movementY"in e?e.movementY:z0}}),LS=As(wg),AB=Ne({},wg,{dataTransfer:0}),OB=As(AB),FB=Ne({},lh,{relatedTarget:0}),B0=As(FB),PB=Ne({},Hc,{animationName:0,elapsedTime:0,pseudoElement:0}),MB=As(PB),LB=Ne({},Hc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zB=As(LB),BB=Ne({},Hc,{data:0}),zS=As(BB),VB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},UB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jB(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=UB[e])?!!t[e]:!1}function fv(){return jB}var GB=Ne({},lh,{key:function(e){if(e.key){var t=VB[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Pp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?WB[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fv,charCode:function(e){return e.type==="keypress"?Pp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Pp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),HB=As(GB),KB=Ne({},wg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),BS=As(KB),XB=Ne({},lh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fv}),qB=As(XB),YB=Ne({},Hc,{propertyName:0,elapsedTime:0,pseudoElement:0}),QB=As(YB),ZB=Ne({},wg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),JB=As(ZB),tV=[9,13,27,32],pv=Ro&&"CompositionEvent"in window,nd=null;Ro&&"documentMode"in document&&(nd=document.documentMode);var eV=Ro&&"TextEvent"in window&&!nd,xE=Ro&&(!pv||nd&&8<nd&&11>=nd),VS=" ",WS=!1;function yE(e,t){switch(e){case"keyup":return tV.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var zl=!1;function nV(e,t){switch(e){case"compositionend":return bE(t);case"keypress":return t.which!==32?null:(WS=!0,VS);case"textInput":return e=t.data,e===VS&&WS?null:e;default:return null}}function sV(e,t){if(zl)return e==="compositionend"||!pv&&yE(e,t)?(e=gE(),Fp=dv=mi=null,zl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xE&&t.locale!=="ko"?null:t.data;default:return null}}var rV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function US(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!rV[e.type]:t==="textarea"}function vE(e,t,n,s){QN(s),t=hm(t,"onChange"),0<t.length&&(n=new hv("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var sd=null,Cd=null;function oV(e){RE(e,0)}function kg(e){var t=Wl(e);if(jN(t))return e}function iV(e,t){if(e==="change")return t}var wE=!1;if(Ro){var V0;if(Ro){var W0="oninput"in document;if(!W0){var jS=document.createElement("div");jS.setAttribute("oninput","return;"),W0=typeof jS.oninput=="function"}V0=W0}else V0=!1;wE=V0&&(!document.documentMode||9<document.documentMode)}function GS(){sd&&(sd.detachEvent("onpropertychange",kE),Cd=sd=null)}function kE(e){if(e.propertyName==="value"&&kg(Cd)){var t=[];vE(t,Cd,e,iv(e)),eE(oV,t)}}function aV(e,t,n){e==="focusin"?(GS(),sd=t,Cd=n,sd.attachEvent("onpropertychange",kE)):e==="focusout"&&GS()}function lV(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kg(Cd)}function cV(e,t){if(e==="click")return kg(t)}function uV(e,t){if(e==="input"||e==="change")return kg(t)}function dV(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ir=typeof Object.is=="function"?Object.is:dV;function Sd(e,t){if(Ir(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!jy.call(t,r)||!Ir(e[r],t[r]))return!1}return!0}function HS(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function KS(e,t){var n=HS(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=HS(n)}}function CE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?CE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function SE(){for(var e=window,t=om();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=om(e.document)}return t}function mv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function hV(e){var t=SE(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&CE(n.ownerDocument.documentElement,n)){if(s!==null&&mv(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=n.textContent.length,o=Math.min(s.start,r);s=s.end===void 0?o:Math.min(s.end,r),!e.extend&&o>s&&(r=s,s=o,o=r),r=KS(n,o);var i=KS(n,s);r&&i&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),o>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fV=Ro&&"documentMode"in document&&11>=document.documentMode,Bl=null,cb=null,rd=null,ub=!1;function XS(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ub||Bl==null||Bl!==om(s)||(s=Bl,"selectionStart"in s&&mv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),rd&&Sd(rd,s)||(rd=s,s=hm(cb,"onSelect"),0<s.length&&(t=new hv("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=Bl)))}function Gf(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Vl={animationend:Gf("Animation","AnimationEnd"),animationiteration:Gf("Animation","AnimationIteration"),animationstart:Gf("Animation","AnimationStart"),transitionend:Gf("Transition","TransitionEnd")},U0={},IE={};Ro&&(IE=document.createElement("div").style,"AnimationEvent"in window||(delete Vl.animationend.animation,delete Vl.animationiteration.animation,delete Vl.animationstart.animation),"TransitionEvent"in window||delete Vl.transitionend.transition);function Cg(e){if(U0[e])return U0[e];if(!Vl[e])return e;var t=Vl[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in IE)return U0[e]=t[n];return e}var $E=Cg("animationend"),TE=Cg("animationiteration"),NE=Cg("animationstart"),EE=Cg("transitionend"),_E=new Map,qS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qi(e,t){_E.set(e,t),ml(t,[e])}for(var j0=0;j0<qS.length;j0++){var G0=qS[j0],pV=G0.toLowerCase(),mV=G0[0].toUpperCase()+G0.slice(1);Qi(pV,"on"+mV)}Qi($E,"onAnimationEnd");Qi(TE,"onAnimationIteration");Qi(NE,"onAnimationStart");Qi("dblclick","onDoubleClick");Qi("focusin","onFocus");Qi("focusout","onBlur");Qi(EE,"onTransitionEnd");bc("onMouseEnter",["mouseout","mouseover"]);bc("onMouseLeave",["mouseout","mouseover"]);bc("onPointerEnter",["pointerout","pointerover"]);bc("onPointerLeave",["pointerout","pointerover"]);ml("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ml("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ml("onBeforeInput",["compositionend","keypress","textInput","paste"]);ml("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gV=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bu));function YS(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,pB(s,t,void 0,e),e.currentTarget=null}function RE(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;t:{var o=void 0;if(t)for(var i=s.length-1;0<=i;i--){var a=s[i],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break t;YS(r,a,c),o=l}else for(i=0;i<s.length;i++){if(a=s[i],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break t;YS(r,a,c),o=l}}}if(am)throw e=ob,am=!1,ob=null,e}function pe(e,t){var n=t[mb];n===void 0&&(n=t[mb]=new Set);var s=e+"__bubble";n.has(s)||(DE(t,e,2,!1),n.add(s))}function H0(e,t,n){var s=0;t&&(s|=4),DE(n,e,s,t)}var Hf="_reactListening"+Math.random().toString(36).slice(2);function Id(e){if(!e[Hf]){e[Hf]=!0,zN.forEach(function(n){n!=="selectionchange"&&(gV.has(n)||H0(n,!1,e),H0(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Hf]||(t[Hf]=!0,H0("selectionchange",!1,t))}}function DE(e,t,n,s){switch(mE(t)){case 1:var r=_B;break;case 4:r=RB;break;default:r=uv}n=r.bind(null,t,n,e),r=void 0,!rb||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),s?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function K0(e,t,n,s,r){var o=s;if(!(t&1)&&!(t&2)&&s!==null)t:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(i===4)for(i=s.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;i=i.return}for(;a!==null;){if(i=Ia(a),i===null)return;if(l=i.tag,l===5||l===6){s=o=i;continue t}a=a.parentNode}}s=s.return}eE(function(){var c=o,u=iv(n),d=[];t:{var h=_E.get(e);if(h!==void 0){var f=hv,p=e;switch(e){case"keypress":if(Pp(n)===0)break t;case"keydown":case"keyup":f=HB;break;case"focusin":p="focus",f=B0;break;case"focusout":p="blur",f=B0;break;case"beforeblur":case"afterblur":f=B0;break;case"click":if(n.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=LS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=OB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=qB;break;case $E:case TE:case NE:f=MB;break;case EE:f=QB;break;case"scroll":f=DB;break;case"wheel":f=JB;break;case"copy":case"cut":case"paste":f=zB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=BS}var m=(t&4)!==0,g=!m&&e==="scroll",x=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,b;y!==null;){b=y;var v=b.stateNode;if(b.tag===5&&v!==null&&(b=v,x!==null&&(v=bd(y,x),v!=null&&m.push($d(y,v,b)))),g)break;y=y.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(t&7)){t:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&n!==nb&&(p=n.relatedTarget||n.fromElement)&&(Ia(p)||p[Do]))break t;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Ia(p):null,p!==null&&(g=gl(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=LS,v="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=BS,v="onPointerLeave",x="onPointerEnter",y="pointer"),g=f==null?h:Wl(f),b=p==null?h:Wl(p),h=new m(v,y+"leave",f,n,u),h.target=g,h.relatedTarget=b,v=null,Ia(u)===c&&(m=new m(x,y+"enter",p,n,u),m.target=b,m.relatedTarget=g,v=m),g=v,f&&p)e:{for(m=f,x=p,y=0,b=m;b;b=El(b))y++;for(b=0,v=x;v;v=El(v))b++;for(;0<y-b;)m=El(m),y--;for(;0<b-y;)x=El(x),b--;for(;y--;){if(m===x||x!==null&&m===x.alternate)break e;m=El(m),x=El(x)}m=null}else m=null;f!==null&&QS(d,h,f,m,!1),p!==null&&g!==null&&QS(d,g,p,m,!0)}}t:{if(h=c?Wl(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var w=iV;else if(US(h))if(wE)w=uV;else{w=lV;var k=aV}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=cV);if(w&&(w=w(e,c))){vE(d,w,n,u);break t}k&&k(e,h,c),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Qy(h,"number",h.value)}switch(k=c?Wl(c):window,e){case"focusin":(US(k)||k.contentEditable==="true")&&(Bl=k,cb=c,rd=null);break;case"focusout":rd=cb=Bl=null;break;case"mousedown":ub=!0;break;case"contextmenu":case"mouseup":case"dragend":ub=!1,XS(d,n,u);break;case"selectionchange":if(fV)break;case"keydown":case"keyup":XS(d,n,u)}var C;if(pv)t:{switch(e){case"compositionstart":var S="onCompositionStart";break t;case"compositionend":S="onCompositionEnd";break t;case"compositionupdate":S="onCompositionUpdate";break t}S=void 0}else zl?yE(e,n)&&(S="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(xE&&n.locale!=="ko"&&(zl||S!=="onCompositionStart"?S==="onCompositionEnd"&&zl&&(C=gE()):(mi=u,dv="value"in mi?mi.value:mi.textContent,zl=!0)),k=hm(c,S),0<k.length&&(S=new zS(S,e,null,n,u),d.push({event:S,listeners:k}),C?S.data=C:(C=bE(n),C!==null&&(S.data=C)))),(C=eV?nV(e,n):sV(e,n))&&(c=hm(c,"onBeforeInput"),0<c.length&&(u=new zS("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=C))}RE(d,t)})}function $d(e,t,n){return{instance:e,listener:t,currentTarget:n}}function hm(e,t){for(var n=t+"Capture",s=[];e!==null;){var r=e,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=bd(e,n),o!=null&&s.unshift($d(e,o,r)),o=bd(e,t),o!=null&&s.push($d(e,o,r))),e=e.return}return s}function El(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function QS(e,t,n,s,r){for(var o=t._reactName,i=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=bd(n,o),l!=null&&i.unshift($d(n,l,a))):r||(l=bd(n,o),l!=null&&i.push($d(n,l,a)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var xV=/\r\n?/g,yV=/\u0000|\uFFFD/g;function ZS(e){return(typeof e=="string"?e:""+e).replace(xV,`
`).replace(yV,"")}function Kf(e,t,n){if(t=ZS(t),ZS(e)!==t&&n)throw Error(rt(425))}function fm(){}var db=null,hb=null;function fb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pb=typeof setTimeout=="function"?setTimeout:void 0,bV=typeof clearTimeout=="function"?clearTimeout:void 0,JS=typeof Promise=="function"?Promise:void 0,vV=typeof queueMicrotask=="function"?queueMicrotask:typeof JS<"u"?function(e){return JS.resolve(null).then(e).catch(wV)}:pb;function wV(e){setTimeout(function(){throw e})}function X0(e,t){var n=t,s=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){e.removeChild(r),kd(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);kd(t)}function Ni(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function tI(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Kc=Math.random().toString(36).slice(2),Gr="__reactFiber$"+Kc,Td="__reactProps$"+Kc,Do="__reactContainer$"+Kc,mb="__reactEvents$"+Kc,kV="__reactListeners$"+Kc,CV="__reactHandles$"+Kc;function Ia(e){var t=e[Gr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Do]||n[Gr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=tI(e);e!==null;){if(n=e[Gr])return n;e=tI(e)}return t}e=n,n=e.parentNode}return null}function ch(e){return e=e[Gr]||e[Do],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Wl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(rt(33))}function Sg(e){return e[Td]||null}var gb=[],Ul=-1;function Zi(e){return{current:e}}function ge(e){0>Ul||(e.current=gb[Ul],gb[Ul]=null,Ul--)}function ue(e,t){Ul++,gb[Ul]=e.current,e.current=t}var zi={},Fn=Zi(zi),us=Zi(!1),ja=zi;function vc(e,t){var n=e.type.contextTypes;if(!n)return zi;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=t[o];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function ds(e){return e=e.childContextTypes,e!=null}function pm(){ge(us),ge(Fn)}function eI(e,t,n){if(Fn.current!==zi)throw Error(rt(168));ue(Fn,t),ue(us,n)}function AE(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in t))throw Error(rt(108,aB(e)||"Unknown",r));return Ne({},n,s)}function mm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||zi,ja=Fn.current,ue(Fn,e),ue(us,us.current),!0}function nI(e,t,n){var s=e.stateNode;if(!s)throw Error(rt(169));n?(e=AE(e,t,ja),s.__reactInternalMemoizedMergedChildContext=e,ge(us),ge(Fn),ue(Fn,e)):ge(us),ue(us,n)}var yo=null,Ig=!1,q0=!1;function OE(e){yo===null?yo=[e]:yo.push(e)}function SV(e){Ig=!0,OE(e)}function Ji(){if(!q0&&yo!==null){q0=!0;var e=0,t=Jt;try{var n=yo;for(Jt=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}yo=null,Ig=!1}catch(r){throw yo!==null&&(yo=yo.slice(e+1)),oE(av,Ji),r}finally{Jt=t,q0=!1}}return null}var jl=[],Gl=0,gm=null,xm=0,Vs=[],Ws=0,Ga=null,Co=1,So="";function xa(e,t){jl[Gl++]=xm,jl[Gl++]=gm,gm=e,xm=t}function FE(e,t,n){Vs[Ws++]=Co,Vs[Ws++]=So,Vs[Ws++]=Ga,Ga=e;var s=Co;e=So;var r=32-br(s)-1;s&=~(1<<r),n+=1;var o=32-br(t)+r;if(30<o){var i=r-r%5;o=(s&(1<<i)-1).toString(32),s>>=i,r-=i,Co=1<<32-br(t)+r|n<<r|s,So=o+e}else Co=1<<o|n<<r|s,So=e}function gv(e){e.return!==null&&(xa(e,1),FE(e,1,0))}function xv(e){for(;e===gm;)gm=jl[--Gl],jl[Gl]=null,xm=jl[--Gl],jl[Gl]=null;for(;e===Ga;)Ga=Vs[--Ws],Vs[Ws]=null,So=Vs[--Ws],Vs[Ws]=null,Co=Vs[--Ws],Vs[Ws]=null}var $s=null,Ss=null,we=!1,pr=null;function PE(e,t){var n=js(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function sI(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,$s=e,Ss=Ni(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,$s=e,Ss=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ga!==null?{id:Co,overflow:So}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=js(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,$s=e,Ss=null,!0):!1;default:return!1}}function xb(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yb(e){if(we){var t=Ss;if(t){var n=t;if(!sI(e,t)){if(xb(e))throw Error(rt(418));t=Ni(n.nextSibling);var s=$s;t&&sI(e,t)?PE(s,n):(e.flags=e.flags&-4097|2,we=!1,$s=e)}}else{if(xb(e))throw Error(rt(418));e.flags=e.flags&-4097|2,we=!1,$s=e}}}function rI(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;$s=e}function Xf(e){if(e!==$s)return!1;if(!we)return rI(e),we=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fb(e.type,e.memoizedProps)),t&&(t=Ss)){if(xb(e))throw ME(),Error(rt(418));for(;t;)PE(e,t),t=Ni(t.nextSibling)}if(rI(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(rt(317));t:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ss=Ni(e.nextSibling);break t}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ss=null}}else Ss=$s?Ni(e.stateNode.nextSibling):null;return!0}function ME(){for(var e=Ss;e;)e=Ni(e.nextSibling)}function wc(){Ss=$s=null,we=!1}function yv(e){pr===null?pr=[e]:pr.push(e)}var IV=Vo.ReactCurrentBatchConfig;function Cu(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(rt(309));var s=n.stateNode}if(!s)throw Error(rt(147,e));var r=s,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var a=r.refs;i===null?delete a[o]:a[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(rt(284));if(!n._owner)throw Error(rt(290,e))}return e}function qf(e,t){throw e=Object.prototype.toString.call(t),Error(rt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function oI(e){var t=e._init;return t(e._payload)}function LE(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function n(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function s(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function r(x,y){return x=Di(x,y),x.index=0,x.sibling=null,x}function o(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,y,b,v){return y===null||y.tag!==6?(y=ny(b,x.mode,v),y.return=x,y):(y=r(y,b),y.return=x,y)}function l(x,y,b,v){var w=b.type;return w===Ll?u(x,y,b.props.children,v,b.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===oi&&oI(w)===y.type)?(v=r(y,b.props),v.ref=Cu(x,y,b),v.return=x,v):(v=Up(b.type,b.key,b.props,null,x.mode,v),v.ref=Cu(x,y,b),v.return=x,v)}function c(x,y,b,v){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=sy(b,x.mode,v),y.return=x,y):(y=r(y,b.children||[]),y.return=x,y)}function u(x,y,b,v,w){return y===null||y.tag!==7?(y=La(b,x.mode,v,w),y.return=x,y):(y=r(y,b),y.return=x,y)}function d(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ny(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Lf:return b=Up(y.type,y.key,y.props,null,x.mode,b),b.ref=Cu(x,null,y),b.return=x,b;case Ml:return y=sy(y,x.mode,b),y.return=x,y;case oi:var v=y._init;return d(x,v(y._payload),b)}if(Lu(y)||yu(y))return y=La(y,x.mode,b,null),y.return=x,y;qf(x,y)}return null}function h(x,y,b,v){var w=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return w!==null?null:a(x,y,""+b,v);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Lf:return b.key===w?l(x,y,b,v):null;case Ml:return b.key===w?c(x,y,b,v):null;case oi:return w=b._init,h(x,y,w(b._payload),v)}if(Lu(b)||yu(b))return w!==null?null:u(x,y,b,v,null);qf(x,b)}return null}function f(x,y,b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return x=x.get(b)||null,a(y,x,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Lf:return x=x.get(v.key===null?b:v.key)||null,l(y,x,v,w);case Ml:return x=x.get(v.key===null?b:v.key)||null,c(y,x,v,w);case oi:var k=v._init;return f(x,y,b,k(v._payload),w)}if(Lu(v)||yu(v))return x=x.get(b)||null,u(y,x,v,w,null);qf(y,v)}return null}function p(x,y,b,v){for(var w=null,k=null,C=y,S=y=0,I=null;C!==null&&S<b.length;S++){C.index>S?(I=C,C=null):I=C.sibling;var $=h(x,C,b[S],v);if($===null){C===null&&(C=I);break}e&&C&&$.alternate===null&&t(x,C),y=o($,y,S),k===null?w=$:k.sibling=$,k=$,C=I}if(S===b.length)return n(x,C),we&&xa(x,S),w;if(C===null){for(;S<b.length;S++)C=d(x,b[S],v),C!==null&&(y=o(C,y,S),k===null?w=C:k.sibling=C,k=C);return we&&xa(x,S),w}for(C=s(x,C);S<b.length;S++)I=f(C,x,S,b[S],v),I!==null&&(e&&I.alternate!==null&&C.delete(I.key===null?S:I.key),y=o(I,y,S),k===null?w=I:k.sibling=I,k=I);return e&&C.forEach(function(E){return t(x,E)}),we&&xa(x,S),w}function m(x,y,b,v){var w=yu(b);if(typeof w!="function")throw Error(rt(150));if(b=w.call(b),b==null)throw Error(rt(151));for(var k=w=null,C=y,S=y=0,I=null,$=b.next();C!==null&&!$.done;S++,$=b.next()){C.index>S?(I=C,C=null):I=C.sibling;var E=h(x,C,$.value,v);if(E===null){C===null&&(C=I);break}e&&C&&E.alternate===null&&t(x,C),y=o(E,y,S),k===null?w=E:k.sibling=E,k=E,C=I}if($.done)return n(x,C),we&&xa(x,S),w;if(C===null){for(;!$.done;S++,$=b.next())$=d(x,$.value,v),$!==null&&(y=o($,y,S),k===null?w=$:k.sibling=$,k=$);return we&&xa(x,S),w}for(C=s(x,C);!$.done;S++,$=b.next())$=f(C,x,S,$.value,v),$!==null&&(e&&$.alternate!==null&&C.delete($.key===null?S:$.key),y=o($,y,S),k===null?w=$:k.sibling=$,k=$);return e&&C.forEach(function(A){return t(x,A)}),we&&xa(x,S),w}function g(x,y,b,v){if(typeof b=="object"&&b!==null&&b.type===Ll&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Lf:t:{for(var w=b.key,k=y;k!==null;){if(k.key===w){if(w=b.type,w===Ll){if(k.tag===7){n(x,k.sibling),y=r(k,b.props.children),y.return=x,x=y;break t}}else if(k.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===oi&&oI(w)===k.type){n(x,k.sibling),y=r(k,b.props),y.ref=Cu(x,k,b),y.return=x,x=y;break t}n(x,k);break}else t(x,k);k=k.sibling}b.type===Ll?(y=La(b.props.children,x.mode,v,b.key),y.return=x,x=y):(v=Up(b.type,b.key,b.props,null,x.mode,v),v.ref=Cu(x,y,b),v.return=x,x=v)}return i(x);case Ml:t:{for(k=b.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(x,y.sibling),y=r(y,b.children||[]),y.return=x,x=y;break t}else{n(x,y);break}else t(x,y);y=y.sibling}y=sy(b,x.mode,v),y.return=x,x=y}return i(x);case oi:return k=b._init,g(x,y,k(b._payload),v)}if(Lu(b))return p(x,y,b,v);if(yu(b))return m(x,y,b,v);qf(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(x,y.sibling),y=r(y,b),y.return=x,x=y):(n(x,y),y=ny(b,x.mode,v),y.return=x,x=y),i(x)):n(x,y)}return g}var kc=LE(!0),zE=LE(!1),ym=Zi(null),bm=null,Hl=null,bv=null;function vv(){bv=Hl=bm=null}function wv(e){var t=ym.current;ge(ym),e._currentValue=t}function bb(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function tc(e,t){bm=e,bv=Hl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(as=!0),e.firstContext=null)}function Qs(e){var t=e._currentValue;if(bv!==e)if(e={context:e,memoizedValue:t,next:null},Hl===null){if(bm===null)throw Error(rt(308));Hl=e,bm.dependencies={lanes:0,firstContext:e}}else Hl=Hl.next=e;return t}var $a=null;function kv(e){$a===null?$a=[e]:$a.push(e)}function BE(e,t,n,s){var r=t.interleaved;return r===null?(n.next=n,kv(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ao(e,s)}function Ao(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ii=!1;function Cv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function VE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Eo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ei(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Ut&2){var r=s.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),s.pending=t,Ao(e,n)}return r=s.interleaved,r===null?(t.next=t,kv(s)):(t.next=r.next,r.next=t),s.interleaved=t,Ao(e,n)}function Mp(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,lv(e,n)}}function iI(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?r=o=t:o=o.next=t}else r=o=t;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function vm(e,t,n,s){var r=e.updateQueue;ii=!1;var o=r.firstBaseUpdate,i=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,i===null?o=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==i&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=r.baseState;i=0,u=c=l=null,a=o;do{var h=a.lane,f=a.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var p=e,m=a;switch(h=t,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break t}d=p;break t;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break t;d=Ne({},d,h);break t;case 2:ii=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,i|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,t=r.shared.interleaved,t!==null){r=t;do i|=r.lane,r=r.next;while(r!==t)}else o===null&&(r.shared.lanes=0);Ka|=i,e.lanes=i,e.memoizedState=d}}function aI(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(rt(191,r));r.call(s)}}}var uh={},Xr=Zi(uh),Nd=Zi(uh),Ed=Zi(uh);function Ta(e){if(e===uh)throw Error(rt(174));return e}function Sv(e,t){switch(ue(Ed,t),ue(Nd,e),ue(Xr,uh),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Jy(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Jy(t,e)}ge(Xr),ue(Xr,t)}function Cc(){ge(Xr),ge(Nd),ge(Ed)}function WE(e){Ta(Ed.current);var t=Ta(Xr.current),n=Jy(t,e.type);t!==n&&(ue(Nd,e),ue(Xr,n))}function Iv(e){Nd.current===e&&(ge(Xr),ge(Nd))}var $e=Zi(0);function wm(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Y0=[];function $v(){for(var e=0;e<Y0.length;e++)Y0[e]._workInProgressVersionPrimary=null;Y0.length=0}var Lp=Vo.ReactCurrentDispatcher,Q0=Vo.ReactCurrentBatchConfig,Ha=0,Te=null,Ye=null,on=null,km=!1,od=!1,_d=0,$V=0;function Sn(){throw Error(rt(321))}function Tv(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ir(e[n],t[n]))return!1;return!0}function Nv(e,t,n,s,r,o){if(Ha=o,Te=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Lp.current=e===null||e.memoizedState===null?_V:RV,e=n(s,r),od){o=0;do{if(od=!1,_d=0,25<=o)throw Error(rt(301));o+=1,on=Ye=null,t.updateQueue=null,Lp.current=DV,e=n(s,r)}while(od)}if(Lp.current=Cm,t=Ye!==null&&Ye.next!==null,Ha=0,on=Ye=Te=null,km=!1,t)throw Error(rt(300));return e}function Ev(){var e=_d!==0;return _d=0,e}function Fr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?Te.memoizedState=on=e:on=on.next=e,on}function Zs(){if(Ye===null){var e=Te.alternate;e=e!==null?e.memoizedState:null}else e=Ye.next;var t=on===null?Te.memoizedState:on.next;if(t!==null)on=t,Ye=e;else{if(e===null)throw Error(rt(310));Ye=e,e={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},on===null?Te.memoizedState=on=e:on=on.next=e}return on}function Rd(e,t){return typeof t=="function"?t(e):t}function Z0(e){var t=Zs(),n=t.queue;if(n===null)throw Error(rt(311));n.lastRenderedReducer=e;var s=Ye,r=s.baseQueue,o=n.pending;if(o!==null){if(r!==null){var i=r.next;r.next=o.next,o.next=i}s.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,s=s.baseState;var a=i=null,l=null,c=o;do{var u=c.lane;if((Ha&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:e(s,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,i=s):l=l.next=d,Te.lanes|=u,Ka|=u}c=c.next}while(c!==null&&c!==o);l===null?i=s:l.next=a,Ir(s,t.memoizedState)||(as=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=l,n.lastRenderedState=s}if(e=n.interleaved,e!==null){r=e;do o=r.lane,Te.lanes|=o,Ka|=o,r=r.next;while(r!==e)}else r===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function J0(e){var t=Zs(),n=t.queue;if(n===null)throw Error(rt(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,o=t.memoizedState;if(r!==null){n.pending=null;var i=r=r.next;do o=e(o,i.action),i=i.next;while(i!==r);Ir(o,t.memoizedState)||(as=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,s]}function UE(){}function jE(e,t){var n=Te,s=Zs(),r=t(),o=!Ir(s.memoizedState,r);if(o&&(s.memoizedState=r,as=!0),s=s.queue,_v(KE.bind(null,n,s,e),[e]),s.getSnapshot!==t||o||on!==null&&on.memoizedState.tag&1){if(n.flags|=2048,Dd(9,HE.bind(null,n,s,r,t),void 0,null),cn===null)throw Error(rt(349));Ha&30||GE(n,t,r)}return r}function GE(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Te.updateQueue,t===null?(t={lastEffect:null,stores:null},Te.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function HE(e,t,n,s){t.value=n,t.getSnapshot=s,XE(t)&&qE(e)}function KE(e,t,n){return n(function(){XE(t)&&qE(e)})}function XE(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ir(e,n)}catch{return!0}}function qE(e){var t=Ao(e,1);t!==null&&vr(t,e,1,-1)}function lI(e){var t=Fr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rd,lastRenderedState:e},t.queue=e,e=e.dispatch=EV.bind(null,Te,e),[t.memoizedState,e]}function Dd(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Te.updateQueue,t===null?(t={lastEffect:null,stores:null},Te.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function YE(){return Zs().memoizedState}function zp(e,t,n,s){var r=Fr();Te.flags|=e,r.memoizedState=Dd(1|t,n,void 0,s===void 0?null:s)}function $g(e,t,n,s){var r=Zs();s=s===void 0?null:s;var o=void 0;if(Ye!==null){var i=Ye.memoizedState;if(o=i.destroy,s!==null&&Tv(s,i.deps)){r.memoizedState=Dd(t,n,o,s);return}}Te.flags|=e,r.memoizedState=Dd(1|t,n,o,s)}function cI(e,t){return zp(8390656,8,e,t)}function _v(e,t){return $g(2048,8,e,t)}function QE(e,t){return $g(4,2,e,t)}function ZE(e,t){return $g(4,4,e,t)}function JE(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function t_(e,t,n){return n=n!=null?n.concat([e]):null,$g(4,4,JE.bind(null,t,e),n)}function Rv(){}function e_(e,t){var n=Zs();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&Tv(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function n_(e,t){var n=Zs();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&Tv(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function s_(e,t,n){return Ha&21?(Ir(n,t)||(n=lE(),Te.lanes|=n,Ka|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,as=!0),e.memoizedState=n)}function TV(e,t){var n=Jt;Jt=n!==0&&4>n?n:4,e(!0);var s=Q0.transition;Q0.transition={};try{e(!1),t()}finally{Jt=n,Q0.transition=s}}function r_(){return Zs().memoizedState}function NV(e,t,n){var s=Ri(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},o_(e))i_(t,n);else if(n=BE(e,t,n,s),n!==null){var r=Xn();vr(n,e,s,r),a_(n,t,s)}}function EV(e,t,n){var s=Ri(e),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(o_(e))i_(t,r);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,a=o(i,n);if(r.hasEagerState=!0,r.eagerState=a,Ir(a,i)){var l=t.interleaved;l===null?(r.next=r,kv(t)):(r.next=l.next,l.next=r),t.interleaved=r;return}}catch{}finally{}n=BE(e,t,r,s),n!==null&&(r=Xn(),vr(n,e,s,r),a_(n,t,s))}}function o_(e){var t=e.alternate;return e===Te||t!==null&&t===Te}function i_(e,t){od=km=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function a_(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,lv(e,n)}}var Cm={readContext:Qs,useCallback:Sn,useContext:Sn,useEffect:Sn,useImperativeHandle:Sn,useInsertionEffect:Sn,useLayoutEffect:Sn,useMemo:Sn,useReducer:Sn,useRef:Sn,useState:Sn,useDebugValue:Sn,useDeferredValue:Sn,useTransition:Sn,useMutableSource:Sn,useSyncExternalStore:Sn,useId:Sn,unstable_isNewReconciler:!1},_V={readContext:Qs,useCallback:function(e,t){return Fr().memoizedState=[e,t===void 0?null:t],e},useContext:Qs,useEffect:cI,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,zp(4194308,4,JE.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zp(4194308,4,e,t)},useInsertionEffect:function(e,t){return zp(4,2,e,t)},useMemo:function(e,t){var n=Fr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Fr();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=NV.bind(null,Te,e),[s.memoizedState,e]},useRef:function(e){var t=Fr();return e={current:e},t.memoizedState=e},useState:lI,useDebugValue:Rv,useDeferredValue:function(e){return Fr().memoizedState=e},useTransition:function(){var e=lI(!1),t=e[0];return e=TV.bind(null,e[1]),Fr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Te,r=Fr();if(we){if(n===void 0)throw Error(rt(407));n=n()}else{if(n=t(),cn===null)throw Error(rt(349));Ha&30||GE(s,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,cI(KE.bind(null,s,o,e),[e]),s.flags|=2048,Dd(9,HE.bind(null,s,o,n,t),void 0,null),n},useId:function(){var e=Fr(),t=cn.identifierPrefix;if(we){var n=So,s=Co;n=(s&~(1<<32-br(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=_d++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=$V++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},RV={readContext:Qs,useCallback:e_,useContext:Qs,useEffect:_v,useImperativeHandle:t_,useInsertionEffect:QE,useLayoutEffect:ZE,useMemo:n_,useReducer:Z0,useRef:YE,useState:function(){return Z0(Rd)},useDebugValue:Rv,useDeferredValue:function(e){var t=Zs();return s_(t,Ye.memoizedState,e)},useTransition:function(){var e=Z0(Rd)[0],t=Zs().memoizedState;return[e,t]},useMutableSource:UE,useSyncExternalStore:jE,useId:r_,unstable_isNewReconciler:!1},DV={readContext:Qs,useCallback:e_,useContext:Qs,useEffect:_v,useImperativeHandle:t_,useInsertionEffect:QE,useLayoutEffect:ZE,useMemo:n_,useReducer:J0,useRef:YE,useState:function(){return J0(Rd)},useDebugValue:Rv,useDeferredValue:function(e){var t=Zs();return Ye===null?t.memoizedState=e:s_(t,Ye.memoizedState,e)},useTransition:function(){var e=J0(Rd)[0],t=Zs().memoizedState;return[e,t]},useMutableSource:UE,useSyncExternalStore:jE,useId:r_,unstable_isNewReconciler:!1};function ur(e,t){if(e&&e.defaultProps){t=Ne({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function vb(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:Ne({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Tg={isMounted:function(e){return(e=e._reactInternals)?gl(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Xn(),r=Ri(e),o=Eo(s,r);o.payload=t,n!=null&&(o.callback=n),t=Ei(e,o,r),t!==null&&(vr(t,e,r,s),Mp(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Xn(),r=Ri(e),o=Eo(s,r);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Ei(e,o,r),t!==null&&(vr(t,e,r,s),Mp(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Xn(),s=Ri(e),r=Eo(n,s);r.tag=2,t!=null&&(r.callback=t),t=Ei(e,r,s),t!==null&&(vr(t,e,s,n),Mp(t,e,s))}};function uI(e,t,n,s,r,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,o,i):t.prototype&&t.prototype.isPureReactComponent?!Sd(n,s)||!Sd(r,o):!0}function l_(e,t,n){var s=!1,r=zi,o=t.contextType;return typeof o=="object"&&o!==null?o=Qs(o):(r=ds(t)?ja:Fn.current,s=t.contextTypes,o=(s=s!=null)?vc(e,r):zi),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Tg,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function dI(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Tg.enqueueReplaceState(t,t.state,null)}function wb(e,t,n,s){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Cv(e);var o=t.contextType;typeof o=="object"&&o!==null?r.context=Qs(o):(o=ds(t)?ja:Fn.current,r.context=vc(e,o)),r.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(vb(e,t,o,n),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&Tg.enqueueReplaceState(r,r.state,null),vm(e,n,r,s),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Sc(e,t){try{var n="",s=t;do n+=iB(s),s=s.return;while(s);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:r,digest:null}}function ty(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function kb(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var AV=typeof WeakMap=="function"?WeakMap:Map;function c_(e,t,n){n=Eo(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Im||(Im=!0,Db=s),kb(e,t)},n}function u_(e,t,n){n=Eo(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var r=t.value;n.payload=function(){return s(r)},n.callback=function(){kb(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){kb(e,t),typeof s!="function"&&(_i===null?_i=new Set([this]):_i.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function hI(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new AV;var r=new Set;s.set(t,r)}else r=s.get(t),r===void 0&&(r=new Set,s.set(t,r));r.has(n)||(r.add(n),e=KV.bind(null,e,t,n),t.then(e,e))}function fI(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function pI(e,t,n,s,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Eo(-1,1),t.tag=2,Ei(n,t,1))),n.lanes|=1),e)}var OV=Vo.ReactCurrentOwner,as=!1;function Wn(e,t,n,s){t.child=e===null?zE(t,null,n,s):kc(t,e.child,n,s)}function mI(e,t,n,s,r){n=n.render;var o=t.ref;return tc(t,r),s=Nv(e,t,n,s,o,r),n=Ev(),e!==null&&!as?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Oo(e,t,r)):(we&&n&&gv(t),t.flags|=1,Wn(e,t,s,r),t.child)}function gI(e,t,n,s,r){if(e===null){var o=n.type;return typeof o=="function"&&!zv(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,d_(e,t,o,s,r)):(e=Up(n.type,null,s,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&r)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Sd,n(i,s)&&e.ref===t.ref)return Oo(e,t,r)}return t.flags|=1,e=Di(o,s),e.ref=t.ref,e.return=t,t.child=e}function d_(e,t,n,s,r){if(e!==null){var o=e.memoizedProps;if(Sd(o,s)&&e.ref===t.ref)if(as=!1,t.pendingProps=s=o,(e.lanes&r)!==0)e.flags&131072&&(as=!0);else return t.lanes=e.lanes,Oo(e,t,r)}return Cb(e,t,n,s,r)}function h_(e,t,n){var s=t.pendingProps,r=s.children,o=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ue(Xl,vs),vs|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ue(Xl,vs),vs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:n,ue(Xl,vs),vs|=s}else o!==null?(s=o.baseLanes|n,t.memoizedState=null):s=n,ue(Xl,vs),vs|=s;return Wn(e,t,r,n),t.child}function f_(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cb(e,t,n,s,r){var o=ds(n)?ja:Fn.current;return o=vc(t,o),tc(t,r),n=Nv(e,t,n,s,o,r),s=Ev(),e!==null&&!as?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Oo(e,t,r)):(we&&s&&gv(t),t.flags|=1,Wn(e,t,n,r),t.child)}function xI(e,t,n,s,r){if(ds(n)){var o=!0;mm(t)}else o=!1;if(tc(t,r),t.stateNode===null)Bp(e,t),l_(t,n,s),wb(t,n,s,r),s=!0;else if(e===null){var i=t.stateNode,a=t.memoizedProps;i.props=a;var l=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=Qs(c):(c=ds(n)?ja:Fn.current,c=vc(t,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==s||l!==c)&&dI(t,i,s,c),ii=!1;var h=t.memoizedState;i.state=h,vm(t,s,i,r),l=t.memoizedState,a!==s||h!==l||us.current||ii?(typeof u=="function"&&(vb(t,n,u,s),l=t.memoizedState),(a=ii||uI(t,n,a,s,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=l),i.props=s,i.state=l,i.context=c,s=a):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,VE(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ur(t.type,a),i.props=c,d=t.pendingProps,h=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Qs(l):(l=ds(n)?ja:Fn.current,l=vc(t,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||h!==l)&&dI(t,i,s,l),ii=!1,h=t.memoizedState,i.state=h,vm(t,s,i,r);var p=t.memoizedState;a!==d||h!==p||us.current||ii?(typeof f=="function"&&(vb(t,n,f,s),p=t.memoizedState),(c=ii||uI(t,n,c,s,h,p,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,p,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=p),i.props=s,i.state=p,i.context=l,s=c):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return Sb(e,t,n,s,o,r)}function Sb(e,t,n,s,r,o){f_(e,t);var i=(t.flags&128)!==0;if(!s&&!i)return r&&nI(t,n,!1),Oo(e,t,o);s=t.stateNode,OV.current=t;var a=i&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&i?(t.child=kc(t,e.child,null,o),t.child=kc(t,null,a,o)):Wn(e,t,a,o),t.memoizedState=s.state,r&&nI(t,n,!0),t.child}function p_(e){var t=e.stateNode;t.pendingContext?eI(e,t.pendingContext,t.pendingContext!==t.context):t.context&&eI(e,t.context,!1),Sv(e,t.containerInfo)}function yI(e,t,n,s,r){return wc(),yv(r),t.flags|=256,Wn(e,t,n,s),t.child}var Ib={dehydrated:null,treeContext:null,retryLane:0};function $b(e){return{baseLanes:e,cachePool:null,transitions:null}}function m_(e,t,n){var s=t.pendingProps,r=$e.current,o=!1,i=(t.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),ue($e,r&1),e===null)return yb(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=s.children,e=s.fallback,o?(s=t.mode,o=t.child,i={mode:"hidden",children:i},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=_g(i,s,0,null),e=La(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=$b(n),t.memoizedState=Ib,e):Dv(t,i));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return FV(e,t,i,s,a,r,n);if(o){o=s.fallback,i=t.mode,r=e.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(i&1)&&t.child!==r?(s=t.child,s.childLanes=0,s.pendingProps=l,t.deletions=null):(s=Di(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?o=Di(a,o):(o=La(o,i,n,null),o.flags|=2),o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,i=e.child.memoizedState,i=i===null?$b(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~n,t.memoizedState=Ib,s}return o=e.child,e=o.sibling,s=Di(o,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Dv(e,t){return t=_g({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Yf(e,t,n,s){return s!==null&&yv(s),kc(t,e.child,null,n),e=Dv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function FV(e,t,n,s,r,o,i){if(n)return t.flags&256?(t.flags&=-257,s=ty(Error(rt(422))),Yf(e,t,i,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=s.fallback,r=t.mode,s=_g({mode:"visible",children:s.children},r,0,null),o=La(o,r,i,null),o.flags|=2,s.return=t,o.return=t,s.sibling=o,t.child=s,t.mode&1&&kc(t,e.child,null,i),t.child.memoizedState=$b(i),t.memoizedState=Ib,o);if(!(t.mode&1))return Yf(e,t,i,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,o=Error(rt(419)),s=ty(o,s,void 0),Yf(e,t,i,s)}if(a=(i&e.childLanes)!==0,as||a){if(s=cn,s!==null){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|i)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,Ao(e,r),vr(s,e,r,-1))}return Lv(),s=ty(Error(rt(421))),Yf(e,t,i,s)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=XV.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,Ss=Ni(r.nextSibling),$s=t,we=!0,pr=null,e!==null&&(Vs[Ws++]=Co,Vs[Ws++]=So,Vs[Ws++]=Ga,Co=e.id,So=e.overflow,Ga=t),t=Dv(t,s.children),t.flags|=4096,t)}function bI(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),bb(e.return,t,n)}function ey(e,t,n,s,r){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=n,o.tailMode=r)}function g_(e,t,n){var s=t.pendingProps,r=s.revealOrder,o=s.tail;if(Wn(e,t,s.children,n),s=$e.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bI(e,n,t);else if(e.tag===19)bI(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;e.sibling===null;){if(e.return===null||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(ue($e,s),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&wm(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),ey(t,!1,r,n,o);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&wm(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}ey(t,!0,n,null,o);break;case"together":ey(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bp(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Oo(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ka|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(rt(153));if(t.child!==null){for(e=t.child,n=Di(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Di(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function PV(e,t,n){switch(t.tag){case 3:p_(t),wc();break;case 5:WE(t);break;case 1:ds(t.type)&&mm(t);break;case 4:Sv(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,r=t.memoizedProps.value;ue(ym,s._currentValue),s._currentValue=r;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(ue($e,$e.current&1),t.flags|=128,null):n&t.child.childLanes?m_(e,t,n):(ue($e,$e.current&1),e=Oo(e,t,n),e!==null?e.sibling:null);ue($e,$e.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return g_(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ue($e,$e.current),s)break;return null;case 22:case 23:return t.lanes=0,h_(e,t,n)}return Oo(e,t,n)}var x_,Tb,y_,b_;x_=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Tb=function(){};y_=function(e,t,n,s){var r=e.memoizedProps;if(r!==s){e=t.stateNode,Ta(Xr.current);var o=null;switch(n){case"input":r=qy(e,r),s=qy(e,s),o=[];break;case"select":r=Ne({},r,{value:void 0}),s=Ne({},s,{value:void 0}),o=[];break;case"textarea":r=Zy(e,r),s=Zy(e,s),o=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=fm)}tb(n,s);var i;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xd.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xd.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&pe("scroll",e),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}};b_=function(e,t,n,s){n!==s&&(t.flags|=4)};function Su(e,t){if(!we)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function In(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function MV(e,t,n){var s=t.pendingProps;switch(xv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return In(t),null;case 1:return ds(t.type)&&pm(),In(t),null;case 3:return s=t.stateNode,Cc(),ge(us),ge(Fn),$v(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Xf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,pr!==null&&(Fb(pr),pr=null))),Tb(e,t),In(t),null;case 5:Iv(t);var r=Ta(Ed.current);if(n=t.type,e!==null&&t.stateNode!=null)y_(e,t,n,s,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(rt(166));return In(t),null}if(e=Ta(Xr.current),Xf(t)){s=t.stateNode,n=t.type;var o=t.memoizedProps;switch(s[Gr]=t,s[Td]=o,e=(t.mode&1)!==0,n){case"dialog":pe("cancel",s),pe("close",s);break;case"iframe":case"object":case"embed":pe("load",s);break;case"video":case"audio":for(r=0;r<Bu.length;r++)pe(Bu[r],s);break;case"source":pe("error",s);break;case"img":case"image":case"link":pe("error",s),pe("load",s);break;case"details":pe("toggle",s);break;case"input":NS(s,o),pe("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},pe("invalid",s);break;case"textarea":_S(s,o),pe("invalid",s)}tb(n,o),r=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?s.textContent!==a&&(o.suppressHydrationWarning!==!0&&Kf(s.textContent,a,e),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Kf(s.textContent,a,e),r=["children",""+a]):xd.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&pe("scroll",s)}switch(n){case"input":zf(s),ES(s,o,!0);break;case"textarea":zf(s),RS(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=fm)}s=r,t.updateQueue=s,s!==null&&(t.flags|=4)}else{i=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=KN(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=i.createElement(n,{is:s.is}):(e=i.createElement(n),n==="select"&&(i=e,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):e=i.createElementNS(e,n),e[Gr]=t,e[Td]=s,x_(e,t,!1,!1),t.stateNode=e;t:{switch(i=eb(n,s),n){case"dialog":pe("cancel",e),pe("close",e),r=s;break;case"iframe":case"object":case"embed":pe("load",e),r=s;break;case"video":case"audio":for(r=0;r<Bu.length;r++)pe(Bu[r],e);r=s;break;case"source":pe("error",e),r=s;break;case"img":case"image":case"link":pe("error",e),pe("load",e),r=s;break;case"details":pe("toggle",e),r=s;break;case"input":NS(e,s),r=qy(e,s),pe("invalid",e);break;case"option":r=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},r=Ne({},s,{value:void 0}),pe("invalid",e);break;case"textarea":_S(e,s),r=Zy(e,s),pe("invalid",e);break;default:r=s}tb(n,r),a=r;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?YN(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&XN(e,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&yd(e,l):typeof l=="number"&&yd(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(xd.hasOwnProperty(o)?l!=null&&o==="onScroll"&&pe("scroll",e):l!=null&&nv(e,o,l,i))}switch(n){case"input":zf(e),ES(e,s,!1);break;case"textarea":zf(e),RS(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Li(s.value));break;case"select":e.multiple=!!s.multiple,o=s.value,o!=null?Yl(e,!!s.multiple,o,!1):s.defaultValue!=null&&Yl(e,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=fm)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break t;case"img":s=!0;break t;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return In(t),null;case 6:if(e&&t.stateNode!=null)b_(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(rt(166));if(n=Ta(Ed.current),Ta(Xr.current),Xf(t)){if(s=t.stateNode,n=t.memoizedProps,s[Gr]=t,(o=s.nodeValue!==n)&&(e=$s,e!==null))switch(e.tag){case 3:Kf(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Kf(s.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Gr]=t,t.stateNode=s}return In(t),null;case 13:if(ge($e),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(we&&Ss!==null&&t.mode&1&&!(t.flags&128))ME(),wc(),t.flags|=98560,o=!1;else if(o=Xf(t),s!==null&&s.dehydrated!==null){if(e===null){if(!o)throw Error(rt(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(rt(317));o[Gr]=t}else wc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;In(t),o=!1}else pr!==null&&(Fb(pr),pr=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||$e.current&1?tn===0&&(tn=3):Lv())),t.updateQueue!==null&&(t.flags|=4),In(t),null);case 4:return Cc(),Tb(e,t),e===null&&Id(t.stateNode.containerInfo),In(t),null;case 10:return wv(t.type._context),In(t),null;case 17:return ds(t.type)&&pm(),In(t),null;case 19:if(ge($e),o=t.memoizedState,o===null)return In(t),null;if(s=(t.flags&128)!==0,i=o.rendering,i===null)if(s)Su(o,!1);else{if(tn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=wm(e),i!==null){for(t.flags|=128,Su(o,!1),s=i.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)o=n,e=s,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ue($e,$e.current&1|2),t.child}e=e.sibling}o.tail!==null&&ze()>Ic&&(t.flags|=128,s=!0,Su(o,!1),t.lanes=4194304)}else{if(!s)if(e=wm(i),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Su(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!we)return In(t),null}else 2*ze()-o.renderingStartTime>Ic&&n!==1073741824&&(t.flags|=128,s=!0,Su(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(n=o.last,n!==null?n.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=ze(),t.sibling=null,n=$e.current,ue($e,s?n&1|2:n&1),t):(In(t),null);case 22:case 23:return Mv(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?vs&1073741824&&(In(t),t.subtreeFlags&6&&(t.flags|=8192)):In(t),null;case 24:return null;case 25:return null}throw Error(rt(156,t.tag))}function LV(e,t){switch(xv(t),t.tag){case 1:return ds(t.type)&&pm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Cc(),ge(us),ge(Fn),$v(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Iv(t),null;case 13:if(ge($e),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(rt(340));wc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ge($e),null;case 4:return Cc(),null;case 10:return wv(t.type._context),null;case 22:case 23:return Mv(),null;case 24:return null;default:return null}}var Qf=!1,_n=!1,zV=typeof WeakSet=="function"?WeakSet:Set,ht=null;function Kl(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){_e(e,t,s)}else n.current=null}function Nb(e,t,n){try{n()}catch(s){_e(e,t,s)}}var vI=!1;function BV(e,t){if(db=um,e=SE(),mv(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else t:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break t}var i=0,a=-1,l=-1,c=0,u=0,d=e,h=null;e:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=i+r),d!==o||s!==0&&d.nodeType!==3||(l=i+s),d.nodeType===3&&(i+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===e)break e;if(h===n&&++c===r&&(a=i),h===o&&++u===s&&(l=i),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(hb={focusedElem:e,selectionRange:n},um=!1,ht=t;ht!==null;)if(t=ht,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ht=e;else for(;ht!==null;){t=ht;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:ur(t.type,m),g);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(rt(163))}}catch(v){_e(t,t.return,v)}if(e=t.sibling,e!==null){e.return=t.return,ht=e;break}ht=t.return}return p=vI,vI=!1,p}function id(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&e)===e){var o=r.destroy;r.destroy=void 0,o!==void 0&&Nb(t,n,o)}r=r.next}while(r!==s)}}function Ng(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function Eb(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function v_(e){var t=e.alternate;t!==null&&(e.alternate=null,v_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gr],delete t[Td],delete t[mb],delete t[kV],delete t[CV])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function w_(e){return e.tag===5||e.tag===3||e.tag===4}function wI(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||w_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _b(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=fm));else if(s!==4&&(e=e.child,e!==null))for(_b(e,t,n),e=e.sibling;e!==null;)_b(e,t,n),e=e.sibling}function Rb(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Rb(e,t,n),e=e.sibling;e!==null;)Rb(e,t,n),e=e.sibling}var pn=null,fr=!1;function ti(e,t,n){for(n=n.child;n!==null;)k_(e,t,n),n=n.sibling}function k_(e,t,n){if(Kr&&typeof Kr.onCommitFiberUnmount=="function")try{Kr.onCommitFiberUnmount(vg,n)}catch{}switch(n.tag){case 5:_n||Kl(n,t);case 6:var s=pn,r=fr;pn=null,ti(e,t,n),pn=s,fr=r,pn!==null&&(fr?(e=pn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):pn.removeChild(n.stateNode));break;case 18:pn!==null&&(fr?(e=pn,n=n.stateNode,e.nodeType===8?X0(e.parentNode,n):e.nodeType===1&&X0(e,n),kd(e)):X0(pn,n.stateNode));break;case 4:s=pn,r=fr,pn=n.stateNode.containerInfo,fr=!0,ti(e,t,n),pn=s,fr=r;break;case 0:case 11:case 14:case 15:if(!_n&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var o=r,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Nb(n,t,i),r=r.next}while(r!==s)}ti(e,t,n);break;case 1:if(!_n&&(Kl(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){_e(n,t,a)}ti(e,t,n);break;case 21:ti(e,t,n);break;case 22:n.mode&1?(_n=(s=_n)||n.memoizedState!==null,ti(e,t,n),_n=s):ti(e,t,n);break;default:ti(e,t,n)}}function kI(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new zV),t.forEach(function(s){var r=qV.bind(null,e,s);n.has(s)||(n.add(s),s.then(r,r))})}}function ar(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var o=e,i=t,a=i;t:for(;a!==null;){switch(a.tag){case 5:pn=a.stateNode,fr=!1;break t;case 3:pn=a.stateNode.containerInfo,fr=!0;break t;case 4:pn=a.stateNode.containerInfo,fr=!0;break t}a=a.return}if(pn===null)throw Error(rt(160));k_(o,i,r),pn=null,fr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){_e(r,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)C_(t,e),t=t.sibling}function C_(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ar(t,e),Ar(e),s&4){try{id(3,e,e.return),Ng(3,e)}catch(m){_e(e,e.return,m)}try{id(5,e,e.return)}catch(m){_e(e,e.return,m)}}break;case 1:ar(t,e),Ar(e),s&512&&n!==null&&Kl(n,n.return);break;case 5:if(ar(t,e),Ar(e),s&512&&n!==null&&Kl(n,n.return),e.flags&32){var r=e.stateNode;try{yd(r,"")}catch(m){_e(e,e.return,m)}}if(s&4&&(r=e.stateNode,r!=null)){var o=e.memoizedProps,i=n!==null?n.memoizedProps:o,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&GN(r,o),eb(a,i);var c=eb(a,o);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?YN(r,d):u==="dangerouslySetInnerHTML"?XN(r,d):u==="children"?yd(r,d):nv(r,u,d,c)}switch(a){case"input":Yy(r,o);break;case"textarea":HN(r,o);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?Yl(r,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?Yl(r,!!o.multiple,o.defaultValue,!0):Yl(r,!!o.multiple,o.multiple?[]:"",!1))}r[Td]=o}catch(m){_e(e,e.return,m)}}break;case 6:if(ar(t,e),Ar(e),s&4){if(e.stateNode===null)throw Error(rt(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(m){_e(e,e.return,m)}}break;case 3:if(ar(t,e),Ar(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{kd(t.containerInfo)}catch(m){_e(e,e.return,m)}break;case 4:ar(t,e),Ar(e);break;case 13:ar(t,e),Ar(e),r=e.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(Fv=ze())),s&4&&kI(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(_n=(c=_n)||u,ar(t,e),_n=c):ar(t,e),Ar(e),s&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ht=e,u=e.child;u!==null;){for(d=ht=u;ht!==null;){switch(h=ht,f=h.child,h.tag){case 0:case 11:case 14:case 15:id(4,h,h.return);break;case 1:Kl(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,n=h.return;try{t=s,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){_e(s,n,m)}}break;case 5:Kl(h,h.return);break;case 22:if(h.memoizedState!==null){SI(d);continue}}f!==null?(f.return=h,ht=f):SI(d)}u=u.sibling}t:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=qN("display",i))}catch(m){_e(e,e.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){_e(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break t;for(;d.sibling===null;){if(d.return===null||d.return===e)break t;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ar(t,e),Ar(e),s&4&&kI(e);break;case 21:break;default:ar(t,e),Ar(e)}}function Ar(e){var t=e.flags;if(t&2){try{t:{for(var n=e.return;n!==null;){if(w_(n)){var s=n;break t}n=n.return}throw Error(rt(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(yd(r,""),s.flags&=-33);var o=wI(e);Rb(e,o,r);break;case 3:case 4:var i=s.stateNode.containerInfo,a=wI(e);_b(e,a,i);break;default:throw Error(rt(161))}}catch(l){_e(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function VV(e,t,n){ht=e,S_(e)}function S_(e,t,n){for(var s=(e.mode&1)!==0;ht!==null;){var r=ht,o=r.child;if(r.tag===22&&s){var i=r.memoizedState!==null||Qf;if(!i){var a=r.alternate,l=a!==null&&a.memoizedState!==null||_n;a=Qf;var c=_n;if(Qf=i,(_n=l)&&!c)for(ht=r;ht!==null;)i=ht,l=i.child,i.tag===22&&i.memoizedState!==null?II(r):l!==null?(l.return=i,ht=l):II(r);for(;o!==null;)ht=o,S_(o),o=o.sibling;ht=r,Qf=a,_n=c}CI(e)}else r.subtreeFlags&8772&&o!==null?(o.return=r,ht=o):CI(e)}}function CI(e){for(;ht!==null;){var t=ht;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_n||Ng(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!_n)if(n===null)s.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:ur(t.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&aI(t,o,s);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}aI(t,i,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&kd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(rt(163))}_n||t.flags&512&&Eb(t)}catch(h){_e(t,t.return,h)}}if(t===e){ht=null;break}if(n=t.sibling,n!==null){n.return=t.return,ht=n;break}ht=t.return}}function SI(e){for(;ht!==null;){var t=ht;if(t===e){ht=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ht=n;break}ht=t.return}}function II(e){for(;ht!==null;){var t=ht;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ng(4,t)}catch(l){_e(t,n,l)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var r=t.return;try{s.componentDidMount()}catch(l){_e(t,r,l)}}var o=t.return;try{Eb(t)}catch(l){_e(t,o,l)}break;case 5:var i=t.return;try{Eb(t)}catch(l){_e(t,i,l)}}}catch(l){_e(t,t.return,l)}if(t===e){ht=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ht=a;break}ht=t.return}}var WV=Math.ceil,Sm=Vo.ReactCurrentDispatcher,Av=Vo.ReactCurrentOwner,Ys=Vo.ReactCurrentBatchConfig,Ut=0,cn=null,We=null,mn=0,vs=0,Xl=Zi(0),tn=0,Ad=null,Ka=0,Eg=0,Ov=0,ad=null,rs=null,Fv=0,Ic=1/0,xo=null,Im=!1,Db=null,_i=null,Zf=!1,gi=null,$m=0,ld=0,Ab=null,Vp=-1,Wp=0;function Xn(){return Ut&6?ze():Vp!==-1?Vp:Vp=ze()}function Ri(e){return e.mode&1?Ut&2&&mn!==0?mn&-mn:IV.transition!==null?(Wp===0&&(Wp=lE()),Wp):(e=Jt,e!==0||(e=window.event,e=e===void 0?16:mE(e.type)),e):1}function vr(e,t,n,s){if(50<ld)throw ld=0,Ab=null,Error(rt(185));ah(e,n,s),(!(Ut&2)||e!==cn)&&(e===cn&&(!(Ut&2)&&(Eg|=n),tn===4&&ci(e,mn)),hs(e,s),n===1&&Ut===0&&!(t.mode&1)&&(Ic=ze()+500,Ig&&Ji()))}function hs(e,t){var n=e.callbackNode;IB(e,t);var s=cm(e,e===cn?mn:0);if(s===0)n!==null&&OS(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&OS(n),t===1)e.tag===0?SV($I.bind(null,e)):OE($I.bind(null,e)),vV(function(){!(Ut&6)&&Ji()}),n=null;else{switch(cE(s)){case 1:n=av;break;case 4:n=iE;break;case 16:n=lm;break;case 536870912:n=aE;break;default:n=lm}n=D_(n,I_.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function I_(e,t){if(Vp=-1,Wp=0,Ut&6)throw Error(rt(327));var n=e.callbackNode;if(ec()&&e.callbackNode!==n)return null;var s=cm(e,e===cn?mn:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Tm(e,s);else{t=s;var r=Ut;Ut|=2;var o=T_();(cn!==e||mn!==t)&&(xo=null,Ic=ze()+500,Ma(e,t));do try{GV();break}catch(a){$_(e,a)}while(!0);vv(),Sm.current=o,Ut=r,We!==null?t=0:(cn=null,mn=0,t=tn)}if(t!==0){if(t===2&&(r=ib(e),r!==0&&(s=r,t=Ob(e,r))),t===1)throw n=Ad,Ma(e,0),ci(e,s),hs(e,ze()),n;if(t===6)ci(e,s);else{if(r=e.current.alternate,!(s&30)&&!UV(r)&&(t=Tm(e,s),t===2&&(o=ib(e),o!==0&&(s=o,t=Ob(e,o))),t===1))throw n=Ad,Ma(e,0),ci(e,s),hs(e,ze()),n;switch(e.finishedWork=r,e.finishedLanes=s,t){case 0:case 1:throw Error(rt(345));case 2:ya(e,rs,xo);break;case 3:if(ci(e,s),(s&130023424)===s&&(t=Fv+500-ze(),10<t)){if(cm(e,0)!==0)break;if(r=e.suspendedLanes,(r&s)!==s){Xn(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=pb(ya.bind(null,e,rs,xo),t);break}ya(e,rs,xo);break;case 4:if(ci(e,s),(s&4194240)===s)break;for(t=e.eventTimes,r=-1;0<s;){var i=31-br(s);o=1<<i,i=t[i],i>r&&(r=i),s&=~o}if(s=r,s=ze()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*WV(s/1960))-s,10<s){e.timeoutHandle=pb(ya.bind(null,e,rs,xo),s);break}ya(e,rs,xo);break;case 5:ya(e,rs,xo);break;default:throw Error(rt(329))}}}return hs(e,ze()),e.callbackNode===n?I_.bind(null,e):null}function Ob(e,t){var n=ad;return e.current.memoizedState.isDehydrated&&(Ma(e,t).flags|=256),e=Tm(e,t),e!==2&&(t=rs,rs=n,t!==null&&Fb(t)),e}function Fb(e){rs===null?rs=e:rs.push.apply(rs,e)}function UV(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],o=r.getSnapshot;r=r.value;try{if(!Ir(o(),r))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ci(e,t){for(t&=~Ov,t&=~Eg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-br(t),s=1<<n;e[n]=-1,t&=~s}}function $I(e){if(Ut&6)throw Error(rt(327));ec();var t=cm(e,0);if(!(t&1))return hs(e,ze()),null;var n=Tm(e,t);if(e.tag!==0&&n===2){var s=ib(e);s!==0&&(t=s,n=Ob(e,s))}if(n===1)throw n=Ad,Ma(e,0),ci(e,t),hs(e,ze()),n;if(n===6)throw Error(rt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ya(e,rs,xo),hs(e,ze()),null}function Pv(e,t){var n=Ut;Ut|=1;try{return e(t)}finally{Ut=n,Ut===0&&(Ic=ze()+500,Ig&&Ji())}}function Xa(e){gi!==null&&gi.tag===0&&!(Ut&6)&&ec();var t=Ut;Ut|=1;var n=Ys.transition,s=Jt;try{if(Ys.transition=null,Jt=1,e)return e()}finally{Jt=s,Ys.transition=n,Ut=t,!(Ut&6)&&Ji()}}function Mv(){vs=Xl.current,ge(Xl)}function Ma(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,bV(n)),We!==null)for(n=We.return;n!==null;){var s=n;switch(xv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&pm();break;case 3:Cc(),ge(us),ge(Fn),$v();break;case 5:Iv(s);break;case 4:Cc();break;case 13:ge($e);break;case 19:ge($e);break;case 10:wv(s.type._context);break;case 22:case 23:Mv()}n=n.return}if(cn=e,We=e=Di(e.current,null),mn=vs=t,tn=0,Ad=null,Ov=Eg=Ka=0,rs=ad=null,$a!==null){for(t=0;t<$a.length;t++)if(n=$a[t],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,o=n.pending;if(o!==null){var i=o.next;o.next=r,s.next=i}n.pending=s}$a=null}return e}function $_(e,t){do{var n=We;try{if(vv(),Lp.current=Cm,km){for(var s=Te.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}km=!1}if(Ha=0,on=Ye=Te=null,od=!1,_d=0,Av.current=null,n===null||n.return===null){tn=1,Ad=t,We=null;break}t:{var o=e,i=n.return,a=n,l=t;if(t=mn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=fI(i);if(f!==null){f.flags&=-257,pI(f,i,a,o,t),f.mode&1&&hI(o,c,t),t=f,l=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(l),t.updateQueue=m}else p.add(l);break t}else{if(!(t&1)){hI(o,c,t),Lv();break t}l=Error(rt(426))}}else if(we&&a.mode&1){var g=fI(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),pI(g,i,a,o,t),yv(Sc(l,a));break t}}o=l=Sc(l,a),tn!==4&&(tn=2),ad===null?ad=[o]:ad.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var x=c_(o,l,t);iI(o,x);break t;case 1:a=l;var y=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(_i===null||!_i.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var v=u_(o,a,t);iI(o,v);break t}}o=o.return}while(o!==null)}E_(n)}catch(w){t=w,We===n&&n!==null&&(We=n=n.return);continue}break}while(!0)}function T_(){var e=Sm.current;return Sm.current=Cm,e===null?Cm:e}function Lv(){(tn===0||tn===3||tn===2)&&(tn=4),cn===null||!(Ka&268435455)&&!(Eg&268435455)||ci(cn,mn)}function Tm(e,t){var n=Ut;Ut|=2;var s=T_();(cn!==e||mn!==t)&&(xo=null,Ma(e,t));do try{jV();break}catch(r){$_(e,r)}while(!0);if(vv(),Ut=n,Sm.current=s,We!==null)throw Error(rt(261));return cn=null,mn=0,tn}function jV(){for(;We!==null;)N_(We)}function GV(){for(;We!==null&&!gB();)N_(We)}function N_(e){var t=R_(e.alternate,e,vs);e.memoizedProps=e.pendingProps,t===null?E_(e):We=t,Av.current=null}function E_(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=LV(n,t),n!==null){n.flags&=32767,We=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tn=6,We=null;return}}else if(n=MV(n,t,vs),n!==null){We=n;return}if(t=t.sibling,t!==null){We=t;return}We=t=e}while(t!==null);tn===0&&(tn=5)}function ya(e,t,n){var s=Jt,r=Ys.transition;try{Ys.transition=null,Jt=1,HV(e,t,n,s)}finally{Ys.transition=r,Jt=s}return null}function HV(e,t,n,s){do ec();while(gi!==null);if(Ut&6)throw Error(rt(327));n=e.finishedWork;var r=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(rt(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if($B(e,o),e===cn&&(We=cn=null,mn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zf||(Zf=!0,D_(lm,function(){return ec(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ys.transition,Ys.transition=null;var i=Jt;Jt=1;var a=Ut;Ut|=4,Av.current=null,BV(e,n),C_(n,e),hV(hb),um=!!db,hb=db=null,e.current=n,VV(n),xB(),Ut=a,Jt=i,Ys.transition=o}else e.current=n;if(Zf&&(Zf=!1,gi=e,$m=r),o=e.pendingLanes,o===0&&(_i=null),vB(n.stateNode),hs(e,ze()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Im)throw Im=!1,e=Db,Db=null,e;return $m&1&&e.tag!==0&&ec(),o=e.pendingLanes,o&1?e===Ab?ld++:(ld=0,Ab=e):ld=0,Ji(),null}function ec(){if(gi!==null){var e=cE($m),t=Ys.transition,n=Jt;try{if(Ys.transition=null,Jt=16>e?16:e,gi===null)var s=!1;else{if(e=gi,gi=null,$m=0,Ut&6)throw Error(rt(331));var r=Ut;for(Ut|=4,ht=e.current;ht!==null;){var o=ht,i=o.child;if(ht.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ht=c;ht!==null;){var u=ht;switch(u.tag){case 0:case 11:case 15:id(8,u,o)}var d=u.child;if(d!==null)d.return=u,ht=d;else for(;ht!==null;){u=ht;var h=u.sibling,f=u.return;if(v_(u),u===c){ht=null;break}if(h!==null){h.return=f,ht=h;break}ht=f}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}ht=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,ht=i;else t:for(;ht!==null;){if(o=ht,o.flags&2048)switch(o.tag){case 0:case 11:case 15:id(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,ht=x;break t}ht=o.return}}var y=e.current;for(ht=y;ht!==null;){i=ht;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,ht=b;else t:for(i=y;ht!==null;){if(a=ht,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ng(9,a)}}catch(w){_e(a,a.return,w)}if(a===i){ht=null;break t}var v=a.sibling;if(v!==null){v.return=a.return,ht=v;break t}ht=a.return}}if(Ut=r,Ji(),Kr&&typeof Kr.onPostCommitFiberRoot=="function")try{Kr.onPostCommitFiberRoot(vg,e)}catch{}s=!0}return s}finally{Jt=n,Ys.transition=t}}return!1}function TI(e,t,n){t=Sc(n,t),t=c_(e,t,1),e=Ei(e,t,1),t=Xn(),e!==null&&(ah(e,1,t),hs(e,t))}function _e(e,t,n){if(e.tag===3)TI(e,e,n);else for(;t!==null;){if(t.tag===3){TI(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(_i===null||!_i.has(s))){e=Sc(n,e),e=u_(t,e,1),t=Ei(t,e,1),e=Xn(),t!==null&&(ah(t,1,e),hs(t,e));break}}t=t.return}}function KV(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=Xn(),e.pingedLanes|=e.suspendedLanes&n,cn===e&&(mn&n)===n&&(tn===4||tn===3&&(mn&130023424)===mn&&500>ze()-Fv?Ma(e,0):Ov|=n),hs(e,t)}function __(e,t){t===0&&(e.mode&1?(t=Wf,Wf<<=1,!(Wf&130023424)&&(Wf=4194304)):t=1);var n=Xn();e=Ao(e,t),e!==null&&(ah(e,t,n),hs(e,n))}function XV(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),__(e,n)}function qV(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(rt(314))}s!==null&&s.delete(t),__(e,n)}var R_;R_=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||us.current)as=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return as=!1,PV(e,t,n);as=!!(e.flags&131072)}else as=!1,we&&t.flags&1048576&&FE(t,xm,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Bp(e,t),e=t.pendingProps;var r=vc(t,Fn.current);tc(t,n),r=Nv(null,t,s,e,r,n);var o=Ev();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ds(s)?(o=!0,mm(t)):o=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Cv(t),r.updater=Tg,t.stateNode=r,r._reactInternals=t,wb(t,s,e,n),t=Sb(null,t,s,!0,o,n)):(t.tag=0,we&&o&&gv(t),Wn(null,t,r,n),t=t.child),t;case 16:s=t.elementType;t:{switch(Bp(e,t),e=t.pendingProps,r=s._init,s=r(s._payload),t.type=s,r=t.tag=QV(s),e=ur(s,e),r){case 0:t=Cb(null,t,s,e,n);break t;case 1:t=xI(null,t,s,e,n);break t;case 11:t=mI(null,t,s,e,n);break t;case 14:t=gI(null,t,s,ur(s.type,e),n);break t}throw Error(rt(306,s,""))}return t;case 0:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:ur(s,r),Cb(e,t,s,r,n);case 1:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:ur(s,r),xI(e,t,s,r,n);case 3:t:{if(p_(t),e===null)throw Error(rt(387));s=t.pendingProps,o=t.memoizedState,r=o.element,VE(e,t),vm(t,s,null,n);var i=t.memoizedState;if(s=i.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){r=Sc(Error(rt(423)),t),t=yI(e,t,s,n,r);break t}else if(s!==r){r=Sc(Error(rt(424)),t),t=yI(e,t,s,n,r);break t}else for(Ss=Ni(t.stateNode.containerInfo.firstChild),$s=t,we=!0,pr=null,n=zE(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wc(),s===r){t=Oo(e,t,n);break t}Wn(e,t,s,n)}t=t.child}return t;case 5:return WE(t),e===null&&yb(t),s=t.type,r=t.pendingProps,o=e!==null?e.memoizedProps:null,i=r.children,fb(s,r)?i=null:o!==null&&fb(s,o)&&(t.flags|=32),f_(e,t),Wn(e,t,i,n),t.child;case 6:return e===null&&yb(t),null;case 13:return m_(e,t,n);case 4:return Sv(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=kc(t,null,s,n):Wn(e,t,s,n),t.child;case 11:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:ur(s,r),mI(e,t,s,r,n);case 7:return Wn(e,t,t.pendingProps,n),t.child;case 8:return Wn(e,t,t.pendingProps.children,n),t.child;case 12:return Wn(e,t,t.pendingProps.children,n),t.child;case 10:t:{if(s=t.type._context,r=t.pendingProps,o=t.memoizedProps,i=r.value,ue(ym,s._currentValue),s._currentValue=i,o!==null)if(Ir(o.value,i)){if(o.children===r.children&&!us.current){t=Oo(e,t,n);break t}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(o.tag===1){l=Eo(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),bb(o.return,n,t),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(rt(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),bb(i,n,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Wn(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,s=t.pendingProps.children,tc(t,n),r=Qs(r),s=s(r),t.flags|=1,Wn(e,t,s,n),t.child;case 14:return s=t.type,r=ur(s,t.pendingProps),r=ur(s.type,r),gI(e,t,s,r,n);case 15:return d_(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:ur(s,r),Bp(e,t),t.tag=1,ds(s)?(e=!0,mm(t)):e=!1,tc(t,n),l_(t,s,r),wb(t,s,r,n),Sb(null,t,s,!0,e,n);case 19:return g_(e,t,n);case 22:return h_(e,t,n)}throw Error(rt(156,t.tag))};function D_(e,t){return oE(e,t)}function YV(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function js(e,t,n,s){return new YV(e,t,n,s)}function zv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function QV(e){if(typeof e=="function")return zv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rv)return 11;if(e===ov)return 14}return 2}function Di(e,t){var n=e.alternate;return n===null?(n=js(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Up(e,t,n,s,r,o){var i=2;if(s=e,typeof e=="function")zv(e)&&(i=1);else if(typeof e=="string")i=5;else t:switch(e){case Ll:return La(n.children,r,o,t);case sv:i=8,r|=8;break;case Gy:return e=js(12,n,t,r|2),e.elementType=Gy,e.lanes=o,e;case Hy:return e=js(13,n,t,r),e.elementType=Hy,e.lanes=o,e;case Ky:return e=js(19,n,t,r),e.elementType=Ky,e.lanes=o,e;case WN:return _g(n,r,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case BN:i=10;break t;case VN:i=9;break t;case rv:i=11;break t;case ov:i=14;break t;case oi:i=16,s=null;break t}throw Error(rt(130,e==null?e:typeof e,""))}return t=js(i,n,t,r),t.elementType=e,t.type=s,t.lanes=o,t}function La(e,t,n,s){return e=js(7,e,s,t),e.lanes=n,e}function _g(e,t,n,s){return e=js(22,e,s,t),e.elementType=WN,e.lanes=n,e.stateNode={isHidden:!1},e}function ny(e,t,n){return e=js(6,e,null,t),e.lanes=n,e}function sy(e,t,n){return t=js(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ZV(e,t,n,s,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=M0(0),this.expirationTimes=M0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=M0(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Bv(e,t,n,s,r,o,i,a,l){return e=new ZV(e,t,n,a,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=js(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cv(o),e}function JV(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ml,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function A_(e){if(!e)return zi;e=e._reactInternals;t:{if(gl(e)!==e||e.tag!==1)throw Error(rt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break t;case 1:if(ds(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break t}}t=t.return}while(t!==null);throw Error(rt(171))}if(e.tag===1){var n=e.type;if(ds(n))return AE(e,n,t)}return t}function O_(e,t,n,s,r,o,i,a,l){return e=Bv(n,s,!0,e,r,o,i,a,l),e.context=A_(null),n=e.current,s=Xn(),r=Ri(n),o=Eo(s,r),o.callback=t??null,Ei(n,o,r),e.current.lanes=r,ah(e,r,s),hs(e,s),e}function Rg(e,t,n,s){var r=t.current,o=Xn(),i=Ri(r);return n=A_(n),t.context===null?t.context=n:t.pendingContext=n,t=Eo(o,i),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=Ei(r,t,i),e!==null&&(vr(e,r,i,o),Mp(e,r,i)),i}function Nm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function NI(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Vv(e,t){NI(e,t),(e=e.alternate)&&NI(e,t)}function t4(){return null}var F_=typeof reportError=="function"?reportError:function(e){console.error(e)};function Wv(e){this._internalRoot=e}Dg.prototype.render=Wv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(rt(409));Rg(e,t,null,null)};Dg.prototype.unmount=Wv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xa(function(){Rg(null,e,null,null)}),t[Do]=null}};function Dg(e){this._internalRoot=e}Dg.prototype.unstable_scheduleHydration=function(e){if(e){var t=hE();e={blockedOn:null,target:e,priority:t};for(var n=0;n<li.length&&t!==0&&t<li[n].priority;n++);li.splice(n,0,e),n===0&&pE(e)}};function Uv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ag(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function EI(){}function e4(e,t,n,s,r){if(r){if(typeof s=="function"){var o=s;s=function(){var c=Nm(i);o.call(c)}}var i=O_(t,s,e,0,null,!1,!1,"",EI);return e._reactRootContainer=i,e[Do]=i.current,Id(e.nodeType===8?e.parentNode:e),Xa(),i}for(;r=e.lastChild;)e.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=Nm(l);a.call(c)}}var l=Bv(e,0,!1,null,null,!1,!1,"",EI);return e._reactRootContainer=l,e[Do]=l.current,Id(e.nodeType===8?e.parentNode:e),Xa(function(){Rg(t,l,n,s)}),l}function Og(e,t,n,s,r){var o=n._reactRootContainer;if(o){var i=o;if(typeof r=="function"){var a=r;r=function(){var l=Nm(i);a.call(l)}}Rg(t,i,e,r)}else i=e4(n,t,e,r,s);return Nm(i)}uE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=zu(t.pendingLanes);n!==0&&(lv(t,n|1),hs(t,ze()),!(Ut&6)&&(Ic=ze()+500,Ji()))}break;case 13:Xa(function(){var s=Ao(e,1);if(s!==null){var r=Xn();vr(s,e,1,r)}}),Vv(e,1)}};cv=function(e){if(e.tag===13){var t=Ao(e,134217728);if(t!==null){var n=Xn();vr(t,e,134217728,n)}Vv(e,134217728)}};dE=function(e){if(e.tag===13){var t=Ri(e),n=Ao(e,t);if(n!==null){var s=Xn();vr(n,e,t,s)}Vv(e,t)}};hE=function(){return Jt};fE=function(e,t){var n=Jt;try{return Jt=e,t()}finally{Jt=n}};sb=function(e,t,n){switch(t){case"input":if(Yy(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=Sg(s);if(!r)throw Error(rt(90));jN(s),Yy(s,r)}}}break;case"textarea":HN(e,n);break;case"select":t=n.value,t!=null&&Yl(e,!!n.multiple,t,!1)}};JN=Pv;tE=Xa;var n4={usingClientEntryPoint:!1,Events:[ch,Wl,Sg,QN,ZN,Pv]},Iu={findFiberByHostInstance:Ia,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},s4={bundleType:Iu.bundleType,version:Iu.version,rendererPackageName:Iu.rendererPackageName,rendererConfig:Iu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=sE(e),e===null?null:e.stateNode},findFiberByHostInstance:Iu.findFiberByHostInstance||t4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jf.isDisabled&&Jf.supportsFiber)try{vg=Jf.inject(s4),Kr=Jf}catch{}}Ds.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=n4;Ds.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uv(t))throw Error(rt(200));return JV(e,t,null,n)};Ds.createRoot=function(e,t){if(!Uv(e))throw Error(rt(299));var n=!1,s="",r=F_;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=Bv(e,1,!1,null,null,n,!1,s,r),e[Do]=t.current,Id(e.nodeType===8?e.parentNode:e),new Wv(t)};Ds.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(rt(188)):(e=Object.keys(e).join(","),Error(rt(268,e)));return e=sE(t),e=e===null?null:e.stateNode,e};Ds.flushSync=function(e){return Xa(e)};Ds.hydrate=function(e,t,n){if(!Ag(t))throw Error(rt(200));return Og(null,e,t,!0,n)};Ds.hydrateRoot=function(e,t,n){if(!Uv(e))throw Error(rt(405));var s=n!=null&&n.hydratedSources||null,r=!1,o="",i=F_;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=O_(t,null,e,1,n??null,r,!1,o,i),e[Do]=t.current,Id(e),s)for(e=0;e<s.length;e++)n=s[e],r=n._getVersion,r=r(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Dg(t)};Ds.render=function(e,t,n){if(!Ag(t))throw Error(rt(200));return Og(null,e,t,!1,n)};Ds.unmountComponentAtNode=function(e){if(!Ag(e))throw Error(rt(40));return e._reactRootContainer?(Xa(function(){Og(null,null,e,!1,function(){e._reactRootContainer=null,e[Do]=null})}),!0):!1};Ds.unstable_batchedUpdates=Pv;Ds.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!Ag(n))throw Error(rt(200));if(e==null||e._reactInternals===void 0)throw Error(rt(38));return Og(e,t,n,!1,s)};Ds.version="18.3.1-next-f1338f8080-20240426";function P_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(P_)}catch(e){console.error(e)}}P_(),PN.exports=Ds;var dh=PN.exports;const r4=q1(dh);var M_,_I=dh;M_=_I.createRoot,_I.hydrateRoot;function o4(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,s,r,o,i=[],a="",l=e.split("/");for(l[0]||l.shift();r=l.shift();)n=r[0],n==="*"?(i.push(n),a+=r[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(s=r.indexOf("?",1),o=r.indexOf(".",1),i.push(r.substring(1,~s?s:~o?o:r.length)),a+=~s&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(a+=(~s?"?":"")+"\\"+r.substring(o))):a+="/"+r;return{keys:i,pattern:new RegExp("^"+a+(t?"(?=$|/)":"/?$"),"i")}}var L_={exports:{}},z_={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $c=D;function i4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var a4=typeof Object.is=="function"?Object.is:i4,l4=$c.useState,c4=$c.useEffect,u4=$c.useLayoutEffect,d4=$c.useDebugValue;function h4(e,t){var n=t(),s=l4({inst:{value:n,getSnapshot:t}}),r=s[0].inst,o=s[1];return u4(function(){r.value=n,r.getSnapshot=t,ry(r)&&o({inst:r})},[e,n,t]),c4(function(){return ry(r)&&o({inst:r}),e(function(){ry(r)&&o({inst:r})})},[e]),d4(n),n}function ry(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a4(e,n)}catch{return!0}}function f4(e,t){return t()}var p4=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f4:h4;z_.useSyncExternalStore=$c.useSyncExternalStore!==void 0?$c.useSyncExternalStore:p4;L_.exports=z_;var m4=L_.exports;const g4=Kz.useInsertionEffect,x4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",y4=x4?D.useLayoutEffect:D.useEffect,b4=g4||y4,B_=e=>{const t=D.useRef([e,(...n)=>t[0](...n)]).current;return b4(()=>{t[0]=e}),t[1]},v4="popstate",jv="pushState",Gv="replaceState",w4="hashchange",RI=[v4,jv,Gv,w4],k4=e=>{for(const t of RI)addEventListener(t,e);return()=>{for(const t of RI)removeEventListener(t,e)}},V_=(e,t)=>m4.useSyncExternalStore(k4,e,t),C4=()=>location.search,S4=({ssrSearch:e=""}={})=>V_(C4,()=>e),DI=()=>location.pathname,I4=({ssrPath:e}={})=>V_(DI,e?()=>e:DI),$4=(e,{replace:t=!1,state:n=null}={})=>history[t?Gv:jv](n,"",e),T4=(e={})=>[I4(e),$4],AI=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[AI]>"u"){for(const e of[jv,Gv]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,AI,{value:!0})}const N4=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",W_=(e="")=>e==="/"?"":e,E4=(e,t)=>e[0]==="~"?e.slice(1):W_(t)+e,_4=(e="",t)=>N4(OI(W_(e)),OI(t)),OI=e=>{try{return decodeURI(e)}catch{return e}},U_={hook:T4,searchHook:S4,parser:o4,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:e=>e},j_=D.createContext(U_),Fg=()=>D.useContext(j_),G_={},H_=D.createContext(G_),R4=()=>D.useContext(H_),Hv=e=>{const[t,n]=e.hook(e);return[_4(e.base,t),B_((s,r)=>n(E4(s,e.base),r))]},K_=(e,t,n,s)=>{const{pattern:r,keys:o}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),i=r.exec(n)||[],[a,...l]=i;return a!==void 0?[!0,(()=>{const c=o!==!1?Object.fromEntries(o.map((d,h)=>[d,l[h]])):i.groups;let u={...l};return c&&Object.assign(u,c),u})(),...s?[a]:[]]:[!1,null]},D4=({children:e,...t})=>{var u,d;const n=Fg(),s=t.hook?U_:n;let r=s;const[o,i]=((u=t.ssrPath)==null?void 0:u.split("?"))??[];i&&(t.ssrSearch=i,t.ssrPath=o),t.hrefs=t.hrefs??((d=t.hook)==null?void 0:d.hrefs);let a=D.useRef({}),l=a.current,c=l;for(let h in s){const f=h==="base"?s[h]+(t[h]||""):t[h]||s[h];l===c&&f!==c[h]&&(a.current=c={...c}),c[h]=f,f!==s[h]&&(r=c)}return D.createElement(j_.Provider,{value:r,children:e})},FI=({children:e,component:t},n)=>t?D.createElement(t,{params:n}):typeof e=="function"?e(n):e,A4=e=>{let t=D.useRef(G_),n=t.current;for(const s in e)e[s]!==n[s]&&(n=e);return Object.keys(e).length===0&&(n=e),t.current=n},PI=({path:e,nest:t,match:n,...s})=>{const r=Fg(),[o]=Hv(r),[i,a,l]=n??K_(r.parser,e,o,t),c=A4({...R4(),...a});if(!i)return null;const u=l?D.createElement(D4,{base:l},FI(s,c)):FI(s,c);return D.createElement(H_.Provider,{value:c,children:u})};D.forwardRef((e,t)=>{const n=Fg(),[s,r]=Hv(n),{to:o="",href:i=o,onClick:a,asChild:l,children:c,className:u,replace:d,state:h,...f}=e,p=B_(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(a==null||a(g),g.defaultPrevented||(g.preventDefault(),r(i,e)))}),m=n.hrefs(i[0]==="~"?i.slice(1):n.base+i,n);return l&&D.isValidElement(c)?D.cloneElement(c,{onClick:p,href:m}):D.createElement("a",{...f,onClick:p,href:m,className:u!=null&&u.call?u(s===i):u,children:c,ref:t})});const X_=e=>Array.isArray(e)?e.flatMap(t=>X_(t&&t.type===D.Fragment?t.props.children:t)):[e],O4=({children:e,location:t})=>{const n=Fg(),[s]=Hv(n);for(const r of X_(e)){let o=0;if(D.isValidElement(r)&&(o=K_(n.parser,r.props.path,t||s,r.props.nest))[0])return D.cloneElement(r,{match:o})}return null};var Pg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Mg=typeof window>"u"||"Deno"in globalThis;function dr(){}function F4(e,t){return typeof e=="function"?e(t):e}function P4(e){return typeof e=="number"&&e>=0&&e!==1/0}function M4(e,t){return Math.max(e+(t||0)-Date.now(),0)}function MI(e,t){return typeof e=="function"?e(t):e}function L4(e,t){return typeof e=="function"?e(t):e}function LI(e,t){const{type:n="all",exact:s,fetchStatus:r,predicate:o,queryKey:i,stale:a}=e;if(i){if(s){if(t.queryHash!==Kv(i,t.options))return!1}else if(!Fd(t.queryKey,i))return!1}if(n!=="all"){const l=t.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&t.isStale()!==a||r&&r!==t.state.fetchStatus||o&&!o(t))}function zI(e,t){const{exact:n,status:s,predicate:r,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(n){if(Od(t.options.mutationKey)!==Od(o))return!1}else if(!Fd(t.options.mutationKey,o))return!1}return!(s&&t.state.status!==s||r&&!r(t))}function Kv(e,t){return((t==null?void 0:t.queryKeyHashFn)||Od)(e)}function Od(e){return JSON.stringify(e,(t,n)=>Pb(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Fd(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(n=>!Fd(e[n],t[n])):!1}function q_(e,t){if(e===t)return e;const n=BI(e)&&BI(t);if(n||Pb(e)&&Pb(t)){const s=n?e:Object.keys(e),r=s.length,o=n?t:Object.keys(t),i=o.length,a=n?[]:{};let l=0;for(let c=0;c<i;c++){const u=n?c:o[c];(!n&&s.includes(u)||n)&&e[u]===void 0&&t[u]===void 0?(a[u]=void 0,l++):(a[u]=q_(e[u],t[u]),a[u]===e[u]&&e[u]!==void 0&&l++)}return r===i&&l===r?e:a}return t}function BI(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Pb(e){if(!VI(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!VI(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function VI(e){return Object.prototype.toString.call(e)==="[object Object]"}function z4(e){return new Promise(t=>{setTimeout(t,e)})}function B4(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?q_(e,t):t}function V4(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function W4(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var Xv=Symbol();function Y_(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Xv?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Aa,ui,uc,gN,U4=(gN=class extends Pg{constructor(){super();Xt(this,Aa);Xt(this,ui);Xt(this,uc);Et(this,uc,t=>{if(!Mg&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Z(this,ui)||this.setEventListener(Z(this,uc))}onUnsubscribe(){var t;this.hasListeners()||((t=Z(this,ui))==null||t.call(this),Et(this,ui,void 0))}setEventListener(t){var n;Et(this,uc,t),(n=Z(this,ui))==null||n.call(this),Et(this,ui,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){Z(this,Aa)!==t&&(Et(this,Aa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof Z(this,Aa)=="boolean"?Z(this,Aa):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Aa=new WeakMap,ui=new WeakMap,uc=new WeakMap,gN),Q_=new U4,dc,di,hc,xN,j4=(xN=class extends Pg{constructor(){super();Xt(this,dc,!0);Xt(this,di);Xt(this,hc);Et(this,hc,t=>{if(!Mg&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){Z(this,di)||this.setEventListener(Z(this,hc))}onUnsubscribe(){var t;this.hasListeners()||((t=Z(this,di))==null||t.call(this),Et(this,di,void 0))}setEventListener(t){var n;Et(this,hc,t),(n=Z(this,di))==null||n.call(this),Et(this,di,t(this.setOnline.bind(this)))}setOnline(t){Z(this,dc)!==t&&(Et(this,dc,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return Z(this,dc)}},dc=new WeakMap,di=new WeakMap,hc=new WeakMap,xN),Em=new j4;function G4(){let e,t;const n=new Promise((r,o)=>{e=r,t=o});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),e(r)},n.reject=r=>{s({status:"rejected",reason:r}),t(r)},n}function H4(e){return Math.min(1e3*2**e,3e4)}function Z_(e){return(e??"online")==="online"?Em.isOnline():!0}var J_=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function oy(e){return e instanceof J_}function tR(e){let t=!1,n=0,s=!1,r;const o=G4(),i=m=>{var g;s||(h(new J_(m)),(g=e.abort)==null||g.call(e))},a=()=>{t=!0},l=()=>{t=!1},c=()=>Q_.isFocused()&&(e.networkMode==="always"||Em.isOnline())&&e.canRun(),u=()=>Z_(e.networkMode)&&e.canRun(),d=m=>{var g;s||(s=!0,(g=e.onSuccess)==null||g.call(e,m),r==null||r(),o.resolve(m))},h=m=>{var g;s||(s=!0,(g=e.onError)==null||g.call(e,m),r==null||r(),o.reject(m))},f=()=>new Promise(m=>{var g;r=x=>{(s||c())&&m(x)},(g=e.onPause)==null||g.call(e)}).then(()=>{var m;r=void 0,s||(m=e.onContinue)==null||m.call(e)}),p=()=>{if(s)return;let m;const g=n===0?e.initialPromise:void 0;try{m=g??e.fn()}catch(x){m=Promise.reject(x)}Promise.resolve(m).then(d).catch(x=>{var k;if(s)return;const y=e.retry??(Mg?0:3),b=e.retryDelay??H4,v=typeof b=="function"?b(n,x):b,w=y===!0||typeof y=="number"&&n<y||typeof y=="function"&&y(n,x);if(t||!w){h(x);return}n++,(k=e.onFail)==null||k.call(e,n,x),z4(v).then(()=>c()?void 0:f()).then(()=>{t?h(x):p()})})};return{promise:o,cancel:i,continue:()=>(r==null||r(),o),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?p():f().then(p),o)}}function K4(){let e=[],t=0,n=a=>{a()},s=a=>{a()},r=a=>setTimeout(a,0);const o=a=>{t?e.push(a):r(()=>{n(a)})},i=()=>{const a=e;e=[],a.length&&r(()=>{s(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;t++;try{l=a()}finally{t--,t||i()}return l},batchCalls:a=>(...l)=>{o(()=>{a(...l)})},schedule:o,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{s=a},setScheduler:a=>{r=a}}}var jn=K4(),Oa,yN,eR=(yN=class{constructor(){Xt(this,Oa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),P4(this.gcTime)&&Et(this,Oa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Mg?1/0:5*60*1e3))}clearGcTimeout(){Z(this,Oa)&&(clearTimeout(Z(this,Oa)),Et(this,Oa,void 0))}},Oa=new WeakMap,yN),fc,pc,Bs,$n,rh,Fa,hr,po,bN,X4=(bN=class extends eR{constructor(t){super();Xt(this,hr);Xt(this,fc);Xt(this,pc);Xt(this,Bs);Xt(this,$n);Xt(this,rh);Xt(this,Fa);Et(this,Fa,!1),Et(this,rh,t.defaultOptions),this.setOptions(t.options),this.observers=[],Et(this,Bs,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Et(this,fc,Y4(this.options)),this.state=t.state??Z(this,fc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Z(this,$n))==null?void 0:t.promise}setOptions(t){this.options={...Z(this,rh),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Z(this,Bs).remove(this)}setData(t,n){const s=B4(this.state.data,t,this.options);return Cn(this,hr,po).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){Cn(this,hr,po).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,r;const n=(s=Z(this,$n))==null?void 0:s.promise;return(r=Z(this,$n))==null||r.cancel(t),n?n.then(dr).catch(dr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Z(this,fc))}isActive(){return this.observers.some(t=>L4(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Xv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!M4(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=Z(this,$n))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=Z(this,$n))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Z(this,Bs).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(Z(this,$n)&&(Z(this,Fa)?Z(this,$n).cancel({revert:!0}):Z(this,$n).cancelRetry()),this.scheduleGc()),Z(this,Bs).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Cn(this,hr,po).call(this,{type:"invalidate"})}fetch(t,n){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Z(this,$n))return Z(this,$n).continueRetry(),Z(this,$n).promise}if(t&&this.setOptions(t),!this.options.queryFn){const d=this.observers.find(h=>h.options.queryFn);d&&this.setOptions(d.options)}const s=new AbortController,r=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(Et(this,Fa,!0),s.signal)})},o=()=>{const d=Y_(this.options,n),h={queryKey:this.queryKey,meta:this.meta};return r(h),Et(this,Fa,!1),this.options.persister?this.options.persister(d,h,this):d(h)},i={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:o};r(i),(l=this.options.behavior)==null||l.onFetch(i,this),Et(this,pc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=i.fetchOptions)==null?void 0:c.meta))&&Cn(this,hr,po).call(this,{type:"fetch",meta:(u=i.fetchOptions)==null?void 0:u.meta});const a=d=>{var h,f,p,m;oy(d)&&d.silent||Cn(this,hr,po).call(this,{type:"error",error:d}),oy(d)||((f=(h=Z(this,Bs).config).onError)==null||f.call(h,d,this),(m=(p=Z(this,Bs).config).onSettled)==null||m.call(p,this.state.data,d,this)),this.scheduleGc()};return Et(this,$n,tR({initialPromise:n==null?void 0:n.initialPromise,fn:i.fetchFn,abort:s.abort.bind(s),onSuccess:d=>{var h,f,p,m;if(d===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(g){a(g);return}(f=(h=Z(this,Bs).config).onSuccess)==null||f.call(h,d,this),(m=(p=Z(this,Bs).config).onSettled)==null||m.call(p,d,this.state.error,this),this.scheduleGc()},onError:a,onFail:(d,h)=>{Cn(this,hr,po).call(this,{type:"failed",failureCount:d,error:h})},onPause:()=>{Cn(this,hr,po).call(this,{type:"pause"})},onContinue:()=>{Cn(this,hr,po).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),Z(this,$n).start()}},fc=new WeakMap,pc=new WeakMap,Bs=new WeakMap,$n=new WeakMap,rh=new WeakMap,Fa=new WeakMap,hr=new WeakSet,po=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...q4(s.data,this.options),fetchMeta:t.meta??null};case"success":return{...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=t.error;return oy(r)&&r.revert&&Z(this,pc)?{...Z(this,pc),fetchStatus:"idle"}:{...s,error:r,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),jn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),Z(this,Bs).notify({query:this,type:"updated",action:t})})},bN);function q4(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Z_(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Y4(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var zr,vN,Q4=(vN=class extends Pg{constructor(t={}){super();Xt(this,zr);this.config=t,Et(this,zr,new Map)}build(t,n,s){const r=n.queryKey,o=n.queryHash??Kv(r,n);let i=this.get(o);return i||(i=new X4({cache:this,queryKey:r,queryHash:o,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(r)}),this.add(i)),i}add(t){Z(this,zr).has(t.queryHash)||(Z(this,zr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=Z(this,zr).get(t.queryHash);n&&(t.destroy(),n===t&&Z(this,zr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){jn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Z(this,zr).get(t)}getAll(){return[...Z(this,zr).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>LI(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>LI(t,s)):n}notify(t){jn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){jn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){jn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},zr=new WeakMap,vN),Br,Vn,Pa,Vr,ri,wN,Z4=(wN=class extends eR{constructor(t){super();Xt(this,Vr);Xt(this,Br);Xt(this,Vn);Xt(this,Pa);this.mutationId=t.mutationId,Et(this,Vn,t.mutationCache),Et(this,Br,[]),this.state=t.state||J4(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Z(this,Br).includes(t)||(Z(this,Br).push(t),this.clearGcTimeout(),Z(this,Vn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Et(this,Br,Z(this,Br).filter(n=>n!==t)),this.scheduleGc(),Z(this,Vn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Z(this,Br).length||(this.state.status==="pending"?this.scheduleGc():Z(this,Vn).remove(this))}continue(){var t;return((t=Z(this,Pa))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var r,o,i,a,l,c,u,d,h,f,p,m,g,x,y,b,v,w,k,C;Et(this,Pa,tR({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(S,I)=>{Cn(this,Vr,ri).call(this,{type:"failed",failureCount:S,error:I})},onPause:()=>{Cn(this,Vr,ri).call(this,{type:"pause"})},onContinue:()=>{Cn(this,Vr,ri).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Z(this,Vn).canRun(this)}));const n=this.state.status==="pending",s=!Z(this,Pa).canStart();try{if(!n){Cn(this,Vr,ri).call(this,{type:"pending",variables:t,isPaused:s}),await((o=(r=Z(this,Vn).config).onMutate)==null?void 0:o.call(r,t,this));const I=await((a=(i=this.options).onMutate)==null?void 0:a.call(i,t));I!==this.state.context&&Cn(this,Vr,ri).call(this,{type:"pending",context:I,variables:t,isPaused:s})}const S=await Z(this,Pa).start();return await((c=(l=Z(this,Vn).config).onSuccess)==null?void 0:c.call(l,S,t,this.state.context,this)),await((d=(u=this.options).onSuccess)==null?void 0:d.call(u,S,t,this.state.context)),await((f=(h=Z(this,Vn).config).onSettled)==null?void 0:f.call(h,S,null,this.state.variables,this.state.context,this)),await((m=(p=this.options).onSettled)==null?void 0:m.call(p,S,null,t,this.state.context)),Cn(this,Vr,ri).call(this,{type:"success",data:S}),S}catch(S){try{throw await((x=(g=Z(this,Vn).config).onError)==null?void 0:x.call(g,S,t,this.state.context,this)),await((b=(y=this.options).onError)==null?void 0:b.call(y,S,t,this.state.context)),await((w=(v=Z(this,Vn).config).onSettled)==null?void 0:w.call(v,void 0,S,this.state.variables,this.state.context,this)),await((C=(k=this.options).onSettled)==null?void 0:C.call(k,void 0,S,t,this.state.context)),S}finally{Cn(this,Vr,ri).call(this,{type:"error",error:S})}}finally{Z(this,Vn).runNext(this)}}},Br=new WeakMap,Vn=new WeakMap,Pa=new WeakMap,Vr=new WeakSet,ri=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),jn.batch(()=>{Z(this,Br).forEach(s=>{s.onMutationUpdate(t)}),Z(this,Vn).notify({mutation:this,type:"updated",action:t})})},wN);function J4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var bs,oh,kN,tW=(kN=class extends Pg{constructor(t={}){super();Xt(this,bs);Xt(this,oh);this.config=t,Et(this,bs,new Map),Et(this,oh,Date.now())}build(t,n,s){const r=new Z4({mutationCache:this,mutationId:++Pf(this,oh)._,options:t.defaultMutationOptions(n),state:s});return this.add(r),r}add(t){const n=tp(t),s=Z(this,bs).get(n)??[];s.push(t),Z(this,bs).set(n,s),this.notify({type:"added",mutation:t})}remove(t){var s;const n=tp(t);if(Z(this,bs).has(n)){const r=(s=Z(this,bs).get(n))==null?void 0:s.filter(o=>o!==t);r&&(r.length===0?Z(this,bs).delete(n):Z(this,bs).set(n,r))}this.notify({type:"removed",mutation:t})}canRun(t){var s;const n=(s=Z(this,bs).get(tp(t)))==null?void 0:s.find(r=>r.state.status==="pending");return!n||n===t}runNext(t){var s;const n=(s=Z(this,bs).get(tp(t)))==null?void 0:s.find(r=>r!==t&&r.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){jn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...Z(this,bs).values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(s=>zI(n,s))}findAll(t={}){return this.getAll().filter(n=>zI(t,n))}notify(t){jn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return jn.batch(()=>Promise.all(t.map(n=>n.continue().catch(dr))))}},bs=new WeakMap,oh=new WeakMap,kN);function tp(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function WI(e){return{onFetch:(t,n)=>{var u,d,h,f,p;const s=t.options,r=(h=(d=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,o=((f=t.state.data)==null?void 0:f.pages)||[],i=((p=t.state.data)==null?void 0:p.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let m=!1;const g=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?m=!0:t.signal.addEventListener("abort",()=>{m=!0}),t.signal)})},x=Y_(t.options,t.fetchOptions),y=async(b,v,w)=>{if(m)return Promise.reject();if(v==null&&b.pages.length)return Promise.resolve(b);const k={queryKey:t.queryKey,pageParam:v,direction:w?"backward":"forward",meta:t.options.meta};g(k);const C=await x(k),{maxPages:S}=t.options,I=w?W4:V4;return{pages:I(b.pages,C,S),pageParams:I(b.pageParams,v,S)}};if(r&&o.length){const b=r==="backward",v=b?eW:UI,w={pages:o,pageParams:i},k=v(s,w);a=await y(w,k,b)}else{const b=e??o.length;do{const v=l===0?i[0]??s.initialPageParam:UI(s,a);if(l>0&&v==null)break;a=await y(a,v),l++}while(l<b)}return a};t.options.persister?t.fetchFn=()=>{var m,g;return(g=(m=t.options).persister)==null?void 0:g.call(m,c,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=c}}}function UI(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function eW(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var Ee,hi,fi,mc,gc,pi,xc,yc,CN,nW=(CN=class{constructor(e={}){Xt(this,Ee);Xt(this,hi);Xt(this,fi);Xt(this,mc);Xt(this,gc);Xt(this,pi);Xt(this,xc);Xt(this,yc);Et(this,Ee,e.queryCache||new Q4),Et(this,hi,e.mutationCache||new tW),Et(this,fi,e.defaultOptions||{}),Et(this,mc,new Map),Et(this,gc,new Map),Et(this,pi,0)}mount(){Pf(this,pi)._++,Z(this,pi)===1&&(Et(this,xc,Q_.subscribe(async e=>{e&&(await this.resumePausedMutations(),Z(this,Ee).onFocus())})),Et(this,yc,Em.subscribe(async e=>{e&&(await this.resumePausedMutations(),Z(this,Ee).onOnline())})))}unmount(){var e,t;Pf(this,pi)._--,Z(this,pi)===0&&((e=Z(this,xc))==null||e.call(this),Et(this,xc,void 0),(t=Z(this,yc))==null||t.call(this),Et(this,yc,void 0))}isFetching(e){return Z(this,Ee).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Z(this,hi).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Z(this,Ee).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),s=Z(this,Ee).build(this,n);return e.revalidateIfStale&&s.isStaleByTime(MI(n.staleTime,s))&&this.prefetchQuery(n),Promise.resolve(t)}}getQueriesData(e){return Z(this,Ee).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),r=Z(this,Ee).get(s.queryHash),o=r==null?void 0:r.state.data,i=F4(t,o);if(i!==void 0)return Z(this,Ee).build(this,s).setData(i,{...n,manual:!0})}setQueriesData(e,t,n){return jn.batch(()=>Z(this,Ee).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Z(this,Ee).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=Z(this,Ee);jn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=Z(this,Ee),s={type:"active",...e};return jn.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries(s,t)))}cancelQueries(e={},t={}){const n={revert:!0,...t},s=jn.batch(()=>Z(this,Ee).findAll(e).map(r=>r.cancel(n)));return Promise.all(s).then(dr).catch(dr)}invalidateQueries(e={},t={}){return jn.batch(()=>{if(Z(this,Ee).findAll(e).forEach(s=>{s.invalidate()}),e.refetchType==="none")return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,t)})}refetchQueries(e={},t){const n={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},s=jn.batch(()=>Z(this,Ee).findAll(e).filter(r=>!r.isDisabled()).map(r=>{let o=r.fetch(void 0,n);return n.throwOnError||(o=o.catch(dr)),r.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(s).then(dr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=Z(this,Ee).build(this,t);return n.isStaleByTime(MI(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(dr).catch(dr)}fetchInfiniteQuery(e){return e.behavior=WI(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(dr).catch(dr)}ensureInfiniteQueryData(e){return e.behavior=WI(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Em.isOnline()?Z(this,hi).resumePausedMutations():Promise.resolve()}getQueryCache(){return Z(this,Ee)}getMutationCache(){return Z(this,hi)}getDefaultOptions(){return Z(this,fi)}setDefaultOptions(e){Et(this,fi,e)}setQueryDefaults(e,t){Z(this,mc).set(Od(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Z(this,mc).values()];let n={};return t.forEach(s=>{Fd(e,s.queryKey)&&(n={...n,...s.defaultOptions})}),n}setMutationDefaults(e,t){Z(this,gc).set(Od(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Z(this,gc).values()];let n={};return t.forEach(s=>{Fd(e,s.mutationKey)&&(n={...n,...s.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Z(this,fi).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Kv(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===Xv&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Z(this,fi).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Z(this,Ee).clear(),Z(this,hi).clear()}},Ee=new WeakMap,hi=new WeakMap,fi=new WeakMap,mc=new WeakMap,gc=new WeakMap,pi=new WeakMap,xc=new WeakMap,yc=new WeakMap,CN),sW=D.createContext(void 0),rW=({client:e,children:t})=>(D.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),N.jsx(sW.Provider,{value:e,children:t}));async function oW(e){if(!e.ok){const t=await e.text()||e.statusText;throw new Error(`${e.status}: ${t}`)}}const iW=({on401:e})=>async({queryKey:t})=>{const n=await fetch(t.join("/"),{credentials:"include"});return e==="returnNull"&&n.status===401?null:(await oW(n),await n.json())},aW=new nW({defaultOptions:{queries:{queryFn:iW({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),lW=1,cW=1e6;let iy=0;function uW(){return iy=(iy+1)%Number.MAX_SAFE_INTEGER,iy.toString()}const ay=new Map,jI=e=>{if(ay.has(e))return;const t=setTimeout(()=>{ay.delete(e),cd({type:"REMOVE_TOAST",toastId:e})},cW);ay.set(e,t)},dW=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,lW)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?jI(n):e.toasts.forEach(s=>{jI(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===n||n===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},jp=[];let Gp={toasts:[]};function cd(e){Gp=dW(Gp,e),jp.forEach(t=>{t(Gp)})}function hW({...e}){const t=uW(),n=r=>cd({type:"UPDATE_TOAST",toast:{...r,id:t}}),s=()=>cd({type:"DISMISS_TOAST",toastId:t});return cd({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:r=>{r||s()}}}),{id:t,dismiss:s,update:n}}function fW(){const[e,t]=D.useState(Gp);return D.useEffect(()=>(jp.push(t),()=>{const n=jp.indexOf(t);n>-1&&jp.splice(n,1)}),[e]),{...e,toast:hW,dismiss:n=>cd({type:"DISMISS_TOAST",toastId:n})}}function me(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function GI(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function nR(...e){return t=>{let n=!1;const s=e.map(r=>{const o=GI(r,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let r=0;r<s.length;r++){const o=s[r];typeof o=="function"?o():GI(e[r],null)}}}}function Pn(...e){return D.useCallback(nR(...e),e)}function Xc(e,t=[]){let n=[];function s(o,i){const a=D.createContext(i),l=n.length;n=[...n,i];const c=d=>{var x;const{scope:h,children:f,...p}=d,m=((x=h==null?void 0:h[e])==null?void 0:x[l])||a,g=D.useMemo(()=>p,Object.values(p));return N.jsx(m.Provider,{value:g,children:f})};c.displayName=o+"Provider";function u(d,h){var m;const f=((m=h==null?void 0:h[e])==null?void 0:m[l])||a,p=D.useContext(f);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return[c,u]}const r=()=>{const o=n.map(i=>D.createContext(i));return function(a){const l=(a==null?void 0:a[e])||o;return D.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return r.scopeName=e,[s,pW(r,...t)]}function pW(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const s=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const i=s.reduce((a,{useScope:l,scopeName:c})=>{const d=l(o)[`__scope${c}`];return{...a,...d}},{});return D.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}function _m(e){const t=gW(e),n=D.forwardRef((s,r)=>{const{children:o,...i}=s,a=D.Children.toArray(o),l=a.find(yW);if(l){const c=l.props.children,u=a.map(d=>d===l?D.Children.count(c)>1?D.Children.only(null):D.isValidElement(c)?c.props.children:null:d);return N.jsx(t,{...i,ref:r,children:D.isValidElement(c)?D.cloneElement(c,void 0,u):null})}return N.jsx(t,{...i,ref:r,children:o})});return n.displayName=`${e}.Slot`,n}var mW=_m("Slot");function gW(e){const t=D.forwardRef((n,s)=>{const{children:r,...o}=n;if(D.isValidElement(r)){const i=vW(r),a=bW(o,r.props);return r.type!==D.Fragment&&(a.ref=s?nR(s,i):i),D.cloneElement(r,a)}return D.Children.count(r)>1?D.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var sR=Symbol("radix.slottable");function xW(e){const t=({children:n})=>N.jsx(N.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=sR,t}function yW(e){return D.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===sR}function bW(e,t){const n={...t};for(const s in t){const r=e[s],o=t[s];/^on[A-Z]/.test(s)?r&&o?n[s]=(...a)=>{o(...a),r(...a)}:r&&(n[s]=r):s==="style"?n[s]={...r,...o}:s==="className"&&(n[s]=[r,o].filter(Boolean).join(" "))}return{...e,...n}}function vW(e){var s,r;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function rR(e){const t=e+"CollectionProvider",[n,s]=Xc(t),[r,o]=n(t,{collectionRef:{current:null},itemMap:new Map}),i=m=>{const{scope:g,children:x}=m,y=si.useRef(null),b=si.useRef(new Map).current;return N.jsx(r,{scope:g,itemMap:b,collectionRef:y,children:x})};i.displayName=t;const a=e+"CollectionSlot",l=_m(a),c=si.forwardRef((m,g)=>{const{scope:x,children:y}=m,b=o(a,x),v=Pn(g,b.collectionRef);return N.jsx(l,{ref:v,children:y})});c.displayName=a;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=_m(u),f=si.forwardRef((m,g)=>{const{scope:x,children:y,...b}=m,v=si.useRef(null),w=Pn(g,v),k=o(u,x);return si.useEffect(()=>(k.itemMap.set(v,{ref:v,...b}),()=>void k.itemMap.delete(v))),N.jsx(h,{[d]:"",ref:w,children:y})});f.displayName=u;function p(m){const g=o(e+"CollectionConsumer",m);return si.useCallback(()=>{const y=g.collectionRef.current;if(!y)return[];const b=Array.from(y.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((k,C)=>b.indexOf(k.ref.current)-b.indexOf(C.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:i,Slot:c,ItemSlot:f},p,s]}var wW=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Xe=wW.reduce((e,t)=>{const n=_m(`Primitive.${t}`),s=D.forwardRef((r,o)=>{const{asChild:i,...a}=r,l=i?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),N.jsx(l,{...a,ref:o})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function oR(e,t){e&&dh.flushSync(()=>e.dispatchEvent(t))}function no(e){const t=D.useRef(e);return D.useEffect(()=>{t.current=e}),D.useMemo(()=>(...n)=>{var s;return(s=t.current)==null?void 0:s.call(t,...n)},[])}function kW(e,t=globalThis==null?void 0:globalThis.document){const n=no(e);D.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return t.addEventListener("keydown",s,{capture:!0}),()=>t.removeEventListener("keydown",s,{capture:!0})},[n,t])}var CW="DismissableLayer",Mb="dismissableLayer.update",SW="dismissableLayer.pointerDownOutside",IW="dismissableLayer.focusOutside",HI,iR=D.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),qv=D.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:o,onInteractOutside:i,onDismiss:a,...l}=e,c=D.useContext(iR),[u,d]=D.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=D.useState({}),p=Pn(t,C=>d(C)),m=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=m.indexOf(g),y=u?m.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,v=y>=x,w=TW(C=>{const S=C.target,I=[...c.branches].some($=>$.contains(S));!v||I||(r==null||r(C),i==null||i(C),C.defaultPrevented||a==null||a())},h),k=NW(C=>{const S=C.target;[...c.branches].some($=>$.contains(S))||(o==null||o(C),i==null||i(C),C.defaultPrevented||a==null||a())},h);return kW(C=>{y===c.layers.size-1&&(s==null||s(C),!C.defaultPrevented&&a&&(C.preventDefault(),a()))},h),D.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(HI=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),KI(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=HI)}},[u,h,n,c]),D.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),KI())},[u,c]),D.useEffect(()=>{const C=()=>f({});return document.addEventListener(Mb,C),()=>document.removeEventListener(Mb,C)},[]),N.jsx(Xe.div,{...l,ref:p,style:{pointerEvents:b?v?"auto":"none":void 0,...e.style},onFocusCapture:me(e.onFocusCapture,k.onFocusCapture),onBlurCapture:me(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:me(e.onPointerDownCapture,w.onPointerDownCapture)})});qv.displayName=CW;var $W="DismissableLayerBranch",aR=D.forwardRef((e,t)=>{const n=D.useContext(iR),s=D.useRef(null),r=Pn(t,s);return D.useEffect(()=>{const o=s.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),N.jsx(Xe.div,{...e,ref:r})});aR.displayName=$W;function TW(e,t=globalThis==null?void 0:globalThis.document){const n=no(e),s=D.useRef(!1),r=D.useRef(()=>{});return D.useEffect(()=>{const o=a=>{if(a.target&&!s.current){let l=function(){lR(SW,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",r.current),r.current=l,t.addEventListener("click",r.current,{once:!0})):l()}else t.removeEventListener("click",r.current);s.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",r.current)}},[t,n]),{onPointerDownCapture:()=>s.current=!0}}function NW(e,t=globalThis==null?void 0:globalThis.document){const n=no(e),s=D.useRef(!1);return D.useEffect(()=>{const r=o=>{o.target&&!s.current&&lR(IW,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",r),()=>t.removeEventListener("focusin",r)},[t,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function KI(){const e=new CustomEvent(Mb);document.dispatchEvent(e)}function lR(e,t,n,{discrete:s}){const r=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&r.addEventListener(e,t,{once:!0}),s?oR(r,o):r.dispatchEvent(o)}var EW=qv,_W=aR,qa=globalThis!=null&&globalThis.document?D.useLayoutEffect:()=>{},RW="Portal",cR=D.forwardRef((e,t)=>{var a;const{container:n,...s}=e,[r,o]=D.useState(!1);qa(()=>o(!0),[]);const i=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return i?r4.createPortal(N.jsx(Xe.div,{...s,ref:t}),i):null});cR.displayName=RW;function DW(e,t){return D.useReducer((n,s)=>t[n][s]??n,e)}var Yv=e=>{const{present:t,children:n}=e,s=AW(t),r=typeof n=="function"?n({present:s.isPresent}):D.Children.only(n),o=Pn(s.ref,OW(r));return typeof n=="function"||s.isPresent?D.cloneElement(r,{ref:o}):null};Yv.displayName="Presence";function AW(e){const[t,n]=D.useState(),s=D.useRef({}),r=D.useRef(e),o=D.useRef("none"),i=e?"mounted":"unmounted",[a,l]=DW(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return D.useEffect(()=>{const c=ep(s.current);o.current=a==="mounted"?c:"none"},[a]),qa(()=>{const c=s.current,u=r.current;if(u!==e){const h=o.current,f=ep(c);e?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),r.current=e}},[e,l]),qa(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=f=>{const m=ep(s.current).includes(f.animationName);if(f.target===t&&m&&(l("ANIMATION_END"),!r.current)){const g=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=g)})}},h=f=>{f.target===t&&(o.current=ep(s.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:D.useCallback(c=>{c&&(s.current=getComputedStyle(c)),n(c)},[])}}function ep(e){return(e==null?void 0:e.animationName)||"none"}function OW(e){var s,r;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function uR({prop:e,defaultProp:t,onChange:n=()=>{}}){const[s,r]=FW({defaultProp:t,onChange:n}),o=e!==void 0,i=o?e:s,a=no(n),l=D.useCallback(c=>{if(o){const d=typeof c=="function"?c(e):c;d!==e&&a(d)}else r(c)},[o,e,r,a]);return[i,l]}function FW({defaultProp:e,onChange:t}){const n=D.useState(e),[s]=n,r=D.useRef(s),o=no(t);return D.useEffect(()=>{r.current!==s&&(o(s),r.current=s)},[s,r,o]),n}var PW="VisuallyHidden",Lg=D.forwardRef((e,t)=>N.jsx(Xe.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));Lg.displayName=PW;var MW=Lg,Qv="ToastProvider",[Zv,LW,zW]=rR("Toast"),[dR,W1t]=Xc("Toast",[zW]),[BW,zg]=dR(Qv),hR=e=>{const{__scopeToast:t,label:n="Notification",duration:s=5e3,swipeDirection:r="right",swipeThreshold:o=50,children:i}=e,[a,l]=D.useState(null),[c,u]=D.useState(0),d=D.useRef(!1),h=D.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Qv}\`. Expected non-empty \`string\`.`),N.jsx(Zv.Provider,{scope:t,children:N.jsx(BW,{scope:t,label:n,duration:s,swipeDirection:r,swipeThreshold:o,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:D.useCallback(()=>u(f=>f+1),[]),onToastRemove:D.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:i})})};hR.displayName=Qv;var fR="ToastViewport",VW=["F8"],Lb="toast.viewportPause",zb="toast.viewportResume",pR=D.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:s=VW,label:r="Notifications ({hotkey})",...o}=e,i=zg(fR,n),a=LW(n),l=D.useRef(null),c=D.useRef(null),u=D.useRef(null),d=D.useRef(null),h=Pn(t,d,i.onViewportChange),f=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=i.toastCount>0;D.useEffect(()=>{const g=x=>{var b;s.length!==0&&s.every(v=>x[v]||x.code===v)&&((b=d.current)==null||b.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[s]),D.useEffect(()=>{const g=l.current,x=d.current;if(p&&g&&x){const y=()=>{if(!i.isClosePausedRef.current){const k=new CustomEvent(Lb);x.dispatchEvent(k),i.isClosePausedRef.current=!0}},b=()=>{if(i.isClosePausedRef.current){const k=new CustomEvent(zb);x.dispatchEvent(k),i.isClosePausedRef.current=!1}},v=k=>{!g.contains(k.relatedTarget)&&b()},w=()=>{g.contains(document.activeElement)||b()};return g.addEventListener("focusin",y),g.addEventListener("focusout",v),g.addEventListener("pointermove",y),g.addEventListener("pointerleave",w),window.addEventListener("blur",y),window.addEventListener("focus",b),()=>{g.removeEventListener("focusin",y),g.removeEventListener("focusout",v),g.removeEventListener("pointermove",y),g.removeEventListener("pointerleave",w),window.removeEventListener("blur",y),window.removeEventListener("focus",b)}}},[p,i.isClosePausedRef]);const m=D.useCallback(({tabbingDirection:g})=>{const y=a().map(b=>{const v=b.ref.current,w=[v,...tU(v)];return g==="forwards"?w:w.reverse()});return(g==="forwards"?y.reverse():y).flat()},[a]);return D.useEffect(()=>{const g=d.current;if(g){const x=y=>{var w,k,C;const b=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!b){const S=document.activeElement,I=y.shiftKey;if(y.target===g&&I){(w=c.current)==null||w.focus();return}const A=m({tabbingDirection:I?"backwards":"forwards"}),L=A.findIndex(O=>O===S);ly(A.slice(L+1))?y.preventDefault():I?(k=c.current)==null||k.focus():(C=u.current)==null||C.focus()}};return g.addEventListener("keydown",x),()=>g.removeEventListener("keydown",x)}},[a,m]),N.jsxs(_W,{ref:l,role:"region","aria-label":r.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&N.jsx(Bb,{ref:c,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"forwards"});ly(g)}}),N.jsx(Zv.Slot,{scope:n,children:N.jsx(Xe.ol,{tabIndex:-1,...o,ref:h})}),p&&N.jsx(Bb,{ref:u,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"backwards"});ly(g)}})]})});pR.displayName=fR;var mR="ToastFocusProxy",Bb=D.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:s,...r}=e,o=zg(mR,n);return N.jsx(Lg,{"aria-hidden":!0,tabIndex:0,...r,ref:t,style:{position:"fixed"},onFocus:i=>{var c;const a=i.relatedTarget;!((c=o.viewport)!=null&&c.contains(a))&&s()}})});Bb.displayName=mR;var Bg="Toast",WW="toast.swipeStart",UW="toast.swipeMove",jW="toast.swipeCancel",GW="toast.swipeEnd",gR=D.forwardRef((e,t)=>{const{forceMount:n,open:s,defaultOpen:r,onOpenChange:o,...i}=e,[a=!0,l]=uR({prop:s,defaultProp:r,onChange:o});return N.jsx(Yv,{present:n||a,children:N.jsx(XW,{open:a,...i,ref:t,onClose:()=>l(!1),onPause:no(e.onPause),onResume:no(e.onResume),onSwipeStart:me(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:me(e.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:me(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:me(e.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});gR.displayName=Bg;var[HW,KW]=dR(Bg,{onClose(){}}),XW=D.forwardRef((e,t)=>{const{__scopeToast:n,type:s="foreground",duration:r,open:o,onClose:i,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=e,m=zg(Bg,n),[g,x]=D.useState(null),y=Pn(t,O=>x(O)),b=D.useRef(null),v=D.useRef(null),w=r||m.duration,k=D.useRef(0),C=D.useRef(w),S=D.useRef(0),{onToastAdd:I,onToastRemove:$}=m,E=no(()=>{var P;(g==null?void 0:g.contains(document.activeElement))&&((P=m.viewport)==null||P.focus()),i()}),A=D.useCallback(O=>{!O||O===1/0||(window.clearTimeout(S.current),k.current=new Date().getTime(),S.current=window.setTimeout(E,O))},[E]);D.useEffect(()=>{const O=m.viewport;if(O){const P=()=>{A(C.current),c==null||c()},M=()=>{const U=new Date().getTime()-k.current;C.current=C.current-U,window.clearTimeout(S.current),l==null||l()};return O.addEventListener(Lb,M),O.addEventListener(zb,P),()=>{O.removeEventListener(Lb,M),O.removeEventListener(zb,P)}}},[m.viewport,w,l,c,A]),D.useEffect(()=>{o&&!m.isClosePausedRef.current&&A(w)},[o,w,m.isClosePausedRef,A]),D.useEffect(()=>(I(),()=>$()),[I,$]);const L=D.useMemo(()=>g?CR(g):null,[g]);return m.viewport?N.jsxs(N.Fragment,{children:[L&&N.jsx(qW,{__scopeToast:n,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:L}),N.jsx(HW,{scope:n,onClose:E,children:dh.createPortal(N.jsx(Zv.ItemSlot,{scope:n,children:N.jsx(EW,{asChild:!0,onEscapeKeyDown:me(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||E(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:N.jsx(Xe.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":m.swipeDirection,...p,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:me(e.onKeyDown,O=>{O.key==="Escape"&&(a==null||a(O.nativeEvent),O.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,E()))}),onPointerDown:me(e.onPointerDown,O=>{O.button===0&&(b.current={x:O.clientX,y:O.clientY})}),onPointerMove:me(e.onPointerMove,O=>{if(!b.current)return;const P=O.clientX-b.current.x,M=O.clientY-b.current.y,U=!!v.current,R=["left","right"].includes(m.swipeDirection),z=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,H=R?z(0,P):0,X=R?0:z(0,M),Q=O.pointerType==="touch"?10:2,J={x:H,y:X},nt={originalEvent:O,delta:J};U?(v.current=J,np(UW,d,nt,{discrete:!1})):XI(J,m.swipeDirection,Q)?(v.current=J,np(WW,u,nt,{discrete:!1}),O.target.setPointerCapture(O.pointerId)):(Math.abs(P)>Q||Math.abs(M)>Q)&&(b.current=null)}),onPointerUp:me(e.onPointerUp,O=>{const P=v.current,M=O.target;if(M.hasPointerCapture(O.pointerId)&&M.releasePointerCapture(O.pointerId),v.current=null,b.current=null,P){const U=O.currentTarget,R={originalEvent:O,delta:P};XI(P,m.swipeDirection,m.swipeThreshold)?np(GW,f,R,{discrete:!0}):np(jW,h,R,{discrete:!0}),U.addEventListener("click",z=>z.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),qW=e=>{const{__scopeToast:t,children:n,...s}=e,r=zg(Bg,t),[o,i]=D.useState(!1),[a,l]=D.useState(!1);return ZW(()=>i(!0)),D.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:N.jsx(cR,{asChild:!0,children:N.jsx(Lg,{...s,children:o&&N.jsxs(N.Fragment,{children:[r.label," ",n]})})})},YW="ToastTitle",xR=D.forwardRef((e,t)=>{const{__scopeToast:n,...s}=e;return N.jsx(Xe.div,{...s,ref:t})});xR.displayName=YW;var QW="ToastDescription",yR=D.forwardRef((e,t)=>{const{__scopeToast:n,...s}=e;return N.jsx(Xe.div,{...s,ref:t})});yR.displayName=QW;var bR="ToastAction",vR=D.forwardRef((e,t)=>{const{altText:n,...s}=e;return n.trim()?N.jsx(kR,{altText:n,asChild:!0,children:N.jsx(Jv,{...s,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${bR}\`. Expected non-empty \`string\`.`),null)});vR.displayName=bR;var wR="ToastClose",Jv=D.forwardRef((e,t)=>{const{__scopeToast:n,...s}=e,r=KW(wR,n);return N.jsx(kR,{asChild:!0,children:N.jsx(Xe.button,{type:"button",...s,ref:t,onClick:me(e.onClick,r.onClose)})})});Jv.displayName=wR;var kR=D.forwardRef((e,t)=>{const{__scopeToast:n,altText:s,...r}=e;return N.jsx(Xe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...r,ref:t})});function CR(e){const t=[];return Array.from(e.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&t.push(s.textContent),JW(s)){const r=s.ariaHidden||s.hidden||s.style.display==="none",o=s.dataset.radixToastAnnounceExclude==="";if(!r)if(o){const i=s.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...CR(s))}}),t}function np(e,t,n,{discrete:s}){const r=n.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&r.addEventListener(e,t,{once:!0}),s?oR(r,o):r.dispatchEvent(o)}var XI=(e,t,n=0)=>{const s=Math.abs(e.x),r=Math.abs(e.y),o=s>r;return t==="left"||t==="right"?o&&s>n:!o&&r>n};function ZW(e=()=>{}){const t=no(e);qa(()=>{let n=0,s=0;return n=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(s)}},[t])}function JW(e){return e.nodeType===e.ELEMENT_NODE}function tU(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function ly(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var eU=hR,SR=pR,IR=gR,$R=xR,TR=yR,NR=vR,ER=Jv;function _R(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=_R(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function RR(){for(var e,t,n=0,s="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=_R(e))&&(s&&(s+=" "),s+=t);return s}const qI=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,YI=RR,DR=(e,t)=>n=>{var s;if((t==null?void 0:t.variants)==null)return YI(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:o}=t,i=Object.keys(r).map(c=>{const u=n==null?void 0:n[c],d=o==null?void 0:o[c];if(u===null)return null;const h=qI(u)||qI(d);return r[c][h]}),a=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((c,u)=>{let{class:d,className:h,...f}=u;return Object.entries(f).every(p=>{let[m,g]=p;return Array.isArray(g)?g.includes({...o,...a}[m]):{...o,...a}[m]===g})?[...c,d,h]:c},[]);return YI(e,i,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nU=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AR=(...e)=>e.filter((t,n,s)=>!!t&&s.indexOf(t)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var sU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rU=D.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:o,iconNode:i,...a},l)=>D.createElement("svg",{ref:l,...sU,width:t,height:t,stroke:e,strokeWidth:s?Number(n)*24/Number(t):n,className:AR("lucide",r),...a},[...i.map(([c,u])=>D.createElement(c,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=(e,t)=>{const n=D.forwardRef(({className:s,...r},o)=>D.createElement(rU,{ref:o,iconNode:t,className:AR(`lucide-${nU(e)}`,s),...r}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oU=qc("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iU=qc("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aU=qc("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lU=qc("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cU=qc("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uU=qc("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),tw="-",dU=e=>{const t=fU(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:i=>{const a=i.split(tw);return a[0]===""&&a.length!==1&&a.shift(),OR(a,t)||hU(i)},getConflictingClassGroupIds:(i,a)=>{const l=n[i]||[];return a&&s[i]?[...l,...s[i]]:l}}},OR=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const n=e[0],s=t.nextPart.get(n),r=s?OR(e.slice(1),s):void 0;if(r)return r;if(t.validators.length===0)return;const o=e.join(tw);return(i=t.validators.find(({validator:a})=>a(o)))==null?void 0:i.classGroupId},QI=/^\[(.+)\]$/,hU=e=>{if(QI.test(e)){const t=QI.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},fU=e=>{const{theme:t,prefix:n}=e,s={nextPart:new Map,validators:[]};return mU(Object.entries(e.classGroups),n).forEach(([o,i])=>{Vb(i,s,o,t)}),s},Vb=(e,t,n,s)=>{e.forEach(r=>{if(typeof r=="string"){const o=r===""?t:ZI(t,r);o.classGroupId=n;return}if(typeof r=="function"){if(pU(r)){Vb(r(s),t,n,s);return}t.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([o,i])=>{Vb(i,ZI(t,o),n,s)})})},ZI=(e,t)=>{let n=e;return t.split(tw).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},pU=e=>e.isThemeGetter,mU=(e,t)=>t?e.map(([n,s])=>{const r=s.map(o=>typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([i,a])=>[t+i,a])):o);return[n,r]}):e,gU=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,s=new Map;const r=(o,i)=>{n.set(o,i),t++,t>e&&(t=0,s=n,n=new Map)};return{get(o){let i=n.get(o);if(i!==void 0)return i;if((i=s.get(o))!==void 0)return r(o,i),i},set(o,i){n.has(o)?n.set(o,i):r(o,i)}}},FR="!",xU=e=>{const{separator:t,experimentalParseClassName:n}=e,s=t.length===1,r=t[0],o=t.length,i=a=>{const l=[];let c=0,u=0,d;for(let g=0;g<a.length;g++){let x=a[g];if(c===0){if(x===r&&(s||a.slice(g,g+o)===t)){l.push(a.slice(u,g)),u=g+o;continue}if(x==="/"){d=g;continue}}x==="["?c++:x==="]"&&c--}const h=l.length===0?a:a.substring(u),f=h.startsWith(FR),p=f?h.substring(1):h,m=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:m}};return n?a=>n({className:a,parseClassName:i}):i},yU=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(s=>{s[0]==="["?(t.push(...n.sort(),s),n=[]):n.push(s)}),t.push(...n.sort()),t},bU=e=>({cache:gU(e.cacheSize),parseClassName:xU(e),...dU(e)}),vU=/\s+/,wU=(e,t)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=t,o=[],i=e.trim().split(vU);let a="";for(let l=i.length-1;l>=0;l-=1){const c=i[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:f}=n(c);let p=!!f,m=s(p?h.substring(0,f):h);if(!m){if(!p){a=c+(a.length>0?" "+a:a);continue}if(m=s(h),!m){a=c+(a.length>0?" "+a:a);continue}p=!1}const g=yU(u).join(":"),x=d?g+FR:g,y=x+m;if(o.includes(y))continue;o.push(y);const b=r(m,p);for(let v=0;v<b.length;++v){const w=b[v];o.push(x+w)}a=c+(a.length>0?" "+a:a)}return a};function kU(){let e=0,t,n,s="";for(;e<arguments.length;)(t=arguments[e++])&&(n=PR(t))&&(s&&(s+=" "),s+=n);return s}const PR=e=>{if(typeof e=="string")return e;let t,n="";for(let s=0;s<e.length;s++)e[s]&&(t=PR(e[s]))&&(n&&(n+=" "),n+=t);return n};function CU(e,...t){let n,s,r,o=i;function i(l){const c=t.reduce((u,d)=>d(u),e());return n=bU(c),s=n.cache.get,r=n.cache.set,o=a,a(l)}function a(l){const c=s(l);if(c)return c;const u=wU(l,n);return r(l,u),u}return function(){return o(kU.apply(null,arguments))}}const fe=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},MR=/^\[(?:([a-z-]+):)?(.+)\]$/i,SU=/^\d+\/\d+$/,IU=new Set(["px","full","screen"]),$U=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,TU=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,NU=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,EU=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,_U=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ho=e=>nc(e)||IU.has(e)||SU.test(e),ei=e=>Yc(e,"length",LU),nc=e=>!!e&&!Number.isNaN(Number(e)),cy=e=>Yc(e,"number",nc),$u=e=>!!e&&Number.isInteger(Number(e)),RU=e=>e.endsWith("%")&&nc(e.slice(0,-1)),Nt=e=>MR.test(e),ni=e=>$U.test(e),DU=new Set(["length","size","percentage"]),AU=e=>Yc(e,DU,LR),OU=e=>Yc(e,"position",LR),FU=new Set(["image","url"]),PU=e=>Yc(e,FU,BU),MU=e=>Yc(e,"",zU),Tu=()=>!0,Yc=(e,t,n)=>{const s=MR.exec(e);return s?s[1]?typeof t=="string"?s[1]===t:t.has(s[1]):n(s[2]):!1},LU=e=>TU.test(e)&&!NU.test(e),LR=()=>!1,zU=e=>EU.test(e),BU=e=>_U.test(e),VU=()=>{const e=fe("colors"),t=fe("spacing"),n=fe("blur"),s=fe("brightness"),r=fe("borderColor"),o=fe("borderRadius"),i=fe("borderSpacing"),a=fe("borderWidth"),l=fe("contrast"),c=fe("grayscale"),u=fe("hueRotate"),d=fe("invert"),h=fe("gap"),f=fe("gradientColorStops"),p=fe("gradientColorStopPositions"),m=fe("inset"),g=fe("margin"),x=fe("opacity"),y=fe("padding"),b=fe("saturate"),v=fe("scale"),w=fe("sepia"),k=fe("skew"),C=fe("space"),S=fe("translate"),I=()=>["auto","contain","none"],$=()=>["auto","hidden","clip","visible","scroll"],E=()=>["auto",Nt,t],A=()=>[Nt,t],L=()=>["",ho,ei],O=()=>["auto",nc,Nt],P=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],M=()=>["solid","dashed","dotted","double","none"],U=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",Nt],H=()=>["auto","avoid","all","avoid-page","page","left","right","column"],X=()=>[nc,Nt];return{cacheSize:500,separator:":",theme:{colors:[Tu],spacing:[ho,ei],blur:["none","",ni,Nt],brightness:X(),borderColor:[e],borderRadius:["none","","full",ni,Nt],borderSpacing:A(),borderWidth:L(),contrast:X(),grayscale:z(),hueRotate:X(),invert:z(),gap:A(),gradientColorStops:[e],gradientColorStopPositions:[RU,ei],inset:E(),margin:E(),opacity:X(),padding:A(),saturate:X(),scale:X(),sepia:z(),skew:X(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",Nt]}],container:["container"],columns:[{columns:[ni]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...P(),Nt]}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",$u,Nt]}],basis:[{basis:E()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Nt]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",$u,Nt]}],"grid-cols":[{"grid-cols":[Tu]}],"col-start-end":[{col:["auto",{span:["full",$u,Nt]},Nt]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[Tu]}],"row-start-end":[{row:["auto",{span:[$u,Nt]},Nt]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Nt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Nt]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...R()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...R(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...R(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Nt,t]}],"min-w":[{"min-w":[Nt,t,"min","max","fit"]}],"max-w":[{"max-w":[Nt,t,"none","full","min","max","fit","prose",{screen:[ni]},ni]}],h:[{h:[Nt,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Nt,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Nt,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Nt,t,"auto","min","max","fit"]}],"font-size":[{text:["base",ni,ei]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",cy]}],"font-family":[{font:[Tu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Nt]}],"line-clamp":[{"line-clamp":["none",nc,cy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ho,Nt]}],"list-image":[{"list-image":["none",Nt]}],"list-style-type":[{list:["none","disc","decimal",Nt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...M(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ho,ei]}],"underline-offset":[{"underline-offset":["auto",ho,Nt]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Nt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Nt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...P(),OU]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",AU]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},PU]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...M(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:M()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...M()]}],"outline-offset":[{"outline-offset":[ho,Nt]}],"outline-w":[{outline:[ho,ei]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[ho,ei]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ni,MU]}],"shadow-color":[{shadow:[Tu]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...U(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":U()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",ni,Nt]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Nt]}],duration:[{duration:X()}],ease:[{ease:["linear","in","out","in-out",Nt]}],delay:[{delay:X()}],animate:[{animate:["none","spin","ping","pulse","bounce",Nt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[v]}],"scale-x":[{"scale-x":[v]}],"scale-y":[{"scale-y":[v]}],rotate:[{rotate:[$u,Nt]}],"translate-x":[{"translate-x":[S]}],"translate-y":[{"translate-y":[S]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Nt]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Nt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Nt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ho,ei,cy]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},WU=CU(VU);function zn(...e){return WU(RR(e))}const UU=eU,zR=D.forwardRef(({className:e,...t},n)=>N.jsx(SR,{ref:n,className:zn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));zR.displayName=SR.displayName;const jU=DR("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),BR=D.forwardRef(({className:e,variant:t,...n},s)=>N.jsx(IR,{ref:s,className:zn(jU({variant:t}),e),...n}));BR.displayName=IR.displayName;const GU=D.forwardRef(({className:e,...t},n)=>N.jsx(NR,{ref:n,className:zn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));GU.displayName=NR.displayName;const VR=D.forwardRef(({className:e,...t},n)=>N.jsx(ER,{ref:n,className:zn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:N.jsx(uU,{className:"h-4 w-4"})}));VR.displayName=ER.displayName;const WR=D.forwardRef(({className:e,...t},n)=>N.jsx($R,{ref:n,className:zn("text-sm font-semibold",e),...t}));WR.displayName=$R.displayName;const UR=D.forwardRef(({className:e,...t},n)=>N.jsx(TR,{ref:n,className:zn("text-sm opacity-90",e),...t}));UR.displayName=TR.displayName;function HU(){const{toasts:e}=fW();return N.jsxs(UU,{children:[e.map(function({id:t,title:n,description:s,action:r,...o}){return N.jsxs(BR,{...o,children:[N.jsxs("div",{className:"grid gap-1",children:[n&&N.jsx(WR,{children:n}),s&&N.jsx(UR,{children:s})]}),r,N.jsx(VR,{})]},t)}),N.jsx(zR,{})]})}const KU=["top","right","bottom","left"],Bi=Math.min,ws=Math.max,Rm=Math.round,sp=Math.floor,qr=e=>({x:e,y:e}),XU={left:"right",right:"left",bottom:"top",top:"bottom"},qU={start:"end",end:"start"};function Wb(e,t,n){return ws(e,Bi(t,n))}function Fo(e,t){return typeof e=="function"?e(t):e}function Po(e){return e.split("-")[0]}function Qc(e){return e.split("-")[1]}function ew(e){return e==="x"?"y":"x"}function nw(e){return e==="y"?"height":"width"}function Vi(e){return["top","bottom"].includes(Po(e))?"y":"x"}function sw(e){return ew(Vi(e))}function YU(e,t,n){n===void 0&&(n=!1);const s=Qc(e),r=sw(e),o=nw(r);let i=r==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=Dm(i)),[i,Dm(i)]}function QU(e){const t=Dm(e);return[Ub(e),t,Ub(t)]}function Ub(e){return e.replace(/start|end/g,t=>qU[t])}function ZU(e,t,n){const s=["left","right"],r=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?r:s:t?s:r;case"left":case"right":return t?o:i;default:return[]}}function JU(e,t,n,s){const r=Qc(e);let o=ZU(Po(e),n==="start",s);return r&&(o=o.map(i=>i+"-"+r),t&&(o=o.concat(o.map(Ub)))),o}function Dm(e){return e.replace(/left|right|bottom|top/g,t=>XU[t])}function tj(e){return{top:0,right:0,bottom:0,left:0,...e}}function jR(e){return typeof e!="number"?tj(e):{top:e,right:e,bottom:e,left:e}}function Am(e){const{x:t,y:n,width:s,height:r}=e;return{width:s,height:r,top:n,left:t,right:t+s,bottom:n+r,x:t,y:n}}function JI(e,t,n){let{reference:s,floating:r}=e;const o=Vi(t),i=sw(t),a=nw(i),l=Po(t),c=o==="y",u=s.x+s.width/2-r.width/2,d=s.y+s.height/2-r.height/2,h=s[a]/2-r[a]/2;let f;switch(l){case"top":f={x:u,y:s.y-r.height};break;case"bottom":f={x:u,y:s.y+s.height};break;case"right":f={x:s.x+s.width,y:d};break;case"left":f={x:s.x-r.width,y:d};break;default:f={x:s.x,y:s.y}}switch(Qc(t)){case"start":f[i]-=h*(n&&c?-1:1);break;case"end":f[i]+=h*(n&&c?-1:1);break}return f}const ej=async(e,t,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:o=[],platform:i}=n,a=o.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(t));let c=await i.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:d}=JI(c,s,l),h=s,f={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:x}=a[m],{x:y,y:b,data:v,reset:w}=await x({x:u,y:d,initialPlacement:s,placement:h,strategy:r,middlewareData:f,rects:c,platform:i,elements:{reference:e,floating:t}});u=y??u,d=b??d,f={...f,[g]:{...f[g],...v}},w&&p<=50&&(p++,typeof w=="object"&&(w.placement&&(h=w.placement),w.rects&&(c=w.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:r}):w.rects),{x:u,y:d}=JI(c,h,l)),m=-1)}return{x:u,y:d,placement:h,strategy:r,middlewareData:f}};async function Pd(e,t){var n;t===void 0&&(t={});const{x:s,y:r,platform:o,rects:i,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Fo(t,e),p=jR(f),g=a[h?d==="floating"?"reference":"floating":d],x=Am(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(g)))==null||n?g:g.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=d==="floating"?{x:s,y:r,width:i.floating.width,height:i.floating.height}:i.reference,b=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),v=await(o.isElement==null?void 0:o.isElement(b))?await(o.getScale==null?void 0:o.getScale(b))||{x:1,y:1}:{x:1,y:1},w=Am(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:b,strategy:l}):y);return{top:(x.top-w.top+p.top)/v.y,bottom:(w.bottom-x.bottom+p.bottom)/v.y,left:(x.left-w.left+p.left)/v.x,right:(w.right-x.right+p.right)/v.x}}const nj=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:s,placement:r,rects:o,platform:i,elements:a,middlewareData:l}=t,{element:c,padding:u=0}=Fo(e,t)||{};if(c==null)return{};const d=jR(u),h={x:n,y:s},f=sw(r),p=nw(f),m=await i.getDimensions(c),g=f==="y",x=g?"top":"left",y=g?"bottom":"right",b=g?"clientHeight":"clientWidth",v=o.reference[p]+o.reference[f]-h[f]-o.floating[p],w=h[f]-o.reference[f],k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let C=k?k[b]:0;(!C||!await(i.isElement==null?void 0:i.isElement(k)))&&(C=a.floating[b]||o.floating[p]);const S=v/2-w/2,I=C/2-m[p]/2-1,$=Bi(d[x],I),E=Bi(d[y],I),A=$,L=C-m[p]-E,O=C/2-m[p]/2+S,P=Wb(A,O,L),M=!l.arrow&&Qc(r)!=null&&O!==P&&o.reference[p]/2-(O<A?$:E)-m[p]/2<0,U=M?O<A?O-A:O-L:0;return{[f]:h[f]+U,data:{[f]:P,centerOffset:O-P-U,...M&&{alignmentOffset:U}},reset:M}}}),sj=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,s;const{placement:r,middlewareData:o,rects:i,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=Fo(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const x=Po(r),y=Vi(a),b=Po(a)===a,v=await(l.isRTL==null?void 0:l.isRTL(c.floating)),w=h||(b||!m?[Dm(a)]:QU(a)),k=p!=="none";!h&&k&&w.push(...JU(a,m,p,v));const C=[a,...w],S=await Pd(t,g),I=[];let $=((s=o.flip)==null?void 0:s.overflows)||[];if(u&&I.push(S[x]),d){const O=YU(r,i,v);I.push(S[O[0]],S[O[1]])}if($=[...$,{placement:r,overflows:I}],!I.every(O=>O<=0)){var E,A;const O=(((E=o.flip)==null?void 0:E.index)||0)+1,P=C[O];if(P)return{data:{index:O,overflows:$},reset:{placement:P}};let M=(A=$.filter(U=>U.overflows[0]<=0).sort((U,R)=>U.overflows[1]-R.overflows[1])[0])==null?void 0:A.placement;if(!M)switch(f){case"bestFit":{var L;const U=(L=$.filter(R=>{if(k){const z=Vi(R.placement);return z===y||z==="y"}return!0}).map(R=>[R.placement,R.overflows.filter(z=>z>0).reduce((z,H)=>z+H,0)]).sort((R,z)=>R[1]-z[1])[0])==null?void 0:L[0];U&&(M=U);break}case"initialPlacement":M=a;break}if(r!==M)return{reset:{placement:M}}}return{}}}};function t2(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function e2(e){return KU.some(t=>e[t]>=0)}const rj=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:s="referenceHidden",...r}=Fo(e,t);switch(s){case"referenceHidden":{const o=await Pd(t,{...r,elementContext:"reference"}),i=t2(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:e2(i)}}}case"escaped":{const o=await Pd(t,{...r,altBoundary:!0}),i=t2(o,n.floating);return{data:{escapedOffsets:i,escaped:e2(i)}}}default:return{}}}}};async function oj(e,t){const{placement:n,platform:s,elements:r}=e,o=await(s.isRTL==null?void 0:s.isRTL(r.floating)),i=Po(n),a=Qc(n),l=Vi(n)==="y",c=["left","top"].includes(i)?-1:1,u=o&&l?-1:1,d=Fo(t,e);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const ij=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,s;const{x:r,y:o,placement:i,middlewareData:a}=t,l=await oj(t,e);return i===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:o+l.y,data:{...l,placement:i}}}}},aj=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:s,placement:r}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:a={fn:g=>{let{x,y}=g;return{x,y}}},...l}=Fo(e,t),c={x:n,y:s},u=await Pd(t,l),d=Vi(Po(r)),h=ew(d);let f=c[h],p=c[d];if(o){const g=h==="y"?"top":"left",x=h==="y"?"bottom":"right",y=f+u[g],b=f-u[x];f=Wb(y,f,b)}if(i){const g=d==="y"?"top":"left",x=d==="y"?"bottom":"right",y=p+u[g],b=p-u[x];p=Wb(y,p,b)}const m=a.fn({...t,[h]:f,[d]:p});return{...m,data:{x:m.x-n,y:m.y-s,enabled:{[h]:o,[d]:i}}}}}},lj=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:s,placement:r,rects:o,middlewareData:i}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Fo(e,t),u={x:n,y:s},d=Vi(r),h=ew(d);let f=u[h],p=u[d];const m=Fo(a,t),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const b=h==="y"?"height":"width",v=o.reference[h]-o.floating[b]+g.mainAxis,w=o.reference[h]+o.reference[b]-g.mainAxis;f<v?f=v:f>w&&(f=w)}if(c){var x,y;const b=h==="y"?"width":"height",v=["top","left"].includes(Po(r)),w=o.reference[d]-o.floating[b]+(v&&((x=i.offset)==null?void 0:x[d])||0)+(v?0:g.crossAxis),k=o.reference[d]+o.reference[b]+(v?0:((y=i.offset)==null?void 0:y[d])||0)-(v?g.crossAxis:0);p<w?p=w:p>k&&(p=k)}return{[h]:f,[d]:p}}}},cj=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,s;const{placement:r,rects:o,platform:i,elements:a}=t,{apply:l=()=>{},...c}=Fo(e,t),u=await Pd(t,c),d=Po(r),h=Qc(r),f=Vi(r)==="y",{width:p,height:m}=o.floating;let g,x;d==="top"||d==="bottom"?(g=d,x=h===(await(i.isRTL==null?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(x=d,g=h==="end"?"top":"bottom");const y=m-u.top-u.bottom,b=p-u.left-u.right,v=Bi(m-u[g],y),w=Bi(p-u[x],b),k=!t.middlewareData.shift;let C=v,S=w;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(S=b),(s=t.middlewareData.shift)!=null&&s.enabled.y&&(C=y),k&&!h){const $=ws(u.left,0),E=ws(u.right,0),A=ws(u.top,0),L=ws(u.bottom,0);f?S=p-2*($!==0||E!==0?$+E:ws(u.left,u.right)):C=m-2*(A!==0||L!==0?A+L:ws(u.top,u.bottom))}await l({...t,availableWidth:S,availableHeight:C});const I=await i.getDimensions(a.floating);return p!==I.width||m!==I.height?{reset:{rects:!0}}:{}}}};function Vg(){return typeof window<"u"}function Zc(e){return GR(e)?(e.nodeName||"").toLowerCase():"#document"}function Ts(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function lo(e){var t;return(t=(GR(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function GR(e){return Vg()?e instanceof Node||e instanceof Ts(e).Node:!1}function $r(e){return Vg()?e instanceof Element||e instanceof Ts(e).Element:!1}function so(e){return Vg()?e instanceof HTMLElement||e instanceof Ts(e).HTMLElement:!1}function n2(e){return!Vg()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ts(e).ShadowRoot}function hh(e){const{overflow:t,overflowX:n,overflowY:s,display:r}=Tr(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+n)&&!["inline","contents"].includes(r)}function uj(e){return["table","td","th"].includes(Zc(e))}function Wg(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function rw(e){const t=ow(),n=$r(e)?Tr(e):e;return["transform","translate","scale","rotate","perspective"].some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(n.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(n.contain||"").includes(s))}function dj(e){let t=Wi(e);for(;so(t)&&!Tc(t);){if(rw(t))return t;if(Wg(t))return null;t=Wi(t)}return null}function ow(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Tc(e){return["html","body","#document"].includes(Zc(e))}function Tr(e){return Ts(e).getComputedStyle(e)}function Ug(e){return $r(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Wi(e){if(Zc(e)==="html")return e;const t=e.assignedSlot||e.parentNode||n2(e)&&e.host||lo(e);return n2(t)?t.host:t}function HR(e){const t=Wi(e);return Tc(t)?e.ownerDocument?e.ownerDocument.body:e.body:so(t)&&hh(t)?t:HR(t)}function Md(e,t,n){var s;t===void 0&&(t=[]),n===void 0&&(n=!0);const r=HR(e),o=r===((s=e.ownerDocument)==null?void 0:s.body),i=Ts(r);if(o){const a=jb(i);return t.concat(i,i.visualViewport||[],hh(r)?r:[],a&&n?Md(a):[])}return t.concat(r,Md(r,[],n))}function jb(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function KR(e){const t=Tr(e);let n=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const r=so(e),o=r?e.offsetWidth:n,i=r?e.offsetHeight:s,a=Rm(n)!==o||Rm(s)!==i;return a&&(n=o,s=i),{width:n,height:s,$:a}}function iw(e){return $r(e)?e:e.contextElement}function sc(e){const t=iw(e);if(!so(t))return qr(1);const n=t.getBoundingClientRect(),{width:s,height:r,$:o}=KR(t);let i=(o?Rm(n.width):n.width)/s,a=(o?Rm(n.height):n.height)/r;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const hj=qr(0);function XR(e){const t=Ts(e);return!ow()||!t.visualViewport?hj:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function fj(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Ts(e)?!1:t}function Ya(e,t,n,s){t===void 0&&(t=!1),n===void 0&&(n=!1);const r=e.getBoundingClientRect(),o=iw(e);let i=qr(1);t&&(s?$r(s)&&(i=sc(s)):i=sc(e));const a=fj(o,n,s)?XR(o):qr(0);let l=(r.left+a.x)/i.x,c=(r.top+a.y)/i.y,u=r.width/i.x,d=r.height/i.y;if(o){const h=Ts(o),f=s&&$r(s)?Ts(s):s;let p=h,m=jb(p);for(;m&&s&&f!==p;){const g=sc(m),x=m.getBoundingClientRect(),y=Tr(m),b=x.left+(m.clientLeft+parseFloat(y.paddingLeft))*g.x,v=x.top+(m.clientTop+parseFloat(y.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,d*=g.y,l+=b,c+=v,p=Ts(m),m=jb(p)}}return Am({width:u,height:d,x:l,y:c})}function aw(e,t){const n=Ug(e).scrollLeft;return t?t.left+n:Ya(lo(e)).left+n}function qR(e,t,n){n===void 0&&(n=!1);const s=e.getBoundingClientRect(),r=s.left+t.scrollLeft-(n?0:aw(e,s)),o=s.top+t.scrollTop;return{x:r,y:o}}function pj(e){let{elements:t,rect:n,offsetParent:s,strategy:r}=e;const o=r==="fixed",i=lo(s),a=t?Wg(t.floating):!1;if(s===i||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=qr(1);const u=qr(0),d=so(s);if((d||!d&&!o)&&((Zc(s)!=="body"||hh(i))&&(l=Ug(s)),so(s))){const f=Ya(s);c=sc(s),u.x=f.x+s.clientLeft,u.y=f.y+s.clientTop}const h=i&&!d&&!o?qR(i,l,!0):qr(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function mj(e){return Array.from(e.getClientRects())}function gj(e){const t=lo(e),n=Ug(e),s=e.ownerDocument.body,r=ws(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),o=ws(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let i=-n.scrollLeft+aw(e);const a=-n.scrollTop;return Tr(s).direction==="rtl"&&(i+=ws(t.clientWidth,s.clientWidth)-r),{width:r,height:o,x:i,y:a}}function xj(e,t){const n=Ts(e),s=lo(e),r=n.visualViewport;let o=s.clientWidth,i=s.clientHeight,a=0,l=0;if(r){o=r.width,i=r.height;const c=ow();(!c||c&&t==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:o,height:i,x:a,y:l}}function yj(e,t){const n=Ya(e,!0,t==="fixed"),s=n.top+e.clientTop,r=n.left+e.clientLeft,o=so(e)?sc(e):qr(1),i=e.clientWidth*o.x,a=e.clientHeight*o.y,l=r*o.x,c=s*o.y;return{width:i,height:a,x:l,y:c}}function s2(e,t,n){let s;if(t==="viewport")s=xj(e,n);else if(t==="document")s=gj(lo(e));else if($r(t))s=yj(t,n);else{const r=XR(e);s={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return Am(s)}function YR(e,t){const n=Wi(e);return n===t||!$r(n)||Tc(n)?!1:Tr(n).position==="fixed"||YR(n,t)}function bj(e,t){const n=t.get(e);if(n)return n;let s=Md(e,[],!1).filter(a=>$r(a)&&Zc(a)!=="body"),r=null;const o=Tr(e).position==="fixed";let i=o?Wi(e):e;for(;$r(i)&&!Tc(i);){const a=Tr(i),l=rw(i);!l&&a.position==="fixed"&&(r=null),(o?!l&&!r:!l&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||hh(i)&&!l&&YR(e,i))?s=s.filter(u=>u!==i):r=a,i=Wi(i)}return t.set(e,s),s}function vj(e){let{element:t,boundary:n,rootBoundary:s,strategy:r}=e;const i=[...n==="clippingAncestors"?Wg(t)?[]:bj(t,this._c):[].concat(n),s],a=i[0],l=i.reduce((c,u)=>{const d=s2(t,u,r);return c.top=ws(d.top,c.top),c.right=Bi(d.right,c.right),c.bottom=Bi(d.bottom,c.bottom),c.left=ws(d.left,c.left),c},s2(t,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function wj(e){const{width:t,height:n}=KR(e);return{width:t,height:n}}function kj(e,t,n){const s=so(t),r=lo(t),o=n==="fixed",i=Ya(e,!0,o,t);let a={scrollLeft:0,scrollTop:0};const l=qr(0);if(s||!s&&!o)if((Zc(t)!=="body"||hh(r))&&(a=Ug(t)),s){const h=Ya(t,!0,o,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else r&&(l.x=aw(r));const c=r&&!s&&!o?qR(r,a):qr(0),u=i.left+a.scrollLeft-l.x-c.x,d=i.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:i.width,height:i.height}}function uy(e){return Tr(e).position==="static"}function r2(e,t){if(!so(e)||Tr(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return lo(e)===n&&(n=n.ownerDocument.body),n}function QR(e,t){const n=Ts(e);if(Wg(e))return n;if(!so(e)){let r=Wi(e);for(;r&&!Tc(r);){if($r(r)&&!uy(r))return r;r=Wi(r)}return n}let s=r2(e,t);for(;s&&uj(s)&&uy(s);)s=r2(s,t);return s&&Tc(s)&&uy(s)&&!rw(s)?n:s||dj(e)||n}const Cj=async function(e){const t=this.getOffsetParent||QR,n=this.getDimensions,s=await n(e.floating);return{reference:kj(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Sj(e){return Tr(e).direction==="rtl"}const Ij={convertOffsetParentRelativeRectToViewportRelativeRect:pj,getDocumentElement:lo,getClippingRect:vj,getOffsetParent:QR,getElementRects:Cj,getClientRects:mj,getDimensions:wj,getScale:sc,isElement:$r,isRTL:Sj};function ZR(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function $j(e,t){let n=null,s;const r=lo(e);function o(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(a||t(),!h||!f)return;const p=sp(d),m=sp(r.clientWidth-(u+h)),g=sp(r.clientHeight-(d+f)),x=sp(u),b={rootMargin:-p+"px "+-m+"px "+-g+"px "+-x+"px",threshold:ws(0,Bi(1,l))||1};let v=!0;function w(k){const C=k[0].intersectionRatio;if(C!==l){if(!v)return i();C?i(!1,C):s=setTimeout(()=>{i(!1,1e-7)},1e3)}C===1&&!ZR(c,e.getBoundingClientRect())&&i(),v=!1}try{n=new IntersectionObserver(w,{...b,root:r.ownerDocument})}catch{n=new IntersectionObserver(w,b)}n.observe(e)}return i(!0),o}function Tj(e,t,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,c=iw(e),u=r||o?[...c?Md(c):[],...Md(t)]:[];u.forEach(x=>{r&&x.addEventListener("scroll",n,{passive:!0}),o&&x.addEventListener("resize",n)});const d=c&&a?$j(c,n):null;let h=-1,f=null;i&&(f=new ResizeObserver(x=>{let[y]=x;y&&y.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(t)})),n()}),c&&!l&&f.observe(c),f.observe(t));let p,m=l?Ya(e):null;l&&g();function g(){const x=Ya(e);m&&!ZR(m,x)&&n(),m=x,p=requestAnimationFrame(g)}return n(),()=>{var x;u.forEach(y=>{r&&y.removeEventListener("scroll",n),o&&y.removeEventListener("resize",n)}),d==null||d(),(x=f)==null||x.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const Nj=ij,Ej=aj,_j=sj,Rj=cj,Dj=rj,o2=nj,Aj=lj,Oj=(e,t,n)=>{const s=new Map,r={platform:Ij,...n},o={...r.platform,_c:s};return ej(e,t,{...r,platform:o})};var Hp=typeof document<"u"?D.useLayoutEffect:D.useEffect;function Om(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,s,r;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(s=n;s--!==0;)if(!Om(e[s],t[s]))return!1;return!0}if(r=Object.keys(e),n=r.length,n!==Object.keys(t).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(t,r[s]))return!1;for(s=n;s--!==0;){const o=r[s];if(!(o==="_owner"&&e.$$typeof)&&!Om(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function JR(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function i2(e,t){const n=JR(e);return Math.round(t*n)/n}function dy(e){const t=D.useRef(e);return Hp(()=>{t.current=e}),t}function Fj(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:o,floating:i}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,d]=D.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,f]=D.useState(s);Om(h,s)||f(s);const[p,m]=D.useState(null),[g,x]=D.useState(null),y=D.useCallback(R=>{R!==k.current&&(k.current=R,m(R))},[]),b=D.useCallback(R=>{R!==C.current&&(C.current=R,x(R))},[]),v=o||p,w=i||g,k=D.useRef(null),C=D.useRef(null),S=D.useRef(u),I=l!=null,$=dy(l),E=dy(r),A=dy(c),L=D.useCallback(()=>{if(!k.current||!C.current)return;const R={placement:t,strategy:n,middleware:h};E.current&&(R.platform=E.current),Oj(k.current,C.current,R).then(z=>{const H={...z,isPositioned:A.current!==!1};O.current&&!Om(S.current,H)&&(S.current=H,dh.flushSync(()=>{d(H)}))})},[h,t,n,E,A]);Hp(()=>{c===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,d(R=>({...R,isPositioned:!1})))},[c]);const O=D.useRef(!1);Hp(()=>(O.current=!0,()=>{O.current=!1}),[]),Hp(()=>{if(v&&(k.current=v),w&&(C.current=w),v&&w){if($.current)return $.current(v,w,L);L()}},[v,w,L,$,I]);const P=D.useMemo(()=>({reference:k,floating:C,setReference:y,setFloating:b}),[y,b]),M=D.useMemo(()=>({reference:v,floating:w}),[v,w]),U=D.useMemo(()=>{const R={position:n,left:0,top:0};if(!M.floating)return R;const z=i2(M.floating,u.x),H=i2(M.floating,u.y);return a?{...R,transform:"translate("+z+"px, "+H+"px)",...JR(M.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:z,top:H}},[n,a,M.floating,u.x,u.y]);return D.useMemo(()=>({...u,update:L,refs:P,elements:M,floatingStyles:U}),[u,L,P,M,U])}const Pj=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:s,padding:r}=typeof e=="function"?e(n):e;return s&&t(s)?s.current!=null?o2({element:s.current,padding:r}).fn(n):{}:s?o2({element:s,padding:r}).fn(n):{}}}},Mj=(e,t)=>({...Nj(e),options:[e,t]}),Lj=(e,t)=>({...Ej(e),options:[e,t]}),zj=(e,t)=>({...Aj(e),options:[e,t]}),Bj=(e,t)=>({..._j(e),options:[e,t]}),Vj=(e,t)=>({...Rj(e),options:[e,t]}),Wj=(e,t)=>({...Dj(e),options:[e,t]}),Uj=(e,t)=>({...Pj(e),options:[e,t]});var jj="Arrow",tD=D.forwardRef((e,t)=>{const{children:n,width:s=10,height:r=5,...o}=e;return N.jsx(Xe.svg,{...o,ref:t,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:N.jsx("polygon",{points:"0,0 30,0 15,10"})})});tD.displayName=jj;var Gj=tD;function eD(e){const[t,n]=D.useState(void 0);return qa(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const s=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const o=r[0];let i,a;if("borderBoxSize"in o){const l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,a=c.blockSize}else i=e.offsetWidth,a=e.offsetHeight;n({width:i,height:a})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}else n(void 0)},[e]),t}var nD="Popper",[sD,rD]=Xc(nD),[U1t,oD]=sD(nD),iD="PopperAnchor",aD=D.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:s,...r}=e,o=oD(iD,n),i=D.useRef(null),a=Pn(t,i);return D.useEffect(()=>{o.onAnchorChange((s==null?void 0:s.current)||i.current)}),s?null:N.jsx(Xe.div,{...r,ref:a})});aD.displayName=iD;var lw="PopperContent",[Hj,Kj]=sD(lw),lD=D.forwardRef((e,t)=>{var dt,vt,bt,Ct,St,Vt;const{__scopePopper:n,side:s="bottom",sideOffset:r=0,align:o="center",alignOffset:i=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,...m}=e,g=oD(lw,n),[x,y]=D.useState(null),b=Pn(t,Wt=>y(Wt)),[v,w]=D.useState(null),k=eD(v),C=(k==null?void 0:k.width)??0,S=(k==null?void 0:k.height)??0,I=s+(o!=="center"?"-"+o:""),$=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},E=Array.isArray(c)?c:[c],A=E.length>0,L={padding:$,boundary:E.filter(qj),altBoundary:A},{refs:O,floatingStyles:P,placement:M,isPositioned:U,middlewareData:R}=Fj({strategy:"fixed",placement:I,whileElementsMounted:(...Wt)=>Tj(...Wt,{animationFrame:f==="always"}),elements:{reference:g.anchor},middleware:[Mj({mainAxis:r+S,alignmentAxis:i}),l&&Lj({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?zj():void 0,...L}),l&&Bj({...L}),Vj({...L,apply:({elements:Wt,rects:ae,availableWidth:Qt,availableHeight:Kt})=>{const{width:le,height:ne}=ae.reference,es=Wt.floating.style;es.setProperty("--radix-popper-available-width",`${Qt}px`),es.setProperty("--radix-popper-available-height",`${Kt}px`),es.setProperty("--radix-popper-anchor-width",`${le}px`),es.setProperty("--radix-popper-anchor-height",`${ne}px`)}}),v&&Uj({element:v,padding:a}),Yj({arrowWidth:C,arrowHeight:S}),h&&Wj({strategy:"referenceHidden",...L})]}),[z,H]=dD(M),X=no(p);qa(()=>{U&&(X==null||X())},[U,X]);const Q=(dt=R.arrow)==null?void 0:dt.x,J=(vt=R.arrow)==null?void 0:vt.y,nt=((bt=R.arrow)==null?void 0:bt.centerOffset)!==0,[st,ot]=D.useState();return qa(()=>{x&&ot(window.getComputedStyle(x).zIndex)},[x]),N.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...P,transform:U?P.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:st,"--radix-popper-transform-origin":[(Ct=R.transformOrigin)==null?void 0:Ct.x,(St=R.transformOrigin)==null?void 0:St.y].join(" "),...((Vt=R.hide)==null?void 0:Vt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:N.jsx(Hj,{scope:n,placedSide:z,onArrowChange:w,arrowX:Q,arrowY:J,shouldHideArrow:nt,children:N.jsx(Xe.div,{"data-side":z,"data-align":H,...m,ref:b,style:{...m.style,animation:U?void 0:"none"}})})})});lD.displayName=lw;var cD="PopperArrow",Xj={top:"bottom",right:"left",bottom:"top",left:"right"},uD=D.forwardRef(function(t,n){const{__scopePopper:s,...r}=t,o=Kj(cD,s),i=Xj[o.placedSide];return N.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:N.jsx(Gj,{...r,ref:n,style:{...r.style,display:"block"}})})});uD.displayName=cD;function qj(e){return e!==null}var Yj=e=>({name:"transformOrigin",options:e,fn(t){var g,x,y;const{placement:n,rects:s,middlewareData:r}=t,i=((g=r.arrow)==null?void 0:g.centerOffset)!==0,a=i?0:e.arrowWidth,l=i?0:e.arrowHeight,[c,u]=dD(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=r.arrow)==null?void 0:x.x)??0)+a/2,f=(((y=r.arrow)==null?void 0:y.y)??0)+l/2;let p="",m="";return c==="bottom"?(p=i?d:`${h}px`,m=`${-l}px`):c==="top"?(p=i?d:`${h}px`,m=`${s.floating.height+l}px`):c==="right"?(p=`${-l}px`,m=i?d:`${f}px`):c==="left"&&(p=`${s.floating.width+l}px`,m=i?d:`${f}px`),{data:{x:p,y:m}}}});function dD(e){const[t,n="center"]=e.split("-");return[t,n]}var Qj=aD,Zj=lD,Jj=uD,[jg,j1t]=Xc("Tooltip",[rD]),cw=rD(),hD="TooltipProvider",tG=700,a2="tooltip.open",[eG,fD]=jg(hD),pD=e=>{const{__scopeTooltip:t,delayDuration:n=tG,skipDelayDuration:s=300,disableHoverableContent:r=!1,children:o}=e,i=D.useRef(!0),a=D.useRef(!1),l=D.useRef(0);return D.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),N.jsx(eG,{scope:t,isOpenDelayedRef:i,delayDuration:n,onOpen:D.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:D.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,s)},[s]),isPointerInTransitRef:a,onPointerInTransitChange:D.useCallback(c=>{a.current=c},[]),disableHoverableContent:r,children:o})};pD.displayName=hD;var mD="Tooltip",[G1t,Gg]=jg(mD),Gb="TooltipTrigger",nG=D.forwardRef((e,t)=>{const{__scopeTooltip:n,...s}=e,r=Gg(Gb,n),o=fD(Gb,n),i=cw(n),a=D.useRef(null),l=Pn(t,a,r.onTriggerChange),c=D.useRef(!1),u=D.useRef(!1),d=D.useCallback(()=>c.current=!1,[]);return D.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),N.jsx(Qj,{asChild:!0,...i,children:N.jsx(Xe.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...s,ref:l,onPointerMove:me(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(r.onTriggerEnter(),u.current=!0)}),onPointerLeave:me(e.onPointerLeave,()=>{r.onTriggerLeave(),u.current=!1}),onPointerDown:me(e.onPointerDown,()=>{r.open&&r.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:me(e.onFocus,()=>{c.current||r.onOpen()}),onBlur:me(e.onBlur,r.onClose),onClick:me(e.onClick,r.onClose)})})});nG.displayName=Gb;var sG="TooltipPortal",[H1t,rG]=jg(sG,{forceMount:void 0}),Nc="TooltipContent",gD=D.forwardRef((e,t)=>{const n=rG(Nc,e.__scopeTooltip),{forceMount:s=n.forceMount,side:r="top",...o}=e,i=Gg(Nc,e.__scopeTooltip);return N.jsx(Yv,{present:s||i.open,children:i.disableHoverableContent?N.jsx(xD,{side:r,...o,ref:t}):N.jsx(oG,{side:r,...o,ref:t})})}),oG=D.forwardRef((e,t)=>{const n=Gg(Nc,e.__scopeTooltip),s=fD(Nc,e.__scopeTooltip),r=D.useRef(null),o=Pn(t,r),[i,a]=D.useState(null),{trigger:l,onClose:c}=n,u=r.current,{onPointerInTransitChange:d}=s,h=D.useCallback(()=>{a(null),d(!1)},[d]),f=D.useCallback((p,m)=>{const g=p.currentTarget,x={x:p.clientX,y:p.clientY},y=uG(x,g.getBoundingClientRect()),b=dG(x,y),v=hG(m.getBoundingClientRect()),w=pG([...b,...v]);a(w),d(!0)},[d]);return D.useEffect(()=>()=>h(),[h]),D.useEffect(()=>{if(l&&u){const p=g=>f(g,u),m=g=>f(g,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",m)}}},[l,u,f,h]),D.useEffect(()=>{if(i){const p=m=>{const g=m.target,x={x:m.clientX,y:m.clientY},y=(l==null?void 0:l.contains(g))||(u==null?void 0:u.contains(g)),b=!fG(x,i);y?h():b&&(h(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,i,c,h]),N.jsx(xD,{...e,ref:o})}),[iG,aG]=jg(mD,{isInside:!1}),lG=xW("TooltipContent"),xD=D.forwardRef((e,t)=>{const{__scopeTooltip:n,children:s,"aria-label":r,onEscapeKeyDown:o,onPointerDownOutside:i,...a}=e,l=Gg(Nc,n),c=cw(n),{onClose:u}=l;return D.useEffect(()=>(document.addEventListener(a2,u),()=>document.removeEventListener(a2,u)),[u]),D.useEffect(()=>{if(l.trigger){const d=h=>{const f=h.target;f!=null&&f.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),N.jsx(qv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:N.jsxs(Zj,{"data-state":l.stateAttribute,...c,...a,ref:t,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[N.jsx(lG,{children:s}),N.jsx(iG,{scope:n,isInside:!0,children:N.jsx(MW,{id:l.contentId,role:"tooltip",children:r||s})})]})})});gD.displayName=Nc;var yD="TooltipArrow",cG=D.forwardRef((e,t)=>{const{__scopeTooltip:n,...s}=e,r=cw(n);return aG(yD,n).isInside?null:N.jsx(Jj,{...r,...s,ref:t})});cG.displayName=yD;function uG(e,t){const n=Math.abs(t.top-e.y),s=Math.abs(t.bottom-e.y),r=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,s,r,o)){case o:return"left";case r:return"right";case n:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function dG(e,t,n=5){const s=[];switch(t){case"top":s.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":s.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":s.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":s.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return s}function hG(e){const{top:t,right:n,bottom:s,left:r}=e;return[{x:r,y:t},{x:n,y:t},{x:n,y:s},{x:r,y:s}]}function fG(e,t){const{x:n,y:s}=e;let r=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const a=t[o].x,l=t[o].y,c=t[i].x,u=t[i].y;l>s!=u>s&&n<(c-a)*(s-l)/(u-l)+a&&(r=!r)}return r}function pG(e){const t=e.slice();return t.sort((n,s)=>n.x<s.x?-1:n.x>s.x?1:n.y<s.y?-1:n.y>s.y?1:0),mG(t)}function mG(e){if(e.length<=1)return e.slice();const t=[];for(let s=0;s<e.length;s++){const r=e[s];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(r.y-i.y)>=(o.y-i.y)*(r.x-i.x))t.pop();else break}t.push(r)}t.pop();const n=[];for(let s=e.length-1;s>=0;s--){const r=e[s];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(r.y-i.y)>=(o.y-i.y)*(r.x-i.x))n.pop();else break}n.push(r)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var gG=pD,bD=gD;const xG=gG,yG=D.forwardRef(({className:e,sideOffset:t=4,...n},s)=>N.jsx(bD,{ref:s,sideOffset:t,className:zn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...n}));yG.displayName=bD.displayName;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bG=1e-7,vG=1e-4;class vD{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class uw{refCount(t){return ns("refCount")}incRef(t){return ns("incRef")}timerAvailable(){return!0}time(t){return ns("time")}read(t){return ns("read")}readSync(t){return ns("readSync")}readToGPU(t,n){return ns("readToGPU")}numDataIds(){return ns("numDataIds")}disposeData(t,n){return ns("disposeData")}write(t,n,s){return ns("write")}move(t,n,s,r,o){return ns("move")}createTensorFromGPUData(t,n,s){return ns("createTensorFromGPUData")}memory(){return ns("memory")}floatPrecision(){return ns("floatPrecision")}epsilon(){return this.floatPrecision()===32?bG:vG}dispose(){return ns("dispose")}}function ns(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Ol(e,t,n)}function Qa(e,t,n){return Math.max(e,Math.min(t,n))}function dw(e){return e%2===0?e:e+1}function Ol(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function kG(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function T(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function nr(e,t,n=""){T(Ht(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function wD(e){T(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Y(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function Ht(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ec(e){return e%1===0}function Hb(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function rc(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function l2(e,t=r=>0,n,s){return new Promise((r,o)=>{let i=0;const a=()=>{if(e()){r();return}i++;const l=t(i);if(n!=null&&i>=n){o();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function kD(e,t){let n=1,s=-1;for(let o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(e[o]<0)throw Error(`Shapes can not be < 0. Found ${e[o]} at dim ${o}`);if(s===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const r=e.slice();return r[s]=t/n,r}function Rt(e,t){const n=t.length;return e=e==null?t.map((s,r)=>r):[].concat(e),T(e.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),T(e.every(s=>Ec(s)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(s=>s<0?n+s:s)}function ta(e,t){const n=[],s=[],r=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||r?null:Rt(t,e).sort();let i=0;for(let a=0;a<e.length;++a){if(o!=null){if(o[i]===a&&e[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${e[a]}' is not 1`);(o[i]==null||o[i]>a)&&e[a]===1&&(n.push(e[a]),s.push(a)),o[i]<=a&&i++}e[a]!==1&&(n.push(e[a]),s.push(a))}return{newShape:n,keptDims:s}}function xn(e,t){return De(e,t)}function De(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function CG(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function SG(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function CD(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function Fm(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function IG(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function fh(e){return typeof e=="string"||e instanceof String}function $G(e){return typeof e=="boolean"}function Kb(e){return typeof e=="number"}function Jc(e){return Array.isArray(e)?Jc(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":Kb(e)?"float32":fh(e)?"string":$G(e)?"bool":"float32"}function Xb(e){return!!(e&&e.constructor&&e.call&&e.apply)}function qb(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function yt(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let s=t-3;s>=0;--s)n[s]=n[s+1]*e[s+1];return n}function SD(e,t,n,s=!1){const r=new Array;if(t.length===1){const o=t[0]*(s?2:1);for(let i=0;i<o;i++)r[i]=n[e+i]}else{const o=t[0],i=t.slice(1),a=i.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<o;l++)r[l]=SD(e+l*a,i,n,s)}return r}function wr(e,t,n=!1){if(e.length===0)return t[0];const s=e.reduce((r,o)=>r*o)*(n?2:1);if(s===0)return[];if(s!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return SD(0,e,t,n)}function TG(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function hw(e,t){const n=yn(e,t);for(let s=0;s<n.length;s++)n[s]=1;return n}function yn(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function ID(e,t){const n=e.reduce((s,r)=>s*r,1);if(t==null||t==="float32")return wr(e,new Float32Array(n));if(t==="int32")return wr(e,new Int32Array(n));if(t==="bool")return wr(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function Wo(e){e.forEach(t=>{T(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function Yr(e,t,n){if(t===0)return 0;if(t===1)return e[0];let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=n[r]*e[r];return s}function tu(e,t,n){if(t===0)return[];if(t===1)return[e];const s=new Array(t);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(e/n[r]),e-=s[r]*n[r];return s[s.length-1]=e,s}function fw(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c2="tfjsflags";class NG{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=EG,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,s){if(this.flagRegistry[t]={evaluationFn:n,setHook:s},this.urlFlags[t]!=null){const r=this.urlFlags[t];K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${r}.`),this.set(t,r)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(fw(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);c2 in t&&t[c2].split(",").forEach(s=>{const[r,o]=s.split(":");this.urlFlags[r]=RG(r,o)})}}function EG(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(_G(t,s[0],s[1]),s.join("="))),t}function _G(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function RG(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function K(){return $D}let $D=null;function DG(e){$D=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hy;function TD(){if(hy==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");hy=e}return hy}function AG(){const e=TD();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function pw(e,t){const n=AG();if(n.has(e))return n.get(e);{const s=t();return n.set(e,s),n.get(e)}}const Hg="Abs",ph="Acos",mh="Acosh",eu="Add",mw="AddN",gw="All",xw="Any",Kg="ArgMax",Xg="ArgMin",gh="Asin",xh="Asinh",yh="Atan",bh="Atanh",vh="Atan2",qg="AvgPool",yw="AvgPoolGrad",Yg="AvgPool3D",bw="AvgPool3DGrad",Qg="BatchMatMul",Zg="BatchToSpaceND",vw="Bincount",ww="BitwiseAnd",OG="BroadcastTo",ND="BroadcastArgs",wh="Cast",kh="Ceil",Ch="ClipByValue",kw="Complex",Jg="ComplexAbs",tx="Concat",ex="Conv2D",Cw="Conv2DBackpropFilter",nx="Conv2DBackpropInput",sx="Conv3D",Sw="Conv3DBackpropFilterV2",Iw="Conv3DBackpropInputV2",Sh="Cos",Ih="Cosh",$w="Cumprod",rx="Cumsum",Tw="CropAndResize",Nw="DenseBincount",Ew="DepthToSpace",ox="DepthwiseConv2dNative",_w="DepthwiseConv2dNativeBackpropFilter",Rw="DepthwiseConv2dNativeBackpropInput",ED="Diag",ix="Dilation2D",Yb="Dilation2DBackpropInput",Qb="Dilation2DBackpropFilter",FG="Draw",$h="RealDiv",Dw="Einsum",Th="Elu",Aw="EluGrad",Nh="Erf",ax="Equal",Eh="Exp",lx="ExpandDims",_h="Expm1",Ow="FFT",Fw="Fill",Pw="FlipLeftRight",Rh="Floor",Dh="FloorDiv",cx="FusedBatchNorm",ux="GatherV2",_D="GatherNd",dx="Greater",Ah="GreaterEqual",Oh="Identity",Mw="IFFT",Lw="Imag",Fh="IsFinite",Ph="IsInf",Mh="IsNan",hx="LeakyRelu",fx="Less",px="LessEqual",RD="LinSpace",Lh="Log",zh="Log1p",mx="LogicalAnd",gx="LogicalNot",xx="LogicalOr",PG="LogSoftmax",yx="LRN",zw="LRNGrad",bx="Max",Bh="Maximum",vx="MaxPool",Bw="MaxPoolGrad",wx="MaxPool3D",Vw="MaxPool3DGrad",DD="MaxPoolWithArgmax",kx="Mean",Cx="Min",Vh="Minimum",Sx="MirrorPad",Wh="Mod",AD="Multinomial",Uh="Multiply",Ix="Neg",$x="NotEqual",Ww="NonMaxSuppressionV3",Uw="NonMaxSuppressionV4",jw="NonMaxSuppressionV5",Tx="OnesLike",Nx="OneHot",Ex="Pack",_x="PadV2",jh="Pow",Rx="Prelu",Dx="Prod",OD="RaggedGather",FD="RaggedRange",PD="RaggedTensorToTensor",Gw="Range",Hw="Real",Gh="Reciprocal",Hh="Relu",Ax="Reshape",Ox="ResizeNearestNeighbor",Kw="ResizeNearestNeighborGrad",Fx="ResizeBilinear",Xw="ResizeBilinearGrad",Kh="Relu6",Px="Reverse",Xh="Round",qh="Rsqrt",MD="ScatterNd",LD="TensorScatterUpdate",zD="SearchSorted",Mx="Select",Yh="Selu",Lx="Slice",Qh="Sin",Zh="Sinh",Jh="Sign",tf="Sigmoid",ef="Softplus",nf="Sqrt",zx="Sum",Bx="SpaceToBatchND",Vx="SplitV",Wx="Softmax",BD="SparseFillEmptyRows",VD="SparseReshape",WD="SparseSegmentMean",UD="SparseSegmentSum",jD="SparseToDense",sf="SquaredDifference",qw="Square",Yw="StaticRegexReplace",Qw="StridedSlice",GD="StringNGrams",HD="StringSplit",KD="StringToHashBucketFast",rf="Sub",of="Tan",af="Tanh",lf="Tile",Zw="TopK",Jw="Transform",oc="Transpose",tk="Unique",Ux="Unpack",jx="UnsortedSegmentSum",Gx="ZerosLike",cf="Step",MG="FromPixels",ek="RotateWithOffset",Pm="_FusedMatMul",Mm="FusedConv2D",XD="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cs(...e){K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(...e)}function LG(...e){K().getBool("IS_TEST")||K().getBool("PROD")||console.log(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lm=pw("kernelRegistry",()=>new Map),Zb=pw("gradRegistry",()=>new Map);function u2(e,t){const n=YD(e,t);return Lm.get(n)}function d2(e){return Zb.get(e)}function h2(e){const t=Lm.entries(),n=[];for(;;){const{done:s,value:r}=t.next();if(s)break;const[o,i]=r,[a]=o.split("_");a===e&&n.push(i)}return n}function qD(e){const{kernelName:t,backendName:n}=e,s=YD(t,n);Lm.has(s)&&Cs(`The kernel '${t}' for backend '${n}' is already registered`),Lm.set(s,e)}function zG(e){const{kernelName:t}=e;Zb.has(t)&&K().getBool("DEBUG")&&Cs(`Overriding the gradient for '${t}'`),Zb.set(t,e)}function YD(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QD(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var ZD=de,Gs=null;try{Gs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function de(e,t,n){this.low=e|0,this.high=t|0,this.unsigned=!!n}de.prototype.__isLong__;Object.defineProperty(de.prototype,"__isLong__",{value:!0});function gs(e){return(e&&e.__isLong__)===!0}de.isLong=gs;var f2={},p2={};function xl(e,t){var n,s,r;return t?(e>>>=0,(r=0<=e&&e<256)&&(s=p2[e],s)?s:(n=he(e,(e|0)<0?-1:0,!0),r&&(p2[e]=n),n)):(e|=0,(r=-128<=e&&e<128)&&(s=f2[e],s)?s:(n=he(e,e<0?-1:0,!1),r&&(f2[e]=n),n))}de.fromInt=xl;function Hs(e,t){if(isNaN(e))return t?Na:Ks;if(t){if(e<0)return Na;if(e>=JD)return nA}else{if(e<=-g2)return ls;if(e+1>=g2)return eA}return e<0?Hs(-e,t).neg():he(e%_c|0,e/_c|0,t)}de.fromNumber=Hs;function he(e,t,n){return new de(e,t,n)}de.fromBits=he;var zm=Math.pow;function nk(e,t,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return Ks;if(typeof t=="number"?(n=t,t=!1):t=!!t,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=e.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return nk(e.substring(1),t,n).neg();for(var r=Hs(zm(n,8)),o=Ks,i=0;i<e.length;i+=8){var a=Math.min(8,e.length-i),l=parseInt(e.substring(i,i+a),n);if(a<8){var c=Hs(zm(n,a));o=o.mul(c).add(Hs(l))}else o=o.mul(r),o=o.add(Hs(l))}return o.unsigned=t,o}de.fromString=nk;function Rr(e,t){return typeof e=="number"?Hs(e,t):typeof e=="string"?nk(e,t):he(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}de.fromValue=Rr;var m2=65536,BG=1<<24,_c=m2*m2,JD=_c*_c,g2=JD/2,x2=xl(BG),Ks=xl(0);de.ZERO=Ks;var Na=xl(0,!0);de.UZERO=Na;var ql=xl(1);de.ONE=ql;var tA=xl(1,!0);de.UONE=tA;var Jb=xl(-1);de.NEG_ONE=Jb;var eA=he(-1,2147483647,!1);de.MAX_VALUE=eA;var nA=he(-1,-1,!0);de.MAX_UNSIGNED_VALUE=nA;var ls=he(0,-2147483648,!1);de.MIN_VALUE=ls;var lt=de.prototype;lt.toInt=function(){return this.unsigned?this.low>>>0:this.low};lt.toNumber=function(){return this.unsigned?(this.high>>>0)*_c+(this.low>>>0):this.high*_c+(this.low>>>0)};lt.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ls)){var n=Hs(t),s=this.div(n),r=s.mul(n).sub(this);return s.toString(t)+r.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var o=Hs(zm(t,6),this.unsigned),i=this,a="";;){var l=i.div(o),c=i.sub(l.mul(o)).toInt()>>>0,u=c.toString(t);if(i=l,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};lt.getHighBits=function(){return this.high};lt.getHighBitsUnsigned=function(){return this.high>>>0};lt.getLowBits=function(){return this.low};lt.getLowBitsUnsigned=function(){return this.low>>>0};lt.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ls)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,n=31;n>0&&!(t&1<<n);n--);return this.high!=0?n+33:n+1};lt.isZero=function(){return this.high===0&&this.low===0};lt.eqz=lt.isZero;lt.isNegative=function(){return!this.unsigned&&this.high<0};lt.isPositive=function(){return this.unsigned||this.high>=0};lt.isOdd=function(){return(this.low&1)===1};lt.isEven=function(){return(this.low&1)===0};lt.equals=function(t){return gs(t)||(t=Rr(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};lt.eq=lt.equals;lt.notEquals=function(t){return!this.eq(t)};lt.neq=lt.notEquals;lt.ne=lt.notEquals;lt.lessThan=function(t){return this.comp(t)<0};lt.lt=lt.lessThan;lt.lessThanOrEqual=function(t){return this.comp(t)<=0};lt.lte=lt.lessThanOrEqual;lt.le=lt.lessThanOrEqual;lt.greaterThan=function(t){return this.comp(t)>0};lt.gt=lt.greaterThan;lt.greaterThanOrEqual=function(t){return this.comp(t)>=0};lt.gte=lt.greaterThanOrEqual;lt.ge=lt.greaterThanOrEqual;lt.compare=function(t){if(gs(t)||(t=Rr(t)),this.eq(t))return 0;var n=this.isNegative(),s=t.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};lt.comp=lt.compare;lt.negate=function(){return!this.unsigned&&this.eq(ls)?ls:this.not().add(ql)};lt.neg=lt.negate;lt.add=function(t){gs(t)||(t=Rr(t));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,o=this.low&65535,i=t.high>>>16,a=t.high&65535,l=t.low>>>16,c=t.low&65535,u=0,d=0,h=0,f=0;return f+=o+c,h+=f>>>16,f&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,u+=d>>>16,d&=65535,u+=n+i,u&=65535,he(h<<16|f,u<<16|d,this.unsigned)};lt.subtract=function(t){return gs(t)||(t=Rr(t)),this.add(t.neg())};lt.sub=lt.subtract;lt.multiply=function(t){if(this.isZero())return Ks;if(gs(t)||(t=Rr(t)),Gs){var n=Gs.mul(this.low,this.high,t.low,t.high);return he(n,Gs.get_high(),this.unsigned)}if(t.isZero())return Ks;if(this.eq(ls))return t.isOdd()?ls:Ks;if(t.eq(ls))return this.isOdd()?ls:Ks;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(x2)&&t.lt(x2))return Hs(this.toNumber()*t.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,o=this.low>>>16,i=this.low&65535,a=t.high>>>16,l=t.high&65535,c=t.low>>>16,u=t.low&65535,d=0,h=0,f=0,p=0;return p+=i*u,f+=p>>>16,p&=65535,f+=o*u,h+=f>>>16,f&=65535,f+=i*c,h+=f>>>16,f&=65535,h+=r*u,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,h+=i*l,d+=h>>>16,h&=65535,d+=s*u+r*c+o*l+i*a,d&=65535,he(f<<16|p,d<<16|h,this.unsigned)};lt.mul=lt.multiply;lt.divide=function(t){if(gs(t)||(t=Rr(t)),t.isZero())throw Error("division by zero");if(Gs){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var n=(this.unsigned?Gs.div_u:Gs.div_s)(this.low,this.high,t.low,t.high);return he(n,Gs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Na:Ks;var s,r,o;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Na;if(t.gt(this.shru(1)))return tA;o=Na}else{if(this.eq(ls)){if(t.eq(ql)||t.eq(Jb))return ls;if(t.eq(ls))return ql;var i=this.shr(1);return s=i.div(t).shl(1),s.eq(Ks)?t.isNegative()?ql:Jb:(r=this.sub(t.mul(s)),o=s.add(r.div(t)),o)}else if(t.eq(ls))return this.unsigned?Na:Ks;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=Ks}for(r=this;r.gte(t);){s=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:zm(2,a-48),c=Hs(s),u=c.mul(t);u.isNegative()||u.gt(r);)s-=l,c=Hs(s,this.unsigned),u=c.mul(t);c.isZero()&&(c=ql),o=o.add(c),r=r.sub(u)}return o};lt.div=lt.divide;lt.modulo=function(t){if(gs(t)||(t=Rr(t)),Gs){var n=(this.unsigned?Gs.rem_u:Gs.rem_s)(this.low,this.high,t.low,t.high);return he(n,Gs.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};lt.mod=lt.modulo;lt.rem=lt.modulo;lt.not=function(){return he(~this.low,~this.high,this.unsigned)};lt.and=function(t){return gs(t)||(t=Rr(t)),he(this.low&t.low,this.high&t.high,this.unsigned)};lt.or=function(t){return gs(t)||(t=Rr(t)),he(this.low|t.low,this.high|t.high,this.unsigned)};lt.xor=function(t){return gs(t)||(t=Rr(t)),he(this.low^t.low,this.high^t.high,this.unsigned)};lt.shiftLeft=function(t){return gs(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?he(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):he(0,this.low<<t-32,this.unsigned)};lt.shl=lt.shiftLeft;lt.shiftRight=function(t){return gs(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?he(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):he(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};lt.shr=lt.shiftRight;lt.shiftRightUnsigned=function(t){if(gs(t)&&(t=t.toInt()),t&=63,t===0)return this;var n=this.high;if(t<32){var s=this.low;return he(s>>>t|n<<32-t,n>>>t,this.unsigned)}else return t===32?he(n,0,this.unsigned):he(n>>>t-32,0,this.unsigned)};lt.shru=lt.shiftRightUnsigned;lt.shr_u=lt.shiftRightUnsigned;lt.toSigned=function(){return this.unsigned?he(this.low,this.high,!1):this};lt.toUnsigned=function(){return this.unsigned?this:he(this.low,this.high,!0)};lt.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};lt.toBytesLE=function(){var t=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};lt.toBytesBE=function(){var t=this.high,n=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};de.fromBytes=function(t,n,s){return s?de.fromBytesLE(t,n):de.fromBytesBE(t,n)};de.fromBytesLE=function(t,n){return new de(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)};de.fromBytesBE=function(t,n){return new de(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)};const sA=q1(ZD),VG=SN({__proto__:null,default:sA},[ZD]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ka=sA||VG;function Hx(e){return ka.fromString(e,!0,16)}const rA=Hx("c3a5c85c97cb3127"),ba=Hx("b492b66fbe98f273"),Rn=Hx("9ae16a3b2f90404f");function t1(e){return e.xor(e.shru(47))}function oA(e,t,n){const s=e.slice(t,t+n);return ka.fromBytes(Array.from(s),!0,!0)}function se(e,t){return oA(e,t,8)}function y2(e,t){return oA(e,t,4)}function Ze(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function Ai(e,t,n=Hx("9ddfea08eb382d69")){let s=e.xor(t).mul(n);s=s.xor(s.shru(47));let r=t.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function WG(e,t,n,s,r,o){r=r.add(e),o=Ze(o.add(r).add(s),21);const i=r;return r=r.add(t),r=r.add(n),o=o.add(Ze(r,44)),[r.add(s),o.add(i)]}function rp(e,t,n,s){return WG(se(e,t),se(e,t+8),se(e,t+16),se(e,t+24),n,s)}function UG(e,t=e.length){if(t>=8){const n=Rn.add(t*2),s=se(e,0).add(Rn),r=se(e,t-8),o=Ze(r,37).mul(n).add(s),i=Ze(s,25).add(r).mul(n);return Ai(o,i,n)}if(t>=4){const n=Rn.add(t*2),s=y2(e,0);return Ai(s.shl(3).add(t),y2(e,t-4),n)}if(t>0){const n=e[0],s=e[t>>1],r=e[t-1],o=n+(s<<8),i=t+(r<<2);return t1(Rn.mul(o).xor(rA.mul(i))).mul(Rn)}return Rn}function jG(e,t=e.length){const n=Rn.add(t*2),s=se(e,0).mul(ba),r=se(e,8),o=se(e,t-8).mul(n),i=se(e,t-16).mul(Rn);return Ai(Ze(s.add(r),43).add(Ze(o,30)).add(i),s.add(Ze(r.add(Rn),18)).add(o),n)}function GG(e,t=e.length){const n=Rn.add(t*2),s=se(e,0).mul(Rn),r=se(e,8),o=se(e,t-8).mul(n),i=se(e,t-16).mul(Rn),a=Ze(s.add(r),43).add(Ze(o,30)).add(i),l=Ai(a,s.add(Ze(r.add(Rn),18)).add(o),n),c=se(e,16).mul(n),u=se(e,24),d=a.add(se(e,t-32)).mul(n),h=l.add(se(e,t-24)).mul(n);return Ai(Ze(c.add(u),43).add(Ze(d,30)).add(h),c.add(Ze(u.add(s),18)).add(d),n)}function HG(e,t=e.length){const n=ka.fromNumber(81,!0);if(t<=32)return t<=16?UG(e,t):jG(e,t);if(t<=64)return GG(e,t);let s=n,r=n.mul(ba).add(113),o=t1(r.mul(Rn).add(113)).mul(Rn),i=[ka.UZERO,ka.UZERO],a=[ka.UZERO,ka.UZERO];s=s.mul(Rn).add(se(e,0));let l=0;const c=(t-1>>6)*64,u=c+(t-1&63)-63;do s=Ze(s.add(r).add(i[0]).add(se(e,l+8)),37).mul(ba),r=Ze(r.add(i[1]).add(se(e,l+48)),42).mul(ba),s=s.xor(a[1]),r=r.add(i[0]).add(se(e,l+40)),o=Ze(o.add(a[0]),33).mul(ba),i=rp(e,l,i[1].mul(ba),s.add(a[0])),a=rp(e,l+32,o.add(a[1]),r.add(se(e,l+16))),[o,s]=[s,o],l+=64;while(l!==c);const d=ba.add(o.and(255).shl(1));return l=u,a[0]=a[0].add(t-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=Ze(s.add(r).add(i[0]).add(se(e,l+8)),37).mul(d),r=Ze(r.add(i[1]).add(se(e,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(i[0].mul(9).add(se(e,l+40))),o=Ze(o.add(a[0]),33).mul(d),i=rp(e,l,i[1].mul(d),s.add(a[0])),a=rp(e,l+32,o.add(a[1]),r.add(se(e,l+16))),[o,s]=[s,o],Ai(Ai(i[0],a[0],d).add(t1(r).mul(rA)).add(o),Ai(i[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ea(e,t){return t==="string"?Oi(e):yl([e],t)}function KG(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function yl(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Za(e)),K().getBool("DEBUG")&&CG(e,t),KG(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let s=0;s<n.length;++s)Math.round(e[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${t}`)}function Un(){return K().platform.now()}function Oi(e,t="utf-8"){return t=t||"utf-8",K().platform.encode(e,t)}function Ui(e,t="utf-8"){return t=t||"utf-8",K().platform.decode(e,t)}function Js(e){return K().platform.isTypedArray!=null?K().platform.isTypedArray(e):QD(e)}function Za(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||fw(e)||e==null||Js(e)&&n)t.push(e);else if(Array.isArray(e)||Js(e))for(let s=0;s<e.length;++s)Za(e[s],t,n);else{let s=-1;for(const r of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Za(e[r],t,n)}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XG{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new YG)}profileKernel(t,n,s){let r;const o=()=>{r=s()};let i;const a=Un();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const c of r)c.dataSync();i=Promise.resolve({kernelMs:Un()-a})}if(K().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(d=>{qG(d,u.dtype,t)})}return{kernelName:t,outputs:r,inputs:n,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:s,timeMs:r,inputs:o,extraInfo:i}=t;s.forEach(a=>{Promise.all([a.data(),r,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function qG(e,t,n){if(t!=="float32")return!1;for(let s=0;s<e.length;s++){const r=e[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class YG{logKernelProfile(t,n,s,r,o,i){const a=typeof r=="number"?rc(`${r}ms`,9):r.error,l=rc(t,25),c=n.rank,u=n.size,d=rc(n.shape.toString(),14);let h="";for(const f in o){const p=o[f];if(p!=null){const m=p.shape||n.shape,g=m.length;h+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QG(e,t,n){const s={},r={};for(let l=0;l<t.length;l++)s[t[l].id]=!0;for(let l=0;l<e.length;l++){const c=e[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<t.length;p++)if(s[h.id]){c.outputs.forEach(m=>s[m.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const o={};o[n.id]=!0;const i={};for(let l=e.length-1;l>=0;l--){const c=e[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(o[c.outputs[d].id]){for(const h in u)o[u[h].id]=!0,i[c.id]=!0;break}}const a=[];for(let l=0;l<e.length;l++){const c=e[l];if(r[c.id]&&i[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];s[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function ZG(e,t,n,s){for(let r=t.length-1;r>=0;r--){const o=t[r],i=[];if(o.outputs.forEach(l=>{const c=e[l.id];c!=null?i.push(c):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=o.inputs[l];if(!Ht(c.shape,u.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(e[u.id]==null)e[u.id]=c;else{const d=e[u.id];e[u.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b2=20,Nu=3,fy=7;function JG(e,t,n,s){const r=yt(t),o=tH(e,t,n,r),i=t.length,a=Kp(e,t,n,r,o),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function tH(e,t,n,s){const r=Y(t),o=s[s.length-1],i=new Array(o).fill(0),a=t.length,l=n==="complex64"?Wu(e):e;if(a>1)for(let c=0;c<r/o;c++){const u=c*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],Vu(l[u+d],0,n).length)}return i}function Vu(e,t,n){let s;return Array.isArray(e)?s=`${parseFloat(e[0].toFixed(fy))} + ${parseFloat(e[1].toFixed(fy))}j`:fh(e)?s=`'${e}'`:n==="bool"?s=iA(e):s=parseFloat(e.toFixed(fy)).toString(),rc(s,t)}function iA(e){return e===0?"false":"true"}function Kp(e,t,n,s,r,o=!0){const i=n==="complex64"?2:1,a=t[0],l=t.length;if(l===0){if(n==="complex64"){const m=Wu(e);return[Vu(m[0],0,n)]}return n==="bool"?[iA(e[0])]:[e[0].toString()]}if(l===1){if(a>b2){const g=Nu*i;let x=Array.from(e.slice(0,g)),y=Array.from(e.slice((a-Nu)*i,a*i));return n==="complex64"&&(x=Wu(x),y=Wu(y)),["["+x.map((b,v)=>Vu(b,r[v],n)).join(", ")+", ..., "+y.map((b,v)=>Vu(b,r[a-Nu+v],n)).join(", ")+"]"]}return["["+(n==="complex64"?Wu(e):Array.from(e)).map((g,x)=>Vu(g,r[x],n)).join(", ")+"]"]}const c=t.slice(1),u=s.slice(1),d=s[0]*i,h=[];if(a>b2){for(let m=0;m<Nu;m++){const g=m*d,x=g+d;h.push(...Kp(e.slice(g,x),c,n,u,r,!1))}h.push("...");for(let m=a-Nu;m<a;m++){const g=m*d,x=g+d;h.push(...Kp(e.slice(g,x),c,n,u,r,m===a-1))}}else for(let m=0;m<a;m++){const g=m*d,x=g+d;h.push(...Kp(e.slice(g,x),c,n,u,r,m===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(o?"":p),h}function Wu(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class un{constructor(t,n,s){if(this.dtype=n,this.shape=t.slice(),this.size=Y(t),s!=null){const r=s.length;T(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||De(n,this.size),this.strides=yt(t)}set(t,...n){n.length===0&&(n=[0]),T(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const r of t){if(r<0||r>=this.shape[n]){const o=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=this.strides[r]*t[r];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let s=0;s<t.length-1;++s)n+=this.strides[s]*t[s];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(t/this.strides[s]),t-=n[s]*this.strides[s];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return mr().makeTensor(this.values,this.shape,this.dtype)}}let mr=null,Fl=null;function eH(e){mr=e}function nH(e){Fl=e}class Ve{constructor(t,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Y(t),this.strides=yt(t),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Fl.buffer(this.shape,this.dtype,t)}bufferSync(){return Fl.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return wr(this.shape,t,this.dtype==="complex64")}arraySync(){return wr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=mr().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(s=>Ui(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),mr().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=mr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>Ui(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await mr().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),mr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Fl.print(this,t)}clone(){return this.throwIfDisposed(),Fl.clone(this)}toString(t=!1){const n=this.dataSync();return JG(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Fl.cast(this,t)}variable(t=!0,n,s){return this.throwIfDisposed(),mr().makeVariable(this,t,n,s)}}Object.defineProperty(Ve,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function q(){return pw("Tensor",()=>Ve)}q();class Bm extends Ve{constructor(t,n,s,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=n,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Ht(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);mr().disposeTensor(this),this.dataId=t.dataId,mr().incRef(this,null)}dispose(){mr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Bm,Symbol.hasInstance,{value:e=>e instanceof Ve&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var v2;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(v2||(v2={}));var e1;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(e1||(e1={}));var n1;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(n1||(n1={}));var s1;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(s1||(s1={}));var r1;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(r1||(r1={}));const sH={float32:s1,int32:e1,bool:n1,complex64:r1};function fs(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return sH[e][t]}function sk(e){return fs(e,"int32")}function aA(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function lA(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oe(e,t){if(e.dtype===t.dtype)return[e,t];const n=fs(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function cA(e){const t=[];return uA(e,t,new Set),t}function uA(e,t,n){if(e==null)return;if(e instanceof Ve){t.push(e);return}if(!rH(e))return;const s=e;for(const r in s){const o=s[r];n.has(o)||(n.add(o),uA(o,t,n))}}function rH(e){return Array.isArray(e)||typeof e=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function py(e){return e.kernelName!=null}class w2{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Rc{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new w2}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,s=1){return t in this.registryFactory?(Cs(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(t);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new XG(this.backendInstance),!0}setupRegisteredKernels(){h2(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){h2(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof uw)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,o=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[t]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Cs(`Initialization of backend ${t} failed`),Cs(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return Cs(`Initialization of backend ${t} failed`),Cs(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const s=this.state.tensorInfo.get(n),r=s.backend,o=this.readSync(n),i=r.refCount(n);r.disposeData(n,!0),s.backend=t,t.move(n,o,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let s=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(t,n,s){t();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return Rc.nextTensorId++}nextVariableId(){return Rc.nextVariableId++}clone(t){const n=V.runKernel(Oh,{x:t}),s={x:t},r=i=>({x:()=>{const a="float32",l={x:i},c={dtype:a};return V.runKernel(wh,l,c)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,o,{}),n}runKernel(t,n,s){if(this.backendName==null&&this.backend,!(u2(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,s){const r=this.backend.numDataIds();let o=0;s.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${t}'`)}runKernelFunc(t){let n,s=[];const r=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=py(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(py(t)){const{kernelName:p,inputs:m,attrs:g}=t;this.backendName==null&&this.backend;const x=u2(p,this.backendName);T(x!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const y=this.backend.numDataIds();l=x.kernelFunc({inputs:m,attrs:g,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,b);const v=b.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(r){const w=this.getTensorsForGradient(p,m,v);s=this.saveTensorsForBackwardMode(w)}return v}}else{const{forwardFunc:p}=t,m=g=>{r&&(s=g.map(x=>this.keep(this.clone(x))))};a=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,g,x),x}}const{inputs:u,attrs:d}=t,h=py(t)?null:t.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,n,s){const r=d2(t);if(r!=null){const o=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(T(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=o.map(c=>n[c]);const l=s.filter((c,u)=>i[u]);return a.concat(l)}return[]}makeTensor(t,n,s,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let o=t;s==="string"&&fh(t[0])&&(o=t.map(l=>Oi(l)));const i=r.write(o,n,s),a=new Ve(n,s,i,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(i),c=IG(o);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(t,n,s,r){s=s||"float32";const o={dataId:t,shape:n,dtype:s};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(t,n){const{dataId:s,shape:r,dtype:o}=t,i=new Ve(r,o,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(t,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.cast(r));const o=new Bm(t,n,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*Fm(t.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:s})),t instanceof Bm||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const s=t.size*Fm(t.dtype);this.state.numBytes-=s}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,s,r,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:s,saved:o},l=d2(t);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=s[d],f=yn(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),r(c.length>1?c:c[0],o,i))),this.state.activeTape.push(a)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=cA(t),s=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(t,n,s,r=!1){if(T(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));T(o instanceof Ve,()=>"The result y returned by f() must be a tensor.");const i=QG(this.state.activeTape,n,o);if(!r&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=s??oH(o.shape),ZG(a,i,c=>this.tidy(c),iH);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(t){return T(Xb(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{T(n.every(a=>a instanceof Ve),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const o=(a,l)=>(s=t(...n,l),T(s.value instanceof Ve,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(Xb(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];T(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(u.every(h=>h instanceof Ve),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=Un(),s=await this.backend.time(t);return s.wallMs=Un()-n,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new w2;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Rc.nextTensorId=0;Rc.nextVariableId=0;function oH(e){const t=hw(Y(e),"float32");return V.makeTensor(t,e,"float32")}function dA(){const e=TD();if(e._tfengine==null){const t=new NG(e);e._tfengine=new Rc(t)}return DG(e._tfengine.ENV),eH(()=>e._tfengine),e._tfengine}const V=dA();function iH(e,t){const n={a:e,b:t};return V.runKernel(eu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(){return typeof navigator<"u"&&navigator!=null}function hA(e){if(e||aH()){if(e||(e=navigator),e.product==="ReactNative")return!0;const t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){const n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function fA(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yn=K();Yn.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Yn.registerFlag("IS_BROWSER",()=>fA());Yn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Yn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Yn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Yn.registerFlag("PROD",()=>!1);Yn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Yn.getBool("DEBUG"));Yn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Yn.registerFlag("IS_TEST",()=>!1);Yn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Yn.getBool("DEBUG"));Yn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Yn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Yn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kx(e,t){let n=e;if(Js(e))return t==="string"?[]:[e.length];if(aA(e)){const r=e.channels||"RGBA";return[e.height,e.width*r.length]}else if(lA(e))return[e.buffer.size/(t==null?4:Fm(t))];if(!Array.isArray(e))return[];const s=[];for(;Array.isArray(n)||Js(n)&&t!=="string";)s.push(n.length),n=n[0];return Array.isArray(e)&&K().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&pA(e,s,[]),s}function pA(e,t,n){if(n=n||[],!Array.isArray(e)&&!Js(e)){T(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}T(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),T(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const s=t.slice(1);for(let r=0;r<e.length;++r)pA(e[r],s,n.concat(r))}function k2(e,t,n,s){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${e} tensor, but got ${t} tensor`)}}function _(e,t,n,s="numeric"){if(e instanceof q())return k2(s,e.dtype,t,n),e;let r=Jc(e);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),k2(s,r,t,n),e==null||!Js(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const l=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Kx(e,r);!Js(e)&&!Array.isArray(e)&&(e=[e]);const a=r!=="string"?yl(e,r):Za(e,[],!0);return V.makeTensor(a,o,r)}function mA(e,t,n,s="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((o,i)=>_(o,`${t}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lH="__op";function W(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const s=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+lH;const r=(...o)=>{V.startScope(n);try{const i=s(...o);return fw(i)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(i),i}catch(i){throw V.endScope(null),i}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cH(e,t){const n=_(e,"real","complex"),s=_(t,"imag","complex");nr(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return V.runKernel(kw,r)}const Dc=W({complex_:cH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xx(e,t,n,s){if(s==null)s=Jc(e);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(lA(e)||aA(e)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return V.backend.createTensorFromGPUData(e,t||n,s)}if(!Js(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Wo(t);const r=Y(t),o=Y(n);T(r===o,()=>`Based on the provided shape, [${t}], the tensor should have ${r} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==Y(t.slice(i)):!0;T(n[i]===t[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Js(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=s!=="string"?yl(e,s):Za(e,[],!0),V.makeTensor(e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gA(e,t,n){const s=Kx(e,n);return Xx(e,t,s,n)}class nu{static join(t){return new nu(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(s=>Js(s)?s.buffer:s),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let s=0;s<t.length;s++){const r=t[s];s!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+r.byteLength;this.shards.push({buffer:r,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const s=this.findShardForByte(t);if(s===-1)throw new Error(`Could not find start shard for byte ${t}`);const r=n-t,o=new ArrayBuffer(r),i=new Uint8Array(o);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=t+a-c.start,h=a,p=Math.min(n,c.end)-c.start,m=new Uint8Array(c.buffer,d,p-d);if(i.set(m,h),a+=m.length,n<c.end)break}return o}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(r){return t<r.start?-1:t>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=uH(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function uH(e,t){let n=0,s=e.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,o=t(e[r]);if(o===0)return r;o<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pr(){return V}function C2(){return V.memory()}function G(e,t){return V.tidy(e,t)}function At(e){cA(e).forEach(n=>n.dispose())}function Qr(e){return V.keep(e)}function xA(e,t,n=1){return V.registerBackend(e,t,n)}function dH(){return V.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S2=4;async function I2(e,t){const n=[],s=[],r=Array.isArray(e)?e.map(i=>i.name):Object.keys(e);for(let i=0;i<r.length;++i){const a=r[i],l=Array.isArray(e)?e[i].tensor:e[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((g,x)=>g+x.length,0)+S2*h.length,p=new Uint8Array(f);let m=0;for(let g=0;g<h.length;g++){const x=h[g],y=new Uint8Array(new Uint32Array([x.length]).buffer);p.set(y,m),m+=S2,p.set(x,m),m+=x.length}d(p)});s.push(u)}else s.push(l.data());t!=null&&(c.group=t),n.push(c)}const o=await Promise.all(s);return{data:hH(o),specs:n}}function hH(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(o=>{if(t+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const s=new Uint8Array(t);let r=0;return n.forEach(o=>{s.set(new Uint8Array(o.buffer),r),r+=o.byteLength}),s.buffer}const rk=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function $2(e){return rk?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function fH(e){if(rk)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let s=0,r=t.length;s<r;s++)n+=String.fromCharCode(t[s]);return btoa(n)}function pH(e){if(rk){const s=Buffer.from(e,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let s=0;s<t.length;++s)n.set([t.charCodeAt(s)],s);return n.buffer}function mH(e){return nu.join(e)}function yA(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:$2(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:$2(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new nu(e.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Nn.instance==null&&(Nn.instance=new Nn),Nn.instance}static registerSaveRouter(t){Nn.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Nn.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Nn.getHandlers(t,"save")}static getLoadHandlers(t,n){return Nn.getHandlers(t,"load",n)}static getHandlers(t,n,s){const r=[];return(n==="load"?Nn.getInstance().loadRouters:Nn.getInstance().saveRouters).forEach(i=>{const a=i(t,s);a!==null&&r.push(a)}),r}}const gH=e=>Nn.getSaveHandlers(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o1="tensorflowjs",i1=1,Ea="models_store",xi="model_info_store";function bA(){if(!K().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function a1(e){const t=e.result;t.createObjectStore(Ea,{keyPath:"modelPath"}),t.createObjectStore(xi,{keyPath:"modelPath"})}class Ja{constructor(t){if(this.indexedDB=bA(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((s,r)=>{const o=this.indexedDB.open(o1,i1);o.onupgradeneeded=()=>a1(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(Ea,"readonly"),c=a.objectStore(Ea).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(i.close(),r(c.error)),a.oncomplete=()=>i.close()}else{n.weightData=nu.join(n.weightData);const a=yA(n),l=i.transaction(xi,"readwrite");let c=l.objectStore(xi),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return r(h)}let d;u.onsuccess=()=>{d=i.transaction(Ea,"readwrite");const h=d.objectStore(Ea);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(xi);const m=c.delete(this.modelPath);m.onsuccess=()=>(i.close(),r(f.error)),m.onerror=g=>(i.close(),r(f.error))}},u.onerror=h=>(i.close(),r(u.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>r(o.error)})}}Ja.URL_SCHEME="indexeddb://";const vA=e=>K().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ja.URL_SCHEME)?xH(e.slice(Ja.URL_SCHEME.length)):null;Nn.registerSaveRouter(vA);Nn.registerLoadRouter(vA);function xH(e){return new Ja(e)}function yH(e){return e.startsWith(Ja.URL_SCHEME)?e.slice(Ja.URL_SCHEME.length):e}class bH{constructor(){this.indexedDB=bA()}async listModels(){return new Promise((t,n)=>{const s=this.indexedDB.open(o1,i1);s.onupgradeneeded=()=>a1(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(xi,"readonly"),a=o.objectStore(xi).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;t(l)},a.onerror=l=>(r.close(),n(a.error)),o.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(t){return t=yH(t),new Promise((n,s)=>{const r=this.indexedDB.open(o1,i1);r.onupgradeneeded=()=>a1(r),r.onsuccess=()=>{const o=r.result,i=o.transaction(xi,"readwrite"),a=i.objectStore(xi),l=a.get(t);let c;l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const u=a.delete(t),d=()=>{c=o.transaction(Ea,"readwrite");const f=c.objectStore(Ea).delete(t);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=d,u.onerror=h=>(d(),o.close(),s(l.error))}},l.onerror=u=>(o.close(),s(l.error)),i.oncomplete=()=>{c==null?o.close():c.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ko="/",Pl="tensorflowjs_models",wA="info",vH="model_topology",wH="weight_specs",kH="weight_data",CH="model_metadata";function kA(e){return{info:[Pl,e,wA].join(ko),topology:[Pl,e,vH].join(ko),weightSpecs:[Pl,e,wH].join(ko),weightData:[Pl,e,kH].join(ko),modelMetadata:[Pl,e,CH].join(ko)}}function CA(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function SH(e){const t=e.split(ko);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(ko)}function IH(e){return e.startsWith(tl.URL_SCHEME)?e.slice(tl.URL_SCHEME.length):e}class tl{constructor(t){if(!K().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=kA(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),r=yA(t),o=nu.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,fH(o));const i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw CA(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=pH(i),n}}tl.URL_SCHEME="localstorage://";const SA=e=>K().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(tl.URL_SCHEME)?$H(e.slice(tl.URL_SCHEME.length)):null;Nn.registerSaveRouter(SA);Nn.registerLoadRouter(SA);function $H(e){return new tl(e)}class TH{constructor(){T(K().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=Pl+ko,s=ko+wA;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(n)&&o.endsWith(s)){const i=SH(o);t[i]=JSON.parse(this.LS.getItem(o))}}return t}async removeModel(t){t=IH(t);const n=kA(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(n.info));return CA(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T2="://";class Lr{constructor(){this.managers={}}static getInstance(){return Lr.instance==null&&(Lr.instance=new Lr),Lr.instance}static registerManager(t,n){T(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(T2)&&(t=t.slice(0,t.indexOf(T2))),T(t.length>0,()=>"scheme must not be an empty string.");const s=Lr.getInstance();T(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=n}static getManager(t){const n=Lr.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(Lr.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NH{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!K().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return QD(t)}}if(K().get("IS_BROWSER")){K().setPlatform("browser",new NH);try{Lr.registerManager(tl.URL_SCHEME,new TH)}catch{}try{Lr.registerManager(Ja.URL_SCHEME,new bH)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EH={importFetch:()=>require("node-fetch")};let my;class _H{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return K().global.fetch!=null?K().global.fetch(t,n):(my==null&&(my=EH.importFetch()),my(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}K().get("IS_NODE")&&!K().get("IS_BROWSER")&&K().setPlatform("node",new _H);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _t(e,t="float32",n){return t=t||"float32",Wo(e),new un(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(e,t){const n=_(e,"x","cast");if(!SG(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:t};return V.runKernel(wh,s,r)}const ct=W({cast_:RH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DH(e){const n={x:_(e,"x","clone","string_or_numeric")};return V.runKernel(Oh,n)}const za=W({clone_:DH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dA();const OH={buffer:_t,cast:ct,clone:za,print:AH};nH(OH);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(e,t){let n=_(e,"a","add"),s=_(t,"b","add");[n,s]=Oe(n,s);const r={a:n,b:s};return V.runKernel(eu,r)}const et=W({add_:FH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PH(e,t){let n=_(e,"a","floorDiv"),s=_(t,"b","floorDiv");[n,s]=Oe(n,s);const r={a:n,b:s};return V.runKernel(Dh,r)}const IA=W({floorDiv_:PH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MH(e,t){let n=_(e,"a","div"),s=_(t,"b","div");if([n,s]=Oe(n,s),n.dtype==="int32"&&s.dtype==="int32")return IA(n,s);const r={a:n,b:s},o={};return V.runKernel($h,r,o)}const xt=W({div_:MH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(e,t){let n=_(e,"a","mul"),s=_(t,"b","mul");[n,s]=Oe(n,s);const r={a:n,b:s};return V.runKernel(Uh,r)}const F=W({mul_:LH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zH(e){const t=_(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return V.runKernel(Jg,n)}else{const n={x:t};return V.runKernel(Hg,n)}}const Qe=W({abs_:zH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BH(e){const n={x:_(e,"x","acos")};return V.runKernel(ph,n)}const VH=W({acos_:BH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(e){const n={x:_(e,"x","acosh")};return V.runKernel(mh,n)}const UH=W({acosh_:WH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(e,t=null,n=!1){const r={x:_(e,"x","all","bool")},o={axis:t,keepDims:n};return V.runKernel(gw,r,o)}const $A=W({all_:jH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(e,t=null,n=!1){const r={x:_(e,"x","any","bool")},o={axis:t,keepDims:n};return V.runKernel(xw,r,o)}const l1=W({any_:GH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HH(e,t=0){const s={x:_(e,"x","argMax")},r={axis:t};return V.runKernel(Kg,s,r)}const Ld=W({argMax_:HH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(e,t=0){const s={x:_(e,"x","argMin")},r={axis:t};return V.runKernel(Xg,s,r)}const XH=W({argMin_:KH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qH(e){const n={x:_(e,"x","asin")};return V.runKernel(gh,n)}const YH=W({asin_:qH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(e){const n={x:_(e,"x","asinh")};return V.runKernel(xh,n)}const ZH=W({asinh_:QH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(e){const n={x:_(e,"x","atan")};return V.runKernel(yh,n)}const t5=W({atan_:JH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e5(e,t){let n=_(e,"a","atan2"),s=_(t,"b","atan2");[n,s]=Oe(n,s);const r={a:n,b:s};return V.runKernel(vh,r)}const n5=W({atan2_:e5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s5(e){const n={x:_(e,"x","atanh")};return V.runKernel(bh,n)}const r5=W({atanh_:s5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uf(e,t,n,s,r="NHWC",o){const i=e[3],a=[...t,i],l=jo(r);return dn(e,a,n,o,s,null,null,l)}function sr(e,t,n,s,r,o,i="channelsLast"){const[a,l]=zd(t);let c;if(i==="channelsLast")c=[a,l,e[3],e[3]];else if(i==="channelsFirst")c=[a,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${i}`);return dn(e,c,n,s,r,o,!1,i)}function Uo(e,t,n,s,r,o,i="NDHWC"){const[a,l,c]=c1(t);let u,d;if(i==="NDHWC")d="channelsLast",u=[a,l,c,e[4],e[4]];else if(i==="NCDHW")d="channelsFirst",u=[a,l,c,e[1],e[1]];else throw new Error(`Unknown dataFormat ${i}`);return na(e,u,n,s,r,!1,d,o)}function dn(e,t,n,s,r,o,i=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=e;else if(a==="channelsFirst")[l,d,c,u]=e;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=t,[m,g]=zd(n),[x,y]=zd(s),b=ic(h,x),v=ic(f,y),{padInfo:w,outHeight:k,outWidth:C}=a5(r,c,u,m,g,b,v,o,a),S=i?p*d:p;let I;return a==="channelsFirst"?I=[l,S,k,C]:a==="channelsLast"&&(I=[l,k,C,S]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:k,outWidth:C,outChannels:S,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:v,dilationHeight:x,dilationWidth:y,inShape:e,outShape:I,filterShape:t}}function na(e,t,n,s,r,o=!1,i="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,d,h]=e;else if(i==="channelsFirst")[l,h,c,u,d]=e;else throw new Error(`Unknown dataFormat ${i}`);const[f,p,m,,g]=t,[x,y,b]=c1(n),[v,w,k]=c1(s),C=ic(f,v),S=ic(p,w),I=ic(m,k),{padInfo:$,outDepth:E,outHeight:A,outWidth:L}=l5(r,c,u,d,x,y,b,C,S,I,a),O=o?g*h:g;let P;return i==="channelsFirst"?P=[l,O,E,A,L]:i==="channelsLast"&&(P=[l,E,A,L,O]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:E,outHeight:A,outWidth:L,outChannels:O,padInfo:$,strideDepth:x,strideHeight:y,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:S,effectiveFilterWidth:I,dilationDepth:v,dilationHeight:w,dilationWidth:k,inShape:e,outShape:P,filterShape:t}}function o5(e,t,n,s,r){s==null&&(s=ok(e,t,n));const o=e[0],i=e[1],a=Bd((o-t+2*s)/n+1,r),l=Bd((i-t+2*s)/n+1,r);return[a,l]}function i5(e,t,n,s,r,o){r==null&&(r=ok(e,t[0],s[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)e[a]+2*r>=t[a]&&(i[a]=Bd((e[a]-t[a]+2*r)/s[a]+1,o));return i}function ok(e,t,n,s=1){const r=ic(t,s);return Math.floor((e[0]*(n-1)-n+r)/2)}function zd(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function c1(e){return typeof e=="number"?[e,e,e]:e}function ic(e,t){return t<=1?e:e+(e-1)*(t-1)}function a5(e,t,n,s,r,o,i,a,l){let c,u,d;if(typeof e=="number"){c={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const f=o5([t,n],o,s,e,a);u=f[0],d=f[1]}else if(e==="same"){u=Math.ceil(t/s),d=Math.ceil(n/r);const h=Math.max(0,(u-1)*s+o-t),f=Math.max(0,(d-1)*r+i-n),p=Math.floor(h/2),m=h-p,g=Math.floor(f/2),x=f-g;c={top:p,bottom:m,left:g,right:x,type:"SAME"}}else if(e==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-o+1)/s),d=Math.ceil((n-i+1)/r);else if(typeof e=="object"){const h=l==="channelsLast"?e[1][0]:e[2][0],f=l==="channelsLast"?e[1][1]:e[2][1],p=l==="channelsLast"?e[2][0]:e[3][0],m=l==="channelsLast"?e[2][1]:e[3][1];c={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=Bd((t-o+h+f)/s+1,a),d=Bd((n-i+p+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outHeight:u,outWidth:d}}function l5(e,t,n,s,r,o,i,a,l,c,u){let d,h,f,p;if(e==="valid"&&(e=0),typeof e=="number"){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const g=i5([t,n,s,1],[a,l,c],1,[r,o,i],e,u);h=g[0],f=g[1],p=g[2]}else if(e==="same"){h=Math.ceil(t/r),f=Math.ceil(n/o),p=Math.ceil(s/i);const m=(h-1)*r+a-t,g=(f-1)*o+l-n,x=(p-1)*i+c-s,y=Math.floor(m/2),b=m-y,v=Math.floor(g/2),w=g-v,k=Math.floor(x/2),C=x-k;d={top:v,bottom:w,left:k,right:C,front:y,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function Bd(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function el(e){const[t,n,s]=zd(e);return t===1&&n===1&&s===1}function vn(e,t){return el(e)||el(t)}function nl(e){return zd(e).every(t=>t>0)}function jo(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function ts(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")T(Ec(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(s=>{s.forEach(r=>{T(Ec(r),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(e,t){const s={x:_(e,"x","reshape","string_or_numeric")},r={shape:t};return V.runKernel(Ax,s,r)}const j=W({reshape_:c5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u5(e,t,n,s,r){const o=_(e,"x","avgPool","float32"),i=1;T(vn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=j(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),ts("avgPool",s,r);const c={x:a},u={filterSize:t,strides:n,pad:s,dimRoundingMode:r};let d=V.runKernel(qg,c,u);return d=ct(d,o.dtype),l?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const ik=W({avgPool_:u5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d5(e,t,n,s,r,o="NDHWC"){const i=_(e,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=j(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),T(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),ts("avgPool3d",s,r);const c={x:a},u={filterSize:t,strides:n,pad:s,dimRoundingMode:r,dataFormat:o};let d=V.runKernel(Yg,c,u);return d=ct(d,a.dtype),l?j(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const h5=W({avgPool3d_:d5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5(e,t=0){T(e.length>=1,()=>"Pass at least one tensor to concat");const n=mA(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return za(n[0]);const s=n,r={axis:t};return V.runKernel(tx,s,r)}const qn=W({concat_:f5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p5(e,t,n=!1,s=!1){let r=_(e,"a","matMul"),o=_(t,"b","matMul");[r,o]=Oe(r,o);const i={a:r,b:o},a={transposeA:n,transposeB:s};return V.runKernel(Qg,i,a)}const jt=W({matMul_:p5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(e){const n={x:_(e,"x","sigmoid","float32")};return V.runKernel(tf,n)}const su=W({sigmoid_:m5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g5(e,t,n){const s=_(e,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},o={begin:t,size:n};return V.runKernel(Lx,r,o)}const re=W({slice_:g5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(e){const n={x:_(e,"x","tanh","float32")};return V.runKernel(af,n)}const qx=W({tanh_:x5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y5(e,t,n){const s=_(e,"x","batchToSpaceND"),r=t.reduce((a,l)=>a*l);T(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),T(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),T(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${r}`);const o={x:s},i={blockShape:t,crops:n};return V.runKernel(Zg,o,i)}const ak=W({batchToSpaceND_:y5});function b5(e){let t;return e.rank===0||e.rank===1?t=j(e,[1,1,1,e.size]):e.rank===2?t=j(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v5(e,t,n,s,r,o){o==null&&(o=.001);const i=_(e,"x","batchNorm"),a=_(t,"mean","batchNorm"),l=_(n,"variance","batchNorm");let c;r!=null&&(c=_(r,"scale","batchNorm"));let u;s!=null&&(u=_(s,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:b5(i),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:o},p=V.runKernel(cx,h,f);return j(p,i.shape)}const Yx=W({batchNorm_:v5});function w5(e,t,n,s,r,o){const i=_(e,"x","batchNorm"),a=_(t,"mean","batchNorm"),l=_(n,"variance","batchNorm");let c;r!=null&&(c=_(r,"scale","batchNorm"));let u;return s!=null&&(u=_(s,"offset","batchNorm")),T(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),T(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),Yx(i,a,l,u,c,o)}const k5=W({batchNorm2d_:w5});function C5(e,t,n,s,r,o){const i=_(e,"x","batchNorm"),a=_(t,"mean","batchNorm"),l=_(n,"variance","batchNorm");let c;r!=null&&(c=_(r,"scale","batchNorm"));let u;return s!=null&&(u=_(s,"offset","batchNorm")),T(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),T(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),Yx(i,a,l,u,c,o)}const S5=W({batchNorm3d_:C5});function I5(e,t,n,s,r,o){const i=_(e,"x","batchNorm"),a=_(t,"mean","batchNorm"),l=_(n,"variance","batchNorm");let c;r!=null&&(c=_(r,"scale","batchNorm"));let u;return s!=null&&(u=_(s,"offset","batchNorm")),T(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),T(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),Yx(i,a,l,u,c,o)}const $5=W({batchNorm4d_:I5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T5(e,t,n){const s=_(e,"x","bincount"),r=_(t,"weights","bincount");T(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const o={x:s,weights:r},i={size:n};return V.runKernel(vw,o,i)}const N5=W({bincount_:T5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E5(e,t){let n=_(e,"broadcastTo","x");const s=n.shape;if(Wo(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const c=n.shape.slice();for(;c.length<t.length;)c.unshift(1);n=j(n,c)}const r=n.shape,o=Array.from(t);for(let c=t.length-1;c>=0;c--)if(r[c]===t[c])o[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(o.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return za(n);const a={x:n},l={reps:o};return V.runKernel(lf,a,l)}const ud=W({broadcastTo_:E5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _5(e){const n={x:_(e,"x","ceil","float32")};return V.runKernel(kh,n)}const R5=W({ceil_:_5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qx(e,t,n){Wo(e),n=n||Jc(t);const s={shape:e,value:t,dtype:n};return V.runKernel(Fw,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D5(e,t,n){const s=_(e,"x","clipByValue");if(T(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return Qx(s.shape,t,s.dtype);const r={x:s},o={clipValueMin:t,clipValueMax:n};return V.runKernel(Ch,r,o)}const _s=W({clipByValue_:D5});function A5(e){return qn(e,0)}const O5=W({concat1d_:A5});function F5(e,t){return qn(e,t)}const P5=W({concat2d_:F5});function M5(e,t){return qn(e,t)}const L5=W({concat3d_:M5});function z5(e,t){return qn(e,t)}const B5=W({concat4d_:z5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V5(e,t,n,s,r="NHWC",o=[1,1],i){const a=_(e,"x","conv2d","float32"),l=_(t,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),ts("conv2d",s,i);const d=r==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),T(vn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),T(nl(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),T(nl(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},p=V.runKernel(ex,h,f);return u?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const sl=W({conv2d_:V5});function W5(e,t,n,s,r="NWC",o=1,i){const a=_(e,"x","conv1d"),l=_(t,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1]])),T(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),T(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),ts("conv1d",s,i),T(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(vn(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),T(nl(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),T(nl(n),()=>"Error in conv1D: Stride should be larger than 0."),T(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=j(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=j(c,[c.shape[0],1,c.shape[1],c.shape[2]]),g=sl(h,d,[1,n],s,"NHWC",[1,o],i);return u?j(g,[g.shape[2],g.shape[3]]):j(g,[g.shape[0],g.shape[2],g.shape[3]])}const TA=W({conv1d_:W5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U5(e,t,n,s,r,o="NHWC",i){T(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,l=t,c=!1;t.rank===3&&(c=!0,l=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,e[0],e[1],e[2]]),T(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];T(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),T(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),ts("conv2dDerInput",r,i);const h={dy:l,filter:n},f={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,inputShape:a},p=V.runKernel(nx,h,f);return c?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const lk=W({conv2DBackpropInput_:U5});function j5(e,t,n,s,r,o){const i=_(e,"x","conv2dTranspose"),a=_(t,"filter","conv2dTranspose");return lk(n,i,a,s,r,"NHWC",o)}const NA=W({conv2dTranspose_:j5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5(e,t,n,s,r="NDHWC",o=[1,1,1]){const i=_(e,"x","conv3d"),a=_(t,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=j(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(vn(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),T(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),T(nl(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),T(nl(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:o},h=V.runKernel(sx,u,d);return c?j(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const H5=W({conv3d_:G5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K5(e,t,n,s,r){T(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,i=t,a=!1;t.rank===4&&(a=!0,i=j(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),o=[1,e[0],e[1],e[2],e[3]]);const l=o[4],c=i.shape[4];T(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),T(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),T(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),T(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),T(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:i,filter:n},d={pad:r,strides:s,inputShape:o},h=V.runKernel(Iw,u,d);return a?j(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const EA=W({conv3DBackpropInput_:K5});function X5(e,t,n,s,r){const o=_(e,"x","conv3dTranspose"),i=_(t,"filter","conv3dTranspose");return EA(n,o,i,s,r)}const q5=W({conv3dTranspose_:X5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5(e){const n={x:_(e,"x","cos","float32")};return V.runKernel(Sh,n)}const ck=W({cos_:Y5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q5(e){const n={x:_(e,"x","cosh","float32")};return V.runKernel(Ih,n)}const _A=W({cosh_:Q5});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z5(e,t=0,n=!1,s=!1){const o={x:_(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:s};return V.runKernel($w,o,i)}const u1=W({cumprod_:Z5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J5(e,t=0,n=!1,s=!1){const o={x:_(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:s};return V.runKernel(rx,o,i)}const RA=W({cumsum_:J5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t6(e,t,n,s=!1){const r=_(e,"x","denseBincount"),o=_(t,"weights","denseBincount");T(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),T(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(o.size===r.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${o.shape}.`);const i={x:r,weights:o},a={size:n,binaryOutput:s};return V.runKernel(Nw,i,a)}const N2=W({denseBincount_:t6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6(e,t,n="NHWC"){const s=_(e,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],o=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];T(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),T(r*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${t}  for depthToSpace with input shape
    ${s.shape}`),T(o*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${t} for depthToSpace with input shape
        ${s.shape}`),T(i%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:t,dataFormat:n};return V.runKernel(Ew,a,l)}const n6=W({depthToSpace_:e6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6(e,t,n,s,r="NHWC",o=[1,1],i){const a=_(e,"x","depthwiseConv2d","float32"),l=_(t,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),ts("depthwiseConv2d",s,i);const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},p=V.runKernel(ox,h,f);return u?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const uk=W({depthwiseConv2d_:s6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r6(e,t,n,s,r=[1,1],o="NHWC"){const i=_(e,"x","dilation2d"),a=_(t,"filter","dilation2d");T(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),T(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,c=!1;i.rank===3&&(l=j(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),T(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=V.runKernel(ix,u,d);return c?j(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const o6=W({dilation2d_:r6});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ac(e,t){const n=e.length,s=[];for(let r=0;r<n;r++){const o=n-1-r,i=e[o]||1;(t[t.length-1-r]||1)>1&&i===1&&s.unshift(o)}return s}function Ke(e,t){const n=[];for(let s=0;s<t.length;s++){const r=e[e.length-s-1],o=t.length-s-1,i=t[o];(r==null||r===1&&i>1)&&n.unshift(o)}return n}function $t(e,t){const n=Math.max(e.length,t.length),s=new Array(n);for(let r=0;r<n;r++){let o=e[e.length-r-1];o==null&&(o=1);let i=t[t.length-r-1];if(i==null&&(i=1),o===1)s[n-r-1]=i;else if(i===1)s[n-r-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(a)}else s[n-r-1]=o}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6(e,t){let n=_(e,"a","equal","string_or_numeric"),s=_(t,"b","equal","string_or_numeric");[n,s]=Oe(n,s),$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(ax,r)}const ro=W({equal_:i6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(e,t,n){const s=_(t,"a","where"),r=_(n,"b","where"),o=_(e,"condition","where","bool"),i=$t($t(o.shape,s.shape),r.shape),a=ud(o,i),l=ud(s,i),c=ud(r,i),u={condition:a,t:l,e:c};return V.runKernel(Mx,u)}const On=W({where_:a6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l6(e){const n={x:_(e,"x","zerosLike")};return V.runKernel(Gx,n)}const Lt=W({zerosLike_:l6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6(e,t){let n=_(e,"a","div"),s=_(t,"b","div");[n,s]=Oe(n,s);const r=xt(n,s),o=Lt(r),i=ro(s,o);return On(i,o,r)}const u6=W({divNoNan_:c6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d6(e,t){const n=_(e,"t1","dot"),s=_(t,"t2","dot");T((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],o=s.rank===1?s.size:s.shape[0];if(T(r===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${o}.`),n.rank===1&&s.rank===1){const i=j(n,[1,-1]),a=j(s,[-1,1]),l=jt(i,a);return j(l,[])}else if(n.rank===1&&s.rank===2){const i=j(n,[1,-1]),a=j(s,[s.shape[0],s.shape[1]]),l=jt(i,a);return j(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=j(s,[-1,1]),a=jt(n,i);return j(a,[a.size])}else{const i=j(s,[s.shape[0],s.shape[1]]);return jt(n,i)}}const h6=W({dot_:d6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f6(e,...t){const n=t.map((r,o)=>_(r,`tensors${o}`,"einsum")),s={equation:e};return V.runKernel(Dw,n,s)}const Eu=W({einsum_:f6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p6(e){const n={x:_(e,"x","elu","float32")};return V.runKernel(Th,n)}const Zx=W({elu_:p6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m6(e){let t=_(e,"x","erf");T(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=ct(t,"float32"));const n={x:t};return V.runKernel(Nh,n)}const DA=W({erf_:m6});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dk(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function AA(e,t,n){const s=e.length+t.length,r=[];let o=0,i=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(e[o++]):r.push(t[i++]);return r}function sn(e,t){const n=[],s=e.length;for(let o=0;o<s;o++)t.indexOf(o)===-1&&n.push(e[o]);const r=t.map(o=>e[o]);return[n,r]}function Fe(e,t){const n=t.map(s=>1);return AA(e,n,t)}function hn(e,t,n){T(dk(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function Ie(e,t){if(dk(e,t))return null;const n=[];for(let s=0;s<t;++s)e.indexOf(s)===-1&&n.push(s);return e.forEach(s=>n.push(s)),n}function sa(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function Pe(e,t){const n=[];for(let s=t-e;s<t;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g6(e,t=null,n=!1){const r={x:_(e,"x","max")},o={reductionIndices:t,keepDims:n};return V.runKernel(bx,r,o)}const kr=W({max_:g6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x6(e,t=null,n=!1){const r={x:_(e,"x","min")},o={axis:t,keepDims:n};return V.runKernel(Cx,r,o)}const Vm=W({min_:x6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y6(e,t){let n=_(e,"base","pow"),s=_(t,"exp","pow");[n,s]=Oe(n,s);const r={a:n,b:s};return V.runKernel(jh,r)}const rl=W({pow_:y6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kt(e,t){if((Js(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Js(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Xx(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b6(e){const n={x:_(e,"x","sqrt","float32")};return V.runKernel(nf,n)}const bn=W({sqrt_:b6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v6(e){const t=_(e,"x","square"),n={};return V.runKernel("Square",{x:t},n)}const oe=W({square_:v6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w6(e,t=null,n=!1){let s=_(e,"x","sum");s.dtype==="bool"&&(s=ct(s,"int32"));const r={x:s},o={axis:t,keepDims:n};return V.runKernel(zx,r,o)}const mt=W({sum_:w6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k6(e,t="euclidean",n=null,s=!1){e=_(e,"x","norm");const r=OA(e,t,n);let o=r.shape;if(s){const i=Rt(n,e.shape);o=Fe(r.shape,i)}return j(r,o)}function OA(e,t,n=null){if(e.rank===0)return Qe(e);if(e.rank!==1&&n===null)return OA(j(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return mt(Qe(e),n);if(t===1/0)return kr(Qe(e),n);if(t===-1/0)return Vm(Qe(e),n);if(t==="euclidean"||t===2)return bn(mt(rl(Qe(e),kt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return kr(mt(Qe(e),n[0]),n[1]-1);if(t===1/0)return kr(mt(Qe(e),n[1]),n[0]);if(t===-1/0)return Vm(mt(Qe(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return bn(mt(oe(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Jx=W({norm_:k6});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(e,t=null,n=!1){return Jx(e,"euclidean",t,n)}const S6=W({euclideanNorm_:C6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I6(e){const n={x:_(e,"x","exp")};return V.runKernel(Eh,n)}const Rs=W({exp_:I6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $6(e,t=0){const n=_(e,"x","expandDims","string_or_numeric");T(t<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:t};return V.runKernel(lx,s,r)}const Gn=W({expandDims_:$6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(e){const n={x:_(e,"x","expm1")};return V.runKernel(_h,n)}const N6=W({expm1_:T6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(e,t){const n=_(e,"x","tile","string_or_numeric");T(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const s={x:n},r={reps:t};return V.runKernel(lf,s,r)}const xr=W({tile_:E6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _6(e,t,n,s="float32"){t==null&&(t=e);const r=_t([e,t],s),o=e<=t?e:t;for(let a=0;a<o;++a)r.set(1,a,a);const i=j(r.toTensor(),[e,t]);if(n==null)return i;if(n.length===1)return xr(Gn(i,0),[n[0],1,1]);if(n.length===2)return xr(Gn(Gn(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return xr(Gn(Gn(Gn(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const FA=W({eye_:_6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R6(e){const n={x:_(e,"x","floor","float32")};return V.runKernel(Rh,n)}const t0=W({floor_:R6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D6(e,t,n=0,s=0){const r=_(e,"x","gather"),o=_(t,"indices","gather","int32"),i={x:r,indices:o},a={axis:n,batchDims:s};return V.runKernel(ux,i,a)}const hk=W({gather_:D6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A6(e,t){let n=_(e,"a","greater","string_or_numeric"),s=_(t,"b","greater","string_or_numeric");[n,s]=Oe(n,s),$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(dx,r)}const Os=W({greater_:A6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6(e,t){let n=_(e,"a","greaterEqual","string_or_numeric"),s=_(t,"b","greaterEqual","string_or_numeric");[n,s]=Oe(n,s),$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Ah,r)}const bl=W({greaterEqual_:O6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6(e){const n={input:_(e,"input","imag")};return V.runKernel(Lw,n)}const fk=W({imag_:F6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(e){const n={x:_(e,"x","isFinite")};return V.runKernel(Fh,n)}const M6=W({isFinite_:P6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(e){const n={x:_(e,"x","isInf")};return V.runKernel(Ph,n)}const z6=W({isInf_:L6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(e){const n={x:_(e,"x","isNaN")};return V.runKernel(Mh,n)}const V6=W({isNaN_:B6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(e,t=.2){const s={x:_(e,"x","leakyRelu")},r={alpha:t};return V.runKernel(hx,s,r)}const pk=W({leakyRelu_:W6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(e,t){let n=_(e,"a","less","string_or_numeric"),s=_(t,"b","less","string_or_numeric");[n,s]=Oe(n,s),$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(fx,r)}const Wm=W({less_:U6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(e,t){let n=_(e,"a","lessEqual","string_or_numeric"),s=_(t,"b","lessEqual","string_or_numeric");[n,s]=Oe(n,s),$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(px,r)}const ru=W({lessEqual_:j6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(e,t=5,n=1,s=1,r=.5){const o=_(e,"x","localResponseNormalization");T(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),T(Ec(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=j(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},c={depthRadius:t,bias:n,alpha:s,beta:r},u=V.runKernel(yx,l,c);return a?j(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const H6=W({localResponseNormalization_:G6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K6(e){const n={x:_(e,"x","log","float32")};return V.runKernel(Lh,n)}const tr=W({log_:K6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(e){const n={x:_(e,"x","log1p")};return V.runKernel(zh,n)}const mk=W({log1p_:X6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6(e,t){T(Xb(e),()=>"The f passed in variableGrads(f) must be a function"),T(t==null||Array.isArray(t)&&t.every(c=>c instanceof Bm),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const c in V.registeredVariables)t.push(V.registeredVariables[c])}const s=n?t.filter(c=>!c.trainable):null,r=t.length;t=t.filter(c=>c.trainable),T(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const o=!0,{value:i,grads:a}=V.gradients(e,t,null,o);T(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return t.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:i,grads:l}}function ol(e){return V.customGrad(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y6(e){const n={x:_(e,"x","neg")};return V.runKernel(Ix,n)}const be=W({neg_:Y6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q6(e){const n={x:_(e,"x","softplus")};return V.runKernel(ef,n)}const df=W({softplus_:Q6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6(e){const t=_(e,"x","logSigmoid");return ol(s=>({value:be(df(be(s))),gradFunc:i=>F(i,su(be(s)))}))(t)}const J6=W({logSigmoid_:Z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tK(e,t){let n=_(e,"a","sub"),s=_(t,"b","sub");[n,s]=Oe(n,s);const r={a:n,b:s};return V.runKernel(rf,r)}const ft=W({sub_:tK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(e,t=-1){const n=_(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return ol((r,o)=>{const a=kr(r,t,!0),l=ft(r,a),c=ft(ct(l,"float32"),tr(mt(Rs(l),t,!0)));return o([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,m=Rs(f);return ft(d,F(mt(d,t,p),m))}}})(n)}const PA=W({logSoftmax_:eK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nK(e,t=null,n=!1){const s=_(e,"x","logSumExp"),r=Rt(t,s.shape),o=kr(s,r,!0),i=ft(s,o),a=Rs(i),l=mt(a,r),c=tr(l),u=et(j(o,c.shape),c);if(n){const d=Fe(u.shape,r);return j(u,d)}return u}const gk=W({logSumExp_:nK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(e,t){const n=_(e,"a","logicalAnd","bool"),s=_(t,"b","logicalAnd","bool");$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(mx,r)}const Mo=W({logicalAnd_:sK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rK(e){const n={x:_(e,"x","logicalNot","bool")};return V.runKernel(gx,n)}const xk=W({logicalNot_:rK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oK(e,t){const n=_(e,"a","logicalOr","bool"),s=_(t,"b","logicalOr","bool");$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(xx,r)}const MA=W({logicalOr_:oK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(e,t){const n=_(e,"a","logicalXor","bool"),s=_(t,"b","logicalXor","bool");return $t(n.shape,s.shape),Mo(MA(e,t),xk(Mo(e,t)))}const aK=W({logicalXor_:iK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(e,t,n,s,r){const o=_(e,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=j(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(vn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),ts("maxPool",s,r);const c={x:a},u={filterSize:t,strides:n,pad:s,dimRoundingMode:r},d=V.runKernel(vx,c,u);return l?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const yk=W({maxPool_:lK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cK(e,t=[1,1,1],n,s,r,o="NDHWC"){const i=_(e,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=j(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),ts("maxPool3d",s,r);const c={x:a},u={filterSize:t,strides:n,pad:s,dimRoundingMode:r,dataFormat:o},d=V.runKernel(wx,c,u);return l?j(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const uK=W({maxPool3d_:cK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dK(e,t){let n=_(e,"a","maximum"),s=_(t,"b","maximum");[n,s]=Oe(n,s),n.dtype==="bool"&&(n=ct(n,"int32"),s=ct(s,"int32")),$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Bh,r)}const ra=W({maximum_:dK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hK(e,t=null,n=!1){const r={x:_(e,"x","mean")},o={axis:t,keepDims:n};return V.runKernel(kx,r,o)}const Re=W({mean_:hK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Je(e,t="float32"){if(Wo(e),t==="complex64"){const s=Je(e,"float32"),r=Je(e,"float32");return Dc(s,r)}const n=yn(Y(e),t);return V.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Go(e,t="float32"){if(Wo(e),t==="complex64"){const s=Go(e,"float32"),r=Je(e,"float32");return Dc(s,r)}const n=hw(Y(e),t);return V.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fK(e,t){let n=_(e,"a","minimum"),s=_(t,"b","minimum");[n,s]=Oe(n,s),n.dtype==="bool"&&(n=ct(n,"int32"),s=ct(s,"int32")),$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Vh,r)}const Oc=W({minimum_:fK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(e,t,n){T(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=_(e,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)T(t[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),T(t[a][0]>=0&&t[a][0]<=s.shape[a]-r&&t[a][1]>=0&&t[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const o={paddings:t,mode:n},i={x:s};return V.runKernel(Sx,i,o)}const mK=W({mirrorPad_:pK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(e,t){let n=_(e,"a","mod"),s=_(t,"b","mod");[n,s]=Oe(n,s);const r={a:n,b:s};return V.runKernel(Wh,r)}const xK=W({mod_:gK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yK(e,t=null,n=!1){e=_(e,"x","moments");const s=Rt(t,e.shape),r=Re(e,s,n);let o=r.shape;n||(o=Fe(r.shape,s));const i=oe(ft(ct(e,"float32"),j(r,o))),a=Re(i,s,n);return{mean:r,variance:a}}const bk=W({moments_:yK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bK(e,t){let n=_(e,"a","notEqual","string_or_numeric"),s=_(t,"b","notEqual","string_or_numeric");[n,s]=Oe(n,s),$t(n.shape,s.shape);const r={a:n,b:s};return V.runKernel($x,r)}const Vd=W({notEqual_:bK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vK(e,t,n=1,s=0,r="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const i={indices:_(e,"indices","oneHot","int32")},a={dtype:r,depth:t,onValue:n,offValue:s};return V.runKernel(Nx,i,a)}const LA=W({oneHot_:vK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wK(e){const n={x:_(e,"x","onesLike")};return V.runKernel(Tx,n)}const er=W({onesLike_:wK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kK(e,t,n=0){const s=_(e,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:t,constantValue:n},o={x:s};return V.runKernel(_x,o,r)}const vk=W({pad_:kK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CK(e,t,n){const s=_(e,"x","spaceToBatchND");T(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),T(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),T(s.shape.reduce((i,a,l)=>l>0&&l<=t.length?i&&(a+n[l-1][0]+n[l-1][1])%t[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const r={x:s},o={blockShape:t,paddings:n};return V.runKernel(Bx,r,o)}const wk=W({spaceToBatchND_:CK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SK(e,t,n,s,r,o,i){r==null&&(r=[1,1]),o==null&&(o=1),s===0&&(s="valid");const a=_(e,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(vn(o,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${r}'`);const u=sr(l.shape,t,o,r,s),d=[u.dilationHeight,u.dilationWidth];let h;s==="same"?h=$K([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=IK([u.inHeight,u.inWidth],d,h),g=f?s:"valid",x=f?l:wk(l,d,p),b=(n==="avg"?()=>ik(x,t,o,g,i):()=>yk(x,t,o,g,i))(),v=f?b:ak(b,d,m);return c?j(v,[v.shape[1],v.shape[2],v.shape[3]]):v}function IK(e,t,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),o=e.concat(s,r),i=t.map((u,d)=>(u-o[d]%u)%u),a=r.map((u,d)=>u+i[d]),l=t.map((u,d)=>[s[d],a[d]]),c=t.map((u,d)=>[0,i[d]]);return[l,c]}function $K(e,t){const s=e.map((i,a)=>i+(i-1)*(t[a]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),o=s.map((i,a)=>i-r[a]);return s.map((i,a)=>[r[a],o[a]])}const TK=W({pool_:SK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NK(e,t){const n=_(e,"x","prelu"),s=_(t,"alpha","prelu"),r={x:n,alpha:s};return V.runKernel(Rx,r)}const kk=W({prelu_:NK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EK(e,t=null,n=!1){let s=_(e,"x","prod");s.dtype==="bool"&&(s=ct(s,"int32"));const r={x:s},o={axis:t,keepDims:n};return V.runKernel(Dx,r,o)}const _K=W({prod_:EK});var Ck={exports:{}};Ck.exports;(function(e){(function(t,n,s){function r(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function o(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var u=new r(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&o(d,u),h.state=function(){return o(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:this.alea=i})(pl,e)})(Ck);var RK=Ck.exports,Sk={exports:{}};Sk.exports;(function(e){(function(t,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(pl,e)})(Sk);var DK=Sk.exports,Ik={exports:{}};Ik.exports;(function(e){(function(t,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(pl,e)})(Ik);var AK=Ik.exports,$k={exports:{}};$k.exports;(function(e){(function(t,n,s){function r(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(pl,e)})($k);var OK=$k.exports,Tk={exports:{}};Tk.exports;(function(e){(function(t,n,s){function r(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,m,g,x=[],y=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,y=Math.max(y,d.length)),p=0,m=-32;m<y;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,h=x[m&127]^=f+g,p=h==0?p+1:0);for(p>=128&&(x[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=x[p+34&127],h=x[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,x[p]=f^h;u.w=g,u.X=x,u.i=p}c(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(pl,e)})(Tk);var FK=Tk.exports,Nk={exports:{}};Nk.exports;(function(e){(function(t,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(pl,e)})(Nk);var PK=Nk.exports,zA={exports:{}};const MK={},LK=Object.freeze(Object.defineProperty({__proto__:null,default:MK},Symbol.toStringTag,{value:"Module"})),zK=Rz(LK);(function(e){(function(t,n,s){var r=256,o=6,i=52,a="random",l=s.pow(r,o),c=s.pow(2,i),u=c*2,d=r-1,h;function f(v,w,k){var C=[];w=w==!0?{entropy:!0}:w||{};var S=x(g(w.entropy?[v,b(n)]:v??y(),3),C),I=new p(C),$=function(){for(var E=I.g(o),A=l,L=0;E<c;)E=(E+L)*r,A*=r,L=I.g(1);for(;E>=u;)E/=2,A/=2,L>>>=1;return(E+L)/A};return $.int32=function(){return I.g(4)|0},$.quick=function(){return I.g(4)/4294967296},$.double=$,x(b(I.S),n),(w.pass||k||function(E,A,L,O){return O&&(O.S&&m(O,I),E.state=function(){return m(I,{})}),L?(s[a]=E,A):E})($,S,"global"in w?w.global:this==s,w.state)}function p(v){var w,k=v.length,C=this,S=0,I=C.i=C.j=0,$=C.S=[];for(k||(v=[k++]);S<r;)$[S]=S++;for(S=0;S<r;S++)$[S]=$[I=d&I+v[S%k]+(w=$[S])],$[I]=w;(C.g=function(E){for(var A,L=0,O=C.i,P=C.j,M=C.S;E--;)A=M[O=d&O+1],L=L*r+M[d&(M[O]=M[P=d&P+A])+(M[P]=A)];return C.i=O,C.j=P,L})(r)}function m(v,w){return w.i=v.i,w.j=v.j,w.S=v.S.slice(),w}function g(v,w){var k=[],C=typeof v,S;if(w&&C=="object")for(S in v)try{k.push(g(v[S],w-1))}catch{}return k.length?k:C=="string"?v:v+"\0"}function x(v,w){for(var k=v+"",C,S=0;S<k.length;)w[d&S]=d&(C^=w[d&S]*19)+k.charCodeAt(S++);return b(w)}function y(){try{var v;return h&&(v=h.randomBytes)?v=v(r):(v=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(v)),b(v)}catch{var w=t.navigator,k=w&&w.plugins;return[+new Date,t,k,t.screen,b(n)]}}function b(v){return String.fromCharCode.apply(0,v)}if(x(s.random(),n),e.exports){e.exports=f;try{h=zK}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:pl,[],Math)})(zA);var BK=zA.exports,VK=RK,WK=DK,UK=AK,jK=OK,GK=FK,HK=PK,vl=BK;vl.alea=VK;vl.xor128=WK;vl.xorwow=UK;vl.xorshift7=jK;vl.xor4096=GK;vl.tychei=HK;var Ek=vl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BA{constructor(t,n,s,r,o){this.mean=t,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=Ek.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let t,n,s=!1;for(;!s;){let r,o,i;do r=2*this.random()-1,o=2*this.random()-1,i=r*r+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(t))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class KK{constructor(t=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=Ek.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XK(e,t=0,n=1,s,r){if(Wo(e),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const o=new BA(t,n,s,!1,r),i=_t(e,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const qK=W({randomNormal_:XK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YK(e,t=0,n=1,s="float32",r){Wo(e);const o=_t(e,s),i=new KK(t,n,null,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const hf=W({randomUniform_:YK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wd(e,t,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:e,stop:t,step:n,dtype:s};return V.runKernel(Gw,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QK(e){const n={input:_(e,"input","real")};return V.runKernel(Hw,n)}const Um=W({real_:QK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZK(e){const n={x:_(e,"x","reciprocal")};return V.runKernel(Gh,n)}const JK=W({reciprocal_:ZK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(e){const n={x:_(e,"x","relu")};return V.runKernel(Hh,n)}const Ho=W({relu_:t8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8(e){const n={x:_(e,"x","relu6")};return V.runKernel(Kh,n)}const VA=W({relu6_:e8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n8(e,t){const s={x:_(e,"x","reverse")},r={dims:t};return V.runKernel(Px,s,r)}const il=W({reverse_:n8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s8(e){const n={x:_(e,"x","round")};return V.runKernel(Xh,n)}const WA=W({round_:s8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(e){const n={x:_(e,"x","rsqrt","float32")};return V.runKernel(qh,n)}const UA=W({rsqrt_:r8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(e){const n={x:_(e,"x","selu")};return V.runKernel(Yh,n)}const jA=W({selu_:o8});function i8(e,t,n,s,r,o=[1,1],i="NHWC"){const a=_(e,"x","separableConv2d"),l=_(t,"depthwiseFilter","separableConv2d"),c=_(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),T(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];T(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=uk(u,l,s,r,i,o),g=sl(p,c,1,"valid",i);return d?j(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const GA=W({separableConv2d_:i8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a8(e){const n={x:_(e,"x","sign")};return V.runKernel(Jh,n)}const l8=W({sign_:a8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(e){const n={x:_(e,"x","sin","float32")};return V.runKernel(Qh,n)}const HA=W({sin_:c8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u8(e){const n={x:_(e,"x","sinh")};return V.runKernel(Zh,n)}const KA=W({sinh_:u8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(e,t,n){const s=_(e,"x","slice1d");return T(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),re(s,[t],[n])}const _k=W({slice1d_:d8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h8(e,t,n){const s=_(e,"x","slice2d");return T(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),re(s,t,n)}const XA=W({slice2d_:h8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8(e,t,n){const s=_(e,"x","slice3d");return T(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),re(s,t,n)}const Rk=W({slice3d_:f8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(e,t,n){const s=_(e,"x","slice4d");return T(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),re(s,t,n)}const jm=W({slice4d_:p8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(e,t=-1){const n=_(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const s={logits:n},r={dim:t};return V.runKernel(Wx,s,r)}const Dk=W({softmax_:m8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g8(e){T(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return V.runKernel(Ow,t)}const qA=W({fft_:g8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x8(e){T(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return V.runKernel(Mw,t)}const d1=W({ifft_:x8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8(e){const t=e.shape[e.shape.length-1],n=e.size/t;let s;if(t<=2){const r=j(e,[n,t]);s=d1(r)}else{const r=[n,2*(t-1)],o=j(Um(e),[n,t]),i=j(fk(e),[n,t]),a=il(re(o,[0,1],[n,t-2]),1),l=F(il(re(i,[0,1],[n,t-2]),1),kt(-1)),c=qn([o,a],1),u=qn([i,l],1),d=j(Dc(c,u),[r[0],r[1]]);s=d1(d)}if(s=Um(s),e.rank===3&&e.shape[0]!==0){const r=s,o=e.shape[0];s=j(s,[o,s.shape[0]/o,s.shape[1]]),r.dispose()}return s}const b8=W({irfft_:y8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8(e,t,n=0){const r={x:_(e,"x","split")},o={numOrSizeSplits:t,axis:n};return V.runKernel(Vx,r,o)}const Ns=W({split_:v8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(e,t){T(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const s=e.size/n;let r;if(t!=null&&t<n){const p=e.shape.map(g=>0),m=e.shape.map(g=>g);m[e.shape.length-1]=t,r=re(e,p,m),n=t}else if(t!=null&&t>n){const p=e.shape.map(m=>m);p[e.shape.length-1]=t-n,r=qn([e,Je(p)],e.shape.length-1),n=t}else r=e;const o=Lt(r),i=j(Dc(r,o),[s,n]),a=qA(i),l=Math.floor(n/2)+1,c=Um(a),u=fk(a),d=Ns(c,[l,n-l],c.shape.length-1),h=Ns(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,j(Dc(d[0],h[0]),f)}const k8=W({rfft_:w8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8(e,t){let n=_(e,"a","squaredDifference"),s=_(t,"b","squaredDifference");[n,s]=Oe(n,s),$t(n.shape,s.shape);const r={a:n,b:s},o={};return V.runKernel(sf,r,o)}const YA=W({squaredDifference_:C8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(e,t){const n=_(e,"x","squeeze","string_or_numeric");return j(n,ta(n.shape,t).newShape)}const ff=W({squeeze_:S8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(e,t=0){const n=mA(e,"tensors","stack","string_or_numeric");T(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&T(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:t};return V.runKernel(Ex,s,r)}const Lo=W({stack_:I8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $8(e,t=0){const s={x:_(e,"x","step")},r={alpha:t};return V.runKernel(cf,s,r)}const pf=W({step_:$8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8(e,t,n,s,r=0,o=0,i=0,a=0,l=0){const u={x:_(e,"x","stridedSlice","string_or_numeric")},d={begin:t,end:n,strides:s,beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return V.runKernel(Qw,u,d)}const N8=W({stridedSlice_:T8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E8(e){const n={x:_(e,"x","tan","float32")};return V.runKernel(of,n)}const _8=W({tan_:E8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(e,t){wD(e);const n=Kx(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Xx(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _a(e,t,n){if(wD(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Kx(e,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Xx(e,t,s,n)}function QA(e,t,n){const s=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(o+` update.rank < ${r}. `);if(e.length<s+(n.rank-r))throw new Error(o+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+e.length-s)throw new Error(o+` update.rank != ${r+e.length-s}`);for(let i=0;i<r;++i)if(n.shape[i]!==t.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${t.shape[i]}).`);for(let i=0;i<n.rank-r;++i)if(n.shape[i+r]!==e[i+s])throw new Error(o+` updates.shape[${i+r}] (${n.shape[i+r]}) != shape[${i+r}] (${e[i+r]})`)}function R8(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}QA(n,t,e)}function wl(e,t,n){const s=t.shape.length,r=s>1?t.shape[s-1]:1,o=n.length;let i=1;for(let d=r;d<o;++d)i*=n[d];const a=r<1?1:r,l=Y(t.shape)/a,c=[...yt(n.slice(0,r)),1],u=Y(n);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D8(e,t=1,n=!0){const s=_(e,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${t}`);const o={x:s},i={k:t,sorted:n},[a,l]=V.runKernel(Zw,o,i);return{values:a,indices:l}}const A8=W({topk_:D8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O8(e,t=0,n=1,s,r){if(Wo(e),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new BA(t,n,s,!0,r),i=_t(e,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const ZA=W({truncatedNormal_:O8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(e,t=0){const n=_(e,"x","unique","string_or_numeric");T(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:t},[o,i]=V.runKernel(tk,s,r);return{values:o,indices:i}}const P8=W({unique_:F8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8(e,t,n){const s=_(e,"x","unsortedSegmentSum"),r=_(t,"segmentIds","unsortedSegmentSum","int32");T(Ec(n),()=>"numSegments must be of dtype int");const o={x:s,segmentIds:r},i={numSegments:n};return V.runKernel(jx,o,i)}const JA=W({unsortedSegmentSum_:M8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L8(e,t=0){const n=_(e,"x","unstack","string_or_numeric");T(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:t};return V.runKernel(Ux,s,r)}const al=W({unstack_:L8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z8(e,t=!0,n,s){return V.makeVariable(e,t,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tO(e,t){const n=[];for(let o=0;o<t.length;o++)t[o]&&n.push(o);const s=_t(e,"int32"),r=_t([n.length,e.length],"int32");for(let o=0;o<n.length;o++){const i=s.indexToLoc(n[o]),a=o*e.length;r.values.set(i,a)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(e,t,n){const s=_(e,"x","transpose");if(t==null&&(t=s.shape.map((i,a)=>a).reverse()),T(s.rank===t.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${t}.`),t.forEach(i=>{T(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${t}`)}),s.rank<=1)return s.clone();const r={x:s},o={perm:t};return s.dtype==="complex64"?G(()=>{let i=Um(s),a=fk(s);return i=V.runKernel(oc,{x:i},o),a=V.runKernel(oc,{x:a},o),n&&(a=be(a)),Dc(i,a)}):V.runKernel(oc,r,o)}const Mt=W({transpose_:B8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(e,t){if(t==null)return e.shape.slice();if(Ht(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let s=0;s<e.shape.length;s++)t[s]==null&&e.shape[s]!=null?n.push(e.shape[s]):n.push(t[s]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(e,t,n,s){const r=_(e,"x","dropout");if(T(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),T(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof Ve?r.clone():r;const o=V8(r,n),i=1-t,a=xt(t0(et(hf(o,0,1,"float32",s),i)),i);return F(r,a)}const U8=W({dropout_:W8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j8(e,t,n,s,r,o="NHWC",i){let a=e;e.rank===3&&(a=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=j(t,[1,t.shape[0],t.shape[1],t.shape[2]])),T(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=o==="NHWC"?a.shape[3]:a.shape[1],u=o==="NHWC"?l.shape[3]:l.shape[1];T(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),T(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),ts("conv2dDerFilter",r,i);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,filterShape:n};return V.runKernel(Cw,d,h)}const Ak=W({conv2DBackpropFilter_:j8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ok(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return F(e,pf(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Fk(e,t){let n=t;const s=Ke(e.shape,t.shape);return s.length>0&&(n=mt(n,s)),j(n,e.shape)}function Pk(e,t,n,s){if(t==="linear")return e;if(t==="relu")return Ho(e);if(t==="elu")return Zx(e);if(t==="relu6")return VA(e);if(t==="prelu")return kk(e,n);if(t==="leakyrelu")return pk(e,s);if(t==="sigmoid")return su(e);throw new Error(`Unknown fused activation ${t}.`)}const Mk=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8({x:e,filter:t,strides:n,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",Mk(V.state.gradientDepth,l)===!1){T(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=sl(e,t,n,s,r,o,i);return a!=null&&(k=et(k,a)),Pk(k,l,c,u)}const d=_(e,"x","conv2d","float32"),h=_(t,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=j(d,[1,d.shape[0],d.shape[1],d.shape[2]])),T(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),ts("fused conv2d",s,i);const m=r==="NHWC"?f.shape[3]:f.shape[1];T(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),T(vn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const g=dn(f.shape,h.shape,n,o,s,i);let x;a!=null&&(x=_(a,"bias","fused conv2d"),[x]=Oe(x,d),r==="NHWC"?$t(g.outShape,x.shape):(T(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),T(x.shape.length===0||x.shape[0]===g.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let y;if(c!=null){const k=c.shape;if(T(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)T(k[0]===1||k[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${g.outChannels}).`);else if(k.length===3)try{$t(k,g.outShape)}catch{const S=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(S)}y=_(c,"prelu weights","fused conv2d")}const b=(k,C)=>{T(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[S,I,$,E]=C,A=Ok(k,$,l);T(el(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const L=lk(I.shape,A,S,n,s),O=Ak(I,A,S.shape,n,s),P=[L,O];if(E!=null){const M=Fk(E,A);P.push(M)}return P},v={x:f,filter:h,bias:x,preluActivationWeights:y},w={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?ol((C,S,I)=>{let $=V.runKernel(Mm,v,w);return I([S,C,$]),p&&($=j($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:b}})(f,h):ol((C,S,I,$)=>{let E=V.runKernel(Mm,v,w);return $([S,C,E,I]),p&&(E=j(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(f,h,x)}const H8=W({fusedConv2d_:G8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(e,t,n,s,r,o=[1,1],i){let a=e;e.rank===3&&(a=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:i,dilations:o,filterShape:n};return V.runKernel(_w,c,u)}const X8=W({depthwiseConv2dNativeBackpropFilter_:K8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q8(e,t,n,s,r,o=[1,1],i){let a=t,l=!1;t.rank===3&&(l=!0,a=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:i,dilations:o,inputShape:e},d=V.runKernel(Rw,c,u);return l?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Y8=W({depthwiseConv2dNativeBackpropInput_:q8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q8({a:e,b:t,transposeA:n=!1,transposeB:s=!1,bias:r,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(Mk(V.state.gradientDepth,o)===!1){let E=jt(e,t,n,s);return r!=null&&(E=et(E,r)),Pk(E,o,i,a)}let l=_(e,"a","fused matMul"),c=_(t,"b","fused matMul");[l,c]=Oe(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=Y(p),x=Y(m);T(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const b=$t(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),v=n?j(l,[g,u,h]):j(l,[g,h,u]),w=s?j(c,[x,f,d]):j(c,[x,d,f]);let k;r!=null&&(k=_(r,"bias","fused matMul"),[k]=Oe(k,l),$t(b,k.shape));let C;i!=null&&(C=_(i,"prelu weights","fused matMul"));const S=(E,A)=>{const[L,O,P,M]=A,U=Ok(j(E,P.shape),P,o);let R,z;if(!n&&!s?(R=jt(U,O,!1,!0),z=jt(L,U,!0,!1)):!n&&s?(R=jt(U,O,!1,!1),z=jt(U,L,!0,!1)):n&&!s?(R=jt(O,U,!1,!0),z=jt(L,U,!1,!1)):(R=jt(O,U,!0,!0),z=jt(U,L,!0,!0)),r!=null){const H=Fk(M,U);return[R,z,H]}else return[R,z]},I={a:v,b:w,bias:k,preluActivationWeights:C},$={transposeA:n,transposeB:s,activation:o,leakyreluAlpha:a};return r==null?ol((A,L,O)=>{const P=V.runKernel(Pm,I,$);return O([A,L,P]),{value:j(P,b),gradFunc:S}})(v,w):ol((A,L,O,P)=>{const M=V.runKernel(Pm,I,$);return P([A,L,M,O]),{value:j(M,b),gradFunc:S}})(v,w,k)}const E2=W({fusedMatMul_:Q8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(e,t,n,s,r="bilinear",o=0){const i=_(e,"image","cropAndResize"),a=_(t,"boxes","cropAndResize","float32"),l=_(n,"boxInd","cropAndResize","int32"),c=a.shape[0];T(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),T(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),T(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),T(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),T(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:i,boxes:a,boxInd:l},d={method:r,extrapolationValue:o,cropSize:s};return V.runKernel(Tw,u,d)}const J8=W({cropAndResize_:Z8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tX(e){const t=_(e,"image","flipLeftRight","float32");T(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return V.runKernel(Pw,n,{})}const eX=W({flipLeftRight_:tX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nX(e){const t=_(e,"image","grayscaleToRGB"),n=t.rank-1,s=t.shape[n];T(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),T(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(t.rank);return r.fill(1,0,n),r[n]=3,xr(t,r)}const sX=W({grayscaleToRGB_:nX});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rX(e){const t=_(e,"image","RGBToGrayscale"),n=t.rank-1,s=t.shape[n];T(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),T(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=t.dtype,o=ct(t,"float32"),i=cs([.2989,.587,.114]);let a;switch(t.rank){case 2:a=Eu("ij,j->i",o,i);break;case 3:a=Eu("ijk,k->ij",o,i);break;case 4:a=Eu("ijkl,l->ijk",o,i);break;case 5:a=Eu("ijklm,m->ijkl",o,i);break;case 6:a=Eu("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=Gn(a,-1),ct(a,r)}const oX=W({rgbToGrayscale_:rX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iX(e,t,n=0,s=.5){const r=_(e,"image","rotateWithOffset","float32");T(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const o={image:r},i={radians:t,fillValue:n,center:s};return V.runKernel(ek,o,i)}const aX=W({rotateWithOffset_:iX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ou(e,t,n,s,r,o){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=e.shape[0];return n=Math.min(n,i),T(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),T(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),T(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),T(t.rank===1,()=>"scores must be a 1D tensor"),T(t.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${t.shape[0]}`),T(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=_(e,"boxes","nonMaxSuppression","float32"),i=_(t,"scores","nonMaxSuppression","float32"),a=ou(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return V.runKernel(Ww,{boxes:o,scores:i},l)}const cX=W({nonMaxSuppression_:lX});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uX(e,t,n){const s=dX(e,t,n),r=s<0?-(s+1):s;e.splice(r,0,t)}function dX(e,t,n){return fX(e,t,n||hX)}function hX(e,t){return e>t?1:e<t?-1:0}function fX(e,t,n){let s=0,r=e.length,o=0,i=!1;for(;s<r;){o=s+(r-s>>>1);const a=n(t,e[o]);a>0?s=o+1:(r=o,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lk(e,t,n,s,r){return Vk(e,t,n,s,r,0)}function zk(e,t,n,s,r,o){return Vk(e,t,n,s,r,0,!1,o,!0)}function Bk(e,t,n,s,r,o){return Vk(e,t,n,s,r,o,!0)}function Vk(e,t,n,s,r,o,i=!1,a=!1,l=!1){const c=[];for(let g=0;g<t.length;g++)t[g]>r&&c.push({score:t[g],boxIndex:g,suppressBeginIndex:0});c.sort(_2);const u=o>0?-.5/o:0,d=[],h=[];for(;d.length<n&&c.length>0;){const g=c.pop(),{score:x,boxIndex:y,suppressBeginIndex:b}=g;if(x<r)break;let v=!1;for(let w=d.length-1;w>=b;--w){const k=pX(e,y,d[w]);if(k>=s){v=!0;break}if(g.score=g.score*mX(s,u,k),g.score<=r)break}g.suppressBeginIndex=d.length,v||(g.score===x?(d.push(y),h.push(g.score)):g.score>r&&uX(c,g,_2))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function pX(e,t,n){const s=e.subarray(t*4,t*4+4),r=e.subarray(n*4,n*4+4),o=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),f=(a-o)*(l-i),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const m=Math.max(o,c),g=Math.max(i,u),x=Math.min(a,d),y=Math.min(l,h),b=Math.max(x-m,0)*Math.max(y-g,0);return b/(f+p-b)}function mX(e,t,n){const s=Math.exp(t*n*n);return n<=e?s:0}function _2(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function gX(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=_(e,"boxes","nonMaxSuppressionAsync"),i=_(t,"scores","nonMaxSuppressionAsync"),a=ou(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:d}=Lk(c,u,n,s,r);return o!==e&&o.dispose(),i!==t&&i.dispose(),cs(d,"int32")}const xX=gX;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yX(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=_(e,"boxes","nonMaxSuppression"),a=_(t,"scores","nonMaxSuppression"),l=ou(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const c={boxes:i,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o},d=V.runKernel(jw,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const bX=W({nonMaxSuppressionWithScore_:yX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vX(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=_(e,"boxes","nonMaxSuppressionAsync"),a=_(t,"scores","nonMaxSuppressionAsync"),l=ou(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const c=await Promise.all([i.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=Bk(u,d,n,s,r,o);return i!==e&&i.dispose(),a!==t&&a.dispose(),{selectedIndices:cs(h,"int32"),selectedScores:cs(f)}}const wX=vX;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=_(e,"boxes","nonMaxSuppression"),a=_(t,"scores","nonMaxSuppression"),l=ou(i,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:i,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:o},p=V.runKernel(Uw,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const CX=W({nonMaxSuppressionPadded_:kX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function SX(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=_(e,"boxes","nonMaxSuppressionAsync"),a=_(t,"scores","nonMaxSuppressionAsync"),l=ou(i,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:m}=zk(h,f,c,u,d,o);return i!==e&&i.dispose(),a!==t&&a.dispose(),{selectedIndices:cs(p,"int32"),validOutputs:kt(m,"int32")}}const IX=SX;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(e,t,n=!1,s=!1){const r=_(e,"images","resizeBilinear");T(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),T(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),T(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=j(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:t},c=V.runKernel(Fx,a,l);return i?j(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const eO=W({resizeBilinear_:$X});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TX(e,t,n=!1,s=!1){const r=_(e,"images","resizeNearestNeighbor");T(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),T(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),T(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),T(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=j(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:t},c=V.runKernel(Ox,a,l);return i?j(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const nO=W({resizeNearestNeighbor_:TX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NX(e,t="binary",n=!1,s=.5){const r=_(e,"image","threshold"),o=.2989,i=.587,a=.114,l=r.shape[0]*r.shape[1];let c=F(cs([s]),255),u,d,h,f;if(T(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),T(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),T(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),T(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),r.shape[2]===3){[u,d,h]=Ns(r,[1,1,1],-1);const g=F(u,o),x=F(d,i),y=F(h,a);f=et(et(g,x),y)}else f=e;if(t==="otsu"){const g=N5(ct(WA(f),"int32"),gA([]),256);c=EX(g,l)}const p=n?ru(f,c):Os(f,c);return ct(F(p,255),"int32")}function EX(e,t){let n=cs([-1]),s=cs([0]),r=cs([0]),o,i,a,l,c,u;for(let d=0;d<e.size-1;d++){o=re(e,0,d+1),i=re(e,d+1),c=xt(mt(o),t),u=xt(mt(i),t);const h=mt(F(o,Wd(0,o.size)));a=xt(h,mt(o));const f=Qx(i.shape,o.size),p=et(Wd(0,i.size),f),m=F(i,p);l=xt(mt(m),mt(i));const g=ft(a,l),x=ft(a,l),y=F(c,u);r=F(F(y,g),x);const b=Os(r,s);s=On(b,r,s),n=On(b,cs([d]),n)}return n}const _X=W({threshold_:NX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RX(e,t,n="nearest",s="constant",r=0,o){const i=_(e,"image","transform","float32"),a=_(t,"transforms","transform","float32");T(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:o};return V.runKernel(Jw,l,c)}const DX=W({transform_:RX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AX(e,t,n){const s=_(e,"a","bandPart");T(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[o,i]=s.shape.slice(-2);let a,l;typeof t=="number"?(T(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),T(t<=o,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${o}).`),a=_(t<0?o:t,"numLower","bandPart")):(T(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=On(Wm(t,0),o,Oc(t,o))),typeof n=="number"?(T(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),T(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=_(n<0?i:n,"numUpper","bandPart")):(T(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=On(Wm(n,0),i,Oc(n,i)));const c=j(Wd(0,o,1,"int32"),[-1,1]),u=Wd(0,i,1,"int32"),d=ft(c,u),h=Mo(ru(d,a),bl(d,be(l))),f=Je([o,i],s.dtype);return j(Lo(al(j(s,[-1,o,i])).map(p=>On(h,p,f))),r)}const OX=W({bandPart_:AX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(e){let t;if(Array.isArray(e)){t=!1,T(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=e[0].shape[0];for(let o=1;o<e.length;++o)T(e[o].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[o].shape[0]} vs. ${r})`)}else t=!0,e=Ns(e,e.shape[0],0).map(r=>ff(r,[0]));T(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],s=e;for(let r=0;r<e.length;++r)n.push(V.tidy(()=>{let o=s[r];if(r>0)for(let i=0;i<r;++i){const a=F(mt(F(n[i],o)),n[i]);o=ft(o,a)}return xt(o,Jx(o,"euclidean"))}));return t?Lo(n,0):n}const PX=W({gramSchmidt_:FX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MX(e,t=!1){if(T(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return R2(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((l,c)=>l*c),s=al(j(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],o=[];s.forEach(l=>{const[c,u]=R2(l,t);r.push(c),o.push(u)});const i=j(Lo(r,0),e.shape),a=j(Lo(o,0),e.shape);return[i,a]}}function R2(e,t=!1){return V.tidy(()=>{T(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],s=e.shape[1];let r=FA(n),o=za(e);const i=_a([[1]],[1,1]);let a=za(i);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=o,d=a,h=r;[a,o,r]=V.tidy(()=>{const f=re(o,[c,c],[n-c,1]),p=Jx(f),m=re(o,[c,c],[1,1]),g=On(Os(m,0),_a([[-1]]),_a([[1]])),x=ft(m,F(g,p)),y=xt(f,x);y.shape[0]===1?a=za(i):a=qn([i,re(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const b=be(xt(jt(g,x),p)),v=re(o,[c,0],[n-c,s]),w=F(b,a),k=Mt(a);if(c===0)o=ft(v,jt(w,jt(k,v)));else{const I=ft(v,jt(w,jt(k,v)));o=qn([re(o,[0,0],[c,s]),I],0)}const C=Mt(w),S=re(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=ft(S,jt(jt(S,a),C));else{const I=ft(S,jt(jt(S,a),C));r=qn([re(r,[0,0],[n,c]),I],1)}return[a,o,r]}),At([u,d,h])}return!t&&n>s&&(r=re(r,[0,0],[n,s]),o=re(o,[0,0],[s,s])),[r,o]})}const LX=W({qr_:MX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Kn;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Kn||(Kn={}));function zX(e,t,n=Kn.SUM_BY_NONZERO_WEIGHTS){const s=_(e,"losses","computeWeightedLoss");let r=null;t!=null&&(r=_(t,"weights","computeWeightedLoss"));const o=r==null?s:F(s,r);if(n===Kn.NONE)return o;if(n===Kn.SUM)return mt(o);if(n===Kn.MEAN){if(r==null)return Re(o);{const i=s.size/r.size,a=xt(mt(o),mt(r));return i>1?xt(a,kt(i)):a}}if(n===Kn.SUM_BY_NONZERO_WEIGHTS){if(r==null)return xt(mt(o),kt(s.size));{const i=F(r,Go(s.shape)),a=ct(mt(Vd(i,kt(0))),"float32");return xt(mt(o),a)}}throw Error(`Unknown reduction: ${n}`)}const Ko=W({computeWeightedLoss_:zX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BX(e,t,n,s=Kn.SUM_BY_NONZERO_WEIGHTS){const r=_(e,"labels","absoluteDifference"),o=_(t,"predictions","absoluteDifference");let i=null;n!=null&&(i=_(n,"weights","absoluteDifference")),nr(r.shape,o.shape,"Error in absoluteDifference: ");const a=Qe(ft(r,o));return Ko(a,i,s)}const VX=W({absoluteDifference_:BX});function WX(e,t,n,s,r=Kn.SUM_BY_NONZERO_WEIGHTS){const o=_(e,"labels","cosineDistance"),i=_(t,"predictions","cosineDistance");let a=null;s!=null&&(a=_(s,"weights","cosineDistance")),nr(o.shape,i.shape,"Error in cosineDistance: ");const l=kt(1),c=ft(l,mt(F(o,i),n,!0));return Ko(c,a,r)}const UX=W({cosineDistance_:WX});function jX(e,t,n,s=Kn.SUM_BY_NONZERO_WEIGHTS){let r=_(e,"labels","hingeLoss");const o=_(t,"predictions","hingeLoss");let i=null;n!=null&&(i=_(n,"weights","hingeLoss")),nr(r.shape,o.shape,"Error in hingeLoss: ");const a=kt(1);r=ft(F(kt(2),r),a);const l=Ho(ft(a,F(r,o)));return Ko(l,i,s)}const GX=W({hingeLoss_:jX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HX(e,t,n,s=1,r=Kn.SUM_BY_NONZERO_WEIGHTS){const o=_(e,"labels","huberLoss"),i=_(t,"predictions","huberLoss");let a=null;n!=null&&(a=_(n,"weights","huberLoss")),nr(o.shape,i.shape,"Error in huberLoss: ");const l=kt(s),c=Qe(ft(i,o)),u=Oc(c,l),d=ft(c,u),h=et(F(kt(.5),oe(u)),F(l,d));return Ko(h,a,r)}const KX=W({huberLoss_:HX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XX(e,t,n,s=1e-7,r=Kn.SUM_BY_NONZERO_WEIGHTS){const o=_(e,"labels","logLoss"),i=_(t,"predictions","logLoss");let a=null;n!=null&&(a=_(n,"weights","logLoss")),nr(o.shape,i.shape,"Error in logLoss: ");const l=kt(1),c=kt(s),u=be(F(o,tr(et(i,c)))),d=F(ft(l,o),tr(et(ft(l,i),c))),h=ft(u,d);return Ko(h,a,r)}const qX=W({logLoss_:XX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YX(e,t,n,s=Kn.SUM_BY_NONZERO_WEIGHTS){const r=_(e,"labels","meanSquaredError"),o=_(t,"predictions","meanSquaredError");let i=null;n!=null&&(i=_(n,"weights","meanSquaredError")),nr(r.shape,o.shape,"Error in meanSquaredError: ");const a=YA(r,o);return Ko(a,i,s)}const QX=W({meanSquaredError_:YX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX(e,t){const n=_(e,"labels","sigmoidCrossEntropyWithLogits"),s=_(t,"logits","sigmoidCrossEntropyWithLogits");nr(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Ho(s),o=F(s,n),i=mk(Rs(be(Qe(s))));return et(ft(r,o),i)}function JX(e,t,n,s=0,r=Kn.SUM_BY_NONZERO_WEIGHTS){let o=_(e,"multiClassLabels","sigmoidCrossEntropy");const i=_(t,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=_(n,"weights","sigmoidCrossEntropy")),nr(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=kt(s),u=kt(1),d=kt(.5);o=et(F(o,ft(u,c)),F(d,c))}const l=ZX(o,i);return Ko(l,a,r)}const tq=W({sigmoidCrossEntropy_:JX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eq(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return ol((r,o,i)=>{const l=gk(o,[n],!0),c=ft(ct(o,"float32"),l);i([r,c]);const u=be(F(c,r));return{value:mt(u,[n]),gradFunc:(f,p)=>{const[m,g]=p,x=Fe(f.shape,[n]);return[F(j(f,x),ft(ct(m,"float32"),Rs(g))),F(j(f,x),ft(Rs(g),ct(m,"float32")))]}}})(e,t)}function nq(e,t,n,s=0,r=Kn.SUM_BY_NONZERO_WEIGHTS){let o=_(e,"onehotLabels","softmaxCrossEntropy");const i=_(t,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=_(n,"weights","softmaxCrossEntropy")),nr(o.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const c=kt(s),u=kt(1),d=kt(o.shape[1]);o=et(F(o,ft(u,c)),xt(c,d))}const l=eq(o,i);return Ko(l,a,r)}const sq=W({softmaxCrossEntropy_:nq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Io={flipLeftRight:eX,grayscaleToRGB:sX,resizeNearestNeighbor:nO,resizeBilinear:eO,rgbToGrayscale:oX,rotateWithOffset:aX,cropAndResize:J8,nonMaxSuppression:cX,nonMaxSuppressionAsync:xX,nonMaxSuppressionWithScore:bX,nonMaxSuppressionWithScoreAsync:wX,nonMaxSuppressionPadded:CX,nonMaxSuppressionPaddedAsync:IX,threshold:_X,transform:DX},rq={bandPart:OX,gramSchmidt:PX,qr:LX},Gm={absoluteDifference:VX,computeWeightedLoss:Ko,cosineDistance:UX,hingeLoss:GX,huberLoss:KX,logLoss:qX,meanSquaredError:QX,sigmoidCrossEntropy:tq,softmaxCrossEntropy:sq};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oq=new Map,iq=new Map;class iu{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class Us{constructor(){this.classNameMap={}}static getMap(){return Us.instance==null&&(Us.instance=new Us),Us.instance}static register(t){Us.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function tt(e,t,n){T(e.className!=null,()=>"Class being registered does not have the static className property defined."),T(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),T(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const s=n,r=t+">"+s;return Us.register(e),oq.set(r,e),iq.set(e,r),e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oa extends iu{minimize(t,n=!1,s){const{value:r,grads:o}=this.computeGradients(t,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return At(o),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return q6(t,n)}dispose(){this.iterations_!=null&&At(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:kt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(oa,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sO extends oa{static get className(){return"Adadelta"}constructor(t,n,s=null){super(),this.learningRate=t,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=V.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:G(()=>Lt(o).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:G(()=>Lt(o).variable(i))});const a=Array.isArray(t)?t[r].tensor:t[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;G(()=>{const u=et(F(l,this.rho),F(oe(a),1-this.rho)),d=F(xt(bn(et(c,this.epsilon)),bn(et(l,this.epsilon))),a),h=et(F(c,this.rho),F(oe(d),1-this.rho));l.assign(u),c.assign(h);const f=et(F(d,-this.learningRate),o);o.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(At(this.accumulatedGrads.map(t=>t.variable)),At(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,s=!1;this.accumulatedGrads=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rO extends oa{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=V.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:G(()=>Qx(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(t)?t[r].tensor:t[s];if(i==null)return;const a=this.accumulatedGrads[r].variable;G(()=>{const l=et(a,oe(i));a.assign(l);const c=et(F(xt(i,bn(et(l,V.backend.epsilon()))),-this.learningRate),o);o.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&At(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oO extends oa{static get className(){return"Adam"}constructor(t,n,s,r=null){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],G(()=>{this.accBeta1=kt(n).variable(),this.accBeta2=kt(s).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);G(()=>{const s=ft(1,this.accBeta1),r=ft(1,this.accBeta2);n.forEach((o,i)=>{const a=V.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:G(()=>Lt(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:G(()=>Lt(a).variable(l))});const c=Array.isArray(t)?t[i].tensor:t[o];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,h=et(F(u,this.beta1),F(c,1-this.beta1)),f=et(F(d,this.beta2),F(oe(c),1-this.beta2)),p=xt(h,s),m=xt(f,r);u.assign(h),d.assign(f);const g=et(F(xt(p,et(bn(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(F(this.accBeta1,this.beta1)),this.accBeta2.assign(F(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&At(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&At(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),G(()=>{this.accBeta1.assign(rl(this.beta1,this.iterations_+1)),this.accBeta2.assign(rl(this.beta2,this.iterations_+1))});const n=t.length/2,s=!1;this.accumulatedFirstMoment=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iO extends oa{static get className(){return"Adamax"}constructor(t,n,s,r=null,o=0){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],G(()=>{this.iteration=kt(0).variable(),this.accBeta1=kt(n).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);G(()=>{const s=ft(1,this.accBeta1),r=xt(-this.learningRate,et(F(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=V.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:Lt(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:Lt(a).variable(l)});const c=Array.isArray(t)?t[i].tensor:t[o];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,h=et(F(u,this.beta1),F(c,1-this.beta1)),f=F(d,this.beta2),p=Qe(c),m=ra(f,p);u.assign(h),d.assign(m);const g=et(F(xt(r,s),xt(h,et(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(et(this.iteration,1)),this.accBeta1.assign(F(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&At(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&At(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wk extends oa{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=Array.isArray(t)?t[r].tensor:t[s];if(o==null)return;const i=V.registeredVariables[s];G(()=>{const a=et(F(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=Qr(kt(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aO extends Wk{static get className(){return"Momentum"}constructor(t,n,s=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=kt(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=V.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:G(()=>Lt(o).variable(!1))});const i=this.accumulations[r].variable,a=Array.isArray(t)?t[r].tensor:t[s];a!=null&&G(()=>{let l;const c=et(F(this.m,i),a);this.useNesterov?l=et(F(this.c,et(a,F(c,this.m))),o):l=et(F(this.c,c),o),i.assign(c),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&At(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lO extends oa{static get className(){return"RMSProp"}constructor(t,n=.9,s=0,r=null,o=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,r==null&&(this.epsilon=V.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=V.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:G(()=>Lt(o).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:G(()=>Lt(o).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:G(()=>Lt(o).variable(i))});const a=Array.isArray(t)?t[r].tensor:t[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;G(()=>{const u=et(F(l,this.decay),F(oe(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=et(F(d,this.decay),F(a,1-this.decay)),f=xt(F(a,this.learningRate),bn(ft(u,et(oe(h),this.epsilon)))),p=et(F(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const m=ft(o,p);o.assign(m)}else{const d=et(F(l,this.decay),F(oe(a),1-this.decay)),h=et(F(c,this.momentum),xt(F(a,this.learningRate),bn(et(d,this.epsilon))));l.assign(d),c.assign(h);const f=ft(o,h);o.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&At(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&At(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&At(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,s=!1;this.accumulatedMeanSquares=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq=[sO,rO,oO,iO,aO,lO,Wk];function lq(){for(const e of aq)tt(e)}function Uk(e,t){const n=e.shape.length,s=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[s-1]} vs. ${n}`);if(Y(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const r=t.shape,o=r[r.length-1];let i=1;for(let d=0;d<r.length-1;++d)i*=r[d];const a=e.shape,l=r.slice();l.pop();let c=1;for(let d=o;d<n;++d)c*=a[d],l.push(a[d]);const u=[...yt(e.shape).map(d=>d/c),1].slice(0,o);return[l,i,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h1=-2,cq=-1;function jk(e,t,n){const s=e.shape.length;T(s===t.length,()=>`Error in slice${s}D: Length of begin ${t} must match the rank of the array (${s}).`),T(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)T(t[r]+n[r]<=e.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${t[r]+n[r]}) would overflow input.shape[${r}] (${e.shape[r]})`)}function uq(e){const t=[];let n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function Gk(e,t,n){const s=[];for(let r=0;r<e.length;r++)s[r]=Math.ceil((t[r]-e[r])/n[r]);return s}function cO(e,t,n,s){const r=[...e];for(let o=r.length;o<s.length;o++)r.push(1);for(let o=0;o<n;o++)o===0?r[t]=1:(r.splice(t,0,1),r.pop());return r}function uO(e,t,n){return n<=e?n:n-(t-1)}function dO(e,t){const n=[];for(let s=0;s<e;s++)n.push(t+s);return n}function dq(e,t,n,s,r,o,i,a,l){const c=e.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(t.length&&n>0){const f=t[0],p=n+1;u=hO(i,f,p,s,e),d=fO(a,f,p,r,e),h=cO(o,f,p,e)}else for(let f=0;f<c;f++)u[f]=mO(i,s,o,e,f,l),d[f]=gO(a,r,o,e,f,l),h[f]=pO(o,f,l);return{begin:u,end:d,strides:h}}function hO(e,t,n,s,r){const o=[...r],i=dO(n,t);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=uO(t,n,a);let c=s[l];e&1<<l&&(c=0),o[a]=c}return o}function fO(e,t,n,s,r){const o=[...r],i=dO(n,t);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=uO(t,n,a);let c=s[l];e&1<<l&&(c=Number.MAX_SAFE_INTEGER),o[a]=c}for(let a=0;a<o.length;a++){const l=r[a];o[a]<0&&(o[a]+=l),o[a]=Qa(0,o[a],r[a])}return o}function pO(e,t,n){let s=e[t];return(n&1<<t||s==null)&&(s=1),s}function mO(e,t,n,s,r,o){let i=t[r];const a=n[r]||1;(e&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=Qa(0,i,l-1),i}function gO(e,t,n,s,r,o){let i=t[r];const a=n[r]||1;(e&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),a>0?i=Qa(0,i,l):i=Qa(-1,i,l-1),i}function Hk(e,t,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function Kk(e,t){let n=e.length>0?e[e.length-1]:1;for(let s=0;s<e.length-1;s++)n+=e[s]*t[s];return n}function e0(e,t,n){let s;const r=e.shape.length;typeof t=="number"?s=[t,...new Array(r-1).fill(0)]:t.length<r?s=t.concat(new Array(r-t.length).fill(0)):s=t.slice(),s.forEach(i=>{T(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(r).fill(-1):typeof n=="number"?o=[n,...new Array(r-1).fill(-1)]:n.length<r?o=n.concat(new Array(r-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(T(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),e.shape[a]-s[a])),[s,o]}function Xk(e,t,n,s,r,o,i,a,l){let c;if(s==null?(c=new Array(t.length),c.fill(1)):c=s,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)u&&1<<b&a&&d.numAddAxisAfterEllipsis++,1<<b&i&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};hq(d,h);let f=!0,p=!0,m=!0;const g=[],x=[];for(let b=0;b<e.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const v=!!(h.shrinkAxisMask&1<<b),w=e[b];if(w===-1){g.push(v?1:-1);continue}const k=[h.beginMask&1<<b,h.endMask&1<<b],C=[h.strides[b]>0?0:-1,h.strides[b]>0?w:w-1];if(v&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[b]===1;const S=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(v){const A=h.begin[b]<0?w+h.begin[b]:h.begin[b];if(h.begin[b]=A,h.end[b]=h.begin[b]+1,A<0||A>=w)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=D2(h.begin[b],0,h.strides[b],w,k,C),h.end[b]=D2(h.end[b],1,h.strides[b],w,k,C);const E=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===w;f=f&&E,p=p&&(b===0&&h.strides[b]===1||E)}else f=f&&h.strides[b]===1&&S,p=p&&(b===0&&h.strides[b]===1||S);let I,$=!1;if(h.beginValid&&h.endValid?(I=h.end[b]-h.begin[b],$=!0):v?(I=1,$=!0):S&&w>=0&&(h.strides[b]<0?I=-w:I=w,$=!0),$){let E;I===0||I<0!=h.strides[b]<0?E=0:E=Math.trunc(I/h.strides[b])+(I%h.strides[b]!==0?1:0),g.push(E)}else g.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const v=h.finalShapeGatherIndices[b];v>=0?x.push(g[v]):v===h1&&x.push(1)}return{finalShapeSparse:x.filter((b,v)=>h.finalShapeGatherIndices[v]!==h1),finalShape:x,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function hq(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let s=0;s<e.dims;s++)if(1<<s&e.ellipsisMask){const r=Math.min(t.dims-(e.dims-s)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<r;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&e.newAxisMask)t.finalShapeGatherIndices.push(h1),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[s]),e.end!=null&&(t.end[n]=e.end[s]),t.strides[n]=e.strides[s],e.beginMask&1<<s&&(t.beginMask|=1<<n),e.endMask&1<<s&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<s?(t.finalShapeGatherIndices.push(cq),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(s)),t.inputShapeGatherIndicesSparse[n]=s,n++}}function D2(e,t,n,s,r,o){if(r[t])return n>0?o[t]:o[t+1&1];{const i=e<0?s+e:e;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const fq=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:jk,computeFlatOffset:Kk,computeOutShape:Gk,getNormalizedAxes:dq,isSliceContinous:Hk,maskToAxes:uq,parseSliceParams:e0,sliceInfo:Xk,startForAxis:mO,startIndicesWithElidedDims:hO,stopForAxis:gO,stopIndicesWithElidedDims:fO,stridesForAxis:pO,stridesWithElidedDims:cO},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pq{static sgd(t){return new Wk(t)}static momentum(t,n,s=!1){return new aO(t,n,s)}static rmsprop(t,n=.9,s=0,r=null,o=!1){return new lO(t,n,s,r,o)}static adam(t=.001,n=.9,s=.999,r=null){return new oO(t,n,s,r)}static adadelta(t=.001,n=.95,s=null){return new sO(t,n,s)}static adamax(t=.002,n=.9,s=.999,r=null,o=0){return new iO(t,n,s,r,o)}static adagrad(t,n=.1){return new rO(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bo=pq;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mq=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e();function xO(){return new Promise(e=>mq(()=>e()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qk(e,t){const n=e[0].length;e.forEach((r,o)=>{T(r.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),T(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=e[0];e.forEach((r,o)=>{for(let i=0;i<n;i++)T(i===t||r[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function Zr(e,t){const n=e[0].slice();for(let s=1;s<e.length;s++)n[t]+=e[s][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gr;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(gr||(gr={}));function yO(e,t,n){let s=new Array;if(n==null&&t==null)return s;if(t==null)for(;s.length<e+n.length;)s.push(-1);else s=t.slice();if(n==null)return s;if(e+n.length!==s.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const o=n[r],i=s[s.length-n.length+r],a=s[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${r+e}] = ${o} but shape[${r+e}] = ${a}`)}else s[i]=o}return s}function bO(e){const t={FIRST_DIM_SIZE:gr.FIRST_DIM_SIZE,VALUE_ROWIDS:gr.VALUE_ROWIDS,ROW_LENGTHS:gr.ROW_LENGTHS,ROW_SPLITS:gr.ROW_SPLITS,ROW_LIMITS:gr.ROW_LIMITS,ROW_STARTS:gr.ROW_STARTS},n=[];for(const s of e)if(s in t)n.push(t[s]);else break;return n}function vO(e){return e.length===0?0:e[0]===gr.FIRST_DIM_SIZE?e.length-1:e.length}function wO(e,t){if(e==null||t==null)return;const n=e.length,s=t.length;if(n>=s)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const o=e[r],i=t[r+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${r-e.length}] = ${o} but ragged tensor input.flatValues.shape[${r-e.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yk=30;function n0(e){return e<=Yk?e:qb(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qk(e,t,n){const s=n*(typeof e=="number"?e:e[0]),r=t*(typeof e=="number"?e:e[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mf(e,t,n,s=!0){let r=[];if(s)r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const o=t.length;for(let i=0;i<o;++i)r=r.concat([e[i+1]/t[i],t[i]]);r=r.concat(e.slice(o+1))}return r}function gf(e,t,n=!0){const s=[];if(n){s.push(t);for(let r=t+1;r<e;++r)r<=2*t?(s.push(r),s.push(r-(t+1))):s.push(r)}else{const r=[],o=[];for(let i=1;i<e;++i)i>=t*2+1||i%2===1?o.push(i):r.push(i);s.push(...r),s.push(0),s.push(...o)}return s}function xf(e,t,n,s=!0){const r=[];s?r.push(e[0]/n):r.push(e[0]*n);for(let o=1;o<e.length;++o)o<=t.length?s?r.push(t[o-1]*e[o]):r.push(e[o]/t[o-1]):r.push(e[o]);return r}function Zk(e,t){const n=[0];for(let s=0;s<t;++s)n.push(e[s][0]);return n}function Jk(e,t,n){const s=e.slice(0,1);for(let r=0;r<n;++r)s.push(e[r+1]-t[r][0]-t[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s0=1.7580993408473768,r0=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tC=.3275911,eC=.254829592,nC=-.284496736,sC=1.421413741,rC=-1.453152027,oC=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zo(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let s=0;s<n.length;s+=2)n[s]=e[s/2],n[s+1]=t[s/2];return n}function kO(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let s=0;s<e.length;s+=2)t[s/2]=e[s],n[s/2]=e[s+1];return{real:t,imag:n}}function CO(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let r=0;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],s[Math.floor(r/4)]=e[r+1];return{real:n,imag:s}}function SO(e){const t=Math.floor(e.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let r=2;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],s[Math.floor(r/4)]=e[r+1];return{real:n,imag:s}}function iC(e,t){const n=e[t*2],s=e[t*2+1];return{real:n,imag:s}}function IO(e,t,n,s){e[s*2]=t,e[s*2+1]=n}function $O(e,t){const n=new Float32Array(e/2),s=new Float32Array(e/2);for(let r=0;r<Math.ceil(e/2);r++){const o=(t?2:-2)*Math.PI*(r/e);n[r]=Math.cos(o),s[r]=Math.sin(o)}return{real:n,imag:s}}function TO(e,t,n){const s=(n?2:-2)*Math.PI*(e/t),r=Math.cos(s),o=Math.sin(s);return{real:r,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gy="->",gq=/->/g,A2=",",O2="...";function aC(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(gq,"").length)/gy.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${gy}").`);const[s,r]=e.split(gy);T(s.indexOf(O2)===-1,()=>`The ellipsis notation ("${O2}") is not supported yet.`);const o=s.split(A2),i=o.length;if(t!==i)throw new Error(`Expected ${i} input tensors, received ${t}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const f=r[h];if(!o.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<s.length;++h){const f=s[h];a.indexOf(f)===-1&&f!==A2&&a.push(f)}const l=new Array(o.length);for(let h=0;h<i;++h){if(new Set(o[h].split("")).size!==o[h].length)throw new Error(`Found duplicate axes in input component ${o[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<o[h].length;++f)l[h].push(a.indexOf(o[h][f]))}const c=a.length,u=r.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function lC(e,t){let n=new Array(e);n.fill(-1);for(let r=0;r<t.length;++r)n[t[r]]=r;const s=[];for(let r=0;r<e;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function cC(e,t,n){const s=new Array(e);for(let r=0;r<n.length;++r){const o=n[r].shape;for(let i=0;i<t[r].length;++i)s[t[r][i]]===void 0?s[t[r][i]]=o[i]:T(s[t[r][i]]===o[i],()=>`Expected dimension ${s[t[r][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function uC(e,t){const n=e,s=[];let r=0;e.length===0&&n.push(-1),r=e.length+1;for(let i=0;i<r;++i)s.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=xq(t,a);for(const c of l)o.indexOf(c)===-1&&(s[i].push(c),o.push(c))}return{path:n,steps:s}}function dC(e){return e.every((t,n)=>t===n)}function xq(e,t){const n=[];for(let s=0;s<e.length;++s)(e[s].length===0||e[s].indexOf(t)!==-1||t===-1)&&n.push(s);return n}function hC(e,t,n=0){let s=[];if(typeof t=="number")T(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),s=new Array(t).fill(e.shape[n]/t);else{const r=t.reduce((i,a)=>(a===-1&&(i+=1),i),0);T(r<=1,()=>"There should be only one negative value in split array.");const o=t.indexOf(-1);if(o!==-1){const i=t.reduce((a,l)=>l>0?a+l:a);t[o]=e.shape[n]-i}T(e.shape[n]===t.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=t}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NO(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function EO(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function _O(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RO(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function DO(e,t){return`size ${e} must be non-negative, not ${t}`}function AO(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function OO(e,t){const n=Y(e),s=Y(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${e} outputShape= ${t}`}function FO(e,t){const n=Y(e),s=Y(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f1(){return"segment ids must be >= 0"}function PO(){return"segment ids are not increasing"}function MO(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function LO(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zO(e,t){let n=!1,s;for(e<=Yk?(s=e,n=!0):s=qb(e,Math.floor(Math.sqrt(e)));!n;)s>t||s===e?n=!0:s=qb(e,s+1);return s}function BO(e,t,n){const s=[],r=e.length;for(let o=0;o<r;o++)o!==t?s.push(e[o]):s.push(n);return s}function fC(e,t,n,s){const r=t.shape.length,o=e.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(e.shape[d]!==t.shape[d])throw new Error(`x.shape[${d}]: ${e.shape[d]} should be equal to indices.shape[${d}]: ${t.shape[d]}.`);const i=e.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<s;++d)a.push(e.shape[d]),l*=e.shape[d];for(let d=s;d<n;d++)a.push(e.shape[d]),c*=e.shape[d];for(let d=s;d<r;d++)a.push(t.shape[d]);for(let d=n+1;d<o;d++)a.push(e.shape[d]),u*=e.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:a}}const yq=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:fC,computeOutShape:BO,segOpComputeOptimalWindowSize:zO},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bo(e){try{return e.map(t=>Ui(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function VO(e){return e.map(t=>Oi(t))}const bq=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:eC,ERF_A2:nC,ERF_A3:sC,ERF_A4:rC,ERF_A5:oC,ERF_P:tC,PARALLELIZE_THRESHOLD:Yk,get RowPartitionType(){return gr},SELU_SCALE:r0,SELU_SCALEALPHA:s0,applyActivation:Pk,assertAndGetBroadcastShape:$t,assertAxesAreInnerMostDims:hn,assertParamsConsistent:qk,assignToTypedArray:IO,axesAreInnerMostDims:dk,calculateShapes:wl,checkEinsumDimSizes:cC,checkPadOnDimRoundingMode:ts,combineLocations:AA,combineRaggedTensorToTensorShapes:yO,complexWithEvenIndex:CO,complexWithOddIndex:SO,computeConv2DInfo:dn,computeConv3DInfo:na,computeDefaultPad:ok,computeDilation2DInfo:uf,computeOptimalWindowSize:n0,computeOutAndReduceShapes:sn,computeOutShape:Zr,computePool2DInfo:sr,computePool3DInfo:Uo,convertConv2DDataFormat:jo,decodeEinsumEquation:aC,eitherStridesOrDilationsAreOne:vn,expandShapeToKeepDim:Fe,exponent:TO,exponents:$O,fromStringArrayToUint8:VO,fromUint8ToStringArray:Bo,getAxesPermutation:Ie,getBroadcastDims:Ac,getComplexWithIndex:iC,getEinsumComputePath:uC,getEinsumPermutation:lC,getFusedBiasGradient:Fk,getFusedDyActivation:Ok,getImageCenter:Qk,getInnerMostAxes:Pe,getPermuted:gf,getRaggedRank:vO,getReductionAxes:Ke,getReshaped:mf,getReshapedPermuted:xf,getRowPartitionTypesHelper:bO,getSliceBeginCoords:Zk,getSliceSize:Jk,getSparseFillEmptyRowsIndicesDenseShapeMismatch:NO,getSparseFillEmptyRowsNegativeIndexErrorMessage:EO,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:_O,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:AO,getSparseReshapeInputOutputMismatchErrorMessage:FO,getSparseReshapeInputOutputMultipleErrorMessage:OO,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:RO,getSparseReshapeNegativeOutputDimErrorMessage:DO,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:LO,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:f1,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:PO,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:MO,getUndoAxesPermutation:sa,isIdentityPermutation:dC,log:LG,mergeRealAndImagArrays:zo,prepareAndValidate:Uk,prepareSplitSize:hC,segment_util:yq,shouldFuse:Mk,slice_util:fq,splitRealAndImagArrays:kO,stridesOrDilationsArePositive:nl,tupleValuesAreOne:el,upcastType:fs,validateDefaultValueShape:wO,validateInput:R8,validateUpdateShape:QA,warn:Cs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */lq();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WO={kernelName:Hg,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(e,pf(ct(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vq={kernelName:ph,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const s=oe(ct(n,"float32")),r=bn(ft(kt(1),s));return be(xt(e,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wq={kernelName:mh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const s=bn(ft(oe(ct(n,"float32")),1));return xt(e,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kq={kernelName:eu,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=$t(n.shape,s.shape);return{a:()=>{let a=e;const l=Ke(n.shape,r);return l.length>0&&(a=mt(a,l)),j(a,n.shape)},b:()=>{let a=e;const l=Ke(s.shape,r);return l.length>0&&(a=mt(a,l)),j(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cq={kernelName:mw,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((s,r)=>{n[r]=()=>e.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sq={kernelName:Kg,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Lt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iq={kernelName:Xg,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Lt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $q={kernelName:gh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>xt(e,bn(ft(kt(1),oe(ct(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tq={kernelName:xh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const s=bn(et(kt(1),oe(ct(n,"float32"))));return xt(e,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nq={kernelName:vh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=$t(n.shape,s.shape);return{a:()=>{const a=et(oe(n),oe(s));let l=F(e,xt(s,a));const c=Ke(n.shape,r);return c.length>0&&(l=mt(l,c)),j(l,n.shape)},b:()=>{const a=et(oe(n),oe(s));let l=be(F(e,xt(n,a)));const c=Ke(s.shape,r);return c.length>0&&(l=mt(l,c)),j(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eq={kernelName:yh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>xt(e,et(oe(ct(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _q={kernelName:bh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>xt(e,ft(kt(1),oe(ct(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(e,t,n,s,r,o){const i=_(e,"dy","avgPool3dGrad"),a=_(t,"input","avgPool3dGrad");let l=i,c=a,u=!1;a.rank===4&&(u=!0,l=j(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=j(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),ts("avgPool3dGrad",r,o);const d={dy:l,input:c},h={filterSize:n,strides:s,pad:r,dimRoundingMode:o},f=V.runKernel(bw,d,h);return u?j(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Dq=W({avgPool3dGrad_:Rq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aq={kernelName:Yg,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{filterSize:r,strides:o,pad:i,dimRoundingMode:a}=n;return{x:()=>Dq(e,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oq(e,t,n,s,r){const o=_(e,"dy","avgPoolGrad"),i=_(t,"input","avgPoolGrad");T(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,c=!1;i.rank===3&&(c=!0,a=j(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=j(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=V.runKernel(yw,u,d);return c?j(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Fq=W({avgPoolGrad_:Oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pq={kernelName:qg,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{filterSize:r,strides:o,pad:i}=n;return{x:()=>Fq(e,s,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mq={kernelName:Qg,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[s,r]=t,{transposeA:o,transposeB:i}=n;return!o&&!i?{a:()=>jt(e,r,!1,!0),b:()=>jt(s,e,!0,!1)}:!o&&i?{a:()=>jt(e,r,!1,!1),b:()=>jt(e,s,!0,!1)}:o&&!i?{a:()=>jt(r,e,!1,!0),b:()=>jt(s,e,!1,!1)}:{a:()=>jt(r,e,!0,!0),b:()=>jt(e,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lq={kernelName:Zg,gradFunc:(e,t,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>wk(e,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zq={kernelName:OG,gradFunc:(e,t,n)=>{const s=n,r=s.inputShape,o=s.shape,i=Array.from(o);for(let l=r.length-1;l>=0;l--)if(r[l]===o[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>mt(e,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bq={kernelName:wh,gradFunc:e=>({x:()=>e.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vq={kernelName:kh,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wq={kernelName:Ch,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{clipValueMin:r,clipValueMax:o}=n;return{x:()=>On(Mo(bl(s,r),ru(s,o)),e,Lt(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uq={kernelName:Jg,inputsToSave:["x"],gradFunc:WO.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jq={kernelName:tx,saveAllInputs:!0,gradFunc:(e,t,n)=>{const s=t.map(l=>l.shape),{axis:r}=n,o=Rt(r,t[0].shape)[0],i=s.map(l=>l[o]);return Ns(e,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gq={kernelName:ex,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[s,r]=t,{dilations:o,strides:i,pad:a,dataFormat:l}=n;return T(el(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>lk(s.shape,e,r,i,a,l),filter:()=>Ak(s,e,r.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hq={kernelName:nx,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[s,r]=t,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>sl(e,r,o,i,a,1,l),filter:()=>Ak(e,s,r.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kq(e,t,n,s,r){let o=e;e.rank===4&&(o=j(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let i=t;i.rank===4&&(i=j(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),T(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),T(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),T(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),T(o.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`),T(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:o,dy:i},l={strides:s,pad:r,filterShape:n};return V.runKernel(Sw,a,l)}const Xq=W({conv3DBackpropFilter_:Kq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qq={kernelName:sx,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:s,strides:r,pad:o}=n;T(el(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=t;return{x:()=>EA(i.shape,e,a,r,o),filter:()=>Xq(i,e,a.shape,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yq={kernelName:Sh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(be(HA(ct(n,"float32"))),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qq={kernelName:Ih,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(KA(ct(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zq={kernelName:rx,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{axis:r,exclusive:o,reverse:i}=n;return{x:()=>{const a=Ie([r],s.rank);let l=RA(e,r,o,!i);return a!=null&&(l=Mt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jq={kernelName:ox,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:s,strides:r,pad:o,dimRoundingMode:i}=n,a=s??[1,1];T(el(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=t;return T(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),T(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),T(vn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),ts("depthwiseConv2d",o,i),{x:()=>Y8(l.shape,e,c,r,o,a,i),filter:()=>X8(l,e,c.shape,r,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tY={kernelName:ix,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[s,r]=t,o={x:s,filter:r,dy:e},i={x:s,filter:r,dy:e};return{x:()=>V.runKernel(Yb,o,n),filter:()=>V.runKernel(Qb,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eY={kernelName:Th,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,s={dy:e,y:n};return{x:()=>V.runKernel(Aw,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nY={kernelName:Nh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,s=F(Rs(be(oe(n))),2/Math.sqrt(Math.PI));return{x:()=>F(e,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sY={kernelName:Eh,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(e,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rY={kernelName:lx,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>j(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oY={kernelName:_h,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(e,Rs(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iY={kernelName:Rh,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aY={kernelName:Dh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=$t(n.shape,s.shape);return{a:()=>{const a=xt(e,ct(s,"float32")),l=Ke(n.shape,r);return l.length>0?j(mt(a,l),n.shape):a},b:()=>{let a=F(e,ct(n,"float32"));const l=Ke(s.shape,r);l.length>0&&(a=j(mt(a,l),s.shape));const c=oe(s);return be(xt(a,ct(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lY={kernelName:cx,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:s}=n,[r,o,i,a]=t,l=a??kt(1),c=Ke(o.shape,r.shape),u=[];if(o.rank===1){for(let v=0;v<r.shape.length-1;++v)u.push(r.shape[v]);u.push(1)}const d=ft(r,o),h=F(e,l),f=UA(et(i,kt(s))),p=F(F(F(f,f),f),kt(-.5));return{x:()=>o.rank===1?j(F(F(e,xr(j(f,[1,1,1,o.shape[0]]),u)),l),r.shape):j(F(F(e,f),l),r.shape),mean:()=>{let v=F(F(f,kt(-1)),h);return o.rank===1&&(v=mt(v,c)),j(v,o.shape)},variance:()=>{let v=F(F(p,d),h);return o.rank===1&&(v=mt(v,c)),j(v,o.shape)},scale:()=>{const v=F(d,f);let w=F(e,v);return o.rank===1&&(w=mt(w,c)),j(w,o.shape)},offset:()=>{let v=e;return o.rank===1&&(v=mt(v,c)),j(v,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY={kernelName:ux,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[s,r]=t,{axis:o,batchDims:i}=n,a=Rt(o,s.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,p=h.slice(0,a),m=p.length,g=h.slice(o,h.length).slice(1),x=g.length,y=F2(0,m),b=F2(m+1,m+1+x),v=P2([p,[f],g]),w=j(d,v),k=j(u,[f]),C=P2([[m],y,b]),S=Mt(w,C);let I=JA(S,k,c.shape[a]);const $=sa(C);return I=Mt(I,$),I};if(i===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>Lo(u.map((f,p)=>l(f,r.slice(p,1),e.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,e),indices:()=>r}}};function F2(e,t){const n=[];for(let s=e;s<t;++s)n.push(s);return n}function P2(e){const t=[];for(let n=0;n<e.length;++n)for(let s=0;s<e[n].length;++s)t.push(e[n][s]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uY={kernelName:Ah,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t;return{a:()=>Lt(n),b:()=>Lt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dY={kernelName:Oh,gradFunc:e=>({x:()=>ct(e,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hY={kernelName:Fh,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fY={kernelName:Ph,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY={kernelName:Mh,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mY={kernelName:hx,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{alpha:r}=n,o=Os(s,0);return{x:()=>On(o,e,F(e,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY={kernelName:zh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>xt(e,et(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY={kernelName:Lh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>xt(e,ct(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yY={kernelName:PG,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s]=t,{axis:r}=n;return{logits:()=>{const i=Rs(s);return ft(e,F(mt(e,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bY(e,t,n,s=5,r=1,o=1,i=.5){const a={x:e,y:t,dy:n},l={depthRadius:s,bias:r,alpha:o,beta:i};return V.runKernel(zw,a,l)}const vY=W({localResponseNormalizationBackprop_:bY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY={kernelName:yx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s,r]=t,{depthRadius:o,bias:i,alpha:a,beta:l}=n;return{x:()=>vY(s,r,e,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UO(e,t,n,s){return t.rank<n.rank&&(t=j(t,Fe(t.shape,s))),e.rank<n.rank&&(e=j(e,Fe(e.shape,s))),{x:()=>F(e,ct(ro(n,t),e.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M2={kernelName:bx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const s=n,{reductionIndices:r}=s,o=t[0],i=t[1],a=Rt(r,o.shape),l=UO(e,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kY={kernelName:Bh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t;return{a:()=>F(e,ct(bl(n,s),"float32")),b:()=>F(e,ct(Wm(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CY(e,t,n,s,r,o,i){const a=_(e,"dy","maxPool3dGrad"),l=_(t,"input","maxPool3dGrad"),c=_(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=j(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=j(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=j(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),T(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),T(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),T(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),ts("maxPool3dGrad",o,i);const p={dy:u,input:d,output:h},m={filterSize:s,strides:r,pad:o,dimRoundingMode:i},g=V.runKernel(Vw,p,m);return f?j(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const SY=W({maxPool3dGrad_:CY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IY={kernelName:wx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s,r]=t,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>SY(e,s,r,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Y(e,t,n,s,r,o,i){const a=_(e,"dy","maxPoolGrad"),l=_(t,"input","maxPoolGrad"),c=_(n,"output","maxPoolGrad");T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),ts("maxPoolGrad",o,i);const u={dy:a,input:l,output:c},d={filterSize:s,strides:r,pad:o,dimRoundingMode:i};return V.runKernel(Bw,u,d)}const TY=W({maxPoolGrad_:$Y});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NY={kernelName:vx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s,r]=t,{filterSize:o,strides:i,pad:a}=n;return{x:()=>TY(e,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EY={kernelName:kx,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{axis:r}=n,o=Rt(r,s.shape),a=sn(s.shape,o)[1],l=Y(a);return{x:()=>{const u=s.shape.slice();o.forEach(f=>{u[f]=1});const d=j(e,u);return xt(F(d,Go(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Y={kernelName:Cx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const s=n,{axis:r}=s,[o,i]=t,a=Rt(r,o.shape),l=UO(e,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RY={kernelName:Vh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t;return{a:()=>F(e,ct(ru(n,s),"float32")),b:()=>F(e,ct(Os(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DY={kernelName:Sx,inputsToSave:["x"],gradFunc:(e,t,n)=>{const s=t[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>re(e,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AY={kernelName:Wh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=$t(n.shape,s.shape);return{a:()=>{const a=Ke(n.shape,r);return a.length>0?j(mt(e,a),n.shape):e},b:()=>{const a=F(e,be(t0(xt(n,s)))),l=Ke(s.shape,r);return l.length>0?j(mt(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OY={kernelName:Uh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=$t(n.shape,s.shape);return{a:()=>{const a=F(e,ct(s,"float32")),l=Ke(n.shape,r);return l.length>0?j(mt(a,l),n.shape):a},b:()=>{const a=F(e,ct(n,"float32")),l=Ke(s.shape,r);return l.length>0?j(mt(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FY={kernelName:Ix,gradFunc:e=>({x:()=>be(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PY={kernelName:Nx,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>Je(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MY={kernelName:Tx,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LY={kernelName:Ex,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:s}=n;return al(e,s).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L2={kernelName:_x,inputsToSave:["x"],gradFunc:(e,t,n)=>{const s=t[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>re(e,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zY={kernelName:jh,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,s,r]=t,o=n,i=s,a=$t(o.shape,i.shape);return{a:()=>{const u=ct(i,"float32");let d=F(e,F(u,rl(o,ft(u,kt(1)))));const h=Ke(o.shape,a);return h.length>0&&(d=mt(d,h)),j(d,o.shape)},b:()=>{const u=Os(o,0),d=On(u,tr(o),Lt(o));let h=F(e,F(r,d));const f=Ke(i.shape,a);return f.length>0&&(h=mt(h,f)),j(h,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BY={kernelName:Rx,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,s]=t,r=Os(n,0);return{x:()=>On(r,e,F(e,s)),alpha:()=>{let o=On(r,Lt(e),F(e,n));const i=Ke(s.shape,e.shape);return i.length>0&&(o=mt(o,i)),j(o,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VY(e,t,n){const s=e.shape.slice();s[n]=1;const r=j(t,s),o=u1(e,n,!0,!1),i=u1(e,n,!0,!0),a=F(o,i);return F(r,a)}function WY(e,t,n){const s=e.shape.length,r=s-n.length,o=Ie(n,s);let i=e;o!=null&&(i=Mt(e,o));const a=i.shape.slice(),c=a.splice(s-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=i.reshape(a);let d=VY(u,t,r);if(d=d.reshape(i.shape),o!=null){const h=sa(o);d=Mt(d,h)}return d}const UY={kernelName:Dx,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{axis:r}=n;let o=[];return r==null?o=s.shape.map((i,a)=>a):typeof r=="number"?o=[r]:o=r,{x:()=>WY(s,e,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jY={kernelName:$h,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=$t(n.shape,s.shape);return{a:()=>{const a=xt(e,ct(s,"float32")),l=Ke(n.shape,r);return l.length>0?j(mt(a,l),n.shape):a},b:()=>{let a=F(e,ct(n,"float32"));const l=Ke(s.shape,r);l.length>0&&(a=j(mt(a,l),s.shape));const c=oe(s);return be(xt(a,ct(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GY={kernelName:Gh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>xt(e,be(oe(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HY={kernelName:Kh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,s=F(ru(n,6),pf(n));return{x:()=>F(e,ct(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KY={kernelName:Hh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(e,ct(pf(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XY={kernelName:Ax,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>j(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qY={kernelName:Fx,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[s]=t,r={dy:e,images:s};return{images:()=>V.runKernel(Xw,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YY={kernelName:Ox,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[s]=t,r={dy:e,images:s};return{images:()=>V.runKernel(Kw,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QY={kernelName:Px,gradFunc:(e,t,n)=>{const{dims:s}=n,r=Rt(s,e.shape);return{x:()=>il(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZY={kernelName:Xh,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JY={kernelName:qh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>be(xt(e,F(rl(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t7={kernelName:Mx,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>ct(Lt(n),"float32"),t:()=>F(e,ct(n,e.dtype)),e:()=>F(e,ct(xk(n),e.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7={kernelName:Yh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const s=Os(n,kt(0)),r=kt(s0),o=kt(r0),i=F(e,o),a=F(F(e,r),Rs(ct(n,"float32")));return On(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7={kernelName:tf,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(e,F(n,ft(kt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7={kernelName:Jh,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r7={kernelName:Qh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(ck(ct(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7={kernelName:Zh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(_A(ct(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7={kernelName:Lx,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{begin:r,size:o}=n,i=s.shape,[a,l]=e0(s,r,o),c=[];for(let u=0;u<e.rank;u++)c.push([a[u],i[u]-a[u]-l[u]]);return{x:()=>vk(e,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a7={kernelName:Wx,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s]=t,{dim:r}=n,o=!0,i=F(e,s);return{logits:()=>ft(i,F(mt(i,[r],o),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l7={kernelName:ef,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(e,su(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z2={kernelName:Bx,gradFunc:(e,t,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>ak(e,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B2={kernelName:Vx,gradFunc:(e,t,n)=>{const{axis:s}=n;return{x:()=>qn(e,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7={kernelName:nf,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>xt(e,F(bn(ct(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u7={kernelName:qw,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(e,F(ct(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d7={kernelName:sf,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=kt(2);return{a:()=>F(e,F(r,ft(n,s))),b:()=>F(e,F(r,ft(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h7={kernelName:cf,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f7={kernelName:rf,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=$t(n.shape,s.shape);return{a:()=>{let a=e;const l=Ke(n.shape,r);return l.length>0&&(a=mt(a,l)),j(a,n.shape)},b:()=>{let a=e;const l=Ke(s.shape,r);return l.length>0&&(a=mt(a,l)),j(be(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7={kernelName:zx,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,r=s.shape.slice(),{axis:o}=n;Rt(o,s.shape).forEach(c=>{r[c]=1});const a=j(e,r),l=F(a,Go(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m7={kernelName:of,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>xt(e,oe(ck(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g7={kernelName:af,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>F(ft(kt(1),oe(n)),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x7={kernelName:lf,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{reps:r}=n;return{x:()=>{let i=Lt(s);if(s.rank===1)for(let a=0;a<r[0];++a)i=et(i,re(e,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)i=et(i,re(e,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)i=et(i,re(e,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)i=et(i,re(e,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7={kernelName:oc,gradFunc:(e,t,n)=>{const s=n,{perm:r}=s,o=sa(r);return{x:()=>Mt(e,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b7={kernelName:Ux,gradFunc:(e,t,n)=>{const s=n,{axis:r}=s;return{value:()=>Lo(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v7={kernelName:jx,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>w7(e,n)}}};function w7(e,t){const n=ra(t,Lt(t)),s=hk(e,n);let r=bl(t,kt(0,"int32"));const o=s.rank-r.rank;for(let a=0;a<o;++a)r=Gn(r,a+1);r=Mo(r,Go(s.shape,"bool"));const i=Lt(s);return On(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k7={kernelName:Gx,gradFunc:e=>({x:()=>Lt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C7=[WO,vq,wq,kq,Cq,Sq,Iq,$q,Tq,Nq,Eq,_q,Aq,Pq,Mq,Lq,zq,Bq,Vq,Wq,Uq,jq,Hq,Gq,qq,Yq,Qq,Zq,Jq,tY,jY,eY,nY,sY,rY,oY,aY,iY,lY,cY,uY,dY,hY,fY,pY,mY,gY,xY,yY,wY,M2,M2,kY,IY,NY,EY,_Y,RY,DY,AY,OY,FY,PY,MY,LY,L2,L2,zY,BY,UY,GY,HY,KY,XY,qY,YY,QY,ZY,JY,t7,e7,n7,s7,r7,o7,i7,a7,l7,z2,z2,B2,B2,c7,d7,u7,h7,f7,p7,m7,g7,x7,y7,b7,v7,k7];for(const e of C7)zG(e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.abs=function(){return this.throwIfDisposed(),Qe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.acos=function(){return this.throwIfDisposed(),VH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.acosh=function(){return this.throwIfDisposed(),UH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.add=function(e){return this.throwIfDisposed(),et(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.all=function(e,t){return this.throwIfDisposed(),$A(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.any=function(e,t){return this.throwIfDisposed(),l1(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.argMax=function(e){return this.throwIfDisposed(),Ld(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.argMin=function(e){return this.throwIfDisposed(),XH(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,()=>"The array must have only 1 element."),j(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asType=function(e){return this.throwIfDisposed(),ct(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as1D=function(){return this.throwIfDisposed(),j(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as2D=function(e,t){return this.throwIfDisposed(),j(this,[e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),j(this,[e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as4D=function(e,t,n,s){return this.throwIfDisposed(),j(this,[e,t,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as5D=function(e,t,n,s,r){return this.throwIfDisposed(),j(this,[e,t,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asin=function(){return this.throwIfDisposed(),YH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asinh=function(){return this.throwIfDisposed(),ZH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atan=function(){return this.throwIfDisposed(),t5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atan2=function(e){return this.throwIfDisposed(),n5(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atanh=function(){return this.throwIfDisposed(),r5(this)};q().prototype.avgPool=function(e,t,n,s){return this.throwIfDisposed(),ik(this,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),ak(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.batchNorm=function(e,t,n,s,r){return this.throwIfDisposed(),Yx(this,e,t,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.broadcastTo=function(e){return this.throwIfDisposed(),ud(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cast=function(e){return this.throwIfDisposed(),ct(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.ceil=function(){return this.throwIfDisposed(),R5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),_s(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Ve&&(e=[e]),qn([this,...e],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv1d=function(e,t,n,s,r,o){return this.throwIfDisposed(),TA(this,e,t,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv2dTranspose=function(e,t,n,s,r){return this.throwIfDisposed(),NA(this,e,t,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv2d=function(e,t,n,s,r,o){return this.throwIfDisposed(),sl(this,e,t,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cos=function(){return this.throwIfDisposed(),ck(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cosh=function(){return this.throwIfDisposed(),_A(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),u1(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),RA(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),n6(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.depthwiseConv2d=function(e,t,n,s,r,o){return this.throwIfDisposed(),uk(this,e,t,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.dilation2d=function(e,t,n,s,r){return this.throwIfDisposed(),o6(this,e,t,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.divNoNan=function(e){return this.throwIfDisposed(),u6(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.div=function(e){return this.throwIfDisposed(),xt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.dot=function(e){return this.throwIfDisposed(),h6(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.elu=function(){return this.throwIfDisposed(),Zx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.equal=function(e){return this.throwIfDisposed(),ro(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.erf=function(){return this.throwIfDisposed(),DA(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),S6(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.exp=function(){return this.throwIfDisposed(),Rs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.expandDims=function(e){return this.throwIfDisposed(),Gn(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.expm1=function(){return this.throwIfDisposed(),N6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.fft=function(){return this.throwIfDisposed(),qA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.flatten=function(){return this.throwIfDisposed(),j(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.floor=function(){return this.throwIfDisposed(),t0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.floorDiv=function(e){return this.throwIfDisposed(),IA(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.gather=function(e,t,n){return this.throwIfDisposed(),hk(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.greaterEqual=function(e){return this.throwIfDisposed(),bl(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.greater=function(e){return this.throwIfDisposed(),Os(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.ifft=function(){return this.throwIfDisposed(),d1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.irfft=function(){return this.throwIfDisposed(),b8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isFinite=function(){return this.throwIfDisposed(),M6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isInf=function(){return this.throwIfDisposed(),z6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isNaN=function(){return this.throwIfDisposed(),V6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.leakyRelu=function(e){return this.throwIfDisposed(),pk(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.lessEqual=function(e){return this.throwIfDisposed(),ru(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.less=function(e){return this.throwIfDisposed(),Wm(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.localResponseNormalization=function(e,t,n,s){return this.throwIfDisposed(),H6(this,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSigmoid=function(){return this.throwIfDisposed(),J6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSoftmax=function(e){return this.throwIfDisposed(),PA(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),gk(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.log=function(){return this.throwIfDisposed(),tr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.log1p=function(){return this.throwIfDisposed(),mk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Mo(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalNot=function(){return this.throwIfDisposed(),xk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalOr=function(e){return this.throwIfDisposed(),MA(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalXor=function(e){return this.throwIfDisposed(),aK(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),jt(this,e,t,n)};q().prototype.maxPool=function(e,t,n,s){return this.throwIfDisposed(),yk(this,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.max=function(e,t){return this.throwIfDisposed(),kr(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.maximum=function(e){return this.throwIfDisposed(),ra(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mean=function(e,t){return this.throwIfDisposed(),Re(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.min=function(e,t){return this.throwIfDisposed(),Vm(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.minimum=function(e){return this.throwIfDisposed(),Oc(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),mK(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mod=function(e){return this.throwIfDisposed(),xK(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mul=function(e){return this.throwIfDisposed(),F(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.neg=function(){return this.throwIfDisposed(),be(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Jx(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.notEqual=function(e){return this.throwIfDisposed(),Vd(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),LA(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.onesLike=function(){return this.throwIfDisposed(),er(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.pad=function(e,t){return this.throwIfDisposed(),vk(this,e,t)};q().prototype.pool=function(e,t,n,s,r,o){return this.throwIfDisposed(),TK(this,e,t,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.pow=function(e){return this.throwIfDisposed(),rl(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.prelu=function(e){return this.throwIfDisposed(),kk(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.prod=function(e,t){return this.throwIfDisposed(),_K(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reciprocal=function(){return this.throwIfDisposed(),JK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.relu=function(){return this.throwIfDisposed(),Ho(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.relu6=function(){return this.throwIfDisposed(),VA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reshapeAs=function(e){return this.throwIfDisposed(),j(this,e.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reshape=function(e){return this.throwIfDisposed(),j(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),eO(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),nO(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reverse=function(e){return this.throwIfDisposed(),il(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.rfft=function(){return this.throwIfDisposed(),k8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.round=function(){return this.throwIfDisposed(),WA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.rsqrt=function(){return this.throwIfDisposed(),UA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.selu=function(){return this.throwIfDisposed(),jA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.separableConv2d=function(e,t,n,s,r,o){return this.throwIfDisposed(),GA(this,e,t,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sigmoid=function(){return this.throwIfDisposed(),su(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sign=function(){return this.throwIfDisposed(),l8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sin=function(){return this.throwIfDisposed(),HA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sinh=function(){return this.throwIfDisposed(),KA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.slice=function(e,t){return this.throwIfDisposed(),re(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.softmax=function(e){return this.throwIfDisposed(),Dk(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.softplus=function(){return this.throwIfDisposed(),df(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),wk(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.split=function(e,t){return this.throwIfDisposed(),Ns(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sqrt=function(){return this.throwIfDisposed(),bn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.square=function(){return this.throwIfDisposed(),oe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.squaredDifference=function(e){return this.throwIfDisposed(),YA(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.squeeze=function(e){return this.throwIfDisposed(),ff(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof Ve?[this,e]:[this,...e];return Lo(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.step=function(e){return this.throwIfDisposed(),pf(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.stridedSlice=function(e,t,n,s,r,o,i,a){return this.throwIfDisposed(),N8(this,e,t,n,s,r,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sub=function(e){return this.throwIfDisposed(),ft(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sum=function(e,t){return this.throwIfDisposed(),mt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tan=function(){return this.throwIfDisposed(),_8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tanh=function(){return this.throwIfDisposed(),qx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tile=function(e){return this.throwIfDisposed(),xr(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toBool=function(){return this.throwIfDisposed(),ct(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toFloat=function(){return this.throwIfDisposed(),ct(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toInt=function(){return this.throwIfDisposed(),ct(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.topk=function(e,t){return this.throwIfDisposed(),A8(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.transpose=function(e){return this.throwIfDisposed(),Mt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unique=function(e){return this.throwIfDisposed(),P8(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),JA(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unstack=function(e){return this.throwIfDisposed(),al(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.where=function(e,t){return this.throwIfDisposed(),On(e,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.zerosLike=function(){return this.throwIfDisposed(),Lt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Wr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Wr.prototype)}}class Xs extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Xs.prototype)}}class B extends Error{constructor(t){super(t),Object.setPrototypeOf(this,B.prototype)}}class Tt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Tt.prototype)}}class pC extends Error{constructor(t){super(t),Object.setPrototypeOf(this,pC.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jO{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ll(e,t){if(Array.isArray(e)){let n=[];for(let s=0;s<t;s++)n=n.concat(e);return n}else{const n=new Array(t);return n.fill(e),n}}function Ur(e,t){if(!e)throw new pC(t)}function V2(e,t){let n=0;for(const s of e)s===t&&n++;return n}function Hn(e){return e.length===1?e[0]:e}function qt(e){return Array.isArray(e)?e:[e]}function vo(e){const n=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Ca(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let Ps={};function mC(e){if(e==null)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function p1(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>p1(t));else{const t=Object.keys(e);for(const n of t){const s=e[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?e[n]=s.value:p1(s))}}}function yf(e,t={},n={},s="object",r=!1){if(typeof e=="string"){const o=e;let i;if(o in n)i=n[o];else if(o in Ps)i=Ps[o];else if(i=t[o],i==null)throw new B(`Unknown ${s}: ${e}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=e;if(o.className==null||o.config==null)throw new B(`${s}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in n?[a,l]=n[i]:i in Ps?[a,l]=Ps.className:i in t&&([a,l]=t[i]),a==null)throw new B(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(Ps))c[f]=Ps[f];for(const f of Object.keys(n))c[f]=n[f];const u=o.config;u.customObjects=c;const d=Object.assign({},Ps);for(const f of Object.keys(n))Ps[f]=n[f];p1(o.config);const h=l(a,o.config,n,r);return Ps=Object.assign({},d),h}else{const c=Object.assign({},Ps);for(const d of Object.keys(n))Ps[d]=n[d];const u=new a(o.config);return Ps=Object.assign({},c),u}}}function S7(e,t){return e<t?-1:e>t?1:0}function op(e,t){return-1*S7(e,t)}function Fi(e){if(e==null)return e;const t=[];for(const n of e)t.indexOf(n)===-1&&t.push(n);return t}function I7(e){if(e==null)throw new B(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function kl(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new B(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function gC(e,t,n=0,s=1/0){return Ur(n>=0),Ur(s>=n),Array.isArray(e)&&e.length>=n&&e.length<=s&&e.every(r=>typeof r===t)}function en(e,t){Array.isArray(e)?(T(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,s)=>en(n,`element ${s+1} of ${t}`))):T(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${GO(e)}.`)}function GO(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>GO(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function $7(e,t,n){let s=n!=null?n():Un(),r;return(...i)=>{const a=n!=null?n():Un();return a-s<t||(s=a,r=e(...i)),r}}function HO(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let T7=0;function KO(){return T7++}const ip={};function o0(e=""){return e in ip||(ip[e]=0),ip[e]+=1,e+ip[e].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const N7=["channelsFirst","channelsLast"],E7=["nearest","bilinear"],_7=["valid","same","causal"],R7=["max","avg"],D7=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _l=new Map;function Me(e){kl(N7,"DataFormat",e)}function A7(e){kl(E7,"InterpolationFormat",e)}function Fs(e){kl(_7,"PaddingMode",e)}function XO(e){kl(R7,"PoolMode",e)}const dd=[],W2="/";function Ba(e,t){dd.push(e);try{const n=t();return dd.pop(),n}catch(n){throw dd.pop(),n}}function O7(){return dd.length===0?"":dd.join(W2)+W2}function qO(e){if(!QO(e))throw new Error("Not a valid tensor name: '"+e+"'");return O7()+e}function YO(e){if(!QO(e))throw new Error("Not a valid tensor name: '"+e+"'");_l.has(e)||_l.set(e,0);const t=_l.get(e);if(_l.set(e,_l.get(e)+1),t>0){const n=`${e}_${t}`;return _l.set(n,1),n}else return e}const F7=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function QO(e){return!!e.match(F7)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function P7(e){return e===parseInt(e.toString(),10)}function Pi(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let s=1;for(let r=t;r<n;++r)s*=e[r];return s}function Fc(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const s=e[n];s<t&&(t=s)}return t}function ji(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const s=e[n];s>t&&(t=s)}return t}function Nr(e,t){if(t<e)throw new B(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let s=e;s<t;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let xy;function Ue(){return xy==null&&(xy=dH().epsilon()),xy}function Er(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jr(e,t){return ct(e,t)}function bf(e,t=-1){const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),j(e,n)}function M7(e,t){return G(()=>{if(e.shape.length!==2)throw new B(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);const n=bf(e,1);return m1(n,[1,t,1])})}function L7(e){const t=[Pi(e.shape)];return j(e,t)}function z7(e){if(e.rank<=1)throw new B(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],Pi(e.shape,1)];return j(e,t)}function Va(e,t,n){return G(()=>{switch(e.rank){case 1:return _k(e,t,n);case 2:return XA(e,[t,0],[n,e.shape[1]]);case 3:return Rk(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return jm(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return re(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return re(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new B(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function yy(e,t,n){return G(()=>{switch(e.rank){case 1:return _k(e,t,n);case 2:return XA(e,[0,t],[e.shape[0],n]);case 3:return Rk(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return jm(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new B(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function ap(e,t,n,s){return G(()=>{switch(e.rank){case 1:return _k(e,t,n);case 2:switch(s){case 1:return Va(e,t,n);case 2:return yy(e,t,n);default:throw new B(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Va(e,t,n);case 2:return Rk(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return yy(e,t,n);default:throw new B(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Va(e,t,n);case 2:return jm(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return jm(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return yy(e,t,n);default:throw new B(`The axis is not within the rank of the tensor ${s}`)}default:throw new B(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function xC(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),qn(e,t)}function U2(e,t){switch(e.rank){case 1:return O5([e,t]);case 2:return P5([e,t],0);case 3:return L5([e,t],0);case 4:return B5([e,t],0);default:throw new B(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function m1(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new B(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return xr(e,t)}function i0(e,t=0,n=1,s,r){return qK(e,t,n,s,r)}function to(e,t,n,s){if(e.rank<2||t.rank<2)throw new Tt(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){const r=e.shape.slice(-1)[0],o=t.shape.slice(-2)[0];if(r!==o)throw new Tt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return E2({a:e,b:t,transposeA:!1,transposeB:!1,bias:s?g1(e.rank,s,Er()):null,activation:n});{const r=e.shape.slice(),o=r.pop();e=j(e,[-1,o]);const i=t.shape.slice(),a=i.pop(),l=i.pop(),c=[...i,a],u=Array.from({length:t.rank},(p,m)=>m===0?t.rank-2:m<=t.rank-2?m-1:m);t=j(Mt(t,u),[l,-1]);const d=[...r,...c];return j(E2({a:e,b:t,transposeA:!1,transposeB:!1,bias:s?g1(e.rank,s,Er()):null,activation:n}),d)}}function ZO(e,t,n){return G(()=>(Array.isArray(t)?t=cs(t,"int32"):t=ct(t,"int32"),hk(e,t,n)))}function vf(e){return F(e,e)}function g1(e,t,n){const s=t.shape;if(t.rank!==1&&t.rank!==e)throw new B(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return s.length===1?j(t,[1,s[0],1,1,1]):j(t,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?j(t,[1,1,1,1,s[0]]):j(t,[1].concat(s))}else if(e===4){if(n==="channelsFirst")return s.length===1?j(t,[1,s[0],1,1]):j(t,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?j(t,[1,1,1,s[0]]):j(t,[1].concat(s))}else if(e===3){if(n==="channelsFirst")return s.length===1?j(t,[1,s[0],1]):j(t,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?j(t,[1,1,s[0]]):j(t,[1].concat(s))}else if(e<3)return t;throw new B(`Unsupported input rank by biasAdd: ${t.rank}`)}function Dr(e,t,n){return G(()=>(n==null&&(n=Er()),Me(n),et(e,g1(e.rank,t,n))))}function B7(e,t=1){if(t!==1)throw new Tt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return Zx(e)}function V7(e){return G(()=>xt(e,et(Qe(e),1)))}function JO(e,t,n,s){return G(()=>U8(e,t,n,s))}function W7(e){return G(()=>{const t=et(.5,F(.2,e));return _s(t,0,1)})}function wf(e,t,n=!1){return n?e():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const U7=["fanIn","fanOut","fanAvg"],j7=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function G7(e){kl(U7,"FanMode",e)}function H7(e){kl(j7,"Distribution",e)}class rr extends iu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class tF extends rr{apply(t,n){return Je(t,n)}}tF.className="Zeros";tt(tF);class yC extends rr{apply(t,n){return Go(t,n)}}yC.className="Ones";tt(yC);class eF extends rr{constructor(t){if(super(),typeof t!="object")throw new B(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new B(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return G(()=>F(kt(this.value),Go(t,n)))}getConfig(){return{value:this.value}}}eF.className="Constant";tt(eF);class nF extends rr{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return hf(t,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}nF.className="RandomUniform";tt(nF);class sF extends rr{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`randomNormal does not support dType ${n}.`);return i0(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}sF.className="RandomNormal";tt(sF);class rF extends rr{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`truncatedNormal does not support dType ${n}.`);return ZA(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}rF.className="TruncatedNormal";tt(rF);class oF extends rr{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,n){return G(()=>{if(t.length!==2||t[0]!==t[1])throw new B("Identity matrix initializer can only be used for 2D square matrices.");return F(this.gain,FA(t[0]))})}getConfig(){return{gain:this.gain}}}oF.className="Identity";tt(oF);function K7(e,t="channelsLast"){let n,s;if(Me(t),e.length===2)n=e[0],s=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){const r=Pi(e,2);n=e[1]*r,s=e[0]*r}else if(t==="channelsLast"){const r=Pi(e,0,e.length-2);n=e[e.length-2]*r,s=e[e.length-1]*r}}else{const r=Pi(e);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class ps extends rr{constructor(t){if(super(),t.scale<0)throw new B(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,G7(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,H7(this.distribution),this.seed=t.seed}apply(t,n){const s=K7(t),r=s[0],o=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(r+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Tt(`${this.getClassName()} does not support dType ${n}.`);return ZA(t,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return hf(t,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}ps.className="VarianceScaling";tt(ps);class bC extends ps{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return ps.className}}bC.className="GlorotUniform";tt(bC);class vC extends ps{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return ps.className}}vC.className="GlorotNormal";tt(vC);class wC extends ps{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return ps.className}}wC.className="HeNormal";tt(wC);class kC extends ps{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return ps.className}}kC.className="HeUniform";tt(kC);class CC extends ps{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return ps.className}}CC.className="LeCunNormal";tt(CC);class SC extends ps{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return ps.className}}SC.className="LeCunUniform";tt(SC);class iF extends rr{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,n){return G(()=>{if(t.length<2)throw new Tt("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=Y(t.slice(0,-1)),r=t[t.length-1],o=s*r;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],a=i0(i,0,1,n,this.seed),l=rq.qr(a,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=F(c,d.sign()),s<r&&(c=c.transpose()),F(kt(this.gain),c.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}iF.className="Orthogonal";tt(iF);const j2={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function G2(e,t={}){return yf(e,Us.getMap().classNameMap,t,"initializer")}function Ce(e){return mC(e)}function xe(e){if(typeof e=="string"){const t=e in j2?j2[e]:e;if(t==="GlorotNormal")return new vC;if(t==="GlorotUniform")return new bC;if(t==="HeNormal")return new wC;if(t==="HeUniform")return new kC;if(t==="LeCunNormal")return new CC;if(t==="LeCunUniform")return new SC;{const n={};return n.className=t,n.config={},G2(n)}}else return e instanceof rr?e:G2(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function x1(e){return Array.isArray(e)&&Array.isArray(e[0])}function Hm(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function wt(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new B(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function Bt(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new B(`Expected exactly 1 Shape; got ${e.length}`)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Km(e){let t=0;for(const n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((s,r)=>s*r);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const H2="Variable";class X7{constructor(t,n="float32",s=H2,r=!0,o=null){this.dtype=n??"float32",this.shape=t.shape,this.id=KO(),s=s??H2,this.originalName=qO(s),this.name=YO(this.originalName),this.trainable_=r,this.constraint=o,this.val=z8(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),q7(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function q7(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function y1(e){return e.map(t=>t.read())}function IC(e){e.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class je{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class oo{constructor(t,n,s,r,o,i,a){this.dtype=t,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=o,this.outputTensorIndex=a,this.id=KO(),i!=null&&(this.originalName=qO(i),this.name=YO(this.originalName)),this.rank=n.length}}let Y7=0,a0=class{constructor(t,n){this.callArgs=n,this.id=Y7++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const s of t.inboundLayers)s!=null&&s.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},Q7=0;class Dt extends iu{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Q7++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const s=this.getClassName();n=vo(s)+"_"+o0(s)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let s;if(t.batchInputShape!=null)s=t.batchInputShape;else if(t.inputShape!=null){let o=null;t.batchSize!=null&&(o=t.batchSize),s=[o].concat(t.inputShape)}this.batchInputShape=s;let r=t.dtype;r==null&&(r=t.inputDType),r==null&&(r="float32"),this.dtype=r}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new Xs(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new B(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return Hn(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Hn(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Wr(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Wr(`Layer ${this.name} is not connected, no input to return.`);return Hn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Wr(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Wr(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Hn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const n=qt(t);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=qt(this.inputSpec);if(n.length!==s.length)throw new B(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${t}`);for(let r=0;r<n.length;r++){const o=n[r],i=s[r];if(i==null)continue;const a=o.rank;if(i.ndim!=null&&a!==i.ndim)throw new B(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new B(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new B(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&o.dtype!==i.dtype)throw new B(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${o.dtype}.`);if(i.axes){const l=o.shape;for(const c in i.axes){const u=Number(c),d=i.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new B(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const c=i.shape[l],u=o.shape[l];if(c!=null&&u!=null&&c!==u)throw new B(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${o.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const s=qt(t),r=t9(t),o=e9(t);if(r===o)throw new B("Arguments to apply() must be all SymbolicTensors or all Tensors");return Ba(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const i=[];for(const a of qt(t))i.push(a.shape);this.build(Hn(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(t),o){let i=this.call(t,n);this.supportsMasking&&this.setMaskMetadata(t,i);const a=qt(i),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=Hn(l),this.activityRegularizer!=null)throw new Tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=Z7(t),a=this.computeOutputShape(i);let l;const c=J7(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new oo(c,u,this,qt(t),n,this.name,d)):l=new oo(c,a,this,qt(t),n,this.name),this.addInboundNode(t,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new Tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&t[r]!=null&&t[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Wr(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);t.indexOf(s)===-1&&t.push(s)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Wr(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Xs(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Km(this.weights)}build(t){this.built=!0}getWeights(t=!1){return y1(t?this.trainableWeights:this.weights)}setWeights(t){G(()=>{const n=this.weights;if(n.length!==t.length)throw new B(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const s=[],r=y1(n);for(let o=0;o<r.length;++o){const i=r[o],a=n[o],l=t[o];if(!Ht(i.shape,l.shape))throw new B(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}IC(s)})}addWeight(t,n,s,r,o,i,a,l){if(this._addedWeightNames.indexOf(t)!==-1)throw new B(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():xe("zeros"));const c=r.apply(n,s),u=new X7(c,s,t,i,a);return c.dispose(),o!=null&&this.addLoss(()=>o.apply(u.read())),i==null&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=qt(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(t,n,s){if(!this.supportsMasking)return;const r=this.computeMask(t,s),o=qt(n),i=qt(r);if(o.length!==i.length)throw new Error(`${this.name} outputs ${o.length} tensors but ${o.length} masks for those tensors`);for(let a=0;a<o.length;a++)o[a].kerasMask=i[a]}addInboundNode(t,n,s,r,o,i,a=null){const l=qt(t);n=qt(n),s=qt(s),r=qt(r),o=Hm(o),i=Hm(i);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new a0({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:o,outputShapes:i},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function Z7(e){e=qt(e);const t=[];for(const n of e)t.push(n.shape);return Hn(t)}function J7(e){return"float32"}function aF(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{const s=t.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let o=0;o<s.inboundLayers.length;o++){const i=s.inputTensors[o],a=s.inboundLayers[o],l=s.nodeIndices[o],c=aF(i,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function t9(e){let t=!0;for(const n of qt(e))if(!(n instanceof oo)){t=!1;break}return t}function e9(e){let t=!0;for(const n of qt(e))if(n instanceof oo){t=!1;break}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kf extends Dt{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:o0("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new B("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new B("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new B("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=t.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new oo(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new a0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new B(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}kf.className="InputLayer";tt(kf);function n9(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new B("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new kf({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function s9(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return ct(t,e.dtype)}catch{throw new B(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}class yi{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof yi)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,s){if(this.id2Value[t.id]==null)this.id2Value[t.id]=s9(t,n),this.name2Id[t.name]=t.id,s!=null&&(this.id2Mask[t.id]=s);else throw new B(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof oo){if(this.id2Value[t.id]==null)throw new B(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new B(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof oo){if(this.id2Value[t.id]==null)throw new B(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new B(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&At(this.id2Mask)}}const Xm=new jO,qm=new jO;function r9(e){Xm!=null&&Xm.setMaxEntries(e),qm!=null&&qm.setMaxEntries(e)}function Uu(e,t,n,s){const r=n==null?!1:n.training,o=Array.isArray(e),i=o?e:[e],a=i.map(p=>p.name),l=[],c=t.names();for(const p of a)c.indexOf(p)!==-1?l.push(t.getValue(p)):l.push(null);const u=a.join(",")+"|"+t.names().sort().join(",");let d=Xm.get(u),h;if(d==null){const p=o9(i,t);d=p.sorted,h=p.recipientCounts,Xm.put(u,d),qm.put(u,h)}h={},r||Object.assign(h,qm.get(u));const f=new yi(t);for(let p=0;p<d.length;++p){const m=d[p],g=m.sourceLayer;if(g instanceof kf)continue;const x=[],y=[],b=[];let v=!1;for(const I of m.inputs){const $=f.getValue(I),E=f.getMask(I);x.push($),y.push(E),E!=null&&(v=!0),r||(h[I.name]--,h[I.name]===0&&!t.hasKey(I)&&a.indexOf(I.name)===-1&&!$.isDisposed&&I.sourceLayer.stateful!==!0&&b.push($))}v&&(n=n||{},n.mask=y[0]);const w=qt(g.apply(x,n));let k=null;g.supportsMasking&&(k=g.computeMask(x,y));const C=a9(m),S=Array.isArray(C)?C:[C];for(let I=0;I<S.length;++I){f.hasKey(S[I])||f.add(S[I],w[I],Array.isArray(k)?k[0]:k);const $=a.indexOf(S[I].name);$!==-1&&(l[$]=w[I])}r||At(b)}return f.disposeMasks(),o?l:l[0]}function o9(e,t){T(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(e.length===1){const r=K2(e[0],t);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const o of e){const{sorted:i,recipientMap:a}=K2(o,t);for(const l of i)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:i9(s)}}function i9(e){const t={};for(const n in e)t[n]=e[n].size;return t}function K2(e,t){const n=new Set,s=[],r={};for(const a of t.names())n.add(a);const o=[],i=[];for(o.push(e);o.length>0;){const a=o[o.length-1];if(n.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),s.push(a),n.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&o.push(c)}}return{sorted:s,recipientMap:r}}function a9(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let s=0;s<e.sourceLayer.inboundNodes.length;++s)for(const r of e.sourceLayer.inboundNodes[s].outputTensors)if(r.id===e.id){n=s;break}t=e.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l9=K();l9.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,r9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $C(e,t){return G(()=>bn(mt(F(e,e),t,!0)))}class Cf extends iu{getConfig(){return{}}}class lF extends Cf{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return G(()=>{const n=$C(t,this.axis),s=_s(n,0,this.maxValue);return F(t,xt(s,et(Ue(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}lF.className="MaxNorm";tt(lF);class cF extends Cf{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return G(()=>xt(t,et(Ue(),$C(t,this.axis))))}getConfig(){return{axis:this.axis}}}cF.className="UnitNorm";tt(cF);class uF extends Cf{apply(t){return Ho(t)}}uF.className="NonNeg";tt(uF);class dF extends Cf{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return G(()=>{const n=$C(t,this.axis),s=et(F(this.rate,_s(n,this.minValue,this.maxValue)),F(1-this.rate,n));return F(t,xt(s,et(Ue(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}dF.className="MinMaxNorm";tt(dF);const X2={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ge(e){return mC(e)}function q2(e,t={}){return yf(e,Us.getMap().classNameMap,t,"constraint")}function He(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in X2?X2[e]:e,config:{}};return q2(n)}else return e instanceof Cf?e:q2(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function da(e){if(e==null)return;const t=[],n=[],s=[];for(const r in e){const o=e[r];if(typeof o!="number"){const i=o;t.push(i.data()),n.push(r),s.push(i)}}if(t.length>0){const r=await Promise.all(t);for(let o=0;o<r.length;++o)e[n[o]]=r[o][0];At(s)}}function hF(e){if(e!=null)for(const t in e){const n=e[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Y2;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(Y2||(Y2={}));const c9=125;class Ud{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,n){}async onEpochEnd(t,n){}async onBatchBegin(t,n){}async onBatchEnd(t,n){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class u9{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}async onEpochBegin(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(t,n)}async onEpochEnd(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(t,n)}async onBatchBegin(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(t,n)}async onBatchEnd(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(t,n)}async onTrainBegin(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainEnd(t)}}class d9 extends Ud{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const o=n[r];if(typeof o=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+o*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const a=G(()=>et(this.totals[r],F(o,s)));this.totals[r]=a,i!=null&&i.dispose()}}}async onEpochEnd(t,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:G(()=>{const r=F(xt(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),Qr(n[s])}))}}class h9 extends Ud{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,n){n==null&&(n={}),this.epoch.push(t);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const t=[],n=[],s=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];t.push(l.data()),n.push(o),s.push(a)}}const r=await Promise.all(t);for(let o=0;o<r.length;++o)this.history[n[o]][s[o]].dispose(),this.history[n[o]][s[o]]=r[o][0]}}class f9 extends Ud{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||xO,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=c9),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Kb(this.yieldEvery)&&(this.maybeWait=$7(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,n,s){const r=[];this.yield!=null&&(await da(s),r.push(this.yield(t,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,n){this.currentEpoch=t,this.epochBegin!=null&&(await da(n),await this.epochBegin(t,n))}async onEpochEnd(t,n){const s=[];this.epochEnd!=null&&(await da(n),s.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(t,n){this.batchBegin!=null&&(await da(n),await this.batchBegin(t,n))}async onBatchEnd(t,n){const s=[];this.batchEnd!=null&&(await da(n),s.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Kb(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,t,n)),await Promise.all(s)}async onTrainBegin(t){this.trainBegin!=null&&(await da(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await da(t),await this.trainEnd(t))}}function fF(e,t){return e==null&&(e={}),e instanceof Ud?[e]:Array.isArray(e)&&e[0]instanceof Ud?e:qt(e).map(s=>new f9(s,t))}class zs{constructor(){}static registerCallbackConstructor(t,n){T(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),zs.checkForDuplicate(n),zs.constructors[t]==null&&(zs.constructors[t]=[]),zs.constructors[t].push(n)}static checkForDuplicate(t){for(const n in zs.constructors)zs.constructors[+n].forEach(r=>{if(r===t)throw new B("Duplicate callback constructor.")})}static clear(){zs.constructors={}}static createCallbacks(t){const n=[];for(const s in zs.constructors){const r=+s;t>=r&&n.push(...zs.constructors[r])}return n.map(s=>new s)}}zs.constructors={};function pF(e,t,n,s,r,o,i,a,l){const c=new h9,u=[new d9,...zs.createCallbacks(t)];e!=null&&u.push(...e),u.push(c);const d=new u9(u);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:o,batchSize:i,verbose:t,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _o(e,t={},n=!1){return yf(e,Us.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ym(e,t){return G(()=>{e.dtype!=="float32"&&(e=ct(e,"float32"));const n=mt(vf(e),t,!0),s=Qx(n.shape,Ue()),r=bn(ra(n,s));return xt(e,r)})}function l0(e,t){return G(()=>Re(vf(ft(t,e)),-1))}function TC(e,t){return G(()=>Re(Qe(ft(t,e)),-1))}function NC(e,t){return G(()=>{const n=ft(e,t),s=_s(Qe(e),Ue(),Number.MAX_VALUE),r=Qe(xt(n,s));return F(100,Re(r,-1))})}function p9(e,t){return G(()=>{const n=_s(t,Ue(),Number.MAX_VALUE),s=tr(et(1,n)),r=_s(e,Ue(),Number.MAX_VALUE),o=tr(et(1,r));return Re(vf(ft(s,o)),-1)})}function m9(e,t){return G(()=>{const n=ra(0,ft(1,F(e,t)));return Re(vf(n),-1)})}function g9(e,t){return G(()=>{const n=ra(0,ft(1,F(e,t)));return Re(n,-1)})}function x9(e,t){return G(()=>{const n=mt(F(e,t),-1),s=kr(F(ft(1,e),t),-1);return ra(0,et(1,ft(s,n)))})}function y9(e,t){return G(()=>{const n=Math.log(2),s=ft(t,e),r=ft(et(s,df(F(-2,s))),n);return Re(r,-1)})}function jd(e,t,n=!1){return G(()=>{if(n)t=Dk(t);else{const s=mt(t,t.shape.length-1,!0);t=xt(t,s)}return t=_s(t,Ue(),1-Ue()),be(mt(F(ct(e,"float32"),tr(t)),t.shape.length-1))})}function Qm(e,t,n=!1){return G(()=>{const s=ct(t0(L7(e)),"int32");t=_s(t,Ue(),1-Ue());const r=t.shape,o=j(LA(s,r[r.length-1]),r);return jd(o,t,n)})}function b9(e,t){if(!Ht(e.shape,t.shape))throw new B(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return G(()=>{const n=Ho(t),s=be(Qe(t));return et(ft(n,F(t,e)),mk(Rs(s)))})}function c0(e,t){return G(()=>{let n;return n=_s(t,Ue(),1-Ue()),n=tr(xt(n,ft(1,n))),Re(b9(e,n),-1)})}function v9(e,t){return G(()=>{const n=_s(e,Ue(),1),s=_s(t,Ue(),1);return mt(F(e,tr(xt(n,s))),-1)})}function w9(e,t){return G(()=>{const n=tr(et(Ue(),t));return Re(ft(t,F(e,n)),-1)})}function mF(e,t){return G(()=>{const n=Ym(e,-1),s=Ym(t,-1),r=F(n,s);return be(mt(r,-1))})}const Zm={meanSquaredError:l0,meanAbsoluteError:TC,meanAbsolutePercentageError:NC,meanSquaredLogarithmicError:p9,squaredHinge:m9,hinge:g9,categoricalHinge:x9,logcosh:y9,categoricalCrossentropy:jd,sparseCategoricalCrossentropy:Qm,binaryCrossentropy:c0,kullbackLeiblerDivergence:v9,poisson:w9,cosineProximity:mF};function by(e){if(typeof e=="string"){if(e in Zm)return Zm[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new B(t)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gF(e,t){return G(()=>{const n=F(.5,er(t)),s=Jr(Os(t,n),e.dtype);return Re(ro(e,s),-1)})}function xF(e,t){return G(()=>Jr(ro(Ld(e,-1),Ld(t,-1)),"float32"))}function k9(e,t){return G(()=>ct(mt(Mo(ro(e,1),ro(t,1))),"float32"))}function C9(e,t){return G(()=>ct(mt(Mo(ro(e,0),ro(t,1))),"float32"))}function S9(e,t){return G(()=>{const n=k9(e,t),s=C9(e,t),r=et(n,s);return ct(On(Os(r,0),xt(n,r),0),"float32")})}function I9(e,t){return c0(e,t)}function $9(e,t){return e.rank===t.rank&&(e=ff(e,[e.rank-1])),t=Ld(t,-1),t.dtype!==e.dtype&&(t=ct(t,e.dtype)),ct(ro(e,t),"float32")}const T9=l0,N9=l0,E9=TC,_9=TC,R9=NC,D9=NC,yF=jd,A9=mF,bF=Qm,Jm={binaryAccuracy:gF,categoricalAccuracy:xF,precision:S9,categoricalCrossentropy:yF,sparseCategoricalCrossentropy:bF,mse:T9,MSE:N9,mae:E9,MAE:_9,mape:R9,MAPE:D9,cosine:A9};function O9(e){if(typeof e=="string"&&e in Jm)return Jm[e];if(typeof e!="string"&&e!=null)return e;throw new B(`Unknown metric ${e}`)}function lp(e){if(Ur(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(const n of Object.keys(Zm))if(Zm[n]===e){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(Jm))if(Jm[n]===e){t=n;break}return t!==void 0?t:e.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function F9(e){const t={Adagrad:()=>bo.adagrad(.01),Adadelta:()=>bo.adadelta(1,.95,Ue()),Adam:()=>bo.adam(.001,.9,.999,Ue()),Adamax:()=>bo.adamax(.002,.9,.999,Ue(),0),RMSProp:()=>bo.rmsprop(.001,.9,0,Ue()),SGD:()=>bo.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new B(`Unknown Optimizer ${e}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Q2=1*1024*1024;function Z2(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!b1(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(e);s.length>Q2&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${Q2}.`)}}function b1(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t)if(typeof n!="string"||!b1(e[n]))return!1;return!0}else if(Array.isArray(e)){for(const t of e)if(!b1(t))return!1;return!0}else return!1;else{const t=typeof e;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function P9(e,t,n,s=console.log){const r=L9(e),o=["Layer (type)","Input Shape","Output shape","Param #"];r?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(t*u)));let i;if(!r){o.push("Receives inputs"),i=[];for(const u in e.nodesByDepth)i.push(...e.nodesByDepth[u])}s("_".repeat(t)),tg(o,n,s),s("=".repeat(t));const a=e.layers;for(let u=0;u<a.length;++u)r?z9(a[u],n,s):B9(a[u],n,i,s),s((u===a.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=M9(e),c=Km(e.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(t))}function M9(e){let t;return e.collectedTrainableWeights!=null?t=Km(e.collectedTrainableWeights):t=Km(e.trainableWeights),t}function L9(e){let t=!0;const n=[],s=[];for(const r in e.nodesByDepth)n.push(e.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){t=!1;break}s.push(...r)}if(t)for(const r of e.layers){let o=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(o){t=!1;break}else o=!0;if(!t)break}return t}function tg(e,t,n=console.log){let s="";for(let r=0;r<e.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=e[r],s=s.slice(0,t[r]),s+=" ".repeat(t[r]-s.length);n(s)}function z9(e,t,n){let s,r;try{r=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(e.outputShape)}catch{s="multiple"}const o=e.name,i=e.getClassName(),a=[`${o} (${i})`,r,s,e.countParams().toString()];tg(a,t,n)}function B9(e,t,n,s){let r,o;try{o=e.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}const i=[];for(const d of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];i.push(`${f}[${p}][${m}]`)}const a=e.name,l=e.getClassName(),c=i.length===0?"":i[0],u=[`${a} (${l})`,o,r,e.countParams().toString(),c];tg(u,t,s);for(let d=1;d<i.length;++d)tg(["","","","",i[d]],t,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vF(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function v1(e,t){if(e===null)return null;if(typeof e=="string")return Ca(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],s=e.length;for(let r=0;r<s;++r){const o=e[r];vF(t,r,o)?n.push(o):n.push(v1(o,t))}return n}else{const n={};for(const s of Object.keys(e)){const r=e[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const o=Ca(s);n[o]=v1(r,o)}}return n}}function w1(e,t){if(e==null)return null;if(typeof e=="string")return vo(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],s=e.length;for(let r=0;r<s;++r){const o=e[r];vF(t,r,o)?n.push(o):n.push(w1(o,t))}return n}else{const n={};for(const s of Object.keys(e)){const r=e[s],o=vo(s);(s==="name"||s==="className")&&typeof r=="string"?n[o]=r:n[o]=w1(r,s)}return n}}/** @license See the LICENSE file. */const wF="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const V9=e=>{const t=Object.keys(e);if(t.length===0)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class cr extends Dt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=o0(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],Fi(this.inputs).length!==this.inputs.length)throw new B(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);Fi(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const b=y.sourceLayer,v=y.nodeIndex,w=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push(w)}for(const y of this.inputs){const b=y.sourceLayer,v=y.nodeIndex,w=y.tensorIndex;Ur(v===0,"input layer has >1 nodes"),Ur(w===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const b=this.inputLayers[y];if(!(b instanceof kf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},s={},r={},o={},i={},a=[],l=(y,b,v,w,k,C)=>{(w==null||k==null||C==null)&&(w=y.sourceLayer,k=y.nodeIndex,C=y.tensorIndex);const S=w.inboundNodes[k];if(v.indexOf(S)!==-1)throw new Xs(`The tensor ${y.name} at layer "${w.name}" is part of a cycle.`);if(b.indexOf(S)!==-1)return;this.containerNodes.add(cr.nodeKey(w,k)),w.id in i||(i[w.id]=Object.keys(i).length),v.indexOf(S)===-1&&v.push(S);const I=S.inboundLayers.length;for(let $=0;$<I;$++){const E=S.inputTensors[$],A=S.inboundLayers[$],L=S.nodeIndices[$],O=S.tensorIndices[$];l(E,b,v,A,L,O)}for(b.push(S);v.indexOf(S)>=0;)v.splice(v.indexOf(S),1);a.push(S)},c=[],u=[];for(const y of this.outputs)l(y,c,u);const d=a.slice().reverse();for(const y of d){s[y.id]=y,y.id in n||(n[y.id]=0);let b=n[y.id];const v=r[y.outboundLayer.id]==null?0:r[y.outboundLayer.id];b=Math.max(b,v),r[y.outboundLayer.id]=b,o[y.outboundLayer.id]=y.outboundLayer,n[y.id]=b;for(let w=0;w<y.inboundLayers.length;w++){const k=y.inboundLayers[w],C=y.nodeIndices[w],S=k.inboundNodes[C],I=n[S.id]==null?0:n[S.id];n[S.id]=Math.max(b+1,I),s[S.id]=S}}const h={};for(const y in n){const b=n[y];b in h||(h[b]=[]),h[b].push(s[y])}const f={};for(const y in r){const b=r[y];b in f||(f[b]=[]),f[b].push(o[y])}let p=Object.keys(f).map(y=>parseInt(y,10)).sort(op);this.layers=[];for(const y of p){const b=f[y];b.sort((v,w)=>{const k=i[v.id],C=i[w.id];return k<C?-1:k>C?1:0});for(const v of b)v instanceof cr&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=f,p=Object.keys(h).map(y=>parseInt(y,10)).sort(op);const m=this.inputs.slice(),g=[];for(const y of p)for(const b of h[y]){const v=b.outboundLayer;if(v!=null){for(const w of b.inputTensors)if(m.indexOf(w)===-1)throw new Xs(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${v.name}". The following previous layers were accessed without issue: ${g}`);for(const w of b.outputTensors)m.push(w);g.push(v.name)}}this.nodesByDepth=h;const x=this.layers.map(y=>y.name);for(const y of x){const b=x.filter(v=>v===y).length;if(b!==1)throw new Xs(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new a0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new B("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const s={};let r=0;const o=V9(t);o&&this.parseWeights(t);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=o?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new B(`Duplicate weight name: ${u}`);s[u]=c,r++}const i=[];for(const a in t){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],t[a]]);else if(n)throw new B(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new B(`${a.length} of ${r} weights are not set: ${a}`)}IC(i)}parseWeights(t){for(const n in Object.keys(t)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],o=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");o!==n&&(t[o]=t[n],delete t[n])}}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${wF}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const s=w1(this.updatedConfig());return n?JSON.stringify(s):s}call(t,n){return G(()=>{t=qt(t);const s=new yi;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],t[r]);return Uu(this.outputs,s,n)})}computeMask(t,n){return G(()=>{t=qt(t);let s;return n==null?s=ll(null,t.length):s=qt(n),this.runInternalGraph(t,s)[1]})}computeOutputShape(t){const n=Hm(t);if(n.length!==this.inputLayers.length)throw new B(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(op);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const d=[];for(let m=0;m<c.inboundLayers.length;m++){const g=c.inboundLayers[m],x=c.nodeIndices[m],y=c.tensorIndices[m],b=`${g.name}_${x}_${y}`,v=s[b];d.push(v)}const h=u.computeOutputShape(Hn(d)),f=Hm(h),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const g=`${u.name}_${p}_${m}`;s[g]=f[m]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;i.push(d)}for(let a=0;a<i.length;a++){const l=i[a];Ur(l in s),o.push(s[l])}return Hn(o)}runInternalGraph(t,n){n==null&&(n=ll(null,t.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=t[l],d=n[l];s[c.id]=[u,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(op);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of h)m.id in s&&p.push(s[m.id]);if(p.length===h.length){let m={},g,x,y,b;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[v,w]=p[0];m.mask==null&&(m.mask=w),y=qt(d.call(v,m)),b=qt(d.computeMask(v,w)),g=[v],x=[w]}else g=p.map(v=>v[0]),x=p.map(v=>v[1]),m.mask==null&&(m.mask=x),y=qt(d.call(g,m)),b=qt(d.computeMask(g,x));if(d.activityRegularizer)throw new Tt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<f.length;++v){const w=f[v],k=y[v],C=b[v];s[w.id]=[k,C]}}}}const o=[],i=[],a=[];for(const l of this.outputs){Ur(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),o.push(c),i.push(u)}return[o,i,a]}buildNodeConversionMap(t){const n={};let s;for(const r of this.layers){s=r instanceof cr?1:0;for(let o=0;o<r.inboundNodes.length;o++){const i=cr.nodeKey(r,o);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new B("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const s of this.layers)if(s.name===t)return s;throw new B(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new B(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return G(()=>{const t=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=cr.nodeKey(n,s);this.containerNodes.has(r)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),c=[];for(let d=0;d<i.inboundNodes.length;d++){const h=i.inboundNodes[d],f=cr.nodeKey(i,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let g=0;g<h.inboundLayers.length;g++){const x=h.inboundLayers[g],y=h.nodeIndices[g],b=h.tensorIndices[g],v=cr.nodeKey(x,y);let w=n[v];w==null&&(w=0),m.push([x.name,w,b,p])}c.push(m)}}}const u={};u.name=i.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}t.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=cr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[i];r.push([a.name,u,d])}t.inputLayers=r;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=cr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[i];o.push([a.name,u,d])}return t.outputLayers=o,t}static fromConfig(t,n,s={},r=!1){const o={},i={};function a(g,x){g.name in i?i[g.name].push(x):i[g.name]=[x]}function l(g,x){const y=[];let b;for(const v of x){const w=v[0],k=v[1],C=v[2];if(b=v[3]==null?{}:v[3],!(w in o)){a(g,x);return}const S=o[w];if(S.inboundNodes.length<=k){a(g,x);return}const I=S.inboundNodes[k];y.push(I.outputTensors[C])}y.length>0&&g.apply(Hn(y),b)}function c(g){const x=g.name,y=_o(g,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(r),o[x]=y,g.inboundNodes.forEach(v=>{if(!(v instanceof Array))throw new B(`Corrupted configuration, expected array for nodeData: ${v}`);a(y,v)})}const u=n.name,d=n.layers;for(const g of d)c(g);for(;!I7(i);)for(const g of d){const x=o[g.name];if(x.name in i){const y=i[x.name];delete i[x.name];for(const b of y)l(x,b)}}const h=[],f=[],p=n.inputLayers;for(const g of p){const x=g[0],y=g[1],b=g[2];Ur(x in o);const w=o[x].inboundNodes[y].outputTensors;h.push(w[b])}const m=n.outputLayers;for(const g of m){const x=g[0],y=g[1],b=g[2];Ur(x in o);const w=o[x].inboundNodes[y].outputTensors;f.push(w[b])}return new t({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new B("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){G(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function W9(e,t,n){const s=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>null);if(s===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==s)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){const r=[];return t.forEach(o=>{o in e?r.push(e[o]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function kF(e,t){return W9(e,t,"classWeight")}async function CF(e,t,n,s){if(n!=null){const r=G(()=>{if(e.shape.length===1)return za(e);if(e.shape.length===2){if(e.shape[1]>1)return Ld(e,1);if(e.shape[1]===1)return j(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await r.data());At(r);const i=[];return o.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),cs(i,"float32")}else return null}function U9(e,t){return F(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const j9=32;function SF(e,t){let n,s;const r=t;n=r.xs,s=r.ys,T(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const o=J2("input",e.inputNames,n),i=J2("output",e.outputNames,s),a=o[0].shape[0];T(o.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),T(i.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<o.length;l++)T(o[l].shape[0]===a,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);for(let l=0;l<i.length;l++)T(i[l].shape[0]===a,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);return{xs:o,ys:i}}function J2(e,t,n){if(n instanceof Ve)return[n];if(Array.isArray(n))return T(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{const s=[];for(const r of t){if(n[r]==null)throw new B(`The feature data generated by the dataset lacks the required ${e} key '${r}'.`);s.push(n[r])}return s}}function G9(e){if(e.length===3)throw new Tt("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function H9(e,t,n){const s=n.batchesPerEpoch!=null;if(T(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),T(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),T(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const r=n.validationData!=null;let o,i;if(r)if(t$(n.validationData))T(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const g=G9(n.validationData);o=g.xs,i=g.ys}const a=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();const u=fF(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=pF(u,d,n.epochs,null,null,K9(t,n),null,r,c);h.setModel(e),e.history=f,await h.onTrainBegin(),e.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await t.iterator();for(;p<n.epochs;){const g={};await h.onEpochBegin(p);let x=0,y=0;for(s||(m=await t.iterator());!s||x<n.batchesPerEpoch;){const b=await m.next();if(s&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:v,ys:w}=SF(e,b.value),k={};k.batch=y,k.size=v[0].shape[0],await h.onBatchBegin(y,k);const C=[];if(n.classWeight!=null){const $=kF(n.classWeight,e.outputNames);for(let E=0;E<$.length;++E)C.push(await CF(w[E],null,$[E]))}const S=v.concat(w).concat(C),I=a(S);At(S);for(let $=0;$<l.length;++$){const E=l[$],A=I[$];k[E]=A,Qr(A)}await h.onBatchEnd(y,k),hF(k),y++,x++}if(s?x>=n.batchesPerEpoch:b.done){if(r){let v;t$(n.validationData)?v=qt(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):v=qt(e.evaluate(o,i,{batchSize:n.validationBatchSize==null?j9:n.validationBatchSize,verbose:0}));for(let w=0;w<e.metricsNames.length;++w)g[`val_${e.metricsNames[w]}`]=v[w]}break}if(e.stopTraining_)break}if(await h.onEpochEnd(p,g),p++,e.stopTraining_)break}return await h.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function K9(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function t$(e){return typeof e.iterator=="function"}function X9(e){return typeof e.next=="function"}async function q9(e,t,n){n=n||{};const s=n.batches!=null,r=e.testFunction;let o=[];if(n.verbose>0)throw new Tt("Verbose mode is not implemented yet.");T(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=X9(t)?t:await t.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await i.next();if(o=G(()=>{if(c.value){const{xs:u,ys:d}=SF(e,c.value),h=u.concat(d),f=G(()=>r(h));if(At(h),l===0)for(let m=0;m<f.length;++m)o.push(kt(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const g=f[m],x=o[m];o[m]=G(()=>et(o[m],F(p,g))),l>0&&At(x)}At(f),a+=p,++l}return o}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<o.length;++c){const u=o[c];o[c]=xt(o[c],a),At(u)}return Hn(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vy(e){T(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function _u(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(s=>Va(s,t,n-t)):Va(e,t,n-t)}function k1(e,t){return G(()=>e==null?null:Array.isArray(e)?e.map(n=>k1(n,t)):ZO(e,t.dtype==="int32"?t:ct(t,"int32")))}function wy(e,t){const n=[];let s=0,r=null;for(;s<e;)r=s+t,r>=e&&(r=e),n.push([s,r]),s=r;return n}function IF(e){const t=[];e instanceof Ve&&(e=[e]);for(let n=0;n<e.length;++n){const s=e[n];if(s.rank===1)t.push(bf(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(s)}}return t}function lr(e,t){if(e==null)return;const n=[];if(t instanceof Ve)n.push(t.id);else if(Array.isArray(t))t.forEach(r=>n.push(r.id));else if(t!=null)for(const r in t){const o=t[r];n.push(o.id)}const s=[];if(e instanceof Ve)n.indexOf(e.id)===-1&&s.push(e);else if(Array.isArray(e))e.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(e!=null)for(const r in e){const o=e[r];n.indexOf(o.id)===-1&&s.push(o)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Y9(e){return e instanceof Ve}function C1(e){return Array.isArray(e)}function e$(e){return!Y9(e)&&!C1(e)}function n$(e,t,n,s=!0,r=""){if(t==null||t.length===0){if(e!=null){let i=!1;if(C1(e)&&e.length>0)i=!0;else if(e$(e)){for(const a in e)if(e.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new B(`Error when checking model ${r} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(i=>null);let o;if(e$(e)){e=e,o=[];for(const i of t){if(e[i]==null)throw new B(`No data provided for "${i}". Need data for each key in: ${t}`);o.push(e[i])}}else if(C1(e)){if(e=e,e.length!==t.length)throw new B(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);o=e}else{if(e=e,t.length>1)throw new B(`The model ${r} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);o=[e]}if(o=IF(o),n!=null)for(let i=0;i<t.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new B(`Error when checking ${r}: expected ${t[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u>=0&&c!==u)throw new B(`${r} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function Q9(e,t,n){const s=Fi(e.map(o=>o.shape[0]));s.sort();const r=Fi(t.map(o=>o.shape[0]));if(r.sort(),s.length>1)throw new B(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(r.length>1)throw new B(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(o=>o.shape))}`);if(s.length>0&&r.length>0&&!Ht(s,r))throw new B(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function Z9(e,t,n){const s=[l0,c0,jd];for(let r=0;r<e.length;++r){const o=e[r],i=t[r],a=n[r];if(i!=null){if(i===jd&&o.shape[o.shape.length-1]===1)throw new B(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=o.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new B(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function s$(e,t,n,s=!0,r=""){let o;if(Array.isArray(e)){if(e.length!==t.length)throw new B(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);o=e}else{if(t.length>1)throw new B(`The model expects ${t.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);o=[e]}if(n!=null)for(let i=0;i<t.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new B(`Error when checking ${r}: expected ${t[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u!==c)throw new B(`Error when checking ${r}: expected ${t[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function J9(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(s=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(s=>n);{const s=[];for(const r of t){let o=n.hasOwnProperty(r)?n[r]:[];Array.isArray(o)||(o=[o]),s.push(o)}return s}}const tQ="layers-model";class ac extends cr{constructor(t){super(t),this.isTraining=!1}summary(t,n,s=console.log){if(!this.built)throw new B("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");P9(this,t,n,s)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=F9(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof oa))throw new B("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const i in t.loss)if(this.outputNames.indexOf(i)===-1)throw new B(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)t.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(by(t.loss[i]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new B(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(a=>by(a))}else{const i=by(t.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Ba("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=J9(t.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};Ba("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=r[i];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[i];g[g.length-1]===1||this.lossFunctions[i]===c0?["accuracy","acc"].indexOf(p)!==-1?h=gF:["crossentropy","ce"].indexOf(p)!==-1&&(h=I9):this.lossFunctions[i]===Qm?["accuracy","acc"].indexOf(p)!==-1?h=$9:["crossentropy","ce"].indexOf(p)!==-1&&(h=bF):["accuracy","acc"].indexOf(p)!==-1?h=xF:["crossentropy","ce"].indexOf(p)!==-1&&(h=yF);let x;["accuracy","acc"].indexOf(p)!==-1?x="acc":["crossentropy","ce"].indexOf(p)!==-1&&(x="ce"),f=h,d=u+x}else f=O9(p),d=u+lp(p);let m;Ba(d,()=>{m=f}),o(i,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,s={}){const r=s.batchSize==null?32:s.batchSize;vy(r);const i=this.standardizeUserDataXY(t,n,!0,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return Hn(c)}finally{lr(i[0],t),lr(i[1],n)}}async evaluateDataset(t,n){return this.makeTestFunction(),q9(this,t,n)}checkNumSamples(t,n,s,r="steps"){let o;if(s!=null){if(o=null,n!=null)throw new B(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?o=t[0].shape[0]:o=t.shape[0];else throw new B(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return o}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new B("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],o=this.retrieveSymbolicTensors(r),i=new yi;if(t instanceof Ve&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new B(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],t[l])}else for(const l of this.inputs){const c=t[l.name];if(c==null)throw new B(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const a=Uu(o,i);return s?a:a[0]}retrieveSymbolicTensors(t){const n=ll(null,t.length);let s=t.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],i=o.map(a=>a.name);for(let a=0;a<t.length;++a){const l=i.indexOf(t[a]);if(l!==-1&&(n[a]=o[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((o,i)=>{o==null&&r.push(t[i])}),new B(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(t,n=32,s=!1){return G(()=>{const r=this.checkNumSamples(t);if(s)throw new Tt("Verbose predictLoop() is not implemented yet.");const o=wy(r,n),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)G(()=>{const c=o[a][0],u=o[a][1],d=_u(t,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new yi(h);return Uu(this.outputs,f)}).forEach((c,u)=>i[u].push(c));return Hn(i.map(a=>qn(a,0)))})}predict(t,n={}){const s=IF(t);s$(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return vy(r),this.predictLoop(s,r)}finally{lr(s,t)}}predictOnBatch(t){s$(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,s=!0,r){if(this.optimizer_==null)throw new Xs("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===Qm?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(t=n$(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=n$(n,this.feedOutputNames,o,!1,"target"),Q9(t,n),Z9(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&t[0].shape[0]%r!==0)throw new B(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}async standardizeUserData(t,n,s,r,o=!0,i){const[a,l]=this.standardizeUserDataXY(t,n,o,i);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=kF(r,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await CF(l[d],null,u[d]))}return[a,l,c]}testLoop(t,n,s,r=0,o){return G(()=>{const i=this.checkNumSamples(n,s,o,"steps"),a=[];if(r>0)throw new Tt("Verbose mode is not implemented yet.");if(o!=null)throw new Tt("steps mode in testLoop() is not implemented yet");{const l=wy(i,s),c=cs(Nr(0,i));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=Va(c,d,h-d),p=k1(n,f),m=t(p);if(u===0)for(let g=0;g<m.length;++g)a.push(kt(0));for(let g=0;g<m.length;++g){const x=m[g];a[g]=et(a[g],F(h-d,x))}}for(let u=0;u<a.length;++u)a[u]=xt(a[u],i)}return a})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let s=0;s<t.length;++s){const r=t[s];let o=r;if(V2(t,r)>1){const i=V2(t.slice(0,s),r);o+=`_${i}`}n.push(o)}return n}makeTrainFunction(){return t=>{const n=[],s=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:s[m]});const h=new yi(d),f=Uu(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let x=g(r[m],f[m]);o[m]!=null&&(x=U9(x,o[m]));const y=Re(x);n.push(y),m===0?p=x:p=et(p,x)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=n[m];else{const x=this.metricsTensors[m][0],y=this.metricsTensors[m][1];g=Re(x(r[y],f[y]))}Qr(g),i.push(g)}return p=Re(p),this.calculateLosses().forEach(m=>{p=et(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=t=>G(()=>{const n=[];let s;const r=t.slice(0,this.inputs.length),o=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:r[c]});const a=new yi(i),l=Uu(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=Re(u(o[c],l[c]));c===0?s=d:s=et(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=Re(u(o[d],l[d]));n.push(h)}return n})}async fit(t,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,o,i,a,l,c,u,d,h;try{const f=s.batchSize==null?32:s.batchSize;vy(f);const m=await this.standardizeUserData(t,n,s.sampleWeight,s.classWeight,!1,f);r=m[0],o=m[1],h=m[2];let g=!1,x;if(s.validationData!=null&&s.validationData.length>0){if(g=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Tt("validationData including sample weights is not supported yet."):new B(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const $=await this.standardizeUserData(l,c,null,null,!0,f);u=$[0],d=$[1],x=u.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){g=!0;const I=Math.floor(r[0].shape[0]*(1-s.validationSplit)),$=r[0].shape[0];u=_u(r,I,$),i=r,r=_u(r,0,I),d=_u(o,I,$),a=o,o=_u(o,0,I),x=u.concat(d)}else s.validationSteps!=null&&(g=!0);const y=r.concat(o).concat(h);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),v=this.getDedupedMetricsNames();let w,k;g?(this.makeTestFunction(),w=this.testFunction,k=v.slice().concat(v.map(I=>"val_"+I))):(w=null,x=[],k=v.slice());const C=fF(s.callbacks,s.yieldEvery);return await this.fitLoop(b,y,v,f,s.epochs,s.verbose,C,w,x,s.shuffle,k,s.initialEpoch,null,null)}finally{this.isTraining=!1,lr(r,t),lr(o,n),lr(i,t),lr(a,n),lr(u,l),lr(d,c),h!=null&&At(h)}}async fitLoop(t,n,s,r,o,i,a,l,c,u,d,h,f,p){r==null&&(r=32),o==null&&(o=1),u==null&&(u=!0),h==null&&(h=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new B("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(n,r,f,"steps_per_epoch");let x;g!=null&&(x=Nr(0,g)),i==null&&(i=1);const{callbackList:y,history:b}=pF(a,i,o,h,g,f,r,m,d);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let v=h;v<o;++v){await y.onEpochBegin(v);const w={};if(f!=null)throw new Tt("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Tt("batch shuffling is not implemneted yet");u&&wG(x);const k=cs(x),C=wy(g,r);for(let S=0;S<C.length;++S){const I={};if(await y.onBatchBegin(S,I),G(()=>{const $=C[S][0],E=C[S][1],A=Va(k,$,E-$);I.batch=S,I.size=E-$;const L=k1(n,A),O=t(L);for(let P=0;P<s.length;++P){const M=s[P],U=O[P];I[M]=U,Qr(U)}if(S===C.length-1&&m){const P=this.testLoop(l,c,r);for(let M=0;M<s.length;++M){const U=s[M],R=P[M];Qr(R),w["val_"+U]=R}}}),await y.onBatchEnd(S,I),hF(I),this.stopTraining_)break}k.dispose()}if(await y.onEpochEnd(v,w),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,n){return H9(this,t,n)}async trainOnBatch(t,n){const s=await this.standardizeUserData(t,n),r=s[0],o=s[1],a=this.makeTrainFunction()(r.concat(o)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return At(a),lr(s[0],t),lr(s[1],n),Hn(l)}getNamedWeights(t){const n=[],s=t!=null&&t.trainableOnly,r=s?this.trainableWeights:this.weights,o=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||n.push({name:r[i].originalName,tensor:o[i]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=C2().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-C2().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=vo(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>vo(n))}else{const n=Object.keys(this.loss);t={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")t[r]=vo(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[vo(lp(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>vo(lp(t)));{const t={};for(const n in this.metrics)t[n]=vo(lp(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=v1(t.optimizer_config),s=_o(n);let r;if(typeof t.loss=="string")r=Ca(t.loss);else if(Array.isArray(t.loss))r=t.loss.map(i=>Ca(i));else if(t.loss!=null){r={};for(const i in t.loss)r[i]=Ca(t.loss[i])}let o;if(Array.isArray(t.metrics))o=t.metrics.map(i=>Ca(i));else if(t.metrics!=null){o={};for(const i in t.metrics)o[i]=Ca(t.metrics[i])}this.compile({loss:r,metrics:o,optimizer:s})}async save(t,n){if(typeof t=="string"){const c=gH(t);if(c.length===0)throw new B(`Cannot find any save handlers for URL '${t}'`);if(c.length>1)throw new B(`Found more than one (${c.length}) save handlers for URL '${t}'`);t=c[0]}if(t.save==null)throw new B("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await I2(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:tQ,generatedBy:`TensorFlow.js tfjs-layers v${wF}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await I2(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=mH([s.data,u])}return this.userDefinedMetadata!=null&&(Z2(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,t.save(a)}setUserDefinedMetadata(t){Z2(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}ac.className="Model";tt(ac);class $F extends ac{}$F.className="Functional";tt($F);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Pc extends ac{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:o0("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new B(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof Pc||t instanceof ac;let s;if(n){if(s=t,s.outputs.length!==1)throw new B("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new B("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new B("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=n9({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(t.inboundNodes.length!==1)throw new B(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new B("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=aF(this.outputs[0])}this.inboundNodes=[],new a0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ll(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=t.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(Bt(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new ac({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,s=console.log){this.built||this.build(),super.summary(t,n,s)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,s={}){if(!this.built)throw new Xs("The model needs to be compiled before being used.");return this.model.evaluate(t,n,s)}async evaluateDataset(t,n){if(!this.built)throw new Xs("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,s={}){if(!this.built)throw new Xs("The model needs to be compiled before being used.");return this.model.fit(t,n,s)}async fitDataset(t,n){if(!this.built)throw new Xs("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,s={},r=!1){let o,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new B("Legacy serialization format not supported yet.");o=n}else T(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=n.layers,delete n.layers,i=n;const a=new t(i);if(!(a instanceof Pc))throw new Tt(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const u=_o(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(t){if(this.model==null)throw new B("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new B("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),t.push(s)}return{name:this.name,layers:t}}}Pc.className="Sequential";tt(Pc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function eQ(e){return new Pc(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let wn=class extends iu{getConfig(){return{}}};class TF extends wn{apply(t,n=1){return B7(t,n)}}TF.className="elu";tt(TF);class NF extends wn{apply(t){return jA(t)}}NF.className="selu";tt(NF);class EF extends wn{apply(t){return Ho(t)}}EF.className="relu";tt(EF);class _F extends wn{apply(t){return G(()=>Oc(6,Ho(t)))}}_F.className="relu6";tt(_F);class RF extends wn{apply(t){return t}}RF.className="linear";tt(RF);class DF extends wn{apply(t){return su(t)}}DF.className="sigmoid";tt(DF);class AF extends wn{apply(t){return W7(t)}}AF.className="hardSigmoid";tt(AF);class OF extends wn{apply(t){return df(t)}}OF.className="softplus";tt(OF);class FF extends wn{apply(t){return V7(t)}}FF.className="softsign";tt(FF);class PF extends wn{apply(t){return qx(t)}}PF.className="tanh";tt(PF);let EC=class extends wn{apply(t,n=-1){return Dk(t,n)}};EC.className="softmax";tt(EC);class MF extends wn{apply(t,n=-1){return PA(t,n)}}MF.className="logSoftmax";tt(MF);class LF extends wn{apply(t){return G(()=>G(()=>{const n=Math.sqrt(2),s=F(.5,et(1,DA(xt(t,n))));return F(t,s)}))}}LF.className="gelu";tt(LF);class zF extends wn{apply(t){return G(()=>F(.5,F(t,et(1,qx(F(bn(xt(2,Math.PI)),et(t,F(.044715,rl(t,3)))))))))}}zF.className="gelu_new";tt(zF);class BF extends wn{apply(t){return G(()=>F(t,qx(df(t))))}}BF.className="mish";tt(BF);class VF extends wn{apply(t,n=1){return G(()=>F(su(F(t,n)),t))}}VF.className="swish";tt(VF);function Gi(e){return e.getClassName()}function ky(e,t={}){return yf(e,Us.getMap().classNameMap,t,"activation")}function Hi(e){if(e==null){const t={};return t.className="linear",t.config={},ky(t)}if(typeof e=="string"){const t={};return t.className=e,t.config={},ky(t)}else return e instanceof wn?e:ky(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nQ(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}class WF extends iu{}class UF extends WF{constructor(t){super(),nQ(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return G(()=>{let n=Je([1]);return this.hasL1&&(n=et(n,mt(F(this.l1,Qe(t))))),this.hasL2&&(n=et(n,mt(F(this.l2,vf(t))))),j(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}UF.className="L1L2";tt(UF);const r$={l1l2:"L1L2"};function ee(e){return mC(e)}function o$(e,t={}){return yf(e,Us.getMap().classNameMap,t,"regularizer")}function ve(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in r$?r$[e]:e,config:{}};return o$(n)}else return e instanceof WF?e:o$(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jF extends Dt{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=wt(t);let s=Ho(t);return this.maxValue!=null&&(s=_s(s,0,this.maxValue)),s}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}jF.className="ReLU";tt(jF);class GF extends Dt{constructor(t){super(t??{}),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const s=wt(t);return pk(s,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}GF.className="LeakyReLU";tt(GF);class HF extends Dt{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=xe(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=ve(t.alphaRegularizer),this.alphaConstraint=He(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new B(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=Bt(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<t.length;++r)s[r]=t[r];this.inputSpec=[new je({ndim:t.length,axes:s})],this.built=!0}call(t,n){return t=wt(t),kk(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Ce(this.alphaInitializer),alphaRegularizer:ee(this.alphaRegularizer),alphaConstraint:Ge(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}HF.className="PReLU";tt(HF);let KF=class extends Dt{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new Tt(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const s=wt(t);return Zx(s)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}};KF.className="ELU";tt(KF);class XF extends Dt{constructor(t){super(t??{}),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const s=wt(t);return F(s,ct(Os(s,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}XF.className="ThresholdedReLU";tt(XF);class qF extends Dt{constructor(t){super(t??{}),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new EC().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){return G(()=>{let s=wt(t);const r=n.mask;if(r!=null){const o=F(ft(Go(s.shape),ct(r,s.dtype)),kt(-1e9));s=et(s,o)}return this.axis instanceof Array?this.axis.length>1?Rs(ft(s,gk(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}qF.className="Softmax";tt(qF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lc(e,t,n){if(typeof e=="number")return ll(e,t);if(e.length!==t)throw new B(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let s=0;s<t;++s){const r=e[s];if(!P7(r))throw new B(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${r}`)}return e}function Cr(e,t,n,s,r=1){if(e==null)return e;const o=t+(t-1)*(r-1);let i;return n==="same"?i=e:i=e-o+1,Math.floor((i+s-1)/s)}function jr(e,t,n,s){if(e==null)return null;if(s==="valid")e=e*t+ji([n-t,0]);else if(s==="same")e=e*t;else throw new B(`Unsupport padding mode: ${s}.`);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _C(e,t){return G(()=>(Me(t),t==="channelsFirst"?Mt(e,[0,2,3,1]):e))}function YF(e,t){return G(()=>(Me(t),t==="channelsFirst"?Mt(e,[0,2,3,4,1]):e))}function sQ(e,t,n,s=1,r="valid",o,i=1){return G(()=>{if(o==null&&(o=Er()),Me(o),e.shape.length!==3)throw new B(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new B(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new B(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(o==="channelsFirst"&&(e=Mt(e,[0,2,1])),r==="causal")throw new Tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=TA(e,t,s,r==="same"?"same":"valid","NWC",i);return n!=null&&(a=Dr(a,n)),a})}function i$(e,t,n,s=[1,1],r="valid",o,i,a=null){return G(()=>{if(o==null&&(o=Er()),Me(o),e.rank!==3&&e.rank!==4)throw new B(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new B(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=_C(e,o);if(r==="causal")throw new Tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=H8({x:l,filter:t,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),o==="channelsFirst"&&(l=Mt(l,[0,3,1,2])),l})}function rQ(e,t,n,s=[1,1,1],r="valid",o,i){return G(()=>{if(o==null&&(o=Er()),Me(o),e.rank!==4&&e.rank!==5)throw new B(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new B(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let a=YF(e,o);if(r==="causal")throw new Tt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=H5(a,t,s,r==="same"?"same":"valid","NDHWC",i),n!=null&&(a=Dr(a,n)),o==="channelsFirst"&&(a=Mt(a,[0,4,1,2,3])),a})}class u0 extends Dt{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",u0.verifyArgs(n),this.rank=t,en(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Tt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=lc(n.kernelSize,t,"kernelSize"),this.strides=lc(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,Fs(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Me(this.dataFormat),this.activation=Hi(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=xe(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=He(n.biasConstraint),this.biasRegularizer=ve(n.biasRegularizer),this.activityRegularizer=ve(n.activityRegularizer),this.dilationRate=lc(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new B(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new B(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new B(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(Ur("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!gC(t.kernelSize,"number",1,3))throw new B(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Gi(this.activation),useBias:this.useBias,biasInitializer:Ce(this.biasInitializer),biasRegularizer:ee(this.biasRegularizer),activityRegularizer:ee(this.activityRegularizer),biasConstraint:Ge(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class au extends u0{constructor(t,n){super(t,n),this.kernel=null,au.verifyArgs(n),this.filters=n.filters,en(this.filters,"filters"),this.kernelInitializer=xe(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=He(n.kernelConstraint),this.kernelRegularizer=ve(n.kernelRegularizer)}build(t){t=Bt(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new B(`The channel dimension of the input should be defined. Found ${t[n]}`);const s=t[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(t,n){return G(()=>{t=wt(t);let s;const r=this.bias==null?null:this.bias.read(),o=HO(this.activation.getClassName());if(o!=null&&this.rank===2)s=i$(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)s=sQ(t,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=i$(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=rQ(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Tt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(t){t=Bt(t);const n=[],s=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let o=0;o<s.length;++o){const i=Cr(s[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);n.push(i)}let r=[t[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const t={filters:this.filters,kernelInitializer:Ce(this.kernelInitializer),kernelRegularizer:ee(this.kernelRegularizer),kernelConstraint:Ge(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new B(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class Sf extends au{constructor(t){super(2,t),Sf.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!gC(t.kernelSize,"number",1,2))throw new B(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}Sf.className="Conv2D";tt(Sf);class If extends au{constructor(t){super(3,t),If.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new B(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}If.className="Conv3D";tt(If);class QF extends Sf{constructor(t){if(super(t),this.inputSpec=[new je({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new B(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Bt(t),t.length!==4)throw new B("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new B("The channel dimension of the inputs should be defined. Found `None`.");const s=t[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new je({ndim:4,axes:{[n]:s}})],this.built=!0}call(t,n){return G(()=>{let s=wt(t);if(s.shape.length!==4)throw new B(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=r[i],c=r[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=jr(l,h,u,this.padding),m=jr(c,f,d,this.padding),g=[o,p,m,this.filters];this.dataFormat!=="channelsLast"&&(s=Mt(s,[0,2,3,1]));let x=NA(s,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=Mt(x,[0,3,1,2])),this.bias!=null&&(x=Dr(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(t){t=Bt(t);const n=t.slice();let s,r,o;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3):(s=3,r=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=jr(n[r],l,i,this.padding),n[o]=jr(n[o],c,a,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}QF.className="Conv2DTranspose";tt(QF);class ZF extends If{constructor(t){if(super(t),this.inputSpec=[new je({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new B(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Bt(t),t.length!==5)throw new B("Input should have rank 5; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new B("The channel dimension of the inputs should be defined. Found `None`.");const s=t[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new je({ndim:5,axes:{[n]:s}})],this.built=!0}call(t,n){return G(()=>{let s=wt(t);if(s.shape.length!==5)throw new B(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const c=r[l],u=r[i],d=r[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],x=this.strides[2],y=jr(c,m,h,this.padding),b=jr(u,g,f,this.padding),v=jr(d,x,p,this.padding),w=[o,y,b,v,this.filters];this.dataFormat!=="channelsLast"&&(s=Mt(s,[0,2,3,4,1]));let k=q5(s,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(k=Mt(k,[0,4,1,2,3])),this.bias!==null&&(k=Dr(k,this.bias.read(),this.dataFormat)),this.activation!==null&&(k=this.activation.apply(k)),k})}computeOutputShape(t){t=Bt(t);const n=t.slice();let s,r,o,i;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3,i=4):(s=4,r=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=jr(n[r],u,a,this.padding),n[o]=jr(n[o],d,l,this.padding),n[i]=jr(n[i],h,c,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}ZF.className="Conv3DTranspose";tt(ZF);class JF extends au{constructor(t,n){if(super(t,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new B("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new B("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new B(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=xe(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=ve(n.depthwiseRegularizer),this.depthwiseConstraint=He(n.depthwiseConstraint),this.pointwiseInitializer=xe(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=ve(n.pointwiseRegularizer),this.pointwiseConstraint=He(n.pointwiseConstraint)}build(t){if(t=Bt(t),t.length<this.rank+2)throw new B(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new B(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const s=t[n],r=this.kernelSize.concat([s,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new je({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(t,n){return G(()=>{t=wt(t);let s;if(this.rank===1)throw new Tt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=Mt(t,[0,2,3,1])),s=GA(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Dr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Mt(s,[0,3,1,2])),s})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Ce(this.depthwiseInitializer),t.pointwiseInitializer=Ce(this.pointwiseInitializer),t.depthwiseRegularizer=ee(this.depthwiseRegularizer),t.pointwiseRegularizer=ee(this.pointwiseRegularizer),t.depthwiseConstraint=Ge(this.depthwiseConstraint),t.pointwiseConstraint=Ge(this.pointwiseConstraint),t}}JF.className="SeparableConv";class tP extends JF{constructor(t){super(2,t)}}tP.className="SeparableConv2D";tt(tP);class d0 extends au{constructor(t){super(1,t),d0.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!gC(t.kernelSize,"number",1,1))throw new B(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}d0.className="Conv1D";tt(d0);class eP extends Dt{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return G(()=>{if(t=wt(t),this.dataFormat==="channelsLast"){const s=ap(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return ap(s,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=ap(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return ap(s,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}eP.className="Cropping2D";tt(eP);class nP extends Dt{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Me(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,A7(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],s=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,s]}else{const n=t[1]==null?null:this.size[0]*t[1],s=t[2]==null?null:this.size[1]*t[2];return[t[0],n,s,t[3]]}}call(t,n){return G(()=>{let s=wt(t);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Mt(s,[0,2,3,1]);const o=this.size[0]*r[2],i=this.size[1]*r[3],a=this.interpolation==="nearest"?Io.resizeNearestNeighbor(s,[o,i]):Io.resizeBilinear(s,[o,i]);return Mt(a,[0,3,1,2])}else{const o=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Io.resizeNearestNeighbor(s,[o,i]):Io.resizeBilinear(s,[o,i])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}}nP.className="UpSampling2D";tt(nP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oQ(e,t,n=[1,1],s="valid",r,o){return G(()=>{r==null&&(r=Er()),Me(r);let i=_C(e,r);if(e.rank!==4)throw new B(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new B(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return i=uk(i,t,n,s==="same"?"same":"valid","NHWC",o),r==="channelsFirst"&&(i=Mt(i,[0,3,1,2])),i})}class sP extends u0{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=xe(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=He(t.depthwiseConstraint),this.depthwiseRegularizer=ve(t.depthwiseRegularizer)}build(t){if(t=Bt(t),t.length<4)throw new B(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new B(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const s=t[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return G(()=>{t=wt(t);let s=oQ(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Dr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(t){t=Bt(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],r=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,o=Cr(n,this.kernelSize[0],this.padding,this.strides[0]),i=Cr(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],r,o,i]:[t[0],o,i,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Ce(this.depthwiseInitializer),t.depthwiseRegularizer=ee(this.depthwiseRegularizer),t.depthwiseConstraint=Ge(this.depthwiseRegularizer),t}}sP.className="DepthwiseConv2D";tt(sP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rP(e,t,n,s){if(Array.isArray(e)){if(t!=null||n!=null)throw new B("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=e.slice(e.length-s,e.length),e=e.slice(0,e.length-s)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function r(o){return o==null||Array.isArray(o)?o:[o]}return t=r(t),n=r(n),{inputs:e,initialState:t,constants:n}}function oP(e,t,n,s=!1,r,o,i=!1,a=!1){return G(()=>{const l=t.shape.length;if(l<3)throw new B(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Nr(2,l));t=Mt(t,c),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=ct(ct(r,"bool"),"float32"),r.rank===l-1&&(r=Gn(r,-1)),r=Mt(r,c)),s&&(t=il(t,0),r!=null&&(r=il(r,0)));const u=[];let d,h=n;const f=t.shape[0],p=al(t);let m;r!=null&&(m=al(r));for(let x=0;x<f;++x){const y=p[x],b=G(()=>e(y,h));if(r==null)d=b[0],h=b[1];else{const v=G(()=>{const w=m[x],k=ft(er(w),w),C=et(F(b[0],w),F(h[0],k)),S=h.map((I,$)=>et(F(b[1][$],w),F(I,k)));return{output:C,newStates:S}});d=v.output,h=v.newStates}a&&u.push(d)}let g;return a&&(g=Lo(u,1)),[d,g,h]})}class ia extends Dt{constructor(t){super(t);let n;if(t.cell==null)throw new B("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new AC({cells:t.cell}):n=t.cell,n.stateSize==null)throw new B("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new je({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Nr(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){x1(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[t[0],t[1],s]:r=[t[0],s],this.returnState){const o=[];for(const i of n)o.push([t[0],i]);return[r].concat(o)}else return r}computeMask(t,n){return G(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(o=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<t;++s)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new Tt("Constants support is not implemented in RNN yet.");x1(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,s=t.slice(2);this.inputSpec[0]=new je({shape:[n,null,...s]});const r=[t[0]].concat(t.slice(2));this.cell.build(r);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!Ht(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new B(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new je({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){G(()=>{if(!this.stateful)throw new Wr("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new B("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Je([s,r])):this.states_=[Je([s,this.cell.stateSize])];else if(t==null)At(this.states_),this.keptStates!=null&&(At(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Je([s,r])):this.states_[0]=Je([s,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new B(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):At(this.states_);for(let r=0;r<this.states_.length;++r){const o=t[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,i];if(!Ht(o.shape,a))throw new B(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[r]=o}}this.states_=this.states_.map(r=>Qr(r.clone()))})}apply(t,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=rP(t,s,r,this.numConstants);t=o.inputs,s=o.initialState,r=o.constants;let i=[],a=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new je({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof oo){const c=[t].concat(i),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(t,n)}call(t,n){return G(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let o=n==null?null:n.initialState;t=wt(t),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(t));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new B(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=oP((p,m)=>{const g=this.cell.call([p].concat(m),a);return[g[0],g.slice(1)]},t,o,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,r);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(t){return G(()=>{let n=Je(t.shape);return n=mt(n,[1,2]),n=bf(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?m1(n,[1,s]):n):this.cell.stateSize>1?[m1(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===ia.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),t),n)}static fromConfig(t,n,s={}){const r=n.cell,o=_o(r,s);return new t(Object.assign(n,{cell:o}))}}ia.className="RNN";tt(ia);class h0 extends Dt{}class RC extends h0{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,en(this.units,"units"),this.activation=Hi(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xe(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xe(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xe(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=ve(t.kernelRegularizer),this.recurrentRegularizer=ve(t.recurrentRegularizer),this.biasRegularizer=ve(t.biasRegularizer),this.kernelConstraint=He(t.kernelConstraint),this.recurrentConstraint=He(t.recurrentConstraint),this.biasConstraint=He(t.biasConstraint),this.dropout=Fc([1,ji([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Fc([1,ji([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Bt(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return G(()=>{if(t=t,t.length!==2)throw new B(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let s=t[1];t=t[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ki({ones:()=>er(t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ki({ones:()=>er(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=to(F(t,i),this.kernel.read()):o=to(t,this.kernel.read()),this.bias!=null&&(o=Dr(o,this.bias.read())),a!=null&&(s=F(s,a));let l=et(o,to(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Gi(this.activation),useBias:this.useBias,kernelInitializer:Ce(this.kernelInitializer),recurrentInitializer:Ce(this.recurrentInitializer),biasInitializer:Ce(this.biasInitializer),kernelRegularizer:ee(this.kernelRegularizer),recurrentRegularizer:ee(this.recurrentRegularizer),biasRegularizer:ee(this.biasRegularizer),activityRegularizer:ee(this.activityRegularizer),kernelConstraint:Ge(this.kernelConstraint),recurrentConstraint:Ge(this.recurrentConstraint),biasConstraint:Ge(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),n)}}RC.className="SimpleRNNCell";tt(RC);class iP extends ia{constructor(t){t.cell=new RC(t),super(t)}call(t,n){return G(()=>{this.cell.dropoutMask!=null&&(At(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(At(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(t,{mask:s,training:r,initialState:o})})}static fromConfig(t,n){return new t(n)}}iP.className="SimpleRNN";tt(iP);class DC extends h0{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new B("GRUCell does not support reset_after parameter set to true.");this.units=t.units,en(this.units,"units"),this.activation=Hi(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Hi(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xe(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xe(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xe(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=ve(t.kernelRegularizer),this.recurrentRegularizer=ve(t.recurrentRegularizer),this.biasRegularizer=ve(t.biasRegularizer),this.kernelConstraint=He(t.kernelConstraint),this.recurrentConstraint=He(t.recurrentConstraint),this.biasConstraint=He(t.biasConstraint),this.dropout=Fc([1,ji([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Fc([1,ji([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Bt(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return G(()=>{if(t=t,t.length!==2)throw new B(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const s=n.training==null?!1:n.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ki({ones:()=>er(t),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ki({ones:()=>er(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(t=F(t,o[0]));let u=to(t,this.kernel.read());this.useBias&&(u=Dr(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=F(r,i[0]));const d=this.recurrentKernel.read(),[h,f]=Ns(d,[2*this.units,this.units],d.rank-1),p=to(r,h),[m,g,x]=Ns(u,3,u.rank-1),[y,b]=Ns(p,2,p.rank-1);a=this.recurrentActivation.apply(et(m,y)),l=this.recurrentActivation.apply(et(g,b));const v=to(F(l,r),f);c=this.activation.apply(et(x,v));const w=et(F(a,r),F(et(1,be(a)),c));return[w,w]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Gi(this.activation),recurrentActivation:Gi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ce(this.kernelInitializer),recurrentInitializer:Ce(this.recurrentInitializer),biasInitializer:Ce(this.biasInitializer),kernelRegularizer:ee(this.kernelRegularizer),recurrentRegularizer:ee(this.recurrentRegularizer),biasRegularizer:ee(this.biasRegularizer),activityRegularizer:ee(this.activityRegularizer),kernelConstraint:Ge(this.kernelConstraint),recurrentConstraint:Ge(this.recurrentConstraint),biasConstraint:Ge(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),n)}}DC.className="GRUCell";tt(DC);class aP extends ia{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new DC(t),super(t)}call(t,n){return G(()=>{this.cell.dropoutMask!=null&&(At(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(At(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(t,{mask:s,training:r,initialState:o})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}aP.className="GRU";tt(aP);class f0 extends h0{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,en(this.units,"units"),this.activation=Hi(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Hi(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xe(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xe(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xe(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=ve(t.kernelRegularizer),this.recurrentRegularizer=ve(t.recurrentRegularizer),this.biasRegularizer=ve(t.biasRegularizer),this.kernelConstraint=He(t.kernelConstraint),this.recurrentConstraint=He(t.recurrentConstraint),this.biasConstraint=He(t.biasConstraint),this.dropout=Fc([1,ji([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Fc([1,ji([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=Bt(t);const s=t[t.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;r=new(n=class extends rr{apply(l,c){const u=o.apply([i]),d=new yC().apply([i]),h=o.apply([i*2]);return U2(U2(u,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return G(()=>{const s=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new B(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let r=t[1];const o=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ki({ones:()=>er(t),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ki({ones:()=>er(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(t=F(t,i[0]));let h=to(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=F(r,a[0])),h=et(h,to(r,this.recurrentKernel.read())),this.useBias&&(h=Dr(h,this.bias.read()));const[f,p,m,g]=Ns(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=et(F(c,o),F(l,this.activation.apply(m))),d=this.recurrentActivation.apply(g);const x=F(d,this.activation.apply(u));return[x,x,u]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Gi(this.activation),recurrentActivation:Gi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ce(this.kernelInitializer),recurrentInitializer:Ce(this.recurrentInitializer),biasInitializer:Ce(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ee(this.kernelRegularizer),recurrentRegularizer:ee(this.recurrentRegularizer),biasRegularizer:ee(this.biasRegularizer),activityRegularizer:ee(this.activityRegularizer),kernelConstraint:Ge(this.kernelConstraint),recurrentConstraint:Ge(this.recurrentConstraint),biasConstraint:Ge(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),n)}}f0.className="LSTMCell";tt(f0);class lP extends ia{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new f0(t),super(t)}call(t,n){return G(()=>{this.cell.dropoutMask!=null&&(At(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(At(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(t,{mask:s,training:r,initialState:o})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}lP.className="LSTM";tt(lP);class AC extends h0{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return G(()=>{t=t;let s=t.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?i=[t[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),o.push(i.slice(1))}s=[];for(const a of o.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(t){x1(t)&&(t=t[0]),t=t;let n;this.cells.forEach((s,r)=>{Ba(`RNNCell_${r}`,()=>{s.build(t),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=o=>({className:o.getClassName(),config:o.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},t),r)}static fromConfig(t,n,s={}){const r=[];for(const o of n.cells)r.push(_o(o,s));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return y1(t)}setWeights(t){const n=[];for(const s of this.cells){const r=s.weights.length,o=t.splice(r);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],o[i]])}IC(n)}}AC.className="StackedRNNCells";tt(AC);function Ki(e){const{ones:t,rate:n,training:s=!1,count:r=1,dropoutFunc:o}=e,i=()=>o!=null?o(t(),n):JO(t(),n),a=()=>wf(i,t,s);return!r||r<=1?Qr(a().clone()):Array(r).fill(void 0).map(a).map(c=>Qr(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var iQ=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]]);return n};class cP extends ia{constructor(t){if(t.unroll)throw new Tt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Tt("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new je({ndim:5})]}call(t,n){return G(()=>{if(this.cell.dropoutMask!=null&&(At(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(At(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new B("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(t,{mask:s,training:r,initialState:o})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return G(()=>{const{stateSize:n}=this.cell,s=t.shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)],i=Je(o);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(t,n=!1){G(()=>{if(!this.stateful)throw new Wr("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)];if(s[0]==null)throw new B("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Je(o)):this.states_=[Je(o)];else if(t==null)At(this.states_),this.keptStates!=null&&(At(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Je(o)):this.states_[0]=Je(o);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new B(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):At(this.states_);for(let a=0;a<this.states_.length;++a){const l=t[a],c=o;if(!Ht(l.shape,c))throw new B(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Qr(a.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:s,kernelSize:r,padding:o,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",c=t[l?3:2],u=t[l?4:3],d=Cr(c,r[0],o,i[0],a[0]),h=Cr(u,r[1],o,i[1],a[1]);return[...t.slice(0,2),...l?[s,d,h]:[d,h,s]]}}cP.className="ConvRNN2D";class OC extends f0{constructor(t){const{filters:n,kernelSize:s,strides:r,padding:o,dataFormat:i,dilationRate:a}=t;super(Object.assign(Object.assign({},t),{units:n})),this.filters=n,en(this.filters,"filters"),this.kernelSize=lc(s,2,"kernelSize"),this.kernelSize.forEach(l=>en(l,"kernelSize")),this.strides=lc(r||1,2,"strides"),this.strides.forEach(l=>en(l,"strides")),this.padding=o||"valid",Fs(this.padding),this.dataFormat=i||"channelsLast",Me(this.dataFormat),this.dilationRate=lc(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>en(l,"dilationRate"))}build(t){var n;t=Bt(t);const s=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[s]==null)throw new B(`The channel dimension of the input should be defined. Found ${t[s]}`);const r=t[s],o=4,i=this.kernelSize.concat([r,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends rr{apply(h,f){const p=c.apply([u]),m=Go([u]),g=c.apply([u*2]);return xC([p,m,g])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return G(()=>{if(t.length!==3)throw new B(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const s=n.training||!1,r=t[0],o=t[1],i=t[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ki({ones:()=>er(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(H,X,Q)=>!X||!X[Q]?H:F(X[Q],H);let u=c(r,l,0),d=c(r,l,1),h=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ki({ones:()=>er(o),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(o,p,0),g=c(o,p,1),x=c(o,p,2),y=c(o,p,3);const b=3,[v,w,k,C]=Ns(this.kernel.read(),a,b),[S,I,$,E]=this.useBias?Ns(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,v,S,this.padding),d=this.inputConv(d,w,I,this.padding),h=this.inputConv(h,k,$,this.padding),f=this.inputConv(f,C,E,this.padding);const[A,L,O,P]=Ns(this.recurrentKernel.read(),a,b);m=this.recurrentConv(m,A),g=this.recurrentConv(g,L),x=this.recurrentConv(x,O),y=this.recurrentConv(y,P);const M=this.recurrentActivation.apply(et(u,m)),U=this.recurrentActivation.apply(et(d,g)),R=et(F(U,i),F(M,this.activation.apply(et(h,x)))),z=F(this.recurrentActivation.apply(et(f,y)),this.activation.apply(R));return[z,z,R]})}getConfig(){const t=super.getConfig(),n=iQ(t,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(t,n,s,r){const o=sl(t,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Dr(o,s,this.dataFormat):o}recurrentConv(t,n){return sl(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}OC.className="ConvLSTM2DCell";tt(OC);class uP extends cP{constructor(t){const n=new OC(t);super(Object.assign(Object.assign({},t),{cell:n}))}static fromConfig(t,n){return new t(n)}}uP.className="ConvLSTM2D";tt(uP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FC extends Dt{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=wt(t);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,o=this.getNoiseShape(s);return wf(()=>JO(s,this.rate,o,this.seed),()=>s,r)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}FC.className="Dropout";tt(FC);class dP extends FC{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}dP.className="SpatialDropout1D";tt(dP);class PC extends Dt{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,en(this.units,"units"),this.activation=Hi(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=xe(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=xe(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=He(t.kernelConstraint),this.biasConstraint=He(t.biasConstraint),this.kernelRegularizer=ve(t.kernelRegularizer),this.biasRegularizer=ve(t.biasRegularizer),this.activityRegularizer=ve(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=Bt(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=Bt(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=wt(t),r=HO(this.activation.getClassName());let o;return r!=null?o=to(s,this.kernel.read(),r,this.bias?this.bias.read():null):(o=to(s,this.kernel.read()),this.bias!=null&&(o=Dr(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const t={units:this.units,activation:Gi(this.activation),useBias:this.useBias,kernelInitializer:Ce(this.kernelInitializer),biasInitializer:Ce(this.biasInitializer),kernelRegularizer:ee(this.kernelRegularizer),biasRegularizer:ee(this.biasRegularizer),activityRegularizer:ee(this.activityRegularizer),kernelConstraint:Ge(this.kernelConstraint),biasConstraint:Ge(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}PC.className="Dense";tt(PC);class hP extends Dt{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=Bt(t);for(const n of t.slice(1))if(n==null)throw new B(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],Pi(t,1)]}call(t,n){return G(()=>{this.invokeCallHook(t,n);let s=wt(t);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let o=2;o<s.rank;++o)r.push(o);r.push(1),s=Mt(s,r)}return z7(s)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}}hP.className="Flatten";tt(hP);class fP extends Dt{constructor(t){super(t),this.supportsMasking=!0,this.activation=Hi(t.activation)}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=wt(t);return this.activation.apply(s)})}getConfig(){const t={activation:Gi(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}fP.className="Activation";tt(fP);class pP extends Dt{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return G(()=>(t=wt(t),M7(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}pP.className="RepeatVector";tt(pP);class mP extends Dt{constructor(t){super(t),this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const s="Total size of new array must be unchanged.",r=n.slice();let o=1,i=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(i===null)i=l;else throw new B("Can only specifiy one unknown dimension.");else o*=c}const a=Pi(t);if(i!==null){if(o===0||a%o!==0)throw new B(s);r[i]=a/o}else if(a!==o)throw new B(s);return r}computeOutputShape(t){let n=!1;for(let s=0;s<t.length;++s)if(this.isUnknown(t[s])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=wt(t),r=s.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return j(s,o)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}mP.className="Reshape";tt(mP);class gP extends Dt{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=Nr(1,t.dims.length+1);if(!Ht(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new je({ndim:this.dims.length+1})]}computeOutputShape(t){t=Bt(t);const n=t.slice();return this.dims.forEach((s,r)=>{n[r+1]=t[s]}),n}call(t,n){return Mt(wt(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}gP.className="Permute";tt(gP);class xP extends Dt{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const s=wt(t);return l1(Vd(s,this.maskValue),-1)}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=wt(t),i=l1(Vd(s,this.maskValue),-1,!0);return F(s,ct(i,s.dtype))})}}xP.className="Masking";tt(xP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yP extends Dt{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(qt(t.inputLength))}this.inputDim=t.inputDim,en(this.inputDim,"inputDim"),this.outputDim=t.outputDim,en(this.outputDim,"outputDim"),this.embeddingsInitializer=xe(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=ve(t.embeddingsRegularizer),this.activityRegularizer=ve(t.activityRegularizer),this.embeddingsConstraint=He(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return G(()=>this.maskZero?(t=wt(t),Vd(t,Lt(t))):null)}computeOutputShape(t){if(t=Bt(t),this.inputLength==null)return[...t,this.outputDim];const n=qt(this.inputLength);if(n.length!==t.length-1)throw new B(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let s=0;for(let r=0;r<n.length;++r){const o=n[r],i=t[r+1];if(o!=null&&i!=null&&o!==i)throw new B(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);o==null&&(n[s]=i),s++}}return[t[0],...n,this.outputDim]}call(t,n){return G(()=>{this.invokeCallHook(t,n);let s=wt(t);s.dtype!=="int32"&&(s=Jr(s,"int32"));const r=ZO(this.embeddings.read(),j(s,[s.size]));return j(r,Bt(this.computeOutputShape(s.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ce(this.embeddingsInitializer),embeddingsRegularizer:ee(this.embeddingsRegularizer),activityRegularizer:ee(this.activityRegularizer),embeddingsConstraint:Ge(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}yP.className="Embedding";tt(yP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Cl extends Dt{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Tt}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const s=t.slice(0,t.length-n.length);for(let r=0;r<n.length;++r){const o=t[t.length-n.length+r],i=n[r];if(o==null||i==null||o<0||i<0)s.push(null);else if(o===1)s.push(i);else if(i===1)s.push(o);else{if(o!==i)throw new B("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));s.push(o)}}return s}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Bt(t)]),t=t,t.length<2)throw new B(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const o of t)o!=null&&o[0]!==null&&n.push(o[0]);if(n=Fi(n),n.length>1)throw new B(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let s=t[0]==null?null:t[0].slice(1);for(let o=1;o<t.length;++o){const i=t[o]==null?null:t[o].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=t.map(o=>o.length);t.indexOf(null)===-1&&Fi(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return G(()=>{if(t=t,this.reshapeRequired){const s=[],r=t.map(o=>o.rank);if(r.indexOf(null)===-1){const o=ji(r);for(let i of t){const a=i.rank;for(let l=0;l<o-a;++l)i=bf(i,1);s.push(i)}return this.mergeFunction(s)}else{let o=!1;for(const l of t){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=j(l,[d].concat(Pi(u.slice(1))));f=Mt(f,[1,0]),f=j(f,h),s.push(f),o=!0}else if(c>1){const u=Nr(1,c).concat([0]);s.push(Mt(l,u)),o=!0}else s.push(l)}let i=this.mergeFunction(s);const a=i.rank;if(o){if(a==null){const l=i.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));i=j(Mt(j(i,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(Nr(0,a-1));i=Mt(i,l)}}return i}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let r=1;r<t.length;++r){const o=t[r]==null?null:t[r].slice(1);n=this.computeElementwiseOpOutputShape(n,o)}let s=[];for(const r of t)r!=null&&r[0]!==null&&s.push(r[0]);return s=Fi(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(t,n){return G(()=>{if(n==null)return null;if(!Array.isArray(n))throw new B("`mask` should be an Array");if(!Array.isArray(t))throw new B("`inputs` should be an Array");if(n.length!==t.length)throw new B(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:Gn(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Mo(s,n[r]);return s})}}class bP extends Cl{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=et(n,t[s]);return n})}}bP.className="Add";tt(bP);class vP extends Cl{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=F(n,t[s]);return n})}}vP.className="Multiply";tt(vP);class wP extends Cl{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=et(n,t[s]);return F(1/t.length,n)})}}wP.className="Average";tt(wP);class kP extends Cl{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0];for(let s=1;s<t.length;++s)n=ra(n,t[s]);return n})}}kP.className="Maximum";tt(kP);class CP extends Cl{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0];for(let s=1;s<t.length;++s)n=Oc(n,t[s]);return n})}}CP.className="Minimum";tt(CP);class SP extends Cl{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new B("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const r of t)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<t.length;++r){const o=t[r].slice();o.splice(this.axis,1);let i=!1;for(const a of s)if(Ht(a,o)){i=!0;break}i||s.push(o)}if(s.length>1)throw new B("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return G(()=>xC(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new B("A `Concatenate` layer should be called on a list of inputs.");const n=t,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const o of n.slice(1)){if(s[r]==null||o[r]==null){s[r]=null;break}s[r]+=o[r]}return s}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new B("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new B("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new B(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return G(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<t.length;++i)n[i]==null?r.push(ct(er(t[i]),"bool")):n[i].rank<t[i].rank?r.push(Gn(n[i],-1)):r.push(n[i]);const o=qn(r,this.axis);return $A(o,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}SP.className="Concatenate";tt(SP);function Ru(e,t){for(;e<0;)e+=t;return e}function aQ(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Tt("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),T(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new Tt("batchDot is not implemented for complex64-type Tensors yet.");const s=e.shape.length,r=t.shape.length;n==null&&(n=[s-1,r-2]);const o=n;return G(()=>{let i;if(s>r){i=s-r;const l=[];for(let c=0;c<i;++c)l.push(1);t=j(t,t.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let c=0;c<i;++c)l.push(1);e=j(e,e.shape.concat(l))}else i=0;let a;if(e.shape.length===2&&t.shape.length===2)o[0]===o[1]?a=mt(F(e,t),o[0]):a=mt(F(Mt(e,[1,0]),t),o[1]);else{const l=o[0]!==e.shape.length-1,c=o[1]===t.shape.length-1;a=jt(e,t,l,c)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+i;++u)c.push(u);a=ff(a,c)}return a.shape.length===1&&(a=Gn(a,1)),a})}class IP extends Cl{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){T(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],s=t[1];if(n.length>3||s.length>3)throw new Tt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new B(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(t){if(t.length!==2)throw new B(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],s=t[1],r;return Array.isArray(this.axes)?r=this.axes.map((o,i)=>Ru(o,t[i].shape.length)):r=[Ru(this.axes,n.shape.length),Ru(this.axes,s.shape.length)],this.normalize&&(n=Ym(n,r[0]),s=Ym(s,r[1])),aQ(n,s,r)}interpretAxes(t,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Ru(this.axes,t.length),Ru(this.axes,n.length)],s}computeOutputShape(t){T(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),s=t[1].slice();if(n.length>3||s.length>3)throw new Tt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const o=n.concat(s);return o.length===1&&o.push(1),o}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}IP.className="Dot";tt(IP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $P extends Dt{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=wt(t);return wf(()=>et(i0(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}$P.className="GaussianNoise";tt($P);class TP extends Dt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=wt(t);return this.rate>0&&this.rate<1?wf(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return F(s,i0(s.shape,1,o))},()=>s,n.training||!1):s})}}TP.className="GaussianDropout";tt(TP);class NP extends Dt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||wt(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return G(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(t);return wf(()=>{const o=wt(t),l=-1.6732632423543772*1.0507009873554805;let c=bl(hf(s),this.rate);c=Jr(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-u*l*this.rate,h=et(F(o,c),F(et(c,-1),l));return et(F(h,u),d)},()=>wt(t),n.training||!1)}return t})}}NP.className="AlphaDropout";tt(NP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gd(e,t,n,s,r,o=.001){let i;if(e.rank===2)i=k5(e,t,n,s,r,o);else if(e.rank===3)i=S5(e,t,n,s,r,o);else if(e.rank===4)i=$5(e,t,n,s,r,o);else throw new Tt(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return i}function lQ(e,t,n,s,r=.001){return G(()=>{const o=bk(e,s),i=o.mean,a=o.variance;return[Gd(e,i,a,n,t,r),i,a]})}function cQ(e,t,n,s,r=.001){return G(()=>{const o=bk(e,s),i=o.mean,a=o.variance,l=[];for(const p of Nr(0,e.rank))s.indexOf(p)!==-1?l.push(1):l.push(e.shape[p]);const c=j(i,l),u=j(a,l),d=t==null?null:j(t,l),h=n==null?null:j(n,l);return[Gd(e,c,u,h,d,r),i,a]})}function uQ(e,t,n,s,r=.001){return Ht(s.slice().sort(),Nr(0,e.rank-1))?lQ(e,t,n,s,r):cQ(e,t,n,s,r)}class EP extends Dt{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=xe(t.betaInitializer||"zeros"),this.gammaInitializer=xe(t.gammaInitializer||"ones"),this.movingMeanInitializer=xe(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=xe(t.movingVarianceInitializer||"ones"),this.betaConstraint=He(t.betaConstraint),this.gammaConstraint=He(t.gammaConstraint),this.betaRegularizer=ve(t.betaRegularizer),this.gammaRegularizer=ve(t.gammaRegularizer)}build(t){t=Bt(t);const n=this.axis>=0?this.axis:this.axis+t.length,s=t[n];if(s==null)throw new B(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new je({ndim:t.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return G(()=>{const s=n.training==null?!1:n.training,r=wt(t),o=r.shape,i=o.length,a=Nr(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const c=ll(1,i);c[l]=o[l];const u=a.slice();u.sort();const d=!Ht(u,Nr(0,i).slice(0,i-1)),h=()=>{if(d){const y=j(this.movingMean.read(),c),b=j(this.movingVariance.read(),c),v=this.center?j(this.beta.read(),c):null,w=this.scale?j(this.gamma.read(),c):null;return Gd(r,y,b,v,w,this.epsilon)}else return Gd(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[f,p,m]=uQ(r,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(y,b,v)=>{G(()=>{const w=1-v,k=y.read(),C=F(ft(k,b),w);y.write(ft(k,C))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ce(this.betaInitializer),gammaInitializer:Ce(this.gammaInitializer),movingMeanInitializer:Ce(this.movingMeanInitializer),movingVarianceInitializer:Ce(this.movingVarianceInitializer),betaRegularizer:ee(this.betaRegularizer),gammaRegularizer:ee(this.gammaRegularizer),betaConstraint:Ge(this.betaConstraint),gammaConstraint:Ge(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}EP.className="BatchNormalization";tt(EP);class _P extends Dt{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=xe(t.betaInitializer||"zeros"),this.gammaInitializer=xe(t.gammaInitializer||"ones"),this.betaRegularizer=ve(t.betaRegularizer),this.gammaRegularizer=ve(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=Bt(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=n);for(const o of this.axis)if(o<0||o>=n)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==Fi(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(o=>t[o]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(t,n){const s=wt(t),r=s.shape,o=r.length;return G(()=>{let{mean:a,variance:l}=bk(s,this.axis,!0);const c=ll(1,o);for(const m of this.axis)c[m]=r[m];const u=m=>m!=null&&m.shape.length!==o?j(m,c):m;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<o;++m)this.axis.indexOf(m)!==-1?(f.push(r[m]),p.push(1)):(f.push(1),p.push(r[m]));return a=xr(a,f),l=xr(l,f),d!=null&&(d=xr(d,p)),h!=null&&(h=xr(h,p)),Gd(s,a,l,h,d,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ce(this.betaInitializer),gammaInitializer:Ce(this.gammaInitializer),betaRegularizer:ee(this.betaRegularizer),gammaRegularizer:ee(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}_P.className="LayerNormalization";tt(_P);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dQ(e,t,n){return G(()=>{if(e.rank!==4)throw new B(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new B("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Er()),n!=="channelsLast"&&n!=="channelsFirst")throw new B(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],t[0],t[1]]:s=[[0,0],t[0],t[1],[0,0]],vk(e,s)})}class RP extends Dt{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Er():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new B(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,s;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],s=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new B(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new B(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);s=t.padding[1]}this.padding=[n,s]}this.inputSpec=[new je({ndim:4})]}computeOutputShape(t){t=Bt(t);let n,s;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?s=t[3]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],t[1],n,s]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?s=t[2]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],n,s,t[3]])}call(t,n){return G(()=>dQ(wt(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}RP.className="ZeroPadding2D";tt(RP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function p0(e,t,n,s,r,o){return G(()=>{Me(r),XO(o),Fs(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Er()),o==null&&(o="max"),e=_C(e,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=yk(e,t,n,a):i=ik(e,t,n,a),r==="channelsFirst"&&(i=Mt(i,[0,3,1,2])),i})}function DP(e,t,n,s,r,o){return G(()=>{Me(r),XO(o),Fs(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Er()),o==null&&(o="max"),e=YF(e,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=uK(e,t,n,a):i=h5(e,t,n,a),r==="channelsFirst"&&(i=Mt(i,[0,4,1,2,3])),i})}class AP extends Dt{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new B(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(en(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new B(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);en(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,Fs(this.padding),this.inputSpec=[new je({ndim:3})]}computeOutputShape(t){t=Bt(t);const n=Cr(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return G(()=>{this.invokeCallHook(t,n),t=bf(wt(t),2);const s=this.poolingFunction(wt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return ff(s,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class OP extends AP{constructor(t){super(t)}poolingFunction(t,n,s,r,o){return Me(o),Fs(r),p0(t,n,s,r,o,"max")}}OP.className="MaxPooling1D";tt(OP);class FP extends AP{constructor(t){super(t)}poolingFunction(t,n,s,r,o){return Me(o),Fs(r),p0(t,n,s,r,o,"avg")}}FP.className="AveragePooling1D";tt(FP);class PP extends Dt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new B(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];en(this.poolSize,"poolSize"),en(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Me(this.dataFormat),Fs(this.padding),this.inputSpec=[new je({ndim:4})]}computeOutputShape(t){t=Bt(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Cr(n,this.poolSize[0],this.padding,this.strides[0]),s=Cr(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,s]:[t[0],n,s,t[3]]}call(t,n){return G(()=>(this.invokeCallHook(t,n),this.poolingFunction(wt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class MP extends PP{constructor(t){super(t)}poolingFunction(t,n,s,r,o){return Me(o),Fs(r),p0(t,n,s,r,o,"max")}}MP.className="MaxPooling2D";tt(MP);class LP extends PP{constructor(t){super(t)}poolingFunction(t,n,s,r,o){return Me(o),Fs(r),p0(t,n,s,r,o,"avg")}}LP.className="AveragePooling2D";tt(LP);class zP extends Dt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new B(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];en(this.poolSize,"poolSize"),en(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Me(this.dataFormat),Fs(this.padding),this.inputSpec=[new je({ndim:5})]}computeOutputShape(t){t=Bt(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],r=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Cr(n,this.poolSize[0],this.padding,this.strides[0]),s=Cr(s,this.poolSize[1],this.padding,this.strides[1]),r=Cr(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,s,r]:[t[0],n,s,r,t[4]]}call(t,n){return G(()=>(this.invokeCallHook(t,n),this.poolingFunction(wt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class BP extends zP{constructor(t){super(t)}poolingFunction(t,n,s,r,o){return Me(o),Fs(r),DP(t,n,s,r,o,"max")}}BP.className="MaxPooling3D";tt(BP);class VP extends zP{constructor(t){super(t)}poolingFunction(t,n,s,r,o){return Me(o),Fs(r),DP(t,n,s,r,o,"avg")}}VP.className="AveragePooling3D";tt(VP);class WP extends Dt{constructor(t){super(t),this.inputSpec=[new je({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new Tt}}class UP extends WP{constructor(t){super(t||{})}call(t,n){return G(()=>{const s=wt(t);return Re(s,1)})}}UP.className="GlobalAveragePooling1D";tt(UP);class jP extends WP{constructor(t){super(t||{})}call(t,n){return G(()=>{const s=wt(t);return kr(s,1)})}}jP.className="GlobalMaxPooling1D";tt(jP);class GP extends Dt{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Me(this.dataFormat),this.inputSpec=[new je({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new Tt}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class HP extends GP{call(t,n){return G(()=>{const s=wt(t);return this.dataFormat==="channelsLast"?Re(s,[1,2]):Re(s,[2,3])})}}HP.className="GlobalAveragePooling2D";tt(HP);class KP extends GP{call(t,n){return G(()=>{const s=wt(t);return this.dataFormat==="channelsLast"?kr(s,[1,2]):kr(s,[2,3])})}}KP.className="GlobalMaxPooling2D";tt(KP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class XP extends Dt{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,s={}){const r=n.layer,o=_o(r,s);delete n.layer;const i={layer:o};return Object.assign(i,n),new t(i)}}class qP extends XP{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=Bt(t),t.length<3)throw new B(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=Bt(t);const n=[t[0]].concat(t.slice(2)),s=this.layer.computeOutputShape(n),r=t[1];return[s[0],r].concat(s.slice(1))}call(t,n){return G(()=>(t=wt(t),oP((i,a)=>[wt(this.layer.call(i,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}qP.className="TimeDistributed";tt(qP);function hQ(e){kl(D7,"BidirectionalMergeMode",e)}const fQ="concat";class YP extends XP{constructor(t){super(t);const n=t.layer.getConfig(),s={};s.className=t.layer.getClassName(),s.config=n,this.forwardLayer=_o(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=t.layer.getClassName(),r.config=n,this.backwardLayer=_o(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?fQ:t.mergeMode,hQ(this.mergeMode),t.weights)throw new Tt("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,s=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,s)),this.backwardLayer.setWeights(t.slice(s))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,o;return this.returnState&&(o=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(o).concat(o.slice()):[s].concat(o).concat(o.slice()):Hn(r)}apply(t,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=rP(t,s,r,this.numConstants);if(t=o.inputs,s=o.initialState,r=o.constants,Array.isArray(t)&&(s=t.slice(1),t=t[0]),(s==null||s.length===0)&&r==null)return super.apply(t,n);const i=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new B("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const u=s.map(d=>new je({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new Tt("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof oo;for(const c of i)if(c instanceof oo!==l)throw new B("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[t].concat(i),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(t,n)}call(t,n){return G(()=>{const s=n.initialState;let r,o;if(s==null)r=this.forwardLayer.call(t,n),o=this.backwardLayer.call(t,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(t,Object.assign(n,{initialState:l})),o=this.backwardLayer.call(t,Object.assign(n,{initialState:c}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=il(o,1));let a;return this.mergeMode==="concat"?a=xC([r,o]):this.mergeMode==="sum"?a=et(r,o):this.mergeMode==="ave"?a=F(.5,et(r,o)):this.mergeMode==="mul"?a=F(r,o):this.mergeMode==null&&(a=[r,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Ba(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Ba(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(o).concat(o):[s].concat(o).concat(o)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const s=_o(n.layer);if(delete n.layer,n.numConstants!=null)throw new Tt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new t(r)}}YP.className="Bidirectional";tt(YP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class QP extends Dt{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return G(()=>(t=wt(t),t.dtype!=="float32"&&(t=Jr(t,"float32")),et(F(t,this.scale),this.offset)))}}QP.className="Rescaling";tt(QP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:pQ,cropAndResize:mQ}=Io;class ZP extends Dt{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,n,s,r,o,i,a,l){return G(()=>{let c,u=!1;const d=n/i,h=s/a,f=(r+n)/i,p=(o+s)/a,m=[d,h,f,p],g=[];t.rank===3?(u=!0,c=Lo([t])):c=t;for(let w=0;w<c.shape[0];w++)g.push(m);const x=gA(g,[g.length,4]),y=Wd(0,g.length,1,"int32"),v=mQ(c,x,y,[r,o],"nearest");return Jr(u?wt(al(v)):v,l)})}upsize(t,n,s,r){return G(()=>{const o=pQ(t,[n,s]);return Jr(o,r)})}call(t,n){return G(()=>{const s=wt(t),r=s.dtype,o=s.shape,i=o[o.length-3],a=o[o.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,i,a,r):this.upsize(t,this.height,this.width,r)})}getConfig(){const t={height:this.height,width:this.width},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=Bt(t);const n=t.length-3,s=t.length-2;return t[n]=this.height,t[s]=this.width,t}}ZP.className="CenterCrop";tt(ZP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gQ(e,t,n,s){let r=wt(e);if(r.dtype!=="int32"&&(r=Jr(r,"int32")),t==="int")return r;const o=r.shape;if(r.rank===0&&(r=Gn(r,-1)),t==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Gn(r,-1)),r.rank>2)throw new B(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${o} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(t),a=r;let l;if(typeof s<"u"&&t==="count"?l=N2(a,s,n,i):l=N2(a,[],n,i),t!=="tfIdf")return l;if(s)return F(l,s);throw new B("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class JP extends Dt{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){return t=Bt(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,n){return G(()=>{t=wt(t),t.dtype!=="int32"&&(t=Jr(t,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new B(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=wt(n.countWeights)}const r=kr(t),o=Vm(t),i=Os(this.numTokens,r).bufferSync().get(0),a=bl(o,0).bufferSync().get(0);if(!(i&&a))throw new B(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return gQ(t,this.outputMode,this.numTokens,s)})}}JP.className="CategoryEncoding";tt(JP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const xQ=["bilinear","nearest"],a$=new Set(xQ);class tM extends Dt{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(a$.has(t.interpolation))this.interpolation=t.interpolation;else throw new B(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!t.cropToAspectRatio}computeOutputShape(t){t=Bt(t);const n=t[2];return[this.height,this.width,n]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return G(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Io.resizeBilinear(t,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Io.resizeNearestNeighbor(t,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...a$]} are supported`)})}}tM.className="Resizing";tt(tM);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class eM{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}eM.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nM extends Dt{constructor(t){super(t),this.randomGenerator=new eM(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(t,n),t}}nM.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const yQ=["bilinear","nearest"],l$=new Set(yQ);class sM extends nM{constructor(t){super(t);const{factor:n,interpolation:s="bilinear"}=t;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new B(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new B(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new B(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(l$.has(s))this.interpolation=s;else throw new B(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=Bt(t);const n=t[2];return[this.imgHeight,-1,n]}call(t,n){return G(()=>{const s=wt(t);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=hf([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*r;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return Io.resizeBilinear(t,i);case"nearest":return Io.resizeNearestNeighbor(t,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...l$]} are supported`)}})}}sM.className="RandomWidth";tt(sM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cy(e){return new PC(e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bQ=K();bQ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var c$;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(c$||(c$={}));var u$;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(u$||(u$={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var d$;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(d$||(d$={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pt(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vQ=tO;class m0 extends uw{nextDataId(){return m0.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new vD(this,Pr())}write(t,n,s){this.firstUse&&(this.firstUse=!1,K().get("IS_NODE")&&Cs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:s,refCount:1}),r}makeTensorInfo(t,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&fh(s[0])){const o=s.map(i=>Oi(i));r=this.write(o,t,n)}else r=this.write(s,t,n);return{dataId:r,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,s,r,o){this.data.set(t,{values:n,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:s}=this.data.get(t);if(n==="complex64"){const r=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return zo(r,o)}return TG(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const s=n.map(r=>Ui(r));return _t(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return _t(t.shape,t.dtype,n)}makeOutput(t,n,s){return Pr().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(t);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=Un();return t(),{kernelMs:Un()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){pt([t],"where");const n=this.readSync(t.dataId);return vQ(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}m0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rM(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const wQ=e=>{const{x:t}=e.inputs,n=e.backend;pt(t,"abs");let s=new Float32Array(Y(t.shape));const r=n.data.get(t.dataId).values;return s=rM(r),n.makeOutput(s,t.shape,t.dtype)},kQ={kernelName:Hg,backendName:"cpu",kernelFunc:wQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Le(e){return(t,n,s,r,o)=>{const i=$t(t,n),a=i.length,l=yt(i),c=Y(i),u=xn(o,c),d=t.length,h=n.length,f=yt(t),p=yt(n),m=Ac(t,i),g=Ac(n,i);if(m.length+g.length===0)for(let x=0;x<u.length;++x)u[x]=e(s[x%s.length],r[x%r.length]);else for(let x=0;x<u.length;++x){const y=tu(x,a,l),b=y.slice(-d);m.forEach(C=>b[C]=0);const v=Yr(b,d,f),w=y.slice(-h);g.forEach(C=>w[C]=0);const k=Yr(w,h,p);u[x]=e(s[v],r[k])}return[u,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function os(e){const{inputs:t,backend:n}=e,{real:s,imag:r}=t,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",o),imag:n.makeTensorInfo(r.shape,"float32",i)},a}const CQ={kernelName:kw,backendName:"cpu",kernelFunc:os};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eg(e,t,n="float32"){if(n==="complex64"){const r=eg(e,t,"float32"),o=eg(e,t,"float32");return os({inputs:{real:r,imag:o},backend:e})}const s=yn(Y(t),n);return e.makeTensorInfo(t,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function io(e){const{inputs:t,backend:n}=e,{x:s}=t;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const SQ={kernelName:Oh,backendName:"cpu",kernelFunc:io};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cl(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.data.get(s.dataId).complexTensorInfos.real,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const IQ={kernelName:Hw,backendName:"cpu",kernelFunc:cl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oM(e,t,n,s){if(s==="int32"){const r=Int32Array.from(e);return[t,"int32",r]}if(s==="bool"){const r=yl([0],n),[o,i]=Le((a,l)=>a!==l?1:0)(t,[],e,r,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Xi(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return io({inputs:{x:r},backend:n});const u=eg(n,r.shape,r.dtype),d=Xi({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=os({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const u=cl({inputs:{input:r},backend:n}),d=Xi({inputs:{x:u},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(u),d}if(!CD(r.dtype,o)){const u=io({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:o}}const i=n.data.get(r.dataId).values,[a,l,c]=oM(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,c)}const $Q={kernelName:wh,backendName:"cpu",kernelFunc:Xi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(e,t,n,s){return n==null?({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;pt([i,a],e);const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,d=i.dtype==="string"?Bo(c):c,h=i.dtype==="string"?Bo(u):u,f=s||i.dtype,[p,m]=t(i.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const c=Xi({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=Xi({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),x=g.complexTensorInfos.real,y=g.complexTensorInfos.imag,b=l.data.get(x.dataId).values,v=l.data.get(y.dataId).values,[w,k,C]=n(i.shape,a.shape,f,p,b,v),S=l.makeTensorInfo(C,"float32",w),I=l.makeTensorInfo(C,"float32",k),$=os({inputs:{real:S,imag:I},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(S),l.disposeIntermediateTensorInfo(I),$}else{const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,d=s||i.dtype,[h,f]=t(i.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function MC(e){return(t,n,s,r,o,i)=>{const a=$t(t,n),l=Y(a),c=a.length,u=yt(a),d=xn("float32",l),h=xn("float32",l),f=Ac(t,a),p=Ac(n,a),m=zo(s,r),g=zo(o,i),x=t.length,y=yt(t),b=n.length,v=yt(n);if(f.length+p.length===0)for(let w=0;w<d.length;w++){const k=w%m.length,C=w%g.length,S=e(m[k*2],m[k*2+1],g[C*2],g[C*2+1]);d[w]=S.real,h[w]=S.imag}else for(let w=0;w<d.length;w++){const k=tu(w,c,u),C=k.slice(-x);f.forEach(A=>C[A]=0);const S=Yr(C,x,y),I=k.slice(-b);p.forEach(A=>I[A]=0);const $=Yr(I,b,v),E=e(m[S*2],m[S*2+1],g[$*2],g[$*2+1]);d[w]=E.real,h[w]=E.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iM=Le((e,t)=>e+t),TQ=MC((e,t,n,s)=>({real:e+n,imag:t+s})),Mc=qe(eu,iM,TQ),NQ={kernelName:eu,backendName:"cpu",kernelFunc:Mc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LC(e,t,n,s,r){const o=Y(s),i=yn(r,n);for(let a=0;a<e.length;a++){const l=e[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(o>0?i[l]+=t[a]:i[l]+=1)}return i}function aM(e,t,n,s=!1){const r=e.shape[0],o=e.shape[1],i=_t([r,n],t.dtype);for(let a=0;a<r;a++)for(let l=0;l<o;l++){const c=e.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?i.set(1,a,c):t.size>0?i.set(i.get(a,c)+t.get(a,l),a,c):i.set(i.get(a,c)+1,a,c))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lM=Le((e,t)=>e&t),EQ=qe(ww,lM),_Q={kernelName:ww,backendName:"cpu",kernelFunc:EQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function co(e){return(t,n,s)=>{const r=De(n,t.length);for(let o=0;o<t.length;++o)r[o]=e(t[o],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yt(e,t,n){const s=co(t);return aa(e,s,n)}function aa(e,t,n){return({inputs:s,attrs:r,backend:o})=>{const{x:i}=s;pt(i,e);const a=o,l=a.data.get(i.dataId).values;let c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Bo(l)}else c=l;const u=n||i.dtype,d=t(c,u,r);return a.makeTensorInfo(i.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cM=co(e=>Math.ceil(e)),RQ=aa(kh,cM),DQ={kernelName:kh,backendName:"cpu",kernelFunc:RQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uM(e,t,n,s){const r=De(n,Y(t));if(s&&n!=="string"){let o=0;e.forEach(i=>{const a=Y(i.shape);r.set(i.vals,o),o+=a})}else{let o=0;e.forEach(i=>{const a=n==="string"?Bo(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const u=c*t[1]+o;for(let d=0;d<i.shape[1];++d)r[u+d]=a[l++]}o+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dM=Le((e,t)=>e===t?1:0),hM=qe(ax,dM,null,"bool"),AQ={kernelName:ax,backendName:"cpu",kernelFunc:hM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fM=co(e=>Math.exp(e)),pM=aa(Eh,fM,"float32"),OQ={kernelName:Eh,backendName:"cpu",kernelFunc:pM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mM=co(e=>Math.expm1(e)),FQ=aa(_h,mM),PQ={kernelName:_h,backendName:"cpu",kernelFunc:FQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gM=co(e=>Math.floor(e)),MQ=aa(Rh,gM),LQ={kernelName:Rh,backendName:"cpu",kernelFunc:MQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xM=Le((e,t)=>Math.floor(e/t)),zQ=qe(Dh,xM,null,"int32"),BQ={kernelName:Dh,backendName:"cpu",kernelFunc:zQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(e,t,n,s,r,o,i,a,l){const c=_t([s,o],n);for(let u=0;u<s;u++){const d=[];let h=0;for(let f=0;f<r;f++){const p=e[u*r+f];h+=p*i[f],d.push(p)}if(h<0||h>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<o;f++)c.values[u*o+f]=t.get(...t.indexToLoc(h*o+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bM(e,t,n){const s=_t(n,e.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),a=i[0],l=i[2],c=t.locToIndex([a,l]);i[2]=t.values[c];const u=e.locToIndex(i);0<=u&&u<e.values.length&&(s.values[r]=e.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vM=Le((e,t)=>e>t?1:0),VQ=qe(dx,vM,null,"bool"),WQ={kernelName:dx,backendName:"cpu",kernelFunc:VQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wM=Le((e,t)=>e>=t?1:0),UQ=qe(Ah,wM,null,"bool"),jQ={kernelName:Ah,backendName:"cpu",kernelFunc:UQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kM=Le((e,t)=>e<t?1:0),GQ=qe(fx,kM,null,"bool"),HQ={kernelName:fx,backendName:"cpu",kernelFunc:GQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CM=Le((e,t)=>e<=t?1:0),KQ=qe(px,CM,null,"bool"),XQ={kernelName:px,backendName:"cpu",kernelFunc:KQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SM(e,t,n){const s=(t-e)/(n-1),r=yn(n,"float32");r[0]=e;for(let o=1;o<r.length;o++)r[o]=r[o-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IM=co(e=>Math.log(e)),qQ=aa(Lh,IM),YQ={kernelName:Lh,backendName:"cpu",kernelFunc:qQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $M(e,t,n,s){const r=xn(s,Y(n));for(let o=0;o<r.length;++o){const i=o*t;let a=e[i];for(let l=0;l<t;++l){const c=e[i+l];(Number.isNaN(c)||c>a)&&(a=c)}r[o]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TM=Le((e,t)=>Math.max(e,t)),QQ=qe(Bh,TM),ZQ={kernelName:Bh,backendName:"cpu",kernelFunc:QQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NM=Le((e,t)=>Math.min(e,t)),JQ=qe(Vh,NM),tZ={kernelName:Vh,backendName:"cpu",kernelFunc:JQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zC=Le((e,t)=>e*t),eZ=MC((e,t,n,s)=>({real:e*n-t*s,imag:e*s+t*n})),g0=qe(Uh,zC,eZ),nZ={kernelName:Uh,backendName:"cpu",kernelFunc:g0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EM(e,t,n){const s=ea(-1,n);return zC([],t,s,e,n)}function sZ(e){const{inputs:t,backend:n}=e,{x:s}=t;pt(s,"neg");const r=n.data.get(s.dataId).values,[o,i]=EM(r,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,o)}const rZ={kernelName:Ix,backendName:"cpu",kernelFunc:sZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _M=Le((e,t)=>e!==t?1:0),oZ=qe($x,_M,null,"bool"),iZ={kernelName:$x,backendName:"cpu",kernelFunc:oZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BC(e,t,n,s,r){const o=t.length,i=Y(t),a=yt(t),l=yt(r),c=xn(n,Y(r));for(let u=0;u<i;++u){const d=tu(u,o,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[s[p]];const f=Yr(h,o,l);c[f]=e[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qn(e){const{inputs:t,attrs:n,backend:s}=e,{x:r}=t,{perm:o}=n;pt(r,"transpose");const i=r.shape.length,a=new Array(i);for(let d=0;d<a.length;d++)a[d]=r.shape[o[d]];const l=s.data.get(r.dataId).values,c=BC(l,r.shape,r.dtype,o,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const aZ={kernelName:oc,backendName:"cpu",kernelFunc:Qn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RM(e,t,n,s){const[r,o]=sn(e,s),i=fs(t,"int32"),a=yn(Y(r),i),l=Y(o);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:r,outDtype:i}}function lZ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s;pt(r,"prod");const a=r.shape.length,l=Rt(o,r.shape),c=Ie(l,a);let u=l,d=r;const h=[];c!=null&&(d=Qn({inputs:{x:r},backend:n,attrs:{perm:c}}),h.push(d),u=Pe(u.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:g}=RM(d.shape,d.dtype,f,u);let x=m;return i&&(x=Fe(m,l)),h.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(x,g,p)}const cZ={kernelName:Dx,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uZ(e,t,n){e.forEach((s,r)=>{if(s<0||s>=n){const o=tu(r,t.length,yt(t)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${n})`)}})}function dZ(e,t){for(let n=0;n<e.length;++n){const s=e[n],r=n===e.length-1?t:e[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function hZ(e,t,n,s){const r=[];let o=0;const i=t.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);dZ(n,s);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];const u=t[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<e.length;++c){let u=e[c],d=e[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+t.length-1;if(p>=0){const m=a[p],g=m[m.length-1]-f[u];for(let x=u;x<d;++x)a[p].push(f[x+1]+g)}u=f[u],d=f[d]}d!==u&&(r.push([u,d]),o+=d-u)}return{outSplits:a,valueSlices:r,numValues:o}}function fZ(e){const t=[];for(let n=0;n<e.length;++n){const s=e[n].length,r=De("int32",s);t.push(r),e[n].forEach((o,i)=>r[i]=o)}return t}function h$(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let s=t;s<e.length;s++)n[t-1]*=e[s];return n}function pZ(e,t,n,s,r,o){const i=h$(t,2)[1],a=h$(o,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<s;++d)r[l*a+d]=e[u*i+d];++l}}function mZ(e,t,n,s,r){const o=t.slice();o[0]=r;const i=De(n,Y(o)),a=e.length,l=a===0?0:a/t[0];return pZ(e,t,s,l,i,o),[i,o]}function DM(e,t,n,s,r,o,i,a){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const l=t[0][0]-1;if(uZ(o,i,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:d,numValues:h}=hZ(o,i,e,c),f=fZ(u),p=mZ(n,s,r,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f$=2147483647;function AM(e,t,n,s,r,o,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=t.length===0,l=r.length===0,c=i.length===0,u=[];a||u.push(t[0]),l||u.push(r[0]),c||u.push(i[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=De("int32",d+1);h[0]=0;for(let g=0;g<d;++g){const x=a?e[0]:e[g],y=l?s[0]:s[g],b=c?o[0]:o[g];if(b===0)throw new Error("Requires delta != 0");let v;if(b>0&&y<x||b<0&&y>x)v=0;else if(v=Math.ceil(Math.abs((y-x)/b)),v>f$)throw new Error(`Requires ((limit - start) / delta) <= ${f$}`);h[g+1]=h[g]+v}const f=h[d],p=De(n,f);let m=0;for(let g=0;g<d;++g){const x=h[g+1]-h[g];let y=a?e[0]:e[g];const b=c?o[0]:o[g];for(let v=0;v<x;++v)p[m++]=y,y+=b}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ms=gr;class ng{constructor(t,n,s,r,o,i,a,l,c,u){this.shape=t,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=bO(u),this.raggedRank=vO(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===Ms.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===Ms.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case Ms.VALUE_ROWIDS:return ng.getMaxWidthValueRowID(n);case Ms.ROW_SPLITS:return ng.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Ms[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const o=t[r+1]-t[r];o>s&&(s=o)}return s}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let s=0,r=t[0],o=0;for(let i=1;i<n;++i){const a=t[i];a!==r&&(r=a,o=Math.max(i-s,o),s=i)}return Math.max(n-s,o)}tensorShapeFromTensor(t,n,s=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return m$(t,s)}calculateOutputSize(t){const n=this.valuesShape,s=this.defaultValueShape;wO(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=yO(this.raggedRank,r,n);i[0]<0&&(i[0]=t);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(t,n,s){const r=Math.min(t,s),o=[];let i=0;for(let a=0;a<r;++a,i+=n)o.push(i);for(let a=r;a<t;++a)o.push(-1);return T(o.length===t,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(t,n,s,r){const o=t.length,i=[];for(let a=0;a<o-1;++a){const l=t[a+1]-t[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)i.push(u),u+=s;for(let d=0;d<l-c;++d)i.push(-1)}if(o>0&&i.length!==t[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(t,n,s,r){const o=t.length,i=[];if(o===0)return[];let a=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];i.push(c);for(let u=1;u<o;++u){const d=t[u];if(d===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}i.push(c)}if(i.length!==t.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(t,n,s,r){const o=this.getRowPartitionTensor(t),i=this.getRowPartitionTypeByDimension(t);switch(i){case Ms.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,s,r);case Ms.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,s,r);default:throw new Error(`Unsupported partition type: ${Ms[i]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Ms.FIRST_DIM_SIZE:return t[0];case Ms.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ms.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ms[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const o=m$(s,!1),i=De(this.valuesDType,Y(o));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(t,n,s,r){if(s.length===0)return;const o=this.values,i=s;let a=r.slice();a=a.slice(t+1);const l=Y(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;G(()=>{const m=j(u,p);u=ud(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(h<f){const g=o.subarray(d*l),x=i.subarray(h*l),y=(f-h)*l;p$(x,g,y)}if(p>=c){const g=s.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const g=i.slice(f*l);p$(g,u,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function p$(e,t,n){for(let s=0;s<n;s++)e[s]=t[s]}function m$(e,t){const n=[];for(let s of e){if(s<0){if(!t)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function OM(e,t,n,s,r,o,i,a,l,c){return new ng(e,t,n,s,r,o,i,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FM(e,t,n,s){const r=e===t,o=e<t&&n<0,i=t<e&&n>1;if(r||o||i)return yn(0,s);const a=Math.abs(Math.ceil((t-e)/n)),l=yn(a,s);t<e&&n===1&&(n=-1),l[0]=e;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PM=co(e=>1/Math.sqrt(e)),gZ=aa(qh,PM),xZ={kernelName:qh,backendName:"cpu",kernelFunc:gZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(e,t,n,s,r,o,i,a,l,c){const u=[s/r,r],d=e.values,h=t.values;if(s===0)return _t(n,t.dtype);const f=l instanceof un?l:_t(u,t.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<o;p++){const m=[];let g=0;for(let x=0;x<i;x++){const y=d[p*i+x];m.push(y),g+=y*a[x]}if(g<0||g>=s/r)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let x=0;x<r;x++)c?f.values[g*r+x]+=h[p*r+x]:f.values[g*r+x]=t.rank===0?h[0]:h[p*r+x]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yZ=co(e=>1/(1+Math.exp(-e))),MM=Yt(tf,e=>1/(1+Math.exp(-e))),bZ={kernelName:tf,backendName:"cpu",kernelFunc:MM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LM(e,t,n,s,r){const o=Hk(s,t,n),i=Y(n),a=yt(s);if(o){const d=Kk(t,a);return r==="string"?e.slice(d,d+i):e.subarray(d,d+i)}const l=r==="string"?Bo(e):e,c=_t(s,r,l),u=_t(n,r);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,m)=>p+t[m]);u.set(c.get(...f),...h)}return r==="string"?VO(u.values):u.values}function ul(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:o,size:i}=s;pt(r,"slice");const[a,l]=e0(r,o,i);jk(r,a,l);const c=n.data.get(r.dataId).values,u=LM(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const vZ={kernelName:Lx,backendName:"cpu",kernelFunc:ul};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zM(e,t,n,s,r,o,i){const a=t[0],l=o[0],c=new Array(l),u=new Array(a),d=t[1];if(l===0){if(a!==0)throw new Error(NO(a));const g=De(n,0),x=De(r,0);return[g,[0,d],x,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let g=0;g<a;++g){const x=e[g*d];if(x<0)throw new Error(EO(g,x));if(x>=l)throw new Error(_O(g,x,l));++p[x],h=h&&x>=f,f=x}let m=!0;for(let g=0;g<l;++g){const x=p[g]===0;c[g]=x,m=m&&!x,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&h){const g=e,x=s;for(let y=0;y<a;++y)u[y]=y;return[g,[a,d],x,c,u]}else{const g=p[l-1],x=De(n,g*d),y=De(r,g),b=new Array(l).fill(0);for(let v=0;v<a;++v){const w=e[v*d],k=b[w],C=(w===0?0:p[w-1])+k;b[w]++;for(let S=0;S<d;++S)x[C*d+S]=e[v*d+S];y[C]=s[v],u[v]=C}for(let v=0;v<l;++v)if(b[v]===0){const k=v===0?0:p[v-1];x[k*d+0]=v;for(let C=1;C<d;++C)x[k*d+C]=0;y[k]=i}return[x,[g,d],y,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BM(e,t,n,s,r){const o=Y(s),i=t[0],a=r.length,l=[];let c=1,u=-1;for(let g=0;g<a;++g){const x=r[g];if(x===-1){if(u!==-1)throw new Error(RO(u,g));u=g,l.push(1)}else{if(x<0)throw new Error(DO(g,x));c*=x,l.push(x)}}if(u!==-1){if(c<=0)throw new Error(AO());const g=Math.trunc(o/c);if(c*g!==o)throw new Error(OO(s,l));l[u]=g}if(Y(l)!==o)throw new Error(FO(s,l));const h=s.length,f=[];if(h>0){f[h-1]=1;for(let g=h-2;g>=0;--g)f[g]=f[g+1]*s[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=De(n,i*a);for(let g=0;g<i;++g){let x=0;for(let y=0;y<h;++y)x+=e[g*h+y]*f[y];for(let y=0;y<a;++y)m[g*a+y]=Math.trunc(x/p[y]),x%=p[y]}return[m,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VC(e,t,n,s,r,o=!1,i=0){const a=s.length,l=[t[0],e.length/t[0]],c=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(f1());const h=t.slice();h[0]=d;const f=h.reduce((b,v)=>b*v,1),p=De(n,f);if(a===0)return d>0&&p.fill(i),[p,h];if(d<=0)throw new Error(f1());let m=0,g=1,x=0,y=r[m];for(;;){let b=0;if(g<a){if(b=r[g],y===b){++g;continue}if(y>=b)throw new Error(PO())}if(y<0||y>=d)throw new Error(MO(y,d));y>x&&p.fill(i,x*c,y*c);for(let v=m;v<g;++v){const w=s[v];if(w<0||w>=l[0])throw new Error(LO(v,s[v],l[0]));for(let k=0;k<c;k++)p[y*c+k]+=e[w*c+k]}if(o)for(let v=0;v<c;v++)p[y*c+v]/=g-m;if(m=g,++g,x=y+1,y=b,g>a)break}return x<d&&p.fill(i,x*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wZ=co(e=>Math.sqrt(e)),kZ=Yt(nf,e=>Math.sqrt(e)),CZ={kernelName:nf,backendName:"cpu",kernelFunc:kZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VM=Le((e,t)=>{const n=e-t;return n*n}),SZ=qe(sf,VM),IZ={kernelName:sf,backendName:"cpu",kernelFunc:SZ};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WM=co((e,t)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=t;return e.replace(new RegExp(n,s?"g":""),r)}),$Z=aa(Yw,WM),TZ={kernelName:Yw,backendName:"cpu",kernelFunc:$Z};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UM(e,t,n,s){const r=_t(e,t.dtype);for(let o=0;o<r.size;o++){const i=r.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+s[l];r.set(t.get(...a),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NZ{constructor(t,n,s,r,o,i){this.separator=Oi(t),this.nGramWidths=n,this.leftPad=Oi(s),this.rightPad=Oi(r),this.padWidth=o,this.preserveShort=i}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const s=this.getPadWidth(n);return Math.max(0,t+2*s-n+1)}createNGrams(t,n,s,r,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),c=Math.max(0,l-a),u=Math.max(0,l-(o-(a+1))),d=i-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let y=0;y<d;++y)f+=t[h+y].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const m=s[r+a];let g=0;const x=y=>y.forEach(b=>m[g++]=b);for(let y=0;y<c;++y)x(this.leftPad),x(this.separator);for(let y=0;y<d-1;++y)x(t[h+y]),x(this.separator);if(d>0){x(t[h+d-1]);for(let y=0;y<u;++y)x(this.separator),x(this.rightPad)}else{for(let y=0;y<u-1;++y)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(t,n){const s=t.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const o=r-1,i=De("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=o;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),i[l]=i[l-1]+u}const a=new Array(i[o]);for(let l=0;l<o;++l){const c=n[l];let u=i[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(t,c,a,u,f,d),u+=f}),this.preserveShort&&u===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(t,c,a,u,1,h)}}return[a,i]}}function jM(e,t,n,s,r,o,i,a){return new NZ(n,s,r,o,i,a).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZ(e,t,n,s){if(!e.length)return;if(t.length===0){for(let o=0;o<e.length;++o)s.push(e.subarray(o,o+1));return}if(t.length===1){const o=t[0];let i=e.indexOf(o);for(;i!==-1;){const a=e.subarray(0,i);(!n||a.length!==0)&&s.push(a),e=e.subarray(i+1),i=e.indexOf(o)}(!n||e.length!==0)&&s.push(e);return}let r=0;for(let o=0;o<e.length+1;o++)if(o===e.length||t.indexOf(e[o])!==-1){const i=e.subarray(r,o);(!n||i.length!==0)&&s.push(i),r=o+1}}function GM(e,t,n){const s=e.length,r=[];let o=0,i=0;const a=new Array(s);for(let h=0;h<s;++h){const f=r.length;EZ(e[h],t,n,r);const p=r.length-f;a[h]=p,o+=p,i=Math.max(i,p)}const l=De("int32",o*2),c=new Array(o),u=[s,i];let d=0;for(let h=0;h<s;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=r[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HM(e,t){const n=De("int32",e.length);for(let s=0;s<e.length;++s)n[s]=HG(e[s]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KM=Le((e,t)=>e-t),_Z=MC((e,t,n,s)=>({real:e-n,imag:t-s})),WC=qe(rf,KM,_Z),RZ={kernelName:rf,backendName:"cpu",kernelFunc:WC};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XM(e,t){const n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];const s=_t(n,e.dtype);for(let r=0;r<s.values.length;++r){const o=s.indexToLoc(r),i=new Array(e.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%e.shape[l];const a=e.locToIndex(i);s.values[r]=e.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ju=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function qM(e,t,n=0,s=e.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=t-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(t-l*u/a+d)),f=Math.min(s,Math.floor(t+(a-l)*u/a+d));qM(e,t,h,f)}const r=e[t];let o=n,i=s;for(Ol(e,n,t),ju(e[s],r)>0&&Ol(e,n,s);o<i;){for(Ol(e,o,i),o++,i--;ju(e[o],r)<0;)o=o+1;for(;ju(e[i],r)>0;)i=i-1}ju(e[n],r)===0?Ol(e,n,i):(i=i+1,Ol(e,i,s)),i<=t&&(n=i+1),t<=i&&(s=i-1)}}function YM(e,t,n,s,r){const o=t[t.length-1],[i,a]=[e.length/o,o],l=xn(n,i*s),c=xn("int32",i*s);for(let d=0;d<i;d++){const h=d*a,f=e.subarray(h,h+a);let p=new Array(f.length);f.forEach((y,b)=>p[b]={value:y,index:b}),s<p.length&&(qM(p,s),p=p.slice(0,s)),r&&p.sort(ju);const m=d*s,g=l.subarray(m,m+s),x=c.subarray(m,m+s);for(let y=0;y<s;y++)g[y]=p[y].value,x[y]=p[y].index}const u=t.slice();return u[u.length-1]=s,[_t(u,n,l),_t(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QM(e,t,n,s){const r=Rt(t,n)[0],o=[1,n[0],1];for(let p=0;p<r;p++)o[0]*=n[p];o[1]=n[r];for(let p=r+1;p<n.length;p++)o[2]*=n[p];const i=new Map,a=new Int32Array(n[r]),l=new un(o,s,e),c=[],u=o[0]===1&&o[2]===1;for(let p=0;p<n[r];p++){let m;if(u)m=e[p].toString();else{const x=[];for(let y=0;y<o[0];y++)for(let b=0;b<o[2];b++)x.push(l.get(y,p,b));m=x.join(",")}const g=i.get(m);if(g!=null)a[p]=g;else{const x=i.size;i.set(m,x),a[p]=x,c.push(p)}}const d=o.slice();d[1]=i.size;const h=new un(d,s);c.forEach((p,m)=>{for(let g=0;g<o[0];g++)for(let x=0;x<o[2];x++)h.set(l.get(g,p,x),g,m,x)});const f=n.slice();return f[r]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DZ=Object.freeze(Object.defineProperty({__proto__:null,addImpl:iM,bincountImpl:LC,bincountReduceImpl:aM,bitwiseAndImpl:lM,castImpl:oM,ceilImpl:cM,concatImpl:uM,equalImpl:dM,expImpl:fM,expm1Impl:mM,floorDivImpl:xM,floorImpl:gM,gatherNdImpl:yM,gatherV2Impl:bM,greaterEqualImpl:wM,greaterImpl:vM,lessEqualImpl:CM,lessImpl:kM,linSpaceImpl:SM,logImpl:IM,maxImpl:$M,maximumImpl:TM,minimumImpl:NM,multiplyImpl:zC,negImpl:EM,notEqualImpl:_M,prodImpl:RM,raggedGatherImpl:DM,raggedRangeImpl:AM,raggedTensorToTensorImpl:OM,rangeImpl:FM,rsqrtImpl:PM,scatterImpl:Ra,sigmoidImpl:yZ,simpleAbsImpl:rM,sliceImpl:LM,sparseFillEmptyRowsImpl:zM,sparseReshapeImpl:BM,sparseSegmentReductionImpl:VC,sqrtImpl:wZ,squaredDifferenceImpl:VM,staticRegexReplaceImpl:WM,stridedSliceImpl:UM,stringNGramsImpl:jM,stringSplitImpl:GM,stringToHashBucketFastImpl:HM,subImpl:KM,tileImpl:XM,topKImpl:YM,transposeImpl:BC,uniqueImpl:QM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xA("cpu",()=>new m0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZM=Yt(Th,e=>e>=0?e:Math.exp(e)-1),AZ={kernelName:Th,backendName:"cpu",kernelFunc:ZM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JM(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{alpha:o}=s;pt([r],"leakyRelu");const i=Y(r.shape),a=n.data.get(r.dataId).values,l=xn("float32",i);for(let c=0;c<a.length;c++)l[c]=a[c]<0?o*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const OZ={kernelName:hx,backendName:"cpu",kernelFunc:JM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FZ=Le((e,t)=>e<0?t*e:e);function tL(e){const{inputs:t,backend:n}=e,{x:s,alpha:r}=t;pt([s,r],"prelu");const o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,[a,l]=FZ(s.shape,r.shape,o,i,"float32");return n.makeTensorInfo(l,"float32",a)}const PZ={kernelName:Rx,backendName:"cpu",kernelFunc:tL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eL=Yt(Hh,e=>Math.max(0,e)),MZ={kernelName:Hh,backendName:"cpu",kernelFunc:eL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nL=Yt(Kh,e=>Math.min(Math.max(0,e),6)),LZ={kernelName:Kh,backendName:"cpu",kernelFunc:nL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sg(e,t,n,s,r){if(n==="linear")return io({inputs:{x:t},backend:e});if(n==="relu")return eL({inputs:{x:t},backend:e});if(n==="elu")return ZM({inputs:{x:t},backend:e});if(n==="relu6")return nL({inputs:{x:t},backend:e});if(n==="prelu")return tL({inputs:{x:t,alpha:s},backend:e});if(n==="leakyrelu")return JM({inputs:{x:t},backend:e,attrs:{alpha:r}});if(n==="sigmoid")return MM({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ie(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{shape:o}=s,i=Y(r.shape),a=kD(o,i),l=Y(a);T(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const zZ={kernelName:Ax,backendName:"cpu",kernelFunc:ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sL(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:o}=t,{transposeA:i,transposeB:a}=s;pt([r,o],"matMul");const l=r.shape.length,c=o.shape.length,u=i?r.shape[l-2]:r.shape[l-1],d=a?o.shape[c-1]:o.shape[c-2],h=i?r.shape[l-1]:r.shape[l-2],f=a?o.shape[c-2]:o.shape[c-1],p=r.shape.slice(0,-2),m=o.shape.slice(0,-2),g=Y(p),x=Y(m),b=$t(r.shape.slice(0,-2),o.shape.slice(0,-2)).concat([h,f]);T(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const v=i?[g,u,h]:[g,h,u],w=a?[x,f,d]:[x,d,f],k=ie({inputs:{x:r},backend:n,attrs:{shape:v}}),C=ie({inputs:{x:o},backend:n,attrs:{shape:w}}),S=i?k.shape[1]:k.shape[2],I=i?k.shape[2]:k.shape[1],$=a?C.shape[1]:C.shape[2],E=Math.max(g,x),A=n.data.get(k.dataId).values,L=n.data.get(C.dataId).values,O=yt(k.shape),P=yt(C.shape),[M,U,R]=i?[O[0],1,O[1]]:[O[0],O[1],1],[z,H,X]=a?[1,P[1],P[0]]:[P[1],1,P[0]],Q=I*$,J=_t([E,I,$],k.dtype),nt=J.values,st=n.blockSize;for(let ot=0;ot<E;ot++){const dt=ot%g,vt=ot%x;for(let bt=0;bt<I;bt+=st){const Ct=Math.min(bt+st,I);for(let St=0;St<$;St+=st){const Vt=Math.min(St+st,$);for(let Wt=0;Wt<S;Wt+=st){const ae=Math.min(Wt+st,S);for(let Qt=bt;Qt<Ct;Qt++)for(let Kt=St;Kt<Vt;Kt++){let le=0;for(let ne=Wt;ne<ae;ne++){const es=A[dt*M+Qt*U+ne*R],rn=L[ne*z+Kt*H+vt*X];le+=es*rn}nt[ot*Q+(Qt*$+Kt)]+=le}}}}}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(b,J.dtype,J.values)}const BZ={kernelName:Qg,backendName:"cpu",kernelFunc:sL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VZ(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:o,bias:i,preluActivationWeights:a}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;let h,f,p;const m=[];h=sL({inputs:{a:r,b:o},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(f=Mc({inputs:{a:h,b:i},backend:n}),m.push(h),h=f),u&&(p=sg(n,h,u,a,d),m.push(h),h=p);for(const x of m)n.disposeIntermediateTensorInfo(x);return h}const WZ={kernelName:Pm,backendName:"cpu",kernelFunc:VZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UZ=Yt(ph,e=>Math.acos(e)),jZ={kernelName:ph,backendName:"cpu",kernelFunc:UZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GZ=Yt(mh,e=>Math.acosh(e)),HZ={kernelName:mh,backendName:"cpu",kernelFunc:GZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KZ(e){const{inputs:t,backend:n}=e,s=t;pt(t,"addN");const r=s.map(a=>n.data.get(a.dataId).values),o=_t(s[0].shape,s[0].dtype),i=o.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<i.length;c++)i[c]+=l[c]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const XZ={kernelName:mw,backendName:"cpu",kernelFunc:KZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qZ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s;pt(r,"all");const a=Rt(o,r.shape);let l=a;const c=Ie(l,r.shape.length);let u=r;c!=null&&(u=Qn({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Pe(l.length,r.shape.length)),hn("all",l,u.shape.length);const[d,h]=sn(u.shape,l),f=Y(h),p=yn(Y(d),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=m[y];for(let v=0;v<f;++v){const w=m[y+v];b=b&&w}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(i){const x=Fe(d,a),y=ie({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),y}return g}const YZ={kernelName:gw,backendName:"cpu",kernelFunc:qZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QZ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s;pt(r,"any");const a=Rt(o,r.shape);let l=a;const c=Ie(l,r.shape.length);let u=r;c!=null&&(u=Qn({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Pe(l.length,r.shape.length)),hn("any",l,u.shape.length);const[d,h]=sn(u.shape,l),f=Y(h),p=yn(Y(d),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=m[y];for(let v=0;v<f;++v){const w=m[y+v];b=b||w}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(i){const x=Fe(d,a),y=ie({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),y}return g}const ZZ={kernelName:xw,backendName:"cpu",kernelFunc:QZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JZ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o}=s;pt(r,"argMax");let i=Rt(o,r.shape);const a=Ie(i,r.shape.length);let l=r;const c=[];a!=null&&(l=Qn({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=Pe(i.length,l.shape.length)),i=[i[0]],hn("argMax",i,l.shape.length);const[u,d]=sn(l.shape,i),h=Y(u),f=yn(h,"int32"),p=Y(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const x=g*p;let y=m[x],b=0;for(let v=0;v<p;++v){const w=m[x+v];w>y&&(y=w,b=v)}f[g]=b}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const tJ={kernelName:Kg,backendName:"cpu",kernelFunc:JZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o}=s;pt(r,"argMin");let i=Rt(o,r.shape);const a=Ie(i,r.shape.length);let l=r;const c=[];a!=null&&(l=Qn({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=Pe(i.length,l.shape.length)),i=[i[0]],hn("argMin",i,l.shape.length);const[u,d]=sn(l.shape,i),h=Y(u),f=yn(h,"int32"),p=Y(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const x=g*p;let y=m[x],b=0;for(let v=0;v<p;++v){const w=m[x+v];w<y&&(y=w,b=v)}f[g]=b}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const nJ={kernelName:Xg,backendName:"cpu",kernelFunc:eJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ=Yt(gh,e=>Math.asin(e)),rJ={kernelName:gh,backendName:"cpu",kernelFunc:sJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oJ=Yt(xh,e=>Math.asinh(e)),iJ={kernelName:xh,backendName:"cpu",kernelFunc:oJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ=Yt(yh,e=>Math.atan(e)),lJ={kernelName:yh,backendName:"cpu",kernelFunc:aJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cJ=Le((e,t)=>Math.atan2(e,t)),uJ=qe(vh,cJ),dJ={kernelName:vh,backendName:"cpu",kernelFunc:uJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJ=Yt(bh,e=>Math.atanh(e)),fJ={kernelName:bh,backendName:"cpu",kernelFunc:hJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UC(e,t,n,s,r,o){const i=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=_t(r.outShape,n),g=m.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3];for(let v=0;v<r.batchSize;++v){const w=v*x,k=v*s[0];for(let C=0;C<r.inChannels;++C)for(let S=0;S<r.outHeight;++S){const I=S*i-h,$=Math.max(0,I),E=Math.min(r.inHeight,u+I),A=w+S*y;for(let L=0;L<r.outWidth;++L){const O=L*a-f,P=Math.max(0,O),M=Math.min(r.inWidth,d+O);let U=p,R=0,z=0;for(let X=$;X<E;X+=l){const Q=k+X*s[1];for(let J=P;J<M;J+=c){const nt=Q+J*s[2],st=e[nt+C];o==="max"&&st>U?U=st:o==="avg"&&(R+=st,z++)}if(isNaN(U))break}const H=A+L*b+C;g[H]=o==="avg"?R/z:U}}}return m}function rL(e,t,n,s,r=!1,o=!1){const i=_t(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=_t(t,n,e);for(let g=0;g<s.batchSize;++g)for(let x=0;x<s.inChannels;++x)for(let y=0;y<s.outHeight;++y){const b=y*a-f;let v=b;for(;v<0;)v+=c;const w=Math.min(s.inHeight,d+b);for(let k=0;k<s.outWidth;++k){const C=k*l-p;let S=C;for(;S<0;)S+=u;const I=Math.min(s.inWidth,h+C);let $=Number.NEGATIVE_INFINITY,E=-1;for(let A=v;A<w;A+=c){const L=A-b;for(let O=S;O<I;O+=u){const P=O-C,M=m.get(g,A,O,x);M>$&&($=M,r?E=o?((g*s.inHeight+A)*s.inWidth+O)*s.inChannels+x:(A*s.inWidth+O)*s.inChannels+x:E=L*h+P)}}i.set(E,g,y,k,x)}}return i}function oL(e,t,n,s,r,o){const i=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,x=r.padInfo.left,y=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=_t(r.outShape,n),v=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],S=r.outShape[4];for(let I=0;I<r.batchSize;++I){const $=I*w,E=I*s[0];for(let A=0;A<r.inChannels;++A)for(let L=0;L<r.outDepth;++L){const O=L*i-m;let P=O;for(;P<0;)P+=c;const M=Math.min(r.inDepth,h+O),U=$+L*k;for(let R=0;R<r.outHeight;++R){const z=R*a-g;let H=z;for(;H<0;)H+=u;const X=Math.min(r.inHeight,f+z),Q=U+R*C;for(let J=0;J<r.outWidth;++J){const nt=J*l-x;let st=nt;for(;st<0;)st+=d;const ot=Math.min(r.inWidth,p+nt),dt=Q+J*S;let vt=y,bt=0,Ct=0;for(let Vt=P;Vt<M;Vt+=c){const Wt=E+Vt*s[1];for(let ae=H;ae<X;ae+=u){const Qt=Wt+ae*s[2];for(let Kt=st;Kt<ot;Kt+=d){const le=Qt+Kt*s[3],ne=e[le+A];if(o==="max"&&ne>vt?vt=ne:o==="avg"&&(bt+=ne,Ct++),isNaN(vt))break}if(isNaN(vt))break}if(isNaN(vt))break}const St=dt+A;v[St]=o==="avg"?bt/Math.max(Ct,1):vt}}}}return b}function pJ(e,t){const n=_t(t.outShape,"int32"),s=t.strideDepth,r=t.strideHeight,o=t.strideWidth,i=t.dilationDepth,a=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let x=0;x<t.outDepth;++x){const y=x*s-h;let b=y;for(;b<0;)b+=i;const v=Math.min(t.inDepth,c+y);for(let w=0;w<t.outHeight;++w){const k=w*r-f;let C=k;for(;C<0;)C+=a;const S=Math.min(t.inHeight,u+k);for(let I=0;I<t.outWidth;++I){const $=I*o-p;let E=$;for(;E<0;)E+=l;const A=Math.min(t.inWidth,d+$);let L=Number.NEGATIVE_INFINITY,O=-1;for(let P=b;P<v;P+=i){const M=P-y;for(let U=C;U<S;U+=a){const R=U-k;for(let z=E;z<A;z+=l){const H=z-$,X=e.get(m,P,U,z,g);X>=L&&(L=X,O=M*u*d+R*u+H)}}}n.set(O,m,x,w,I,g)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;pt(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(vn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=sr(r.shape,o,i,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Ht(u.inShape,u.outShape))d=io({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=yt(r.shape),p=UC(h,r.shape,r.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const gJ={kernelName:qg,backendName:"cpu",kernelFunc:mJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s;pt(r,"avgPool3d");const u=Uo(r.shape,o,i,1,a,l,c),d=n.data.get(r.dataId).values,h=oL(d,r.shape,r.dtype,yt(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const yJ={kernelName:Yg,backendName:"cpu",kernelFunc:xJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJ(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=s;pt([r,o],"avgPool3DGrad");const u=Uo(o.shape,i,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,g=u.filterWidth,x=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,C=v-1-u.padInfo.front,S=k-1-u.padInfo.left,I=w-1-u.padInfo.top,$=_t(o.shape,"float32"),E=1/(p*m*g),A=n.bufferSync(r);for(let L=0;L<u.batchSize;++L)for(let O=0;O<u.inChannels;++O)for(let P=0;P<u.inDepth;++P)for(let M=0;M<u.inHeight;++M)for(let U=0;U<u.inWidth;++U){const R=P-C,z=M-I,H=U-S;let X=0;for(let Q=0;Q<v;Q+=x){const J=(R+Q)/d;if(!(J<0||J>=u.outDepth||Math.floor(J)!==J))for(let nt=0;nt<w;nt+=y){const st=(z+nt)/h;if(!(st<0||st>=u.outHeight||Math.floor(st)!==st))for(let ot=0;ot<k;ot+=b){const dt=(H+ot)/f;if(dt<0||dt>=u.outWidth||Math.floor(dt)!==dt)continue;const vt=A.get(L,J,st,dt,O);X+=vt}}}$.set(X*E,L,P,M,U,O)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const vJ={kernelName:bw,backendName:"cpu",kernelFunc:bJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJ(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,i=o;pt([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=sr(i.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,x=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,v=x-1-u.padInfo.top,w=_t(i.shape,"float32"),k=1/(f*p),C=n.data.get(r.dataId).values,S=_t(r.shape,"float32",C);for(let I=0;I<u.batchSize;++I)for(let $=0;$<u.inChannels;++$)for(let E=0;E<u.inHeight;++E)for(let A=0;A<u.inWidth;++A){const L=E-v,O=A-b;let P=0;for(let M=0;M<x;M+=m){const U=(L+M)/d;if(!(U<0||U>=u.outHeight||Math.floor(U)!==U))for(let R=0;R<y;R+=g){const z=(O+R)/h;if(z<0||z>=u.outWidth||Math.floor(z)!==z)continue;const H=S.get(I,U,z,$);P+=H}}w.set(P*k,I,E,A,$)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const kJ={kernelName:yw,backendName:"cpu",kernelFunc:wJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,scale:o,offset:i,mean:a,variance:l}=t;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),pt([r,a,l,o,i],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=o?n.data.get(o.dataId).values:new Float32Array([1]),p=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=p.length,x=f.length,y=h.length,b=d.length;let v=0,w=0,k=0,C=0;for(let S=0;S<u.length;++S)m[S]=p[v++]+(u[S]-d[w++])*f[k++]/Math.sqrt(h[C++]+c),v>=g&&(v=0),w>=b&&(w=0),k>=x&&(k=0),C>=y&&(C=0);return n.makeTensorInfo(r.shape,r.dtype,m)}const SJ={kernelName:cx,backendName:"cpu",kernelFunc:CJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:o,crops:i}=s;pt([r],"batchToSpaceND");const a=o.reduce((x,y)=>x*y),l=mf(r.shape,o,a),c=gf(l.length,o.length),u=xf(r.shape,o,a),d=Zk(i,o.length),h=Jk(u,i,o.length),f=ie({inputs:{x:r},backend:n,attrs:{shape:l}}),p=Qn({inputs:{x:f},backend:n,attrs:{perm:c}}),m=ie({inputs:{x:p},backend:n,attrs:{shape:u}}),g=ul({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const $J={kernelName:Zg,backendName:"cpu",kernelFunc:IJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:o}=t,{size:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,c=LC(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}const NJ={kernelName:vw,backendName:"cpu",kernelFunc:TJ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJ(e){const{inputs:t,backend:n}=e,{s0:s,s1:r}=t,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=$t(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const _J={kernelName:ND,backendName:"cpu",kernelFunc:EJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RJ=Yt(Ch,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),DJ={kernelName:Ch,backendName:"cpu",kernelFunc:RJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AJ=e=>{const{x:t}=e.inputs,n=e.backend,s=new Float32Array(Y(t.shape)),r=n.data.get(t.dataId),o=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];s[c]=Math.hypot(u,d)}return n.makeOutput(s,t.shape,"float32")},OJ={kernelName:Jg,backendName:"cpu",kernelFunc:AJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lc(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.data.get(s.dataId).complexTensorInfos.imag,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const FJ={kernelName:Lw,backendName:"cpu",kernelFunc:Lc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zc(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s,o=Rt(r,t[0].shape)[0],i=t.map(m=>m.shape);qk(i,o);let a=Zr(t.map(m=>m.shape),o);if(Y(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);const l=t.filter(m=>Y(m.shape)>0);if(l.length===1)return io({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(v=>cl({inputs:{input:v},backend:n})),g=l.map(v=>Lc({inputs:{input:v},backend:n})),x=zc({inputs:m,backend:n,attrs:{axis:o}}),y=zc({inputs:g,backend:n,attrs:{axis:o}}),b=os({inputs:{real:x,imag:y},backend:n});return m.forEach(v=>n.disposeIntermediateTensorInfo(v)),g.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),b}const c=l.map(m=>{const x=[-1,Y(m.shape.slice(o))];return ie({inputs:{x:m},backend:n,attrs:{shape:x}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=Zr(c.map(m=>m.shape),1);const d=c[0].shape[0]===1,h=uM(u,a,t[0].dtype,d),f=Zr(l.map(m=>m.shape),o),p=n.makeTensorInfo(f,t[0].dtype,h);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const PJ={kernelName:tx,backendName:"cpu",kernelFunc:zc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iL(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;pt([r,o],"conv2d");const d=jo(l),h=dn(r.shape,o.shape,i,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,x=h.padInfo.left,y=h.padInfo.top,b=h.dataFormat==="channelsLast",v=new un(h.outShape,r.dtype),w=yt(r.shape),k=yt(o.shape),C=w[0],S=b?w[1]:w[2],I=b?w[2]:1,$=b?1:w[1],E=v.strides[0],A=b?v.strides[1]:v.strides[2],L=b?v.strides[2]:1,O=b?1:v.strides[1],P=n.data.get(r.dataId).values,M=n.data.get(o.dataId).values,U=v.values;for(let R=0;R<h.batchSize;++R){const z=R*C,H=R*E;for(let X=0;X<h.outHeight;++X){const Q=H+X*A,J=X*h.strideHeight-y;for(let nt=0;nt<f;++nt){const st=J+nt*m;if(st<0||st>=h.inHeight)continue;const ot=nt*k[0],dt=z+st*S;for(let vt=0;vt<h.outWidth;++vt){const bt=Q+vt*L,Ct=vt*h.strideWidth-x;for(let St=0;St<p;++St){const Vt=Ct+St*g;if(Vt<0||Vt>=h.inWidth)continue;const Wt=ot+St*k[1],ae=dt+Vt*I;let Qt=Wt;for(let Kt=0;Kt<h.inChannels;++Kt){const le=P[ae+Kt*$];for(let ne=0;ne<h.outChannels;++ne)U[bt+ne*O]+=le*M[Qt+ne];Qt+=h.outChannels}}}}}}return n.makeTensorInfo(v.shape,v.dtype,U)}const MJ={kernelName:ex,backendName:"cpu",kernelFunc:iL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;pt([r,o],"conv2dBackpropFilter");const d=jo(l),h=dn(r.shape,u,i,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:g}=h,x=h.dataFormat==="channelsLast",y=new un(h.filterShape,"float32"),b=h.padInfo.left,v=h.padInfo.top,w=n.data.get(r.dataId).values,k=n.data.get(o.dataId).values,C=new un(r.shape,r.dtype,w),S=new un(o.shape,o.dtype,k);for(let I=0;I<m;++I){const $=Math.max(0,Math.ceil((v-I)/f)),E=Math.min(h.outHeight,(h.inHeight+v-I)/f);for(let A=0;A<g;++A){const L=Math.max(0,Math.ceil((b-A)/p)),O=Math.min(h.outWidth,(h.inWidth+b-A)/p);for(let P=0;P<h.inChannels;++P)for(let M=0;M<h.outChannels;++M){let U=0;for(let R=0;R<h.batchSize;++R)for(let z=$;z<E;++z){const H=I+z*f-v;for(let X=L;X<O;++X){const Q=A+X*p-b;x?U+=C.get(R,H,Q,P)*S.get(R,z,X,M):U+=C.get(R,P,H,Q)*S.get(R,M,z,X)}}y.set(U,I,A,P,M)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const zJ={kernelName:Cw,backendName:"cpu",kernelFunc:LJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BJ(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;pt([r,o],"conv2dBackpropInput");const d=yt(o.shape),h=yt(r.shape);let f=jo(c);const p=dn(i,o.shape,a,1,l,u,!1,f),m=new un(p.inShape,"float32"),g=m.values,x=n.data.get(r.dataId).values,y=n.data.get(o.dataId).values,[b,v,w]=d,{batchSize:k,filterHeight:C,filterWidth:S,inChannels:I,inHeight:$,inWidth:E,outChannels:A,outHeight:L,outWidth:O,strideHeight:P,strideWidth:M}=p;f=p.dataFormat;const U=C-1-p.padInfo.top,R=S-1-p.padInfo.left,z=f==="channelsLast",H=m.strides[0],X=z?m.strides[1]:m.strides[2],Q=z?m.strides[2]:1,J=z?1:m.strides[1],nt=h[0],st=z?h[1]:h[2],ot=z?h[2]:1,dt=z?1:h[1];for(let vt=0;vt<k;++vt)for(let bt=0;bt<I;++bt)for(let Ct=0;Ct<$;++Ct){const St=Ct-U,Vt=Math.max(0,Math.ceil(St/P)),Wt=Math.min(L,(C+St)/P);for(let ae=0;ae<E;++ae){const Qt=ae-R,Kt=Math.max(0,Math.ceil(Qt/M)),le=Math.min(O,(S+Qt)/M);let ne=0;for(let rn=Vt;rn<Wt;++rn){const Yo=rn*P-St;for(let xs=Kt;xs<le;++xs){const ua=xs*M-Qt,ir=nt*vt+st*rn+ot*xs,uo=b*(C-1-Yo)+v*(S-1-ua)+w*bt;for(let Qo=0;Qo<A;++Qo){const Zo=x[ir+dt*Qo],Jo=y[uo+Qo];ne+=Zo*Jo}}}const es=H*vt+X*Ct+Q*ae+J*bt;g[es]=ne}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const VJ={kernelName:nx,backendName:"cpu",kernelFunc:BJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:i,pad:a,dilations:l}=s;pt([r,o],"conv3d");const c=na(r.shape,o.shape,i,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:g}=c,x=g.front,y=g.left,b=g.top,v=new un(c.outShape,r.dtype),w=n.data.get(r.dataId).values,k=n.data.get(o.dataId).values,C=v.values,S=yt(r.shape),I=yt(o.shape);for(let $=0;$<c.batchSize;++$){const E=$*S[0],A=$*v.strides[0];for(let L=0;L<c.outDepth;++L){const O=A+L*v.strides[1],P=L*c.strideDepth-x;for(let M=0;M<u;++M){const U=P+M*f;if(U<0||U>=c.inDepth)continue;const R=M*I[0],z=E+U*S[1];for(let H=0;H<c.outHeight;++H){const X=O+H*v.strides[2],Q=H*c.strideHeight-b;for(let J=0;J<d;++J){const nt=Q+J*p;if(nt<0||nt>=c.inHeight)continue;const st=R+J*I[1],ot=z+nt*S[2];for(let dt=0;dt<c.outWidth;++dt){const vt=X+dt*c.outChannels,bt=dt*c.strideWidth-y;for(let Ct=0;Ct<h;++Ct){const St=bt+Ct*m;if(St<0||St>=c.inWidth)continue;const Vt=st+Ct*I[2],Wt=ot+St*c.inChannels;let ae=Vt;for(let Qt=0;Qt<c.inChannels;++Qt){const Kt=w[Wt+Qt];for(let le=0;le<c.outChannels;++le)C[vt+le]+=Kt*k[ae+le];ae+=c.outChannels}}}}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const UJ={kernelName:sx,backendName:"cpu",kernelFunc:WJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jJ(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:i,pad:a,filterShape:l}=s;pt([r,o],"conv3dBackpropFilterV2");const c=yt(r.shape),u=yt(o.shape),d=na(r.shape,l,i,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,g=d.filterHeight,x=d.filterWidth,y=new un(d.filterShape,"float32"),b=y.values,[v,w,k,C]=y.strides,S=n.data.get(o.dataId).values,[I,$,E,A]=u,L=n.data.get(r.dataId).values,[O,P,M,U]=c,R=d.padInfo.front,z=d.padInfo.left,H=d.padInfo.top;for(let X=0;X<m;++X){const Q=Math.max(0,Math.ceil((R-X)/h)),J=Math.min(d.outDepth,(d.inDepth+R-X)/h),nt=X*v;for(let st=0;st<g;++st){const ot=Math.max(0,Math.ceil((H-st)/f)),dt=Math.min(d.outHeight,(d.inHeight+H-st)/f),vt=st*w+nt;for(let bt=0;bt<x;++bt){const Ct=Math.max(0,Math.ceil((z-bt)/p)),St=Math.min(d.outWidth,(d.inWidth+z-bt)/p),Vt=bt*k+vt;for(let Wt=0;Wt<d.inChannels;++Wt){const ae=Wt*C+Vt;for(let Qt=0;Qt<d.outChannels;++Qt){let Kt=0;for(let le=0;le<d.batchSize;++le){const ne=le*O,es=le*I;for(let rn=Q;rn<J;++rn){const xs=(X+rn*h-R)*P+ne,ua=rn*$+es;for(let ir=ot;ir<dt;++ir){const Qo=(st+ir*f-H)*M+xs,Zo=ir*E+ua;for(let Jo=Ct;Jo<St;++Jo){const E0=(bt+Jo*p-z)*U+Qo,_0=Jo*A+Zo;Kt+=L[E0+Wt]*S[_0+Qt]}}}}b[ae+Qt]=Kt}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const GJ={kernelName:Sw,backendName:"cpu",kernelFunc:jJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HJ(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{pad:i,strides:a,inputShape:l}=s;pt([r],"conv3dBackpropInputV2");const c=yt(r.shape),u=yt(o.shape),d=na(l,o.shape,a,1,i),h=new un(d.inShape,"float32"),f=h.values,[p,m,g,x]=h.strides,y=n.data.get(r.dataId).values,[b,v,w,k]=c,C=n.data.get(o.dataId).values,[S,I,$,E]=u,{batchSize:A,filterDepth:L,filterHeight:O,filterWidth:P,inChannels:M,inDepth:U,inHeight:R,inWidth:z,outChannels:H,outDepth:X,outHeight:Q,outWidth:J,strideDepth:nt,strideHeight:st,strideWidth:ot}=d,dt=L-1-d.padInfo.front,vt=O-1-d.padInfo.top,bt=P-1-d.padInfo.left;for(let Ct=0;Ct<A;++Ct)for(let St=0;St<M;++St)for(let Vt=0;Vt<U;++Vt){const Wt=Vt-dt,ae=Math.max(0,Math.ceil(Wt/nt)),Qt=Math.min(X,(L+Wt)/nt);for(let Kt=0;Kt<R;++Kt){const le=Kt-vt,ne=Math.max(0,Math.ceil(le/st)),es=Math.min(Q,(O+le)/st);for(let rn=0;rn<z;++rn){const Yo=rn-bt,xs=Math.max(0,Math.ceil(Yo/ot)),ua=Math.min(J,(P+Yo)/ot);let ir=0;for(let uo=ae;uo<Qt;++uo){const Qo=uo*nt-Wt;for(let Zo=ne;Zo<es;++Zo){const Jo=Zo*st-le;for(let xu=xs;xu<ua;++xu){const E0=xu*ot-Yo,_0=b*Ct+v*uo+w*Zo+k*xu,$z=S*(L-1-Qo)+I*(O-1-Jo)+$*(P-1-E0)+E*St;for(let Ff=0;Ff<H;++Ff){const Tz=y[_0+Ff],Nz=C[$z+Ff];ir+=Tz*Nz}}}}f[p*Ct+m*Vt+g*Kt+x*rn+St]=ir}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const KJ={kernelName:Iw,backendName:"cpu",kernelFunc:HJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XJ=Yt(Sh,e=>Math.cos(e)),qJ={kernelName:Sh,backendName:"cpu",kernelFunc:XJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YJ=Yt(Ih,e=>Math.cosh(e)),QJ={kernelName:Ih,backendName:"cpu",kernelFunc:YJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(e){const{inputs:t,backend:n,attrs:s}=e,{image:r,boxes:o,boxInd:i}=t,{cropSize:a,method:l,extrapolationValue:c}=s,[u,d,h,f]=r.shape,p=o.shape[0],[m,g]=a,x=_t([p,m,g,f],"float32"),y=n.data.get(o.dataId).values,b=n.data.get(i.dataId).values,v=n.data.get(r.dataId).values,w=yt(r.shape),k=yt(x.shape);for(let C=0;C<p;C++){const S=C*4,I=y[S],$=y[S+1],E=y[S+2],A=y[S+3],L=b[C];if(L>=u)continue;const O=m>1?(E-I)*(d-1)/(m-1):0,P=g>1?(A-$)*(h-1)/(g-1):0;for(let M=0;M<m;M++){const U=m>1?I*(d-1)+M*O:.5*(I+E)*(d-1);if(U<0||U>d-1){for(let R=0;R<g;R++)for(let z=0;z<f;z++){const H=z+R*k[2]+M*k[1]+C*k[0];x.values[H]=c}continue}if(l==="bilinear"){const R=Math.floor(U),z=Math.ceil(U),H=U-R;for(let X=0;X<g;X++){const Q=g>1?$*(h-1)+X*P:.5*($+A)*(h-1);if(Q<0||Q>h-1){for(let ot=0;ot<f;ot++){const dt=ot+X*k[2]+M*k[1]+C*k[0];x.values[dt]=c}continue}const J=Math.floor(Q),nt=Math.ceil(Q),st=Q-J;for(let ot=0;ot<f;ot++){let dt=ot+J*w[2]+R*w[1]+L*w[0];const vt=v[dt];dt=ot+nt*w[2]+R*w[1]+L*w[0];const bt=v[dt];dt=ot+J*w[2]+z*w[1]+L*w[0];const Ct=v[dt];dt=ot+nt*w[2]+z*w[1]+L*w[0];const St=v[dt],Vt=vt+(bt-vt)*st,Wt=Ct+(St-Ct)*st;dt=ot+X*k[2]+M*k[1]+C*k[0],x.values[dt]=Vt+(Wt-Vt)*H}}}else for(let R=0;R<g;++R){const z=g>1?$*(h-1)+R*P:.5*($+A)*(h-1);if(z<0||z>h-1){for(let Q=0;Q<f;Q++){const J=Q+R*k[2]+M*k[1]+C*k[0];x.values[J]=c}continue}const H=Math.round(z),X=Math.round(U);for(let Q=0;Q<f;Q++){const J=Q+H*w[2]+X*w[1]+L*w[0],nt=Q+R*k[2]+M*k[1]+C*k[0];x.values[nt]=v[J]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const JJ={kernelName:Tw,backendName:"cpu",kernelFunc:ZJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ttt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,exclusive:i,reverse:a}=s;pt(r,"cumprod");const l=Ie([o],r.shape.length);let c=r;l!=null&&(c=Qn({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Pe(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=fs(c.dtype,"int32"),h=hw(Y(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(x,y)=>x+p-y-1:(x,y)=>x+y;for(let x=0;x<f.length;x+=p)for(let y=0;y<p;y++){const b=m(x,y);if(y===0)h[b]=i?1:f[b];else{const v=m(x,y-1);h[b]=i?f[v]*h[v]:f[b]*h[v]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const x=sa(l),y=Qn({inputs:{x:g},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),y}return g}const ett={kernelName:$w,backendName:"cpu",kernelFunc:ttt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ntt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,exclusive:i,reverse:a}=s;pt(r,"cumsum");const l=Ie([o],r.shape.length);let c=r;l!=null&&(c=Qn({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Pe(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=fs(c.dtype,"int32"),h=yn(Y(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(x,y)=>x+p-y-1:(x,y)=>x+y;for(let x=0;x<f.length;x+=p)for(let y=0;y<p;y++){const b=m(x,y);if(y===0)h[b]=i?0:f[b];else{const v=m(x,y-1);h[b]=i?f[v]+h[v]:f[b]+h[v]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const x=sa(l),y=Qn({inputs:{x:g},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),y}return g}const stt={kernelName:rx,backendName:"cpu",kernelFunc:ntt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rtt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:o}=t,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=LC(l,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(o),u=aM(l,c,i,a);return n.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const ott={kernelName:Nw,backendName:"cpu",kernelFunc:rtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function itt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockSize:o,dataFormat:i}=s;T(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*o,h=c*o,f=u/(o*o),p=n.data.get(r.dataId).values,m=new Float32Array(a*d*h*f);let g=0;for(let x=0;x<a;++x)for(let y=0;y<d;++y){const b=Math.floor(y/o),v=y%o;for(let w=0;w<h;++w){const k=Math.floor(w/o),C=w%o,S=(v*o+C)*f;for(let I=0;I<f;++I){const E=I+S+u*(k+c*(b+l*x));m[g++]=p[E]}}}return n.makeTensorInfo([a,d,h,f],r.dtype,m)}const att={kernelName:Ew,backendName:"cpu",kernelFunc:itt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aL(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=s;pt([r,o],"depthwiseConv2DNative");const u=yt(r.shape),d=yt(o.shape);let h=l;h==null&&(h=[1,1]),T(vn(i,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const f=dn(r.shape,o.shape,i,h,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:x,padInfo:y}=f,b=y.left,v=y.top,w=f.outChannels/f.inChannels,k=new un(f.outShape,r.dtype),C=n.data.get(r.dataId).values,S=n.data.get(o.dataId).values,I=k.values;for(let $=0;$<f.batchSize;++$){const E=$*u[0],A=$*k.strides[0];for(let L=0;L<f.outHeight;++L){const O=A+L*k.strides[1],P=L*f.strideHeight-v;for(let M=0;M<p;++M){const U=P+M*g;if(U<0||U>=f.inHeight)continue;const R=M*d[0],z=E+U*u[1];for(let H=0;H<f.outWidth;++H){const X=O+H*k.strides[2],Q=H*f.strideWidth-b;for(let J=0;J<m;++J){const nt=Q+J*x;if(nt<0||nt>=f.inWidth)continue;const st=R+J*d[1],ot=z+nt*f.inChannels;let dt=X,vt=st;for(let bt=0;bt<f.inChannels;++bt){const Ct=C[ot+bt];for(let St=0;St<w;++St)I[dt+St]+=Ct*S[vt+St];dt+=w,vt+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const ltt={kernelName:ox,backendName:"cpu",kernelFunc:aL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ctt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;pt([r,o],"depthwiseConv2dNativeBackpropFilter");const d=dn(r.shape,u,i,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,g=new un(d.filterShape,"float32"),x=d.padInfo.left,y=d.padInfo.top,b=d.outChannels/d.inChannels,v=n.data.get(r.dataId).values,w=new un(r.shape,r.dtype,v),k=n.data.get(o.dataId).values,C=new un(o.shape,o.dtype,k);for(let S=0;S<p;++S){const I=Math.max(0,Math.ceil((y-S)/h)),$=Math.min(d.outHeight,(d.inHeight+y-S)/h);for(let E=0;E<m;++E){const A=Math.max(0,Math.ceil((x-E)/f)),L=Math.min(d.outWidth,(d.inWidth+x-E)/f);for(let O=0;O<d.outChannels;++O){const P=Math.trunc(O/b),M=O%b;let U=0;for(let R=0;R<d.batchSize;++R)for(let z=I;z<$;++z){const H=S+z*h-y;for(let X=A;X<L;++X){const Q=E+X*f-x;U+=w.get(R,H,Q,P)*C.get(R,z,X,O)}}g.set(U,S,E,P,M)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const utt={kernelName:_w,backendName:"cpu",kernelFunc:ctt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dtt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;pt([r,o],"depthwiseConv2DNativeBackpropInput");const d=yt(r.shape),h=yt(o.shape),f=dn(u,o.shape,i,a,l,c,!0),p=new un(f.inShape,"float32"),m=p.values,[g,x,y]=p.strides,b=n.data.get(r.dataId).values,[v,w,k]=d,C=n.data.get(o.dataId).values,[S,I,$]=h,{batchSize:E,filterHeight:A,filterWidth:L,inChannels:O,inHeight:P,inWidth:M,outChannels:U,outHeight:R,outWidth:z,strideHeight:H,strideWidth:X}=f,Q=A-1-f.padInfo.top,J=L-1-f.padInfo.left,nt=U/O;for(let st=0;st<E;++st)for(let ot=0;ot<O;++ot)for(let dt=0;dt<P;++dt){const vt=dt-Q,bt=Math.max(0,Math.ceil(vt/H)),Ct=Math.min(R,(A+vt)/H);for(let St=0;St<M;++St){const Vt=St-J,Wt=Math.max(0,Math.ceil(Vt/X)),ae=Math.min(z,(L+Vt)/X);let Qt=0;for(let Kt=bt;Kt<Ct;++Kt){const le=Kt*H-vt;for(let ne=Wt;ne<ae;++ne){const es=ne*X-Vt,rn=v*st+w*Kt+k*ne,Yo=S*(A-1-le)+I*(L-1-es)+$*ot;for(let xs=0;xs<nt;++xs){const ua=ot*nt+xs,ir=b[rn+ua],uo=C[Yo+xs];Qt+=ir*uo}}}m[g*st+x*dt+y*St+ot]=Qt}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const htt={kernelName:Rw,backendName:"cpu",kernelFunc:dtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ftt(e){const{inputs:t,backend:n}=e,{x:s}=t,r=Y(s.shape),o=n.data.get(s.dataId).values,i=_t([r,r],s.dtype),a=i.values;for(let c=0;c<o.length;c++)a[c*r+c]=o[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const ptt={kernelName:ED,backendName:"cpu",kernelFunc:ftt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mtt={kernelName:ix,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r}=e,{strides:o,pad:i,dilations:a}=n,l=t,c=l.data.get(s.dataId).values,u=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:x,outWidth:y,padInfo:b,strideHeight:v,strideWidth:w,filterHeight:k,filterWidth:C,dilationHeight:S,dilationWidth:I,outShape:$}=uf(s.shape,r.shape,o,i,"NHWC",a),E=Y($),A=$.length,L=De(s.dtype,E);for(let P=0;P<f;++P)for(let M=0;M<x;++M){const U=M*v-b.top;for(let R=0;R<y;++R){const z=R*w-b.left;for(let H=0;H<g;++H){let X=Number.MIN_SAFE_INTEGER;for(let J=0;J<k;++J){const nt=U+J*S;if(nt>=0&&nt<p)for(let st=0;st<C;++st){const ot=z+st*I;if(ot>=0&&ot<m){const dt=Yr([P,nt,ot,H],u,yt(s.shape)),vt=Yr([J,st,H],h,yt(r.shape)),bt=c[dt]+d[vt];bt>X&&(X=bt)}}}const Q=Yr([P,M,R,H],A,yt($));L[Q]=X}}}return{dataId:l.write(yl(L,s.dtype),$,s.dtype),shape:$,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gtt={kernelName:Qb,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r,dy:o}=e,{strides:i,pad:a,dilations:l}=n,c=t,u=wr(s.shape,c.data.get(s.dataId).values),d=wr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:x,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:w,filterWidth:k,dilationHeight:C,dilationWidth:S,outShape:I}=uf(s.shape,r.shape,i,a,"NHWC",l);T(o.rank===I.length,()=>`Error in ${Qb}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const $=wr(I,c.data.get(o.dataId).values),E=ID(r.shape,r.dtype);for(let L=0;L<h;++L)for(let O=0;O<g;++O){const P=O*b-y.top;for(let M=0;M<x;++M){const U=M*v-y.left;for(let R=0;R<m;++R){let z=Number.MIN_SAFE_INTEGER,H=0,X=0;for(let Q=0;Q<w;++Q){const J=P+Q*C;if(J>=0&&J<f)for(let nt=0;nt<k;++nt){const st=U+nt*S;if(st>=0&&st<p){const ot=u[L][J][st][R]+d[Q][nt][R];ot>z&&(z=ot,H=Q,X=nt)}}}E[H][X][R]+=$[L][O][M][R]}}}return{dataId:c.write(yl(E,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xtt={kernelName:Yb,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r,dy:o}=e,{strides:i,pad:a,dilations:l}=n,c=t,u=wr(s.shape,c.data.get(s.dataId).values),d=wr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:x,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:w,filterWidth:k,dilationHeight:C,dilationWidth:S,outShape:I}=uf(s.shape,r.shape,i,a,"NHWC",l);T(o.rank===I.length,()=>`Error in ${Yb}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const $=wr(I,c.data.get(o.dataId).values),E=ID(s.shape,s.dtype);for(let L=0;L<h;++L)for(let O=0;O<g;++O){const P=O*b-y.top;for(let M=0;M<x;++M){const U=M*v-y.left;for(let R=0;R<m;++R){let z=Number.MIN_SAFE_INTEGER,H=P<0?0:P,X=U<0?0:U;for(let Q=0;Q<w;++Q){const J=P+Q*C;if(J>=0&&J<f)for(let nt=0;nt<k;++nt){const st=U+nt*S;if(st>=0&&st<p){const ot=u[L][J][st][R]+d[Q][nt][R];ot>z&&(z=ot,H=J,X=st)}}}E[L][H][X][R]+=$[L][O][M][R]}}}return{dataId:c.write(yl(E,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ytt(e){const{inputs:t,backend:n,attrs:s}=e,{image:r}=t,{canvas:o,options:i}=s,{contextOptions:a,imageOptions:l}=i||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=o.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],m=n.data.get(r.dataId).values,g=r.dtype==="float32"?255:1,x=new Uint8ClampedArray(f*h*4);for(let b=0;b<h*f;++b){const v=[0,0,0,255*c];for(let k=0;k<p;k++){const C=m[b*p+k];if(r.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(r.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);p===1?(v[0]=C*g,v[1]=C*g,v[2]=C*g):v[k]=C*g}const w=b*4;x[w+0]=Math.round(v[0]),x[w+1]=Math.round(v[1]),x[w+2]=Math.round(v[2]),x[w+3]=Math.round(v[3])}o.width=f,o.height=h;const y=new ImageData(x,f,h);return d.putImageData(y,0,0),r}const btt={kernelName:FG,backendName:"cpu",kernelFunc:ytt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $f(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s;pt(r,"sum");let a;r.dtype==="bool"?a=Xi({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=io({inputs:{x:r},backend:n});const l=a.shape.length,c=Rt(o,a.shape),u=Ie(c,l);let d=c,h=a;u!=null&&(h=Qn({inputs:{x:a},backend:n,attrs:{perm:u}}),d=Pe(d.length,l)),hn("sum",d,h.shape.length);const[f,p]=sn(h.shape,d),m=fs(h.dtype,"int32");let g=eg(n,f,m);const x=Y(p),y=n.data.get(g.dataId).values,b=n.data.get(h.dataId).values;for(let v=0;v<y.length;++v){const w=v*x;let k=0;for(let C=0;C<x;++C)k+=b[w+C];y[v]=k}if(i){const v=Fe(g.shape,c),w=g;g=ie({inputs:{x:g},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),g}const vtt={kernelName:zx,backendName:"cpu",kernelFunc:$f};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wtt(e){const{inputs:t,backend:n,attrs:s}=e,{equation:r}=s,o=t,{allDims:i,summedDims:a,idDims:l}=aC(r,o.length);cC(i.length,l,o);const{path:c,steps:u}=uC(a,l),d=u.length;let h=null,f=i.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:x,expandDims:y}=lC(f,l[g]);let b;dC(x)?b=o[g]:(b=Qn({inputs:{x:o[g]},backend:n,attrs:{perm:x}}),p.push(b));const v=b.shape.slice();for(let w=0;w<y.length;++w)v.splice(y[w],0,1);Ht(b.shape,v)||(b=ie({inputs:{x:b},backend:n,attrs:{shape:v}}),p.push(b)),h===null?h=b:(h=g0({inputs:{a:b,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=$f({inputs:{x:h},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const ktt={kernelName:Dw,backendName:"cpu",kernelFunc:wtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ctt(e){const{inputs:t,backend:n}=e,{dy:s,y:r}=t;pt([s,r],"eluGrad");const o=new Float32Array(Y(r.shape)),i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=0?o[l]=a[l]:o[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",o)}const Stt={kernelName:Aw,backendName:"cpu",kernelFunc:Ctt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Itt=tC,$tt=eC,Ttt=nC,Ntt=sC,Ett=rC,_tt=oC,Rtt=Yt(Nh,e=>{const t=Math.sign(e),n=Math.abs(e),s=1/(1+Itt*n);return t*(1-((((_tt*s+Ett)*s+Ntt)*s+Ttt)*s+$tt)*s*Math.exp(-n*n))}),Dtt={kernelName:Nh,backendName:"cpu",kernelFunc:Rtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rg(e){const{inputs:t,backend:n,attrs:s}=e,{input:r}=t,{dim:o}=s,i=r.shape.length,a=r.shape.slice();let l=o;return o<0&&(T(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),ie({inputs:{x:r},backend:n,attrs:{shape:a}})}const Att={kernelName:lx,backendName:"cpu",kernelFunc:rg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ott=Le((e,t)=>e/t),jC=qe($h,Ott),S1={kernelName:$h,backendName:"cpu",kernelFunc:jC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lL(e,t,n){const s=e.shape,r=s[0],o=s[1],i=n.data.get(e.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[r,o],u=Y(c),d=xn("float32",u),h=xn("float32",u);for(let g=0;g<r;g++){const x=ul({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,o]}}),y=ul({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,o]}}),b=os({inputs:{real:x,imag:y},backend:n}),{real:v,imag:w}=Ftt(b,t,n),k=zo(v,w);for(let C=0;C<o;C++){const S=iC(k,C);d[g*o+C]=S.real,h[g*o+C]=S.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),m=os({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function Ftt(e,t,n){const s=Y(e.shape),r=n.data.get(e.dataId),o=n.data.get(r.complexTensorInfos.real.dataId).values,i=n.data.get(r.complexTensorInfos.imag.dataId).values;if(Ptt(s)){const a=I1(o,i,s,t,n),l=[e.shape[0],e.shape[1]];if(t){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",ea(s,"float32")),h=io({inputs:{x:d},backend:n}),f=S1.kernelFunc({inputs:{a:c,b:d},backend:n}),p=S1.kernelFunc({inputs:{a:u,b:h},backend:n}),m=n.data.get(f.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return a}else{const a=zo(o,i),l=Mtt(a,s,t);return kO(l)}}function Ptt(e){return(e&e-1)===0}function I1(e,t,n,s,r){if(n===1)return{real:e,imag:t};const o=zo(e,t),i=n/2,a=CO(o),l=a.real,c=a.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),h=r.makeTensorInfo(u,"float32",c),f=os({inputs:{real:d,imag:h},backend:r}),p=SO(o),m=p.real,g=p.imag,x=[m.length],y=r.makeTensorInfo(x,"float32",m),b=r.makeTensorInfo(x,"float32",g),v=os({inputs:{real:y,imag:b},backend:r}),w=I1(l,c,i,s,r),k=w.real,C=w.imag,S=[k.length],I=r.makeTensorInfo(S,"float32",k),$=r.makeTensorInfo(S,"float32",C),E=os({inputs:{real:I,imag:$},backend:r}),A=I1(m,g,i,s,r),L=A.real,O=A.imag,P=[L.length],M=r.makeTensorInfo(P,"float32",L),U=r.makeTensorInfo(P,"float32",O),R=os({inputs:{real:M,imag:U},backend:r}),z=$O(n,s),H=[z.real.length],X=r.makeTensorInfo(H,"float32",z.real),Q=r.makeTensorInfo(H,"float32",z.imag),J=os({inputs:{real:X,imag:Q},backend:r}),nt=g0({inputs:{a:J,b:R},backend:r}),st=Mc({inputs:{a:E,b:nt},backend:r}),ot=WC({inputs:{a:E,b:nt},backend:r}),dt=cl({inputs:{input:st},backend:r}),vt=cl({inputs:{input:ot},backend:r}),bt=Lc({inputs:{input:st},backend:r}),Ct=Lc({inputs:{input:ot},backend:r}),St=zc({inputs:[dt,vt],backend:r,attrs:{axis:0}}),Vt=zc({inputs:[bt,Ct],backend:r,attrs:{axis:0}}),Wt=r.data.get(St.dataId).values,ae=r.data.get(Vt.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(X),r.disposeIntermediateTensorInfo(Q),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(nt),r.disposeIntermediateTensorInfo(st),r.disposeIntermediateTensorInfo(ot),r.disposeIntermediateTensorInfo(dt),r.disposeIntermediateTensorInfo(bt),r.disposeIntermediateTensorInfo(vt),r.disposeIntermediateTensorInfo(Ct),r.disposeIntermediateTensorInfo(St),r.disposeIntermediateTensorInfo(Vt),{real:Wt,imag:ae}}function Mtt(e,t,n){const s=new Float32Array(t*2);for(let r=0;r<t;r++){let o=0,i=0;for(let a=0;a<t;a++){const l=TO(r*a,t,n),c=iC(e,a);o+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}n&&(o/=t,i/=t),IO(s,o,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ltt(e){const{inputs:t,backend:n}=e,{input:s}=t,r=Y(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=ie({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=lL(a,!1,n),c=ie({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const ztt={kernelName:Ow,backendName:"cpu",kernelFunc:Ltt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GC(e){const{backend:t,attrs:n}=e,{shape:s,value:r,dtype:o}=n,i=o||Jc(r),a=De(i,Y(s));return Vtt(a,r,i),t.makeTensorInfo(s,i,a)}const Btt={kernelName:Fw,backendName:"cpu",kernelFunc:GC};function Vtt(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wtt={kernelName:Pw,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,r=n,o=xn(s.dtype,Y(s.shape)),[i,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let h=0;h<i;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let g=0;g<l;g++){const x=g*c;for(let y=0;y<c;y++){const b=Math.round(l-g-1),v=f+m+x+y;let w=u[v];if(b>=0&&b<l){const k=b*c,C=f+m+k+y;w=u[C]}o[v]=w}}}}return{dataId:r.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Utt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o,bias:i,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=iL({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const g=m;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const x=ie({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=Mc({inputs:{a:m,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else m=Mc({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(g)}if(f){const g=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=ie({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=sg(n,m,f,x,p),n.disposeIntermediateTensorInfo(x)}else m=sg(n,m,f,a,p);n.disposeIntermediateTensorInfo(g)}return m}const jtt={kernelName:Mm,backendName:"cpu",kernelFunc:Utt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gtt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o,bias:i,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=aL({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const g=m;m=Mc({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(g)}if(f){const g=m;m=sg(n,m,f,a,p),n.disposeIntermediateTensorInfo(g)}return m}const Htt={kernelName:XD,backendName:"cpu",kernelFunc:Gtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ktt(e){const{inputs:t,backend:n}=e,{params:s,indices:r}=t,o=Y(s.shape),i=r.shape,a=i[i.length-1],[l,c,u,d]=Uk(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,f=n.bufferSync(s),p=yM(h,f,s.dtype,c,a,u,d,s.shape,o);return n.makeTensorInfo(l,s.dtype,p.values)}const Xtt={kernelName:_D,backendName:"cpu",kernelFunc:Ktt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qtt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,indices:o}=t,{axis:i,batchDims:a}=s;pt([r,o],"gatherV2");const l=Rt(i,r.shape)[0],c=n.data.get(o.dataId).values,u=r.shape[l];for(let v=0;v<c.length;++v){const w=c[v];T(w<=u-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=Y(o.shape),f=fC(r,o,l,d),p=ie({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=ie({inputs:{x:o},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),g=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],x=n.bufferSync(m),y=n.bufferSync(p),b=bM(y,x,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const Ytt={kernelName:ux,backendName:"cpu",kernelFunc:qtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qtt(e){const{inputs:t,backend:n}=e,{input:s}=t,r=Y(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=ie({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=lL(a,!0,n),c=ie({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Ztt={kernelName:Mw,backendName:"cpu",kernelFunc:Qtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jtt=Yt(Fh,e=>Number.isFinite(e)?1:0,"bool"),tet={kernelName:Fh,backendName:"cpu",kernelFunc:Jtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eet=Yt(Ph,e=>Math.abs(e)===1/0?1:0,"bool"),net={kernelName:Ph,backendName:"cpu",kernelFunc:eet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const set=Yt(Mh,e=>Number.isNaN(e)?1:0,"bool"),ret={kernelName:Mh,backendName:"cpu",kernelFunc:set};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oet(e){const{backend:t,attrs:n}=e,{start:s,stop:r,num:o}=n,i=SM(s,r,o);return t.makeTensorInfo([i.length],"float32",i)}const iet={kernelName:RD,backendName:"cpu",kernelFunc:oet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aet=Yt(zh,e=>Math.log1p(e)),cet={kernelName:zh,backendName:"cpu",kernelFunc:aet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uet=Le((e,t)=>e&&t),det=qe(mx,uet,null,"bool"),het={kernelName:mx,backendName:"cpu",kernelFunc:det};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fet=Yt(gx,e=>e?0:1,"bool"),pet={kernelName:gx,backendName:"cpu",kernelFunc:fet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const met=Le((e,t)=>e||t),get=qe(xx,met,null,"bool"),xet={kernelName:xx,backendName:"cpu",kernelFunc:get};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yet(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{depthRadius:o,bias:i,alpha:a,beta:l}=s;pt(r,"LRN");const c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,h=Y(r.shape),f=new Float32Array(h);function p(m){const g=m%c;let x=m-g+Math.max(0,g-o);const y=m-g+Math.min(g+o,u);let b=0;for(;x<=y;x++){const v=d[x];b+=v*v}return b}for(let m=0;m<h;m++){const g=p(m),x=d[m]*Math.pow(i+a*g,-l);f[m]=x}return n.makeTensorInfo(r.shape,r.dtype,f)}const bet={kernelName:yx,backendName:"cpu",kernelFunc:yet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vet(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,y:o,dy:i}=t,{depthRadius:a,bias:l,alpha:c,beta:u}=s;pt(i,"LRNGrad");const d=Y(i.shape),h=i.shape[3],f=n.data.get(i.dataId).values,p=n.data.get(r.dataId).values,m=n.data.get(o.dataId).values,g=new Float32Array(d),x=d;for(let y=0;y<x;y++){const b=y%h,v=y-b+Math.max(0,b-a),w=y-b+Math.min(h,b+a+1);let k=0;for(let C=v;C<w;C++)k+=Math.pow(p[C],2);k=c*k+l;for(let C=v;C<w;C++){let S=-2*c*u*p[C]*m[y]/k;y===C&&(S+=Math.pow(k,-u)),S*=f[y],g[C]+=S}}return n.makeTensorInfo(i.shape,r.dtype,g)}const wet={kernelName:zw,backendName:"cpu",kernelFunc:vet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cL(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reductionIndices:o,keepDims:i}=s,a=n;let l=r.shape;const c=l.length,u=Rt(o,l);let d=u;const h=Ie(d,c);let f=a.data.get(r.dataId).values;if(h!=null){const v=new Array(c);for(let w=0;w<v.length;w++)v[w]=l[h[w]];f=BC(f,l,r.dtype,h,v),d=Pe(d.length,c),l=v}pt(r,"max"),hn("max",d,c);const[p,m]=sn(l,d),g=Y(m),x=$M(f,g,p,r.dtype),y=a.write(x,p,r.dtype);let b=p;return i&&(b=Fe(p,u)),{dataId:y,shape:b,dtype:r.dtype}}const ket={kernelName:bx,backendName:"cpu",kernelFunc:cL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cet(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;pt(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(vn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=sr(r.shape,o,i,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Ht(u.inShape,u.outShape))d=io({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=yt(r.shape),p=UC(h,r.shape,r.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const Iet={kernelName:vx,backendName:"cpu",kernelFunc:Cet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $et(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s;pt(r,"maxPool3d");const u=Uo(r.shape,o,i,1,a,l,c),d=n.data.get(r.dataId).values,h=oL(d,r.shape,r.dtype,yt(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const Tet={kernelName:wx,backendName:"cpu",kernelFunc:$et};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Net(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=s;pt([r,o],"maxPool3DGrad");const u=Uo(o.shape,i,a,1,l,c),d=n.bufferSync(o),h=pJ(d,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,x=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,v=u.effectiveFilterHeight,w=u.effectiveFilterWidth,k=b-1-u.padInfo.front,C=w-1-u.padInfo.left,S=v-1-u.padInfo.top,I=_t(o.shape,"float32"),$=n.bufferSync(r);for(let E=0;E<u.batchSize;++E)for(let A=0;A<u.inChannels;++A)for(let L=0;L<u.inDepth;++L)for(let O=0;O<u.inHeight;++O)for(let P=0;P<u.inWidth;++P){const M=L-k,U=O-S,R=P-C;let z=0;for(let H=0;H<b;H+=g){const X=(M+H)/f;if(!(X<0||X>=u.outDepth||Math.floor(X)!==X))for(let Q=0;Q<v;Q+=x){const J=(U+Q)/p;if(!(J<0||J>=u.outHeight||Math.floor(J)!==J))for(let nt=0;nt<w;nt+=y){const st=(R+nt)/m;if(st<0||st>=u.outWidth||Math.floor(st)!==st)continue;const ot=b*v*w-1-h.get(E,X,J,st,A),dt=H*v*w+Q*w+nt,vt=ot===dt?1:0;if(vt===0)continue;const bt=$.get(E,X,J,st,A);z+=bt*vt}}}I.set(z,E,L,O,P,A)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Eet={kernelName:Vw,backendName:"cpu",kernelFunc:Net};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _et(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o,output:i}=t,a=o;pt([o,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=sr(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,p=_t(h.outShape,a.dtype,rL(f,a.shape,a.dtype,h).values),m=h.strideHeight,g=h.strideWidth,x=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterHeight,v=h.effectiveFilterWidth,w=v-1-h.padInfo.left,k=b-1-h.padInfo.top,C=_t(a.shape,"float32"),S=n.data.get(r.dataId).values,I=_t(r.shape,"float32",S);for(let $=0;$<h.batchSize;++$)for(let E=0;E<h.inChannels;++E)for(let A=0;A<h.inHeight;++A)for(let L=0;L<h.inWidth;++L){const O=A-k,P=L-w;let M=0;for(let U=0;U<b;U+=x){const R=(O+U)/m;if(!(R<0||R>=h.outHeight||Math.floor(R)!==R))for(let z=0;z<v;z+=y){const H=(P+z)/g;if(H<0||H>=h.outWidth||Math.floor(H)!==H)continue;const X=b*v-1-p.get($,R,H,E),Q=U*v+z,J=X===Q?1:0;if(J===0)continue;const nt=I.get($,R,H,E);M+=nt*J}}C.set(M,$,A,L,E)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Ret={kernelName:Bw,backendName:"cpu",kernelFunc:_et};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Det(e,t,n,s,r){const o=yt(t),i=UC(e,t,n,o,r,"max"),a=rL(e,t,n,r,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aet={kernelName:DD,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:s}=e,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=t,l=n;pt(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=sr(s.shape,r,o,[1,1],i),[d,h]=Det(c,s.shape,s.dtype,a,u),f=l.write(d,u.outShape,s.dtype),p=l.write(h,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oet(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s,a=Rt(o,r.shape),c=sn(r.shape,a)[1],u=Y(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=Xi({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=jC({inputs:{a:f,b:h},backend:n});d.push(p);const m=$f({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:i}});return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const Fet={kernelName:kx,backendName:"cpu",kernelFunc:Oet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pet(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s;pt(r,"min");const a=Rt(o,r.shape);let l=a;const c=Ie(l,r.shape.length);let u=r;c!=null&&(u=Qn({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Pe(l.length,r.shape.length)),hn("min",l,u.shape.length);const[d,h]=sn(u.shape,l),f=Y(h),p=yn(Y(d),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=m[y];for(let v=0;v<f;++v){const w=m[y+v];(Number.isNaN(w)||w<b)&&(b=w)}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(i){const x=Fe(d,a),y=ie({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),y}return g}const Met={kernelName:Cx,backendName:"cpu",kernelFunc:Pet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Let(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:o,mode:i}=s;pt(r,"mirrorPad");const a=o.map((b,v)=>b[0]+r.shape[v]+b[1]),l=o.map(b=>b[0]),c=o.map((b,v)=>b[0]+r.shape[v]),u=i==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,f=yt(r.shape),p=Y(a),m=a.length,g=yt(a),x=xn(r.dtype,p);for(let b=0;b<p;b++){let v=tu(b,m,g);for(let k=0;k<m;k++)v[k]<l[k]?v[k]=l[k]*2-v[k]-u:v[k]>=c[k]&&(v[k]=(c[k]-1)*2-v[k]+u);v=v.map((k,C)=>k-l[C]);const w=Yr(v,h,f);x[b]=d[w]}return{dataId:n.write(x,a,r.dtype),shape:a,dtype:r.dtype}}const zet={kernelName:Sx,backendName:"cpu",kernelFunc:Let};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bet=Le((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),Vet=qe(Wh,Bet),Wet={kernelName:Wh,backendName:"cpu",kernelFunc:Vet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uL(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{dim:o}=s,i=r.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=Rt([a],r.shape),c=cL({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Fe(c.shape,l),d=ie({inputs:{x:c},backend:n,attrs:{shape:u}}),h=WC({inputs:{a:r,b:d},backend:n}),f=pM({inputs:{x:h},backend:n}),p=$f({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=ie({inputs:{x:p},backend:n,attrs:{shape:u}}),g=jC({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const Uet={kernelName:Wx,backendName:"cpu",kernelFunc:uL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jet(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{numSamples:o,seed:i,normalized:a}=s;pt(r,"multinomial");const l=a?r:uL({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,o],f=yn(Y(h),"int32");for(let p=0;p<c;++p){const m=p*u,g=new Float32Array(u-1);g[0]=d[m];for(let b=1;b<g.length;++b)g[b]=g[b-1]+d[m+b];const x=Ek.alea(i.toString()),y=p*o;for(let b=0;b<o;++b){const v=x();f[y+b]=g.length;for(let w=0;w<g.length;w++)if(v<g[w]){f[y+b]=w;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const Get={kernelName:AD,backendName:"cpu",kernelFunc:jet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Het=Lk;function Ket(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s;pt(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,{selectedIndices:d}=Het(c,u,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Xet={kernelName:Ww,backendName:"cpu",kernelFunc:Ket};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qet=zk;function Yet(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;pt(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,{selectedIndices:h,validOutputs:f}=qet(u,d,i,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const Qet={kernelName:Uw,backendName:"cpu",kernelFunc:Yet};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zet=Bk;function Jet(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;pt(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,h=i,f=a,p=l,m=c,{selectedIndices:g,selectedScores:x}=Zet(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const tnt={kernelName:jw,backendName:"cpu",kernelFunc:Jet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ent(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r}=t,{dtype:o,depth:i,onValue:a,offValue:l}=s;pt(r,"oneHot");const c=Y(r.shape),u=new Float32Array(c*i);u.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<i&&(u[h*i+d[h]]=a);return n.makeTensorInfo([...r.shape,i],o,u)}const nnt={kernelName:Nx,backendName:"cpu",kernelFunc:ent};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function og(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=cl({inputs:{input:s},backend:n}),o=og({inputs:{x:r},backend:n}),i=Lc({inputs:{input:s},backend:n}),a=og({inputs:{x:i},backend:n}),l=os({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return GC({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const snt={kernelName:Gx,backendName:"cpu",kernelFunc:og};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dL(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=cl({inputs:{input:s},backend:n}),o=dL({inputs:{x:r},backend:n}),i=Lc({inputs:{input:s},backend:n}),a=og({inputs:{x:i},backend:n}),l=os({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return GC({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const rnt={kernelName:Tx,backendName:"cpu",kernelFunc:dL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hL(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s;if(t.length===1)return rg({inputs:{input:t[0]},backend:n,attrs:{dim:r}});const o=t[0].shape,i=t[0].dtype;t.forEach(u=>{nr(o,u.shape,"All tensors passed to stack must have matching shapes"),T(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=t.map(u=>{const d=rg({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=zc({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const ont={kernelName:Ex,backendName:"cpu",kernelFunc:hL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function int(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:o,constantValue:i}=s;pt(r,"pad");const a=o.map((y,b)=>y[0]+r.shape[b]+y[1]),l=o.map(y=>y[0]),c=n.data.get(r.dataId).values,u=Y(r.shape),d=r.shape.length,h=yt(r.shape),f=Y(a),p=a.length,m=yt(a),g=xn(r.dtype,f);i!==0&&g.fill(i);for(let y=0;y<u;y++){const v=tu(y,d,h).map((k,C)=>k+l[C]),w=Yr(v,p,m);g[w]=c[y]}return{dataId:n.write(g,a,r.dtype),shape:a,dtype:r.dtype}}const fL={kernelName:_x,backendName:"cpu",kernelFunc:int};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ant=Le((e,t)=>Math.pow(e,t)),lnt=qe(jh,ant),cnt={kernelName:jh,backendName:"cpu",kernelFunc:lnt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function unt(e){const{inputs:t,backend:n,attrs:s}=e,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=t,a=r.map(g=>n.data.get(g.dataId).values),l=r.map(g=>g.shape),c=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values,[d,h,f]=DM(a,l,c,o.shape,o.dtype,u,i.shape),p=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(f,o.dtype,h);return p.concat([m])}const dnt={kernelName:OD,backendName:"cpu",kernelFunc:unt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hnt(e){const{inputs:t,backend:n}=e,{starts:s,limits:r,deltas:o}=t,i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=AM(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const fnt={kernelName:FD,backendName:"cpu",kernelFunc:hnt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pnt(e){const{inputs:t,backend:n,attrs:s}=e,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,d=n.data.get(i.dataId).values,h=a.map(g=>n.data.get(g.dataId).values),f=a.map(g=>g.shape),[p,m]=OM(c,r.shape,u,o.shape,o.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(p,o.dtype,m)}const mnt={kernelName:PD,backendName:"cpu",kernelFunc:pnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gnt(e){const{backend:t,attrs:n}=e,{start:s,stop:r,dtype:o,step:i}=n,a=FM(s,r,i,o);return t.makeTensorInfo([a.length],o,a)}const xnt={kernelName:Gw,backendName:"cpu",kernelFunc:gnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ynt=Yt(Gh,e=>1/e),bnt={kernelName:Gh,backendName:"cpu",kernelFunc:ynt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vnt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:o,halfPixelCenters:i,size:a}=s;pt(r,"resizeBilinear");const l=yt(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(Y([d,c,u,p])),x=[o&&c>1?h-1:h,o&&u>1?f-1:f],y=[o&&c>1?c-1:c,o&&u>1?u-1:u];let b=0;const v=x[0]/y[0],w=x[1]/y[1];for(let k=0;k<d;k++)for(let C=0;C<c;C++){let S;i?S=v*(C+.5)-.5:S=v*C;const I=Math.max(0,Math.floor(S)),$=S-I,E=Math.min(h-1,Math.ceil(S)),A=k*l[0]+I*l[1],L=k*l[0]+E*l[1];for(let O=0;O<u;O++){let P;i?P=w*(O+.5)-.5:P=w*O;const M=Math.max(0,Math.floor(P)),U=P-M,R=Math.min(f-1,Math.ceil(P)),z=A+M*l[2],H=L+M*l[2],X=A+R*l[2],Q=L+R*l[2];for(let J=0;J<p;J++){const nt=m[z+J],st=m[H+J],ot=m[X+J],dt=m[Q+J],vt=nt+(ot-nt)*U,bt=st+(dt-st)*U,Ct=vt+(bt-vt)*$;g[b++]=Ct}}}return n.makeTensorInfo([d,c,u,p],"float32",g)}const wnt={kernelName:Fx,backendName:"cpu",kernelFunc:vnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function knt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:o}=t,{alignCorners:i}=s;pt([o,r],"resizeBilinearGrad");const a=yt(r.shape),[l,c,u,d]=r.shape,[,h,f]=o.shape,p=new Float32Array(l*c*u*d),m=[i&&h>1?c-1:c,i&&f>1?u-1:u],g=[i&&h>1?h-1:h,i&&f>1?f-1:f],x=m[0]/g[0],y=m[1]/g[1],b=n.data.get(o.dataId).values;let v=0;for(let w=0;w<l;w++){const k=w*a[0];for(let C=0;C<h;C++){const S=C*x,I=Math.floor(S),$=Math.min(Math.ceil(S),c-1),E=k+I*a[1],A=k+$*a[1],L=S-I,O=1-L;for(let P=0;P<f;P++){const M=P*y,U=Math.floor(M),R=Math.min(Math.ceil(M),u-1),z=M-U,H=1-z,X=E+U*a[2],Q=E+R*a[2],J=A+U*a[2],nt=A+R*a[2],st=O*H,ot=O*z,dt=L*H,vt=L*z;for(let bt=0;bt<d;bt++){const Ct=b[v++];p[X+bt]+=Ct*st,p[Q+bt]+=Ct*ot,p[J+bt]+=Ct*dt,p[nt+bt]+=Ct*vt}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const Cnt={kernelName:Xw,backendName:"cpu",kernelFunc:knt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Snt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:o,halfPixelCenters:i,size:a}=s;pt(r,"resizeNearestNeighbor");const l=yt(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(d*c*u*p),x=[o&&c>1?h-1:h,o&&u>1?f-1:f],y=[o&&c>1?c-1:c,o&&u>1?u-1:u],b=x[0]/y[0],v=x[1]/y[1];let w=0;for(let k=0;k<d;k++){const C=k*l[0];for(let S=0;S<c;S++){const I=i?b*(S+.5):b*S;let $=Math.min(h-1,o?Math.round(I):Math.floor(I));i&&($=Math.max(0,$));const E=C+$*l[1];for(let A=0;A<u;A++){const L=i?v*(A+.5):v*A;let O=Math.min(f-1,o?Math.round(L):Math.floor(L));i&&(O=Math.max(0,O));const P=E+O*l[2];for(let M=0;M<p;M++){const U=m[P+M];g[w++]=U}}}}return n.makeTensorInfo([d,c,u,p],r.dtype,g)}const Int={kernelName:Ox,backendName:"cpu",kernelFunc:Snt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $nt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:o}=t,{alignCorners:i}=s;pt([o,r],"resizeNearestNeighborGrad");const a=yt(r.shape),l=yt(o.shape),[c,u,d,h]=r.shape,[,f,p]=o.shape,m=new Float32Array(c*u*d*h),g=n.data.get(o.dataId).values,x=[i&&f>1?u-1:u,i&&p>1?d-1:d],y=[i&&f>1?f-1:f,i&&p>1?p-1:p],b=x[0]/y[0],v=x[1]/y[1],w=1/b,k=1/v,C=Math.ceil(w)*2+2,S=Math.ceil(k)*2+2;for(let I=0;I<c;I++){const $=I*a[0];for(let E=0;E<u;E++){const A=$+E*a[1],L=Math.floor(E*w),O=Math.floor(L-C/2);for(let P=0;P<d;P++){const M=A+P*a[2],U=Math.floor(P*k),R=Math.floor(U-S/2);for(let z=0;z<h;z++){let H=0;for(let X=0;X<C;X++){const Q=X+O;if(Q<0||Q>=f)continue;const J=$+Q*l[1],nt=Q*b,st=Math.min(u-1,i?Math.round(nt):Math.floor(nt));if(E===st)for(let ot=0;ot<S;ot++){const dt=ot+R;if(dt<0||dt>=p)continue;const vt=J+dt*l[2],bt=dt*v,Ct=Math.min(d-1,i?Math.round(bt):Math.floor(bt));P===Ct&&(H+=g[vt+z])}}m[M+z]=H}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}const Tnt={kernelName:Kw,backendName:"cpu",kernelFunc:$nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nnt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dims:o}=s;pt(r,"reverse");const i=r.shape.length,a=Rt(o,r.shape);if(i===0)return io({inputs:{x:r},backend:n});const l=new un(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=r.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Ent={kernelName:Px,backendName:"cpu",kernelFunc:Nnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _nt={kernelName:ek,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,{radians:r,fillValue:o,center:i}=t,a=n,l=xn(s.dtype,Y(s.shape)),[c,u,d,h]=s.shape,[f,p]=Qk(i,u,d),m=255,g=Math.sin(r),x=Math.cos(r),y=a.data.get(s.dataId).values;for(let v=0;v<c;v++){const w=v*d*u*h;for(let k=0;k<u;k++){const C=k*(d*h);for(let S=0;S<d;S++){const I=S*h;for(let $=0;$<h;$++){const E=[c,k,S,$],A=E[2],L=E[1];let O=(A-f)*x-(L-p)*g,P=(A-f)*g+(L-p)*x;O=Math.round(O+f),P=Math.round(P+p);let M=o;if(typeof o!="number"&&($===3?M=m:M=o[$]),O>=0&&O<d&&P>=0&&P<u){const R=P*(d*h),z=O*h,H=w+R+z+$;M=y[H]}const U=w+C+I+$;l[U]=M}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rnt=Yt(Xh,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),Dnt={kernelName:Xh,backendName:"cpu",kernelFunc:Rnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ant(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r,updates:o}=t,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=wl(o,r,i),h=!0,f=n.bufferSync(r),p=n.bufferSync(o),m=Ra(f,p,i,d,c,l,a,u,0,h);return n.makeTensorInfo(i,m.dtype,m.values)}const Ont={kernelName:MD,backendName:"cpu",kernelFunc:Ant};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fnt(e,t){let n=0,s=e.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),e[r]<t?n=r+1:s=r;return s}function Pnt(e,t){let n=0,s=e.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),e[r]<=t?n=r+1:s=r;return s}function Mnt(e,t,n,s,r,o){const i=De("int32",n*r);for(let a=0;a<n;++a){const l=e.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)i[c+u]=o==="left"?Fnt(l,t[u+c]):Pnt(l,t[u+c])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lnt(e){const{inputs:t,backend:n,attrs:s}=e,{sortedSequence:r,values:o}=t,{side:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,c=Mnt(a,l,r.shape[0],r.shape[1],o.shape[1],i);return n.makeTensorInfo(o.shape,"int32",c)}const znt={kernelName:zD,backendName:"cpu",kernelFunc:Lnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bnt(e){const{inputs:t,backend:n}=e,{condition:s,t:r,e:o}=t;pt([s,r,o],"select");const i=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=fs(r.dtype,o.dtype),d=yn(Y(r.shape),u);let h=0;const f=i===0||i>1||r.shape.length===1?1:Y(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(r.shape,u,d)}const Vnt={kernelName:Mx,backendName:"cpu",kernelFunc:Bnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wnt=s0,Unt=r0,jnt=Yt(Yh,e=>e>=0?Unt*e:Wnt*(Math.exp(e)-1)),Gnt={kernelName:Yh,backendName:"cpu",kernelFunc:jnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hnt=Yt(Jh,e=>e<0?-1:e>0?1:0),Knt={kernelName:Jh,backendName:"cpu",kernelFunc:Hnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xnt=Yt(Qh,e=>Math.sin(e)),qnt={kernelName:Qh,backendName:"cpu",kernelFunc:Xnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ynt=Yt(Zh,e=>Math.sinh(e)),Qnt={kernelName:Zh,backendName:"cpu",kernelFunc:Ynt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Znt=11920928955078125e-23,g$=Math.log(Znt)+2,Jnt=Yt(ef,e=>{const t=e>-g$,n=e<g$,s=Math.exp(e);let r;return n?r=s:t?r=e:r=Math.log(1+s),r}),tst={kernelName:ef,backendName:"cpu",kernelFunc:Jnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function est(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:o,paddings:i}=s;pt([r],"spaceToBatchND");const a=Y(o),l=[[0,0]];l.push(...i);for(let k=1+o.length;k<r.shape.length;++k)l.push([0,0]);const c=fL.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=mf(c.shape,o,a,!1),d=gf(u.length,o.length,!1),h=xf(c.shape,o,a,!1),m=ie({inputs:{x:c},backend:n,attrs:{shape:u}}),y=Qn({inputs:{x:m},backend:n,attrs:{perm:d}}),w=ie({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),w}const nst={kernelName:Bx,backendName:"cpu",kernelFunc:est};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sst(e){const{inputs:t,backend:n}=e,{indices:s,values:r,denseShape:o,defaultValue:i}=t;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values[0],[d,h,f,p,m]=zM(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const rst={kernelName:BD,backendName:"cpu",kernelFunc:sst};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ost(e){const{inputs:t,backend:n}=e,{inputIndices:s,inputShape:r,newShape:o}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(o.dataId).values),[c,u,d]=BM(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const ist={kernelName:VD,backendName:"cpu",kernelFunc:ost};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ast(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:o}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=VC(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const lst={kernelName:WD,backendName:"cpu",kernelFunc:ast};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cst(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:o}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=VC(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const ust={kernelName:UD,backendName:"cpu",kernelFunc:cst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dst(e){const{inputs:t,backend:n,attrs:s}=e,{sparseIndices:r,sparseValues:o,defaultValue:i}=t,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=wl(o,r,a),f=!1,p=n.bufferSync(r);let m;switch(o.dtype){case"bool":{const g=n.bufferSync(o),x=!!n.data.get(i.dataId).values[0];m=Ra(p,g,a,h,u,c,l,d,x,f);break}case"float32":{const g=n.bufferSync(o),x=n.data.get(i.dataId).values[0];m=Ra(p,g,a,h,u,c,l,d,x,f);break}case"int32":{const g=n.bufferSync(o),x=n.data.get(i.dataId).values[0];m=Ra(p,g,a,h,u,c,l,d,x,f);break}case"string":{const g=n.bufferSync(o),x=Ui(n.data.get(i.dataId).values[0]);m=Ra(p,g,a,h,u,c,l,d,x,f);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const hst={kernelName:jD,backendName:"cpu",kernelFunc:dst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fst(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{numOrSizeSplits:o,axis:i}=s,a=Rt(i,r.shape)[0],l=hC(r,o,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=ul({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const pst={kernelName:Vx,backendName:"cpu",kernelFunc:fst};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mst={kernelName:qw,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,s=t;pt(n,"square");const r=s.data.get(n.dataId).values,o=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];o[a]=l*l}return{dataId:s.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gst=Yt(cf,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),xst={kernelName:cf,backendName:"cpu",kernelFunc:gst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yst(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:o,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s;pt(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:x,begin:y,end:b,strides:v}=Xk(r.shape,o,i,a,l,c,u,d,h);let w;if(m)w=ie({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||x){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const k=Gk(y,b,v),C=ul({inputs:{x:r},backend:n,attrs:{begin:y,size:k}});w=ie({inputs:{x:C},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(C)}else{const k=n.bufferSync(r),C=UM(f,k,v,y);w=n.makeTensorInfo(p,C.dtype,C.values)}return w}const bst={kernelName:Qw,backendName:"cpu",kernelFunc:yst};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vst(e){const{inputs:t,backend:n,attrs:s}=e,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=t,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,m]=jM(h,f,r,o,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const wst={kernelName:GD,backendName:"cpu",kernelFunc:vst};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kst(e){const{inputs:t,backend:n,attrs:s}=e,{skipEmpty:r}=s,{input:o,delimiter:i}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,d]=GM(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Cst={kernelName:HD,backendName:"cpu",kernelFunc:kst};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sst(e){const{inputs:t,backend:n,attrs:s}=e,{numBuckets:r}=s,{input:o}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(o.dataId).values,a=HM(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const Ist={kernelName:KD,backendName:"cpu",kernelFunc:Sst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $st=Yt(of,e=>Math.tan(e)),Tst={kernelName:of,backendName:"cpu",kernelFunc:$st};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nst=Yt(af,e=>Math.tanh(e)),Est={kernelName:af,backendName:"cpu",kernelFunc:Nst};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _st(e){const{inputs:t,backend:n}=e,{tensor:s,indices:r,updates:o}=t,{sliceRank:i,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=wl(o,r,s.shape),d=!1,h=n.bufferSync(r),f=n.bufferSync(o),p=n.bufferSync(s),m=Ra(h,f,s.shape,u,l,a,i,c,p,d);return n.makeTensorInfo(s.shape,m.dtype,m.values)}const Rst={kernelName:LD,backendName:"cpu",kernelFunc:_st};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dst(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reps:o}=s;pt(r,"tile");const i=XM(n.bufferSync(r),o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Ast={kernelName:lf,backendName:"cpu",kernelFunc:Dst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ost(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{k:o,sorted:i}=s;pt(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=YM(a,r.shape,r.dtype,o,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const Fst={kernelName:Zw,backendName:"cpu",kernelFunc:Ost};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pst(e){const{inputs:t,attrs:n,backend:s}=e,{image:r,transforms:o}=t,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=r.shape,[p,m]=c??[d,h],g=[u,p,m,f],x=yt(r.shape),y=x[0],b=x[1],v=x[2],w=yt(g),k=w[0],C=w[1],S=w[2],I=xn(r.dtype,Y(g));I.fill(l);const $=s.data.get(r.dataId).values,E=s.data.get(o.dataId).values;for(let L=0;L<u;++L){const O=o.shape[0]===1?E:E.subarray(L*8,L*8+8);for(let P=0;P<p;++P)for(let M=0;M<m;++M)for(let U=0;U<f;++U){let R;const z=O[6]*M+O[7]*P+1;if(z===0)continue;const H=(O[0]*M+O[1]*P+O[2])/z,X=(O[3]*M+O[4]*P+O[5])/z,Q=x$(H,h,a),J=x$(X,d,a);switch(i){case"nearest":R=Wst($,d,h,y,b,v,L,J,Q,U,l);break;case"bilinear":R=Ust($,d,h,y,b,v,L,J,Q,U,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const nt=L*k+P*C+M*S+U;I[nt]=R}return s.makeTensorInfo(g,r.dtype,I)}return{dataId:s.write(I,g,r.dtype),shape:r.shape,dtype:r.dtype}}const Mst={kernelName:Jw,backendName:"cpu",kernelFunc:Pst};function x$(e,t,n){switch(n){case"reflect":return Lst(e,t);case"wrap":return zst(e,t);case"nearest":return Vst(e,t);case"constant":default:return Bst(e)}}function Lst(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const s=2*t;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-t?n+s:-n-1}else if(n>t-1)if(t<=1)n=0;else{const s=2*t;n-=s*Math.trunc(n/s),n>=t&&(n=s-n-1)}return Qa(0,n,t-1)}function zst(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const s=t-1;n+=t*(Math.trunc(-n/s)+1)}else if(n>t-1)if(t<=1)n=0;else{const s=t-1;n-=t*Math.trunc(n/s)}return Qa(0,n,t-1)}function Bst(e,t){return e}function Vst(e,t){return Qa(0,e,t-1)}function Gu(e,t,n,s,r,o,i,a,l,c,u){const d=i*s+a*r+l*o+c;return 0<=a&&a<t&&0<=l&&l<n?e[d]:u}function Wst(e,t,n,s,r,o,i,a,l,c,u){const d=Math.round(a),h=Math.round(l);return Gu(e,t,n,s,r,o,i,d,h,c,u)}function Ust(e,t,n,s,r,o,i,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*Gu(e,t,n,s,r,o,i,d,h,c,u)+(l-h)*Gu(e,t,n,s,r,o,i,d,p,c,u),g=(p-l)*Gu(e,t,n,s,r,o,i,f,h,c,u)+(l-h)*Gu(e,t,n,s,r,o,i,f,p,c,u);return(f-a)*m+(a-d)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jst(e){const{inputs:t,attrs:n,backend:s}=e,{axis:r}=n,{x:o}=t;pt(o,"unique");const i=s.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:c}=QM(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const Gst={kernelName:tk,backendName:"cpu",kernelFunc:jst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hst(e){const{inputs:t,backend:n,attrs:s}=e,{value:r}=t;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r.shape.length,a=r.shape[o],l=new Array(i-1);let c=0;for(let f=0;f<i;f++)f!==o&&(l[c++]=r.shape[f]);const u=new Array(i).fill(0),d=r.shape.slice();d[o]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[o]=f;const p=ul({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});h[f]=ie({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const Kst={kernelName:Ux,backendName:"cpu",kernelFunc:Hst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xst(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,segmentIds:o}=t,{numSegments:i}=s;pt(r,"unsortedSegmentSum");const a=r.shape.length,l=o.shape.length,c=[],u=[],d=a-l;let h=o;for(let p=0;p<d;++p){const m=rg({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,u.push(m)}for(let p=0;p<i;++p){const m=ea(p,"int32"),g=n.makeTensorInfo([],"int32",m),x=hM({inputs:{a:g,b:h},backend:n}),y=Xi({inputs:{x},backend:n,attrs:{dtype:"float32"}}),b=g0({inputs:{a:y,b:r},backend:n}),v=$f({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(v),u.push(g),u.push(x),u.push(y),u.push(b),u.push(v)}const f=hL({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const qst={kernelName:jx,backendName:"cpu",kernelFunc:Xst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yst=[WZ,kQ,jZ,HZ,NQ,XZ,YZ,ZZ,tJ,nJ,rJ,iJ,lJ,dJ,fJ,gJ,yJ,vJ,kJ,BZ,SJ,$J,NJ,_Q,_J,$Q,DQ,DJ,CQ,OJ,PJ,MJ,zJ,VJ,UJ,GJ,KJ,qJ,QJ,JJ,ett,stt,ott,att,ltt,utt,htt,ptt,mtt,gtt,xtt,btt,ktt,AZ,Stt,AQ,Dtt,OQ,Att,PQ,ztt,Btt,Wtt,LQ,BQ,jtt,Htt,Xtt,Ytt,WQ,jQ,SQ,Ztt,FJ,tet,net,ret,OZ,HQ,XQ,iet,YQ,cet,het,pet,xet,bet,wet,ket,ZQ,Iet,Tet,Eet,Ret,Aet,Fet,Met,tZ,zet,Wet,Get,nZ,rZ,Xet,Qet,tnt,iZ,nnt,rnt,ont,fL,cnt,PZ,cZ,dnt,fnt,mnt,xnt,IQ,S1,bnt,MZ,LZ,zZ,wnt,Cnt,Int,Tnt,Ent,_nt,Dnt,xZ,Ont,znt,Vnt,Gnt,bZ,Knt,qnt,Qnt,vZ,Uet,tst,nst,rst,ist,lst,ust,hst,pst,CZ,mst,IZ,TZ,xst,bst,wst,Cst,Ist,RZ,vtt,Tst,Est,Rst,Ast,Fst,Mst,aZ,Gst,Kst,qst,snt];for(const e of Yst)qD(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sa={},cp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Qst(e,t){Sa[e]=t}function _r(e,t){if(!(e in Sa)||t!=null){const s=Jst(e,t);if(s!==null)Sa[e]=s;else return console.log("Could not get context for WebGL version",e),null}const n=Sa[e];return n==null||n.isContextLost()?(delete Sa[e],_r(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Sa[e])}function Zst(e){if(!K().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Jst(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=t??Zst(e);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Sa[e]},!1),K().getBool("SOFTWARE_WEBGL_ENABLED")&&(cp.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",cp)||n.getContext("experimental-webgl",cp):n.getContext("webgl2",cp)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hd;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Hd||(Hd={}));var Is;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Is||(Is={}));var an;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(an||(an={}));function Tf(e,t){return[t,e]}function trt(e,t){return e*t}function up(e){const t=Y(e),n=Math.ceil(t/4);return Hb(n)}function lu(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function ert(e,t){const[n,s]=lu(e,t);return n*s*4}function HC(e,t){const n=e;let s,r,o,i,a,l,c,u,d,h;return K().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=e.RGBA,r=e.RGBA,o=e.RGBA,i=n.RGBA,a=e.RGBA,c=4,u=4,d=t!=null?t.HALF_FLOAT_OES:null,h=e.FLOAT,l=e.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ut(e,t){const n=t();return K().getBool("DEBUG")&&nrt(e),n}function nrt(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+irt(e,t))}const srt=596e-10,rrt=65504;function ort(e){return!!(K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||srt<Math.abs(e)&&Math.abs(e)<rrt)}function irt(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function dp(e,t){return Xo(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function art(e,t){const n=Xo(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ut(e,()=>e.shaderSource(n,t)),ut(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function lrt(e,t){const n=Xo(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ut(e,()=>e.shaderSource(n,t)),ut(e,()=>e.compileShader(n)),K().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw pL(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const crt=/ERROR: [0-9]+:([0-9]+):/g;function pL(e,t){const n=crt.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}const s=+n[1],r=e.split(`
`),o=r.length.toString().length+2,i=r.map((d,h)=>rc((h+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,s-1),c=i.slice(s-1,s),u=i.slice(s);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${rc(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function urt(e){return Xo(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function drt(e,t){if(ut(e,()=>e.linkProgram(t)),!K().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function Sy(e,t){if(ut(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function hrt(e,t){const n=Xo(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return ut(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),ut(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function frt(e,t){const n=Xo(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return ut(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),ut(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function prt(e){return Xo(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function mrt(e,t){const n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const s=`[${e}x${t}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(e>n||t>n){const s=`[${e}x${t}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function grt(e){return Xo(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function y$(e,t,n,s,r,o,i){const a=e.getAttribLocation(t,n);return a===-1?!1:(ut(e,()=>e.bindBuffer(e.ARRAY_BUFFER,s)),ut(e,()=>e.vertexAttribPointer(a,r,e.FLOAT,!1,o,i)),ut(e,()=>e.enableVertexAttribArray(a)),!0)}function xrt(e,t,n){krt(e,n),ut(e,()=>e.activeTexture(e.TEXTURE0+n)),ut(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function yrt(e,t,n){return Xo(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function brt(e,t,n){return e.getUniformLocation(t,n)}function vrt(e,t,n,s){ut(e,()=>xrt(e,t,s)),ut(e,()=>e.uniform1i(n,s))}function Iy(e,t,n){ut(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),ut(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function b$(e,t){ut(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),ut(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function hp(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+wrt(e,t))}function wrt(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Xo(e,t,n){const s=ut(e,()=>t());if(s==null)throw new Error(n);return s}function krt(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=t+e.TEXTURE0;if(s<e.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Bc(e,t=2){return Y(e.slice(0,e.length-t))}function Vc(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function fp(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Bc(e),...Vc(e)]),t}function Crt(e,t=!1){let n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=K().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&K().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),t&&(n=n*2,s=s*2,e=e.map((a,l)=>l>=e.length-2?dw(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=ta(e).newShape);let r=Y(e),o=null;e.length<=1&&r<=n?o=[1,r]:e.length===2&&e[0]<=n&&e[1]<=n?o=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);const i=o!=null&&Math.max(...o)>s&&Math.min(...o)<=(t?2:1)&&Math.min(...o)>0;if(o==null||i)if(t){const a=Bc(e);let l=2,c=2;e.length&&([l,c]=Vc(e)),r=a*(l/2)*(c/2),o=Hb(r).map(u=>u*2)}else o=Hb(r);return o}function pp(e){return e%2===0}function ig(e,t){if(e=e.slice(-2),t=t.slice(-2),Ht(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){const n=e[e.length-1],s=t[t.length-1];if(n===s||pp(n)&&pp(s)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&pp(e[0])&&pp(t[0])}let $y,Ty;function Srt(e){if($y==null){const t=_r(e);$y=t.getParameter(t.MAX_TEXTURE_SIZE)}return $y}function Irt(e){if(Ty==null){const t=_r(e);Ty=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Ty)}function $rt(e){if(e===0)return 0;let t;const n=_r(e);return qs(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:qs(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function qs(e,t){return e.getExtension(t)!=null}function v$(e){try{if(_r(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function Trt(e){if(e===0)return!1;const t=_r(e);if(e===1){if(!qs(t,"OES_texture_float"))return!1}else if(!qs(t,"EXT_color_buffer_float"))return!1;return $1(t)}function Nrt(e){if(e===0)return!1;const t=_r(e);if(e===1){if(!qs(t,"OES_texture_float")||!qs(t,"WEBGL_color_buffer_float"))return!1}else{if(qs(t,"EXT_color_buffer_float"))return $1(t);const s="EXT_color_buffer_half_float";if(qs(t,s)){const r=t.getExtension(s);return Ert(t,r)}return!1}return $1(t)}function $1(e){const t=HC(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(o),i}function Ert(e,t){const n=HC(e,t),s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(s),e.deleteFramebuffer(i),a}function _rt(e){return e!==2?!1:_r(e).fenceSync!=null}function Nf(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gt=K();gt.registerFlag("HAS_WEBGL",()=>gt.getNumber("WEBGL_VERSION")>0);gt.registerFlag("WEBGL_VERSION",()=>v$(2)?2:v$(1)?1:0);gt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);gt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>gt.get("WEBGL_VERSION")===2);gt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);gt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);gt.registerFlag("WEBGL_PACK",()=>gt.getBool("HAS_WEBGL"));gt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_CLIP",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_REDUCE",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_LAZILY_UNPACK",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_CONV_IM2COL",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Srt(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Irt(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=gt.getNumber("WEBGL_VERSION");return e===0?0:$rt(e)});gt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>gt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!hA());gt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Trt(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>gt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:gt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));gt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Nrt(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>_rt(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>gt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);gt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});gt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>hA()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});gt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);gt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);gt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);gt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);gt.registerFlag("WEBGL_EXP_CONV",()=>!1);gt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>gt.getBool("IS_TEST"));gt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);gt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);gt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);gt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bn(){let e,t,n,s,r,o,i,a,l,c;return K().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",s="in",r="texture",o="outputColor",i="out vec4 outputColor;",a=K().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",s="varying",r="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:s,texture2D:r,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sl(e,t,n="index"){const s=yt(t);return s.map((r,o)=>{const i=`int ${e[o]} = ${n} / ${r}`,a=o===s.length-1?`int ${e[o+1]} = ${n} - ${e[o]} * ${r}`:`index -= ${e[o]} * ${r}`;return`${i}; ${a};`}).join("")}function x0(e,t,n="index"){const s=yt(t);return s.map((r,o)=>{const i=`int ${e[o]} = ${n} / outShapeStrides[${o}]`,a=o===s.length-1?`int ${e[o+1]} = ${n} - ${e[o]} * outShapeStrides[${o}]`:`index -= ${e[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function Rrt(e,t){const n=e.length,s=e.map(o=>`${t}[${o}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let o=n-3;o>=0;--o)r[o]=`(${r[o+1]} * ${s[o+1]})`;return r}function Drt(e,t,n="index"){const s=e.map((o,i)=>i),r=Rrt(s,t);return r.map((o,i)=>{const a=`int ${e[i]} = ${n} / ${r[i]}`,l=i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${r[i]}`:`index -= ${e[i]} * ${r[i]}`;return`${a}; ${l};`}).join("")}function KC(e){const t=yt(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function XC(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const mL=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:gL}=bq;function Art(e,t,n){const s=[];if(e.forEach(f=>{const p=Y(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=qC(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),o=e.map(f=>Ort(f,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=t.texShape,a=Bn(),l=Mrt(a);let c,u,d=Brt(a);return t.isPacked?(c=Frt(t.logicalShape,i,n.enableShapeUniforms),u=zrt(a)):(c=Prt(t.logicalShape,i,n.enableShapeUniforms),u=Lrt(a)),n.packedInputs&&(d+=jrt),[d,l,u,r,c,o,n.userCode].join(`
`)}function cu(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return not(e,t);case 1:return rot(e,t);case 2:return iot(e,t);case 3:return lot(e,t);case 4:return uot(e,t);case 5:return dot(e);case 6:return hot(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function xL(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return eot(e);case 1:return sot(e,t);case 2:return oot(e,t);case 3:return aot(e,t);default:return cot(e,t)}}function Ort(e,t,n=!1,s){let r="";n?r+=xL(e,s):r+=cu(e,s);const o=e.shapeInfo.logicalShape,i=t.logicalShape;return o.length<=i.length&&(n?r+=fot(e,t):r+=pot(e,t)),r}function Frt(e,t,n){switch(e.length){case 0:return yL();case 1:return Grt(e,t,n);case 2:return Jrt(e,t,n);case 3:return Krt(e,t,n);default:return qrt(e,t,n)}}function Prt(e,t,n){switch(e.length){case 0:return yL();case 1:return Hrt(e,t,n);case 2:return tot(e,t,n);case 3:return Xrt(e,t,n);case 4:return Yrt(e,t,n);case 5:return Qrt(e,t);case 6:return Zrt(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function Mrt(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function Lrt(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function zrt(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function Brt(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Vrt}
    ${Wrt}
    ${Urt}
  `}const Vrt=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Wrt=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Urt=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jrt=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function yL(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Grt(e,t,n){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Hrt(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function Krt(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),o=r*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function Xrt(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${x0(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;const s=Sl(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function qrt(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),o=r*Math.ceil(e[e.length-2]/2);let i=o,a="",l="b, r, c";for(let c=2;c<e.length-1;c++)i*=e[e.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,l=`b${c}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${e.length}(${l});
    }
  `}function Yrt(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${x0(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Sl(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Qrt(e,t){const n=Sl(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Zrt(e,t){const n=Sl(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Jrt(e,t,n){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Ht(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function tot(e,t,n){return Ht(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function Il(e){return`offset${e}`}function eot(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),s=Bn();return`
    vec4 ${n}() {
      return ${s.texture2D}(${t}, halfCR);
    }
  `}function not(e,t){const n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,o]=e.shapeInfo.texShape;if(r===1&&o===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=Il(n);if(t)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=e.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function sot(e,t){const n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e.shapeInfo.texShape,o=Bn();if(t)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function rot(e,t){const n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${uu(e)}
      }
    `;const r=e.shapeInfo.texShape,o=r[0],i=r[1];if(i===1&&o===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Il(n);return i===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function oot(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=e.shapeInfo.texShape,i=o[0],a=o[1],l=Bn();if(o!=null&&Ht(n,o))return t?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(t)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function iot(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=e.shapeInfo.texShape;if(o!=null&&Ht(n,o)){if(t)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=o[0],f=o[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=ta(n),l=i;if(l.length<n.length){const h=du(e,l),f=["row","col"];return`
      ${cu(h,t)}
      float ${r}(int row, int col) {
        return ${r}(${hu(f,a)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${uu(e)}
      }
    `;const c=o[0],u=o[1],d=Il(s);return u===1?t?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?t?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:t?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function aot(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=e.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=du(e,h),m=["b","row","col"];return`
        ${xL(p,t)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${hu(m,f)});
        }
      `}const a=Bn();if(t)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=i[0],c=i[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function lot(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=ta(n),c=a;if(c.length<n.length){const m=du(e,c),g=["row","col","depth"];return`
        ${cu(m,t)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${hu(g,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${uu(e)}
      }
    `;const u=e.shapeInfo.texShape,d=u[0],h=u[1],f=e.shapeInfo.flatOffset;if(h===o&&f==null)return t?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===i&&f==null)return t?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=Il(s);return t?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function cot(e,t){const n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=Bn();if(t)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const o=e.shapeInfo.logicalShape,i=o.length,a=e.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(o[i-1]/2);let h=d*Math.ceil(o[i-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,h*=o[i-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function uot(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:c}=ta(n);if(l.length<n.length){const y=du(e,l),b=["row","col","depth","depth2"];return`
      ${cu(y,t)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${hu(b,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${uu(e)}
      }
    `;const u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,g=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return t?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===o&&u==null)return t?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const x=Il(s);return t?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${x});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${x});
      return sampleTexture(${s}, uv);
    }
  `}function dot(e){const t=e.shapeInfo.logicalShape,n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t[4],o=t[3]*r,i=t[2]*o,a=t[1]*i,{newShape:l,keptDims:c}=ta(t);if(l.length<t.length){const m=du(e,l),g=["row","col","depth","depth2","depth3"];return`
      ${cu(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${hu(g,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${r})) +
          depth3;
        ${uu(e)}
      }
    `;const u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Il(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function hot(e){const t=e.shapeInfo.logicalShape,n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:o}=ta(t);if(r.length<t.length){const g=du(e,r),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${cu(g)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${hu(x,o)});
      }
    `}const i=t[5],a=t[4]*i,l=t[3]*a,c=t[2]*l,u=t[1]*c;if(e.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${uu(e)}
      }
    `;const d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Il(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function uu(e){const t=e.name,n=Y(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function fot(e,t){const n=e.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,a=gL(e.shapeInfo.logicalShape,t.logicalShape),l=te(i),c=i-o;let u;const d=["x","y","z","w","u","v"];o===0?u="":i<2&&a.length>=1?u="coords = 0;":u=a.map(y=>`coords.${d[y+c]} = 0;`).join(`
`);let h="";i<2&&o>0?h="coords":h=e.shapeInfo.logicalShape.map((y,b)=>`coords.${d[b+c]}`).join(", ");let f="return outputValue;";const m=Y(e.shapeInfo.logicalShape)===1,x=Y(t.logicalShape)===1;if(o===1&&!m&&!x)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!x)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const y=o-2,b=o-1;a.indexOf(y)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${h});
      ${f}
    }
  `}function pot(e,t){const n=e.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=t.texShape,i=e.shapeInfo.texShape,a=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&a===l&&e.shapeInfo.flatOffset==null&&Ht(i,o))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=te(l),u=gL(e.shapeInfo.logicalShape,t.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=e.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${s}(${p});
    }
  `}function te(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function qC(e,t,n){const{newShape:s,keptDims:r}=ta(t),o=t.length,i=e&&o===3&&t[0]===1,a=i?t.slice(1):s,l=!e&&o>1&&!Ht(t,n)&&s.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:t,keptDims:r}}function du(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function hu(e,t){return t.map(n=>e[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mot(e,t,n,s){const r=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:t.variableNames[d],shapeInfo:h}}),o=r.map(u=>u.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=Art(r,i,t),l=lrt(e.gl,a),c=e.createProgram(l);return K().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i},bL(e,t,c)))}function bL(e,t,n){const s=[],r=[];let o,i,a,l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),K().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of t.variableNames){const h={name:d,uniform:e.getUniformLocation(n,d,u),offset:e.getUniformLocation(n,`offset${d}`,u)};t.enableShapeUniforms&&(h.shape=e.getUniformLocation(n,`${d}Shape`,u),h.texShape=e.getUniformLocation(n,`${d}TexShape`,u)),s.push(h)}if(t.enableShapeUniforms&&(o=e.getUniformLocation(n,"outShape",u),a=e.getUniformLocation(n,"outShapeStrides",u),i=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(const d of t.customUniforms)r.push(e.getUniformLocation(n,d.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function w$(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,s)=>{const r=n.logicalShape,o=t[s],i=o.shape;if(!Ht(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!Ht(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function got(e,t,n,s,r){t.program.enableShapeUniforms||(w$(t.inShapeInfos,n),w$([t.outShapeInfo],[s]));const o=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?e.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):e.setOutputMatrixTexture(o.texture,i[0],i[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),K().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:f}=t.variablesLocations[l];if(h){const{uniformShape:p}=qC(t.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:e.gl.uniform1iv(h,new Int32Array(p));break;case 2:e.gl.uniform2iv(h,new Int32Array(p));break;case 3:e.gl.uniform3iv(h,new Int32Array(p));break;case 4:e.gl.uniform4iv(h,new Int32Array(p));break}}if(f&&e.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(Y(c.shape)<2)e.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),e.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&d!=null&&e.gl.uniform1i(d,c.texData.slice.flatOffset),e.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=t.outShapeLocation;if(a)switch(s.shape.length){case 1:e.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:e.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:e.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:e.gl.uniform4iv(a,new Int32Array(s.shape));break}if(t.outShapeStridesLocation){const l=yt(s.shape);switch(s.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),t.program.customUniforms&&r)for(let l=0;l<t.program.customUniforms.length;++l){const c=t.program.customUniforms[l],u=t.customUniformLocations[l],d=r[l];if(c.type==="float")e.gl.uniform1fv(u,d);else if(c.type==="vec2")e.gl.uniform2fv(u,d);else if(c.type==="vec3")e.gl.uniform3fv(u,d);else if(c.type==="vec4")e.gl.uniform4fv(u,d);else if(c.type==="int")e.gl.uniform1iv(u,d);else if(c.type==="ivec2")e.gl.uniform2iv(u,d);else if(c.type==="ivec3")e.gl.uniform3iv(u,d);else if(c.type==="ivec4")e.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}e.executeProgram()}function xot(e,t,n){let s="";t.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=qC(e.packedInputs,i.shape,l);let h="",f="",p="";if(u.length===1&&e.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${w[0]>1}_${w[1]>1}`}else if(u.length===2&&!e.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!e.packedInputs){const w=yt(u);p=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const m=i.shape.length,g=u.length===2&&Ht(i.shape,l),x=Y(i.shape)===1,y=Ac(i.shape,n.shape),b=!e.packedInputs&&m===n.shape.length&&Ht(l,n.texData.texShape),v=e.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${b}_${c?d:""}_${u.length}_${x}_${y}_${g}_${h}_${f}_${p}_${v}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${a}`}});const r=e.userCode;let o=e.constructor.name;return o+="_"+s+"_"+r+`${K().getNumber("WEBGL_VERSION")}`,o}function kn(e){return K().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yot{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Hd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Bn();this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?x0(["r","c","d"],t):Sl(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bot{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Hd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Bn();this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?x0(["r","c","d"],t):Sl(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vot{constructor(t){this.variableNames=["A"],this.outTexUsage=Is.DOWNLOAD;const n=Bn();this.outputShape=t,this.userCode=`
      ${mL}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wot{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Is.DOWNLOAD;const n=Bn();this.outputShape=t,this.userCode=`
      ${mL}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kot={R:0,G:1,B:2,A:3};class k${constructor(t,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Bn();this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<s.length;a++){const l=s[a];i+=`
          if(offset == ${a}) {
            result = values[${kot[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?XC():KC(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cot{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Bn();this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length);let r="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?XC():KC(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sot(e){const t=Bn(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return art(e,n)}function Iot(e){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return hrt(e,t)}function $ot(e){const t=new Uint16Array([0,1,2,2,1,3]);return frt(e,t)}function Ef(e,t,n,s,r,o){mrt(t,n);const i=prt(e),a=e.TEXTURE_2D;return ut(e,()=>e.bindTexture(a,i)),ut(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),ut(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),ut(e,()=>e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST)),ut(e,()=>e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST)),K().getNumber("WEBGL_VERSION")===1?ut(e,()=>e.texImage2D(a,0,s,t,n,0,r,o,null)):ut(e,()=>e.texStorage2D(a,1,s,t,n)),ut(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:i,texShape:[n,t]}}function vL(e){return e.internalFormatFloat}function Tot(e,t,n,s){const[r,o]=Tf(t,n);return Ef(e,r,o,vL(s),s.textureFormatFloat,e.FLOAT)}function wL(e){return e.internalFormatHalfFloat}function Not(e,t,n,s){const[r,o]=Tf(t,n);return Ef(e,r,o,wL(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function kL(e){return e.downloadTextureFormat}function Eot(e,t,n,s){const[r,o]=Tf(t,n);return Ef(e,r,o,kL(s),e.RGBA,e.UNSIGNED_BYTE)}function CL(e){return e.internalFormatPackedFloat}function _ot(e,t,n,s){const[r,o]=lu(t,n);return Ef(e,r,o,CL(s),e.RGBA,e.FLOAT)}function SL(e){return e.internalFormatPackedHalfFloat}function Rot(e,t,n,s){const[r,o]=lu(t,n);return Ef(e,r,o,SL(s),e.RGBA,s.textureTypeHalfFloat)}function Dot(e,t,n){return ut(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),y$(e,t,"clipSpacePos",n,3,20,0)&&y$(e,t,"uv",n,2,20,12)}function Aot(e,t,n,s,r,o){ut(e,()=>e.bindTexture(e.TEXTURE_2D,t));let i,a,l;r instanceof Uint8Array?(i=new Uint8Array(n*s*4),a=e.UNSIGNED_BYTE,l=e.RGBA):(i=new Float32Array(n*s*4),a=e.FLOAT,l=o.internalFormatPackedFloat),i.set(r),K().getNumber("WEBGL_VERSION")===2?ut(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,s,e.RGBA,a,i)):ut(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,s,0,e.RGBA,a,i)),ut(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function Oot(e,t,n){ut(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?K().getNumber("WEBGL_VERSION")===2?ut(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):ut(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):K().getNumber("WEBGL_VERSION")===2?ut(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):ut(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),ut(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function Fot(e,t,n,s){const r=e.createBuffer();ut(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r));const a=4*4*t*n;return ut(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),ut(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),ut(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),r}function Pot(e,t,n){const s=e,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Mot(e,t,n,s){const[r,o]=Tf(t,n),i=4,a=new Uint8Array(trt(t*n,i));return ut(e,()=>e.readPixels(0,0,r,o,s.downloadTextureFormat,e.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Lot(e,t,n,s,r,o,i,a){const l=e,c=new Float32Array(ert(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function zot(e,t,n){const s=new Float32Array(t*n*4);return ut(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ny{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=K().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,Qst(n,t)):this.gl=_r(n),t=this.gl,K().getNumber("WEBGL_VERSION")===2){const o=t;this.createVertexArray=()=>ut(o,()=>o.createVertexArray()),this.bindVertexArray=i=>ut(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>ut(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>ut(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(t!=null){const o=t.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ut(t,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>ut(t,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>ut(t,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>ut(t,()=>t.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),K().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=dp(this.gl,o),qs(this.gl,i))this.textureHalfFloatExtension=dp(this.gl,i);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),qs(this.gl,r))this.colorBufferHalfFloatExtension=dp(this.gl,r);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",qs(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(qs(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Iot(this.gl),this.indexBuffer=$ot(this.gl),this.framebuffer=grt(this.gl),this.textureConfig=HC(this.gl,this.textureHalfFloatExtension)}get debug(){return K().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;ut(t,()=>t.finish()),ut(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),ut(t,()=>t.deleteFramebuffer(this.framebuffer)),ut(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),ut(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),ut(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),Tot(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),Not(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),Eot(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),Oot(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,s,r){this.throwIfDisposed(),Aot(this.gl,t,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),Rot(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),_ot(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(b$(this.gl,this.framebuffer),this.outputTexture=null),ut(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,s){return this.downloadMatrixDriver(t,()=>Mot(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,s,r,o,i){return Lot(this.gl,t,n,s,r,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return Pot(this.gl,t,n)}createBufferFromTexture(t,n,s){this.bindTextureToFrameBuffer(t);const r=Fot(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,s;if(K().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),s=()=>{const i=r.clientWaitSync(o,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},n=o}else K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(t,n,s){return this.downloadMatrixDriver(t,()=>zot(this.gl,n,s))}createProgram(t){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Sot(n));const s=urt(n);ut(n,()=>n.attachShader(s,this.vertexShader)),ut(n,()=>n.attachShader(s,t)),drt(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&Sy(n,r),r}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const n=this.gl;ut(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Dot(n,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(ut(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Sy(this.gl,this.program),ut(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,s=!0){return this.throwIfDisposed(),s?yrt(this.gl,t,n):brt(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),ut(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),vrt(this.gl,t,n,s)}setOutputMatrixTexture(t,n,s){this.setOutputMatrixTextureDriver(t,s,n)}setOutputPackedMatrixTexture(t,n,s){this.throwIfDisposed();const[r,o]=lu(n,s);this.setOutputMatrixTextureDriver(t,r,o)}setOutputMatrixWriteRegion(t,n,s,r){this.setOutputMatrixWriteRegionDriver(s,t,r,n)}setOutputPackedMatrixWriteRegion(t,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Sy(this.gl,this.program),hp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ut(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ut(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=dp(this.gl,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,o),o}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await l2(()=>this.disposed||this.isQueryAvailable(t,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(t,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(t,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.getQueryParameter(t,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(t,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=Bot(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in K().platform&&(s=K().platform.setTimeoutCustom.bind(K().platform)),l2(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),Iy(this.gl,t,this.framebuffer),this.debug&&hp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Iy(this.gl,this.outputTexture,this.framebuffer),this.debug&&hp(this.gl)):b$(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(t,n,s){this.throwIfDisposed();const r=this.gl;Iy(r,t,this.framebuffer),this.debug&&hp(r),this.outputTexture=t,ut(r,()=>r.viewport(0,0,n,s)),ut(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(t,n,s,r){this.throwIfDisposed(),ut(this.gl,()=>this.gl.scissor(t,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Bot(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Vot,bincountImpl:IL,bincountReduceImpl:Wot,bitwiseAndImpl:Uot,castImpl:jot,ceilImpl:Got,concatImpl:Hot,equalImpl:Kot,expImpl:Xot,expm1Impl:qot,floorImpl:Yot,gatherNdImpl:Qot,gatherV2Impl:Zot,greaterImpl:Jot,greaterEqualImpl:tit,lessImpl:eit,lessEqualImpl:nit,linSpaceImpl:sit,logImpl:rit,maxImpl:oit,maximumImpl:iit,minimumImpl:ait,multiplyImpl:lit,negImpl:cit,notEqualImpl:uit,prodImpl:dit,raggedGatherImpl:hit,raggedRangeImpl:fit,raggedTensorToTensorImpl:pit,rangeImpl:mit,rsqrtImpl:git,scatterImpl:xit,sigmoidImpl:yit,simpleAbsImpl:$L,sliceImpl:bit,sparseFillEmptyRowsImpl:vit,sparseReshapeImpl:wit,sparseSegmentReductionImpl:TL,sqrtImpl:kit,staticRegexReplaceImpl:Cit,stridedSliceImpl:Sit,stringNGramsImpl:Iit,stringSplitImpl:$it,stringToHashBucketFastImpl:Tit,subImpl:Nit,tileImpl:Eit,topKImpl:_it,transposeImpl:YC,uniqueImpl:Rit}=DZ;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NL(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function Dn(e,t){return t===1?[e]:NL(e,t)}function Dit(e,t){if(e===1)return"rc";let n="";for(let s=0;s<e;s++)n+=t[s],s<e-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ait{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=kn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Dn("rc",this.rank),s=te(this.rank),r=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(t){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let o=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${t[t.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${t[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";const n=t.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(t){const n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EL{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let o="thisRC = rc;";r%2===1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),s+=`
        ${o}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Oit(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?XC():KC(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${s}

        setOutput(result);
      }
    `}}function Oit(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?Drt(["r","c","d"],"inputShape"):Sl(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fit{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,n,s){const r=S$(n,s),o=I$(t,r,s);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=C$(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return r===an.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===an.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===an.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===an.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===an.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(t,n,s,r){if(this.freeTextures==null)return;const o=S$(s,r),i=I$(n,o,r);i in this.freeTextures||(this.freeTextures[i]=[]);const a=C$(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=K().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[i],u=c&&c.indexOf(t);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Pit(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function C$(e,t,n,s,r){const o=Mit(t,s);let i;if(r){const[l,c]=lu(e[0],e[1]);i=l*c}else{const[l,c]=Tf(e[0],e[1]);i=l*c}const a=Pit(n,o);return i*a}function Mit(e,t){switch(e){case an.PACKED_2X2_FLOAT32:return CL(t);case an.PACKED_2X2_FLOAT16:return SL(t);case an.UNPACKED_FLOAT32:return vL(t);case an.UNPACKED_FLOAT16:return wL(t);case an.PACKED_4X1_UNSIGNED_BYTE:return kL(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function Lit(e){return K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?an.PACKED_2X2_FLOAT32:an.UNPACKED_FLOAT32:e?an.PACKED_2X2_FLOAT16:an.UNPACKED_FLOAT16}function S$(e,t){if(e===Is.UPLOAD)return an.PACKED_2X2_FLOAT32;if(e===Is.RENDER||e==null)return Lit(t);if(e===Is.DOWNLOAD||e===Is.PIXELS)return an.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function I$(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hr{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const or="if (isnan(x)) return x;",zit="return x;",$$="return abs(x);",Bit="return (x >= 0.0) ? x : (exp(x) - 1.0);",Vit=or+`
  return (x < 0.0) ? 0.0 : x;
`,Wit=or+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ai="return x;",Uit="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jit="return x;",Git=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Hit=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Kit=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Xit="return 1.0 / (1.0 + exp(-1.0 * x));";class bi{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qit{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length);const n=t.length,s=Dn("rc",n),r=te(n),o=Dit(n,s),i=s.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yit=tO,Qit=1e-7,Zit=1e-4,mp={};function Jit(e){return e in mp||(mp[e]={}),mp[e]}const tat=K().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),eat=600;function nat(){return K().global.screen==null?1024:K().global.screen.height*K().global.screen.width*window.devicePixelRatio*eat/1024/1024}class y0 extends uw{nextDataId(){return y0.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!K().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof Ny)n=t;else{const s=_r(K().getNumber("WEBGL_VERSION"),t);n=new Ny(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=_r(K().getNumber("WEBGL_VERSION"));n=new Ny(s),this.binaryCache=Jit(K().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Fit(this.gpgpu),this.numMBBeforeWarning=nat(),this.texData=new vD(this,Pr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,s,r,o,i){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:t,texShape:[r,o]},l.texShape=[r,o];const c=fp(n),u=new k$(c,!1,i),d=this.runWebGLProgram(u,[a],s,[[r,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(t,n,s){if((K().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||K().getBool("DEBUG"))&&this.checkNumericalProblems(t),s==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:t,usage:Is.UPLOAD,refCount:1}),r}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}move(t,n,s,r,o){if(K().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:s,dtype:r,values:n,usage:Is.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const n=this.texData.get(t),{values:s,dtype:r,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let h;l?h=new bi(a,ai):h=new Hr(a,ai);const f=this.runWebGLProgram(h,[{dataId:t,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(t);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=Un());let d;if(r==="complex64"){const h=this.readSync(o.real.dataId),f=this.readSync(o.imag.dataId);d=zo(h,f)}else d=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=Un()-u),this.convertAndCacheOnCPU(t,d)}async read(t){if(this.pendingRead.has(t)){const p=this.pendingRead.get(t);return new Promise(m=>p.push(m))}const n=this.texData.get(t),{values:s,shape:r,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let p;l?p=new bi(r,ai):p=new Hr(r,ai);const m=this.runWebGLProgram(p,[{dataId:t,shape:r,dtype:i}],i),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(s!=null)return this.convertAndCacheOnCPU(t);if(K().getBool("DEBUG")&&!K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&K().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(i!=="complex64"&&K().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...up(r))}this.pendingRead.set(t,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],g=p[1];d=zo(m,g)}else if(c==null)d=this.getValuesFromTexture(t);else{const p=Y(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;ut(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(t,d),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach(p=>p(h)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Pr().removeDataId(t,this),this.pendingDeletes--),h}readToGPU(t,n={}){const s=this.texData.get(t),{values:r,shape:o,slice:i,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;l?f=new bi(o,ai):f=new Hr(o,ai);const p=this.runWebGLProgram(f,[{dataId:t,shape:o,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(t,n.customTexShape),d=Pr().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const s=n.map(r=>Ui(r));return _t(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return _t(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const s=t[n];if(!ort(s))throw K().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:s,isPacked:r}=this.texData.get(t),o=Y(n);if(K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(t),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...up(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(h),p}const i=K().getBool("WEBGL_PACK")&&r===!0,a=i?fp(n):n,l=i?new wot(a):new vot(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:t}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,t();const o=Za(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=Za(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=kG(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:i[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Un(),endMs:null}}endTimer(t){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Un(),t)}async getQueryTime(t){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:s}=this.texData.get(t);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:n,dtype:s,texShape:r,usage:o,isPacked:i,slice:a}=this.texData.get(t),l=a&&a.origDataId||t,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,o,i)));const u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=tat){return K().getBool("WEBGL_CPU_FORWARD")&&t.every(s=>this.texData.get(s.dataId).texture==null&&Y(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){Cs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return Yit(t.shape,n)}packedUnaryOp(t,n,s){const r=new bi(t.shape,n),o=this.compileAndRun(r,[t],s);return Pr().makeTensorFromTensorInfo(o)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const r=$L(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,r)}if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,$$,t.dtype);const n=new Hr(t.shape,$$),s=this.compileAndRun(n,[t]);return Pr().makeTensorFromTensorInfo(s)}makeTensorInfo(t,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&fh(s[0])){const o=s.map(i=>Oi(i));r=this.write(o,t,n)}else r=this.write(s,t,n);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:n}}makeOutput(t,n,s){return Pr().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,s),this)}unpackTensor(t){const n=new qit(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new Ait(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)}packedReshape(t,n){const s=[Bc(t.shape),...Vc(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},o=[Bc(n),...Vc(n)],i=new EL(o,s),a=!0,l=[s],c=this.runWebGLProgram(i,[r],t.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(t,n){const s=this.texData.get(t),{isPacked:r,shape:o,dtype:i}=s;if(n!=null){const h=Y(o),f=n[0]*n[1]*4;T(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=fp(o);let l;r?l=new bot(a):l=new yot(a);const c=!0,u=[n??up(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:t}],i,u,c,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(t,n,s,r,o=!1,i){const a=this.makeTensorInfo(t.outputShape,s),l=this.texData.get(a.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===Hd.DENSE){const x=i??up(t.outputShape);l.texShape=x.map(y=>y*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),Y(a.shape)===0)return l.values=xn(a.dtype,0),a;const c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(x.dataId);if(y.texture==null){if(!t.packedInputs&&Y(x.shape)<=K().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:y.values};t.packedInputs&&(y.isPacked=!0,y.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!y.isPacked!=!!t.packedInputs)x=y.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),y=this.texData.get(x.dataId);else if(y.isPacked&&!ig(y.shape,x.shape)){const b=x,v=x.shape;x.shape=y.shape,x=this.packedReshape(x,v),c.push(x),y=this.texData.get(x.dataId),b.shape=v}return{shape:x.shape,texData:y,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=xot(t,u,d),f=this.getAndSaveBinary(h,()=>mot(this.gpgpu,t,u,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),K().get("ENGINE_COMPILE_ONLY")||got(this.gpgpu,f,u,d,r),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),p&&(m=this.endTimer(m),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(m)}));const g=K().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const x=Un();x-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!K().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(t,n,s,r,o=!1){return s=s||n[0].dtype,this.runWebGLProgram(t,n,s,r,o)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(K().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=G(()=>{if(!K().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=K().getBool("DEBUG");K().set("DEBUG",!1);const n=this.abs(kt(1e-8)).dataSync()[0];if(K().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Qit:Zit}uploadToGPU(t){const n=this.texData.get(t),{shape:s,dtype:r,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const c=this.activeTimers!=null;let u;c&&(u=Un());let d=n.texShape;if(d==null&&(d=Crt(s,l),n.texShape=d),o!=null){const h=fp(s);let f,p=d[1],m=d[0];const g=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!g)&&([p,m]=lu(d[0],d[1])),l?f=new Cot(h,g):f=new k$(h,g);const x=g?[m,p]:d,y=this.makeTensorInfo(x,r),b=this.texData.get(y.dataId);g?b.usage=Is.PIXELS:b.usage=Is.UPLOAD,b.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,m,o);const v=[[m,p]],k=this.runWebGLProgram(f,[y],r,v,!0),C=this.texData.get(k.dataId);n.texShape=C.texShape,n.isPacked=C.isPacked,n.usage=C.usage,K().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=C.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=Un()-u)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(t,n){const s=this.texData.get(t),{dtype:r}=s;return n!=null&&(s.values=sat(n,r)),s.values}acquireTexture(t,n,s,r){if(this.numBytesInGPU+=this.computeBytes(t,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,r)}computeBytes(t,n){return t[0]*t[1]*Fm(n)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(o){throw o}});t.push(s)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await xO(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(pL(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=bL(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=s,t.infLoc=r,t.nanLoc=o,t.outShapeLocation=i,t.outShapeStridesLocation=a,t.outTexShapeLocation=l}}createTensorFromGPUData(t,n,s){t.channels=t.channels||"RGBA";const{texture:r,height:o,width:i,channels:a}=t,l=Pr().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,o,i,a);return Pr().makeTensorFromDataId(c,n,s,l)}}y0.nextDataId=0;function sat(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let s=0;s<n.length;++s)n[s]=Math.round(e[s]);return n}else throw new Error(`Unknown dtype ${t}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fA()&&xA("webgl",()=>new y0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QC=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class dl{constructor(t,n,s){this.variableNames=["A","B"],this.outputShape=$t(n,s),this.enableShapeUniforms=kn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $l=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class fu{constructor(t,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=$t(n,s);const o=this.outputShape.length;this.enableShapeUniforms=kn(o);let i="";if(r)if(o===0||Y(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${te(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Dn("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ms(e){const{inputs:t,backend:n}=e,{x:s}=t;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const rat={kernelName:Oh,backendName:"webgl",kernelFunc:ms};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function la(e){const{inputs:t,backend:n}=e,{real:s,imag:r}=t,o=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(o.dataId),a=ms({inputs:{x:s},backend:n}),l=ms({inputs:{x:r},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const oat={kernelName:kw,backendName:"webgl",kernelFunc:la};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _L="return (a < 0.) ? b * a : a;",RL=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function iat(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{alpha:o}=s,i=n.makeTensorInfo([],"float32",ea(o,"float32")),a=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fu(RL,r.shape,i.shape):new dl(_L,r.shape,i.shape),l=n.runWebGLProgram(a,[r,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const aat={kernelName:hx,backendName:"webgl",kernelFunc:iat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DL="return (a < 0.) ? b * a : a;",AL=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function lat(e){const{inputs:t,backend:n}=e,{x:s,alpha:r}=t,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fu(AL,s.shape,r.shape):new dl(DL,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],"float32")}const cat={kernelName:Rx,backendName:"webgl",kernelFunc:lat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pu="if (isnan(x)) return x;";function zt({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:o})=>{const{x:i}=r,a=o,l=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),h=n(d.values,l);return a.makeTensorInfo(i.shape,l,h)}const c=K().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let u;return c?u=new bi(i.shape,t):u=new Hr(i.shape,e),a.runWebGLProgram(u,[i],l)}}function fn({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:c}=i,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,x]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{const[v,w]=b,k={dataId:v.dataId,dtype:v.dtype,shape:l.shape},C={dataId:w.dataId,dtype:w.dtype,shape:c.shape},S=new dl(e,l.shape,c.shape);return u.runWebGLProgram(S,[k,C],fs(v.dtype,w.dtype))}),y=la({inputs:{real:g,imag:x},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(x),y}const d=o||fs(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?Bo(p):p,x=l.dtype==="string"?Bo(m):m,[y,b]=r(l.shape,c.shape,g,x,d),v=u.makeTensorInfo(b,d),w=u.texData.get(v.dataId);return w.values=y,v}const h=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let f;return h?f=new fu(t,l.shape,c.shape,n):f=new dl(e,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function Kd(e,t=!1){if(e==="linear")return t?jit:zit;if(e==="relu")return t?Hit:Vit;if(e==="elu")return t?Git:Bit;if(e==="relu6")return t?Kit:Wit;if(e==="prelu")return t?AL:DL;if(e==="leakyrelu")return t?RL:_L;if(e==="sigmoid")return t?Xit:Uit;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OL{constructor(t,n,s,r=!1,o=!1,i=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=kn(this.outputShape.length);const u=r?t[1]:t[2],d=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",f=o?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",x="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";t[0]<n[0]?b=`imod(rc.x, ${t[0]})`:n[0]<t[0]&&(v=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${v};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class N${constructor(t,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=$t(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E$="return a * b;";function ZC(e){const{inputs:t,backend:n}=e,{a:s,b:r}=t,o=fs(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new N$(T$.REAL,s.shape,r.shape),u=new N$(T$.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=la({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=lit(s.shape,r.shape,a.values,l.values,o),d=n.makeTensorInfo(u,o),h=n.texData.get(d.dataId);return h.values=c,d}let i;return K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new fu(E$,s.shape,r.shape):i=new dl(E$,s.shape,r.shape),n.runWebGLProgram(i,[s,r],o)}const uat={kernelName:Uh,backendName:"webgl",kernelFunc:ZC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dat(e,t,n){const s=[Bc(e.shape),...Vc(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},o=[Bc(t),...Vc(t)],i=new EL(o,s),a=!0,l=[s],c=n.runWebGLProgram(i,[r],e.dtype,l,a);return{dataId:c.dataId,shape:t,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function at(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{shape:o}=s,i=n,a=Y(r.shape),l=kD(o,a),c=Y(l);T(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=i.texData.get(r.dataId);return u.isPacked&&!ig(r.shape,l)&&!(u.texture!==null&&ig(u.shape,l))?dat(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const hat={kernelName:Ax,backendName:"webgl",kernelFunc:at};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _${constructor(t,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=t;this.outputShape=[r,i];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${Ec(d)?d.toPrecision(2):d}, ones);`}let u="";o%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fat{constructor(t,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=t;this.outputShape=[r,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";o%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pat(e){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:e[1],s=n0(n);t.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return t}function Tl(e,t,n,s){const r=pat(e.shape);let o=e;for(let i=0;i<r.length;i++){const{inSize:a,windowSize:l,outSize:c}=r[i];let u,d;n==="mean"?u=i===0?new _$({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:c},a):new _$({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:c}):u=new fat({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:c},n),d=o,o=s.runWebGLProgram(u,[o],t),d.dataId!==e.dataId&&s.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mat{constructor(t,n){this.variableNames=["A"];const s=new Array(t.length);for(let i=0;i<s.length;i++)s[i]=t[n[i]];this.outputShape=s,this.rank=s.length;const r=te(this.rank),o=gat(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function gat(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(t);for(let r=0;r<e.length;r++)s[e[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xat{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(t.length);for(let u=0;u<s.length;u++)s[u]=t[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=te(this.rank),o=NL("rc",this.rank),i=new Array(this.rank);for(let u=0;u<n.length;u++)i[n[u]]=o[u];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b0(e,t,n){const s=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xat(e.shape,t):new mat(e.shape,t);return n.runWebGLProgram(s,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yat(e,t,n,s){const r=t,o=e.shape.length,i=Rt(r,e.shape);let a=i;const l=Ie(a,o),c=l!=null;let u=e;c&&(u=b0(e,l,s),a=Pe(a.length,o)),hn("sum",a,o);const[d,h]=sn(u.shape,a);let f=d;n&&(f=Fe(d,i));const p=Y(h),g=Y(e.shape)/p,x=at({inputs:{x:u},attrs:{shape:[g,p]},backend:s}),y=sk(e.dtype),b=Tl(x,y,"sum",s),v=at({inputs:{x:b},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(b),c&&s.disposeIntermediateTensorInfo(u),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s;return yat(r,o,i,n)}const bat={kernelName:zx,backendName:"webgl",kernelFunc:v0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mn(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{perm:o}=s,i=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[o[u]];let c;if(i.shouldExecuteOnCPU([r])){const d=i.texData.get(r.dataId).values,h=YC(d,r.shape,r.dtype,o,l);c=i.makeTensorInfo(l,r.dtype);const f=i.texData.get(c.dataId);f.values=h}else c=b0(r,o,i);return c}const vat={kernelName:oc,backendName:"webgl",kernelFunc:Mn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FL=1e3;function ag({a:e,b:t,transposeA:n,transposeB:s,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const c=e.shape.length,u=t.shape.length,d=n?e.shape[c-2]:e.shape[c-1],h=s?t.shape[u-1]:t.shape[u-2],f=n?e.shape[c-1]:e.shape[c-2],p=s?t.shape[u-2]:t.shape[u-1],m=e.shape.slice(0,-2),g=t.shape.slice(0,-2),x=Y(m),y=Y(g),v=$t(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([f,p]);T(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=n?[x,d,f]:[x,f,d],k=s?[y,p,h]:[y,h,p],C=at({inputs:{x:e},backend:r,attrs:{shape:w}}),S=at({inputs:{x:t},backend:r,attrs:{shape:k}}),I=[C,S],$=Math.max(x,y),E=n?C.shape[1]:C.shape[2],A=o!=null,L=i!=null,O=l==="leakyrelu",P=l!=null?Kd(l,!0):null,M=A||L||O||P!=null;let U;if((f===1||p===1)&&E>FL&&M===!1){let z=C,H=S;n&&(z=Mn({inputs:{x:C},backend:r,attrs:{perm:[0,2,1]}}),I.push(z)),s&&(H=Mn({inputs:{x:S},backend:r,attrs:{perm:[0,2,1]}}),I.push(H));const X=p!==1,Q=p===1;let J=z;X&&(J=at({inputs:{x:z},backend:r,attrs:{shape:[$,E,1]}}),I.push(J));const nt=p===1?2:1;let st=H;Q&&(st=at({inputs:{x:H},backend:r,attrs:{shape:[$,1,E]}}),I.push(st));const ot=ZC({inputs:{a:J,b:st},backend:r});U=v0({inputs:{x:ot},backend:r,attrs:{axis:nt,keepDims:!0}}),I.push(ot)}else{const z=fs(e.dtype,t.dtype),H=new OL(w,k,[$,f,p],n,s,A,P,L,O),X=[C,S];if(o!=null&&X.push(o),L&&X.push(i),O){const Q=r.makeTensorInfo([],"float32",ea(a,"float32"));X.push(Q),I.push(Q)}U=r.runWebGLProgram(H,X,z)}const R=at({inputs:{x:U},backend:r,attrs:{shape:v}});I.push(U);for(const z of I)r.disposeIntermediateTensorInfo(z);return R}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wat(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:o,bias:i,preluActivationWeights:a}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;return ag({a:r,b:o,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const kat={kernelName:Pm,backendName:"webgl",kernelFunc:wat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R$="return abs(x);";function Cat(e){const{inputs:t,backend:n}=e,{x:s}=t;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const o=n.texData.get(s.dataId),i=$L(o.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new bi(s.shape,R$):r=new Hr(s.shape,R$),n.runWebGLProgram(r,[s],s.dtype)}const Sat={kernelName:Hg,backendName:"webgl",kernelFunc:Cat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iat=or+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,$at=zt({opSnippet:Iat}),Tat={kernelName:ph,backendName:"webgl",kernelFunc:$at};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nat=or+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Eat=zt({opSnippet:Nat}),_at={kernelName:mh,backendName:"webgl",kernelFunc:Eat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D$="return a + b;",Rat=fn({opSnippet:D$,packedOpSnippet:D$,supportsComplex:!0,cpuKernelImpl:Vot}),Dat={kernelName:eu,backendName:"webgl",kernelFunc:Rat};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aat{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`float v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oat{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`vec4 v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(e){const{inputs:t,backend:n}=e,s=t;if(s.length===1)return ms({inputs:{x:s[0]},backend:n});if(s.length>K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=Xp({inputs:s.slice(0,l),backend:n}),u=Xp({inputs:s.slice(l),backend:n});return Xp({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>fs(l,c)),o=s.map(l=>l.shape),a=K().getBool("WEBGL_PACK")?new Oat(s[0].shape,o):new Aat(s[0].shape,o);return n.runWebGLProgram(a,s,r)}const Fat={kernelName:mw,backendName:"webgl",kernelFunc:Xp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pat(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s,a=r.shape.length,l=Rt(o,r.shape);let c=l;const u=Ie(c,a);let d=r;u!=null&&(d=Mn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Pe(c.length,a)),hn("all",c,a);const[h,f]=sn(d.shape,c),p=Y(f),m=at({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Tl(m,m.dtype,"all",n);let x;if(i){const y=Fe(h,l);x=at({inputs:{x:g},backend:n,attrs:{shape:y}})}else x=at({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),x}const Mat={kernelName:gw,backendName:"webgl",kernelFunc:Pat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lat(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s,a=r.shape.length,l=Rt(o,r.shape);let c=l;const u=Ie(c,a);let d=r;u!=null&&(d=Mn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Pe(c.length,a)),hn("any",c,a);const[h,f]=sn(d.shape,c),p=Y(f),m=at({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Tl(m,m.dtype,"any",n);let x;if(i){const y=Fe(h,l);x=at({inputs:{x:g},backend:n,attrs:{shape:y}})}else x=at({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),x}const zat={kernelName:xw,backendName:"webgl",kernelFunc:Lat};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bat{constructor(t,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:o,outSize:i}=t;s||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vat{constructor(t,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(t.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const o=t[t.length-1],i=Math.ceil(o/n);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=te(l),u=Dn("coords",l);let d,h;if(i===1){h=l+1;const S=te(h);d=`
        ${S} sourceLocR = ${S}(${u.join()}, 0);
        ++${u[l-1]};
        ${S} sourceLocG = ${S}(${u.join()}, 0);
        ++${u[l-2]};
        ${S} sourceLocA = ${S}(${u.join()}, 0);
        --${u[l-1]};
        ${S} sourceLocB = ${S}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map(S=>"int "+S),g=Dn("sourceLocR",h-1).concat("inIdx.r"),x=Dn("sourceLocG",h-1).concat("inIdx.g"),y=Dn("sourceLocB",h-1).concat("inIdx.b"),b=Dn("sourceLocA",h-1).concat("inIdx.a"),v=s==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,k=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,C=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(e,t,n,s=null){let r=t.shape[0],o=t.shape[1];s!=null&&(r=s.shape[0],o=s.shape[1]);const i=n0(o),a={windowSize:i,inSize:o,batchSize:r,outSize:Math.ceil(o/i)},l=new Bat(a,n,s==null),c=[t];s!=null&&c.push(s);const u=e.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=PL(e,t,n,u);return e.disposeIntermediateTensorInfo(u),d}function ML(e,t,n,s=null){const r=s!=null?s.shape:t.shape,o=r[r.length-1],i=n0(o),a=new Vat(r,i,n,s==null),l=s==null?[t]:[t,s],c=e.runWebGLProgram(a,l,"int32");if(c.shape.length===t.shape.length){const u=ML(e,t,n,c);return e.disposeIntermediateTensorInfo(c),u}return c}function LL(e,t,n,s){const r=[n];if(hn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,t.shape.length),!K().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const o=[],i=e.texData.get(t.dataId),a=i!==null&&i.isPacked;let l=t;a&&(l=e.unpackTensor(t),o.push(l));const[c,u]=sn(l.shape,r),d=Y(u),h=at({inputs:{x:l},backend:e,attrs:{shape:[-1,d]}});o.push(h);const f=PL(e,h,s);o.push(f);const p=at({inputs:{x:f},backend:e,attrs:{shape:c}});return o.forEach(m=>e.disposeIntermediateTensorInfo(m)),p}return ML(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wat(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o}=s;let i=Rt(o,r.shape);const a=Ie(i,r.shape.length);let l=r;const c=[];a!=null&&(l=Mn({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=Pe(i.length,l.shape.length)),hn("argMax",[i[0]],l.shape.length);const u=LL(n,l,i[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const Uat={kernelName:Kg,backendName:"webgl",kernelFunc:Wat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jat(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o}=s;let i=Rt(o,r.shape);const a=Ie(i,r.shape.length);let l=r;const c=[];a!=null&&(l=Mn({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=Pe(i.length,l.shape.length)),hn("argMin",[i[0]],l.shape.length);const u=LL(n,l,i[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const Gat={kernelName:Xg,backendName:"webgl",kernelFunc:jat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hat=or+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Kat=zt({opSnippet:Hat}),Xat={kernelName:gh,backendName:"webgl",kernelFunc:Kat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qat=or+"return log(x + sqrt(x * x + 1.0));",Yat=zt({opSnippet:qat}),Qat={kernelName:xh,backendName:"webgl",kernelFunc:Yat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zat=or+`
  return atan(x);
`,Jat=zt({opSnippet:Zat}),tlt={kernelName:yh,backendName:"webgl",kernelFunc:Jat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const elt=QC+`
  return atan(a, b);
`,nlt=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+$l+`
  return result;
`,slt=fn({opSnippet:elt,packedOpSnippet:nlt}),rlt={kernelName:vh,backendName:"webgl",kernelFunc:slt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const olt=or+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,ilt=zt({opSnippet:olt}),alt={kernelName:bh,backendName:"webgl",kernelFunc:ilt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xd{constructor(t,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,a=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,u=t.dilationWidth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const m=n==="avg",g=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,x=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let y="0.0";if(m||(y="-1.0 / 1e-20"),s){const S=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${S} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?o?g:x:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let v=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(v="avgValue / max(count, 1.0)");const w=Math.floor(i/4)*4,k=i%4,C=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${C}
          }

          int xC = xCCorner + ${w};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${C}
          }
        }
        setOutput(${v});
      }
    `}}class JC{constructor(t,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,a=t.strideDepth,l=t.strideHeight,c=t.strideWidth,u=t.dilationDepth,d=t.dilationHeight,h=t.dilationWidth,f=t.effectiveFilterDepth,p=t.effectiveFilterHeight,m=t.effectiveFilterWidth,g=t.padInfo.front,x=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const b=n==="avg";let v="0.0";if(b||(v="-1.0 / 1e-20"),s){const $=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${g}, ${x}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${$} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?o?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const C=Math.floor(i/4)*4,S=i%4,I=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${g}, ${x}, ${y});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${C}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${I}
            }

            int xC = xCCorner + ${C};
            if (${S===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${S===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${S===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${I}
            }
          }
        }
        setOutput(${k});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function llt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;Nf(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(vn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=sr(r.shape,o,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Ht(u.inShape,u.outShape))return ms({inputs:{x:r},backend:n});const d=new Xd(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const clt={kernelName:qg,backendName:"webgl",kernelFunc:llt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ult(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],d=Uo(r.shape,o,i,u,a,l,c),h=new JC(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const dlt={kernelName:Yg,backendName:"webgl",kernelFunc:ult};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hlt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,u=l-1-t.padInfo.top,d=c-1-t.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class flt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,s=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,d=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=d-1-t.padInfo.front,m=h-1-t.padInfo.top,g=f-1-t.padInfo.left,x=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function plt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,i=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=Uo(i.shape,a,l,d,c,u),f=new flt(h);return n.runWebGLProgram(f,[r],i.dtype)}const mlt={kernelName:bw,backendName:"webgl",kernelFunc:plt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function glt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,i=o;Nf([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=sr(i.shape,a,l,1,c),d=new hlt(u);return n.runWebGLProgram(d,[r],i.dtype)}const xlt={kernelName:yw,backendName:"webgl",kernelFunc:glt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ylt(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:o}=t,{transposeA:i,transposeB:a}=s;return ag({a:r,b:o,transposeA:i,transposeB:a,backend:n})}const blt={kernelName:Qg,backendName:"webgl",kernelFunc:ylt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vlt{constructor(t,n,s,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],$t(t,n),$t(t,s);let a="0.0";r!=null&&($t(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&($t(t,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wlt{constructor(t,n,s,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],$t(t,n),$t(t,s);let a="vec4(0.0)";r!=null&&($t(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&($t(t,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const klt=({inputs:e,backend:t,attrs:n})=>{const{x:s,mean:r,variance:o,offset:i,scale:a}=e;T(r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,o];let u=null;i!=null&&(u=i.shape,c.push(i));let d=null;a!=null&&(d=a.shape,c.push(a));const h=K().getBool("WEBGL_PACK_NORMALIZATION")?new wlt(s.shape,r.shape,o.shape,u,d,l):new vlt(s.shape,r.shape,o.shape,u,d,l);return t.runWebGLProgram(h,c,c[0].dtype)},Clt={kernelName:cx,backendName:"webgl",kernelFunc:klt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Slt{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=te(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Ilt(this.rank);let r;const o=t.map((i,a)=>`sourceLoc.${T1[a]} = start[${a}] + coords.${T1[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const T1=["x","y","z","w","u","v"];function Ilt(e){if(e===1)return"sourceLoc";if(e<=6)return T1.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $lt{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=te(this.rank),s=Dn("coords",this.rank),r=Dn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${t[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((u,d)=>`start[${d}]`).join()});`:t.map((u,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tlt(e,t,n,s){const r=s.texData.get(e.dataId),o=s.makeTensorInfo(n,e.dtype),i=s.texData.get(o.dataId);Object.assign(i,r),i.refCount=1,i.shape=n,i.dtype=e.dtype;let a=Kk(t,yt(e.shape));r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||e.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),o}function mu(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:o,size:i}=s,[a,l]=e0(r,o,i);if(jk(r,a,l),Y(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=bit(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:c}=n.texData.get(r.dataId),u=Hk(r.shape,a,l);if(c||!u){const d=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $lt(l):new Slt(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),Tlt(r,a,l,n)}const Nlt={kernelName:Lx,backendName:"webgl",kernelFunc:mu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Elt=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:o,crops:i}=s;T(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((y,b)=>y*b),l=mf(r.shape,o,a),c=gf(l.length,o.length),u=xf(r.shape,o,a),d=Zk(i,o.length),h=Jk(u,i,o.length),f=[],p=at({inputs:{x:r},backend:n,attrs:{shape:l}}),m=Mn({inputs:{x:p},backend:n,attrs:{perm:c}}),g=at({inputs:{x:m},backend:n,attrs:{shape:u}}),x=mu({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(g),f.forEach(y=>n.disposeIntermediateTensorInfo(y)),x},_lt={kernelName:Zg,backendName:"webgl",kernelFunc:Elt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rlt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:o}=t,{size:i}=s,a=n.readSync(r.dataId),l=n.readSync(o.dataId),c=IL(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}const Dlt={kernelName:vw,backendName:"webgl",kernelFunc:Rlt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Alt=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Olt=`
  return float(int(a.r) & int(b.r));
`;function Flt(e){const{inputs:t,backend:n}=e,{a:s,b:r}=t,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=K().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||i===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,d]=Uot(s.shape,r.shape,l,c,s.dtype),h=n.makeTensorInfo(d,s.dtype),f=n.texData.get(h.dataId);return f.values=u,h}let a;return o?a=new fu(Alt,s.shape,r.shape,!1):a=new dl(Olt,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const Plt={kernelName:ww,backendName:"webgl",kernelFunc:Flt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mlt(e){const{inputs:t,backend:n}=e,{s0:s,s1:r}=t,o=n.readSync(s.dataId),i=n.readSync(r.dataId),a=$t(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Llt={kernelName:ND,backendName:"webgl",kernelFunc:Mlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zlt="return float(a != b);",zL=fn({opSnippet:zlt,cpuKernelImpl:uit,dtype:"bool"}),Blt={kernelName:$x,backendName:"webgl",kernelFunc:zL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _f(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.texData.get(s.dataId);return ms({inputs:{x:r.complexTensorInfos.real},backend:n})}const Vlt={kernelName:Hw,backendName:"webgl",kernelFunc:_f};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wlt="return float(int(x));";function Ult(e,t){const n=new Hr(e.shape,Wlt),s=t.runWebGLProgram(n,[e],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return ms({inputs:{x:r},backend:n});const i=Je(r.shape),a=N1({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=la({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const i=_f({inputs:{input:r},backend:n}),a=N1({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!CD(r.dtype,o)){const i=ms({inputs:{x:r},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId).values,[a,l,c]=jot(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,c)}if(o==="int32")return Ult(r,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",xn("bool",1)),l=zL({inputs:{a:r,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}const jlt={kernelName:wh,backendName:"webgl",kernelFunc:N1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$="return ceil(x);",Glt=zt({opSnippet:A$,packedOpSnippet:A$,cpuKernelImpl:Got}),Hlt={kernelName:kh,backendName:"webgl",kernelFunc:Glt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Klt{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xlt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qlt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{clipValueMin:o,clipValueMax:i}=s;let a;K().getBool("WEBGL_PACK_CLIP")?a=new Xlt(r.shape):a=new Klt(r.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[r],r.dtype,l)}const Ylt={kernelName:Ch,backendName:"webgl",kernelFunc:qlt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qlt{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function Zlt(e){const{inputs:t,backend:n}=e,{x:s}=t,r=n.texData.get(s.dataId),o=new Qlt(s.shape),i=[O$(s,r.complexTensorInfos.real),O$(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const Jlt={kernelName:Jg,backendName:"webgl",kernelFunc:Zlt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tct{constructor(t){this.outputShape=[],this.outputShape=Zr(t,1),this.variableNames=t.map((i,a)=>`T${a}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+t[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const r=n.length,o=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ect{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Zr(t,n);const s=this.outputShape,r=s.length,o=te(r),i=Dn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((m,g)=>`T${g}`);const l=new Array(t.length-1);l[0]=t[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+t[m][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];h+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${gp(a,c,g)}),
            vec2(${gp(u,c,g)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${gp(a,c,p)}),
          vec2(${gp(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function gp(e,t,n){const s=e.indexOf(t);return e.map((o,i)=>i===s?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.texData.get(s.dataId);return ms({inputs:{x:r.complexTensorInfos.imag},backend:n})}const nct={kernelName:Lw,backendName:"webgl",kernelFunc:w0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hu(e,t,n){const s=e[0].dtype;if(s==="complex64"){const f=e.map(y=>_f({inputs:{input:y},backend:n})),p=e.map(y=>w0({inputs:{input:y},backend:n})),m=Hu(f,t,n),g=Hu(p,t,n),x=la({inputs:{real:m,imag:g},backend:n});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),p.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}let r=n.shouldExecuteOnCPU(e);if(s==="string"&&(r=!0),r){const f=e.map(v=>{const k=[-1,Y(v.shape.slice(t))];return at({inputs:{x:v},backend:n,attrs:{shape:k}})}),p=f.map(v=>({vals:n.readSync(v.dataId),shape:v.shape})),m=Zr(f.map(v=>v.shape),1),g=f[0].shape[0]===1,x=Hot(p,m,s,g),y=Zr(e.map(v=>v.shape),t),b=n.makeTensorInfo(y,s,x);return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const o=e.filter(f=>Y(f.shape)>0),i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const f=i?new Hr(e[0].shape,ai):new bi(e[0].shape,ai);return n.runWebGLProgram(f,e,s)}const a=K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const f=[];for(let m=0;m<o.length;m+=a){const g=o.slice(m,m+a);f.push(Hu(g,t,n))}const p=Hu(f,t,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(i){const f=new ect(o.map(p=>p.shape),t);return n.runWebGLProgram(f,o,s)}const{tensors2D:l,outShape:c}=sct(o,t,n),u=new tct(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=at({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function sct(e,t,n){const s=Zr(e.map(o=>o.shape),t);return{tensors2D:e.map(o=>at({inputs:{x:o},attrs:{shape:[-1,Y(o.shape.slice(t))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BL(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s,o=Rt(r,t[0].shape)[0],i=t.map(c=>c.shape);qk(i,o);const a=Zr(t.map(c=>c.shape),o);if(Y(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);const l=t.filter(c=>Y(c.shape)>0);return l.length===1?ms({inputs:{x:l[0]},backend:n}):Hu(l,o,n)}const rct={kernelName:tx,backendName:"webgl",kernelFunc:BL};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VL{constructor(t,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.padInfo.top,a=t.padInfo.left,l=t.strideHeight,c=t.strideWidth,u=t.dilationHeight,d=t.dilationWidth,h=t.filterHeight,f=t.filterWidth,p=Math.floor(t.inChannels/4)*4,m=t.inChannels%4,g=t.dataFormat==="channelsLast",x=g?1:2,y=g?2:3,b=g?3:1;let v="",w="";s&&(r?v=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?v=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:v=`
          float activation(float x) {
            ${s}
          }
        `,w="result = activation(result);");const k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${w}
        setOutput(result);
      }
    `}}class oct{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,s=t.padInfo.top,r=t.padInfo.left,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,d=t.filterDepth,h=t.filterHeight,f=t.filterWidth,p=Math.floor(t.inChannels/4)*4,m=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WL{constructor(t,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=kn(this.outputShape.length);const i=t.padInfo.left,a=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,u=t.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)h+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let g=0;g<u;g++)h+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(d+1)/2;g++){const x=g*2;if(h+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<u&&(i%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?h+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<u)){const y=i%2===0?dw(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:h+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):y===1?h+=`
                     xC${x+1} = xTexelC${x};
                     `:h+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<u&&(i%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<u&&(h+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<u&&(h+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<u&&(h+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:o?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ict{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=kn(this.outputShape.length);const{dataFormat:s}=n,r=Bn(),o=s==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lg(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function UL({x:e,filter:t,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=e.shape,c=s.texData.get(e.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let g;const x=[];if(o!=null){const v=lg(o.shape,f);v!=null&&(o=at({inputs:{x:o},backend:s,attrs:{shape:v}}),x.push(o))}if(r!=null){const v=lg(r.shape,f);v!=null&&(r=at({inputs:{x:r},backend:s,attrs:{shape:v}}),x.push(r))}if(!((d===1||h===1)&&u>FL)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Ht(c.shape.slice(-3),l.slice(-3))){const v=l[0]*l[1]*(l[2]+1),w={dataId:e.dataId,shape:[1,v,n.inChannels],dtype:e.dtype},k=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,T(ig(c.shape,w.shape),()=>`packed reshape ${c.shape} to ${w.shape} isn't free`);const C=at({inputs:{x:t},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(C);const S=ag({a:w,b:C,backend:s,transposeA:p,transposeB:m,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),I=s.texData.get(S.dataId);T(I.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=k,I.shape=n.outShape,g=ms({inputs:{x:S},backend:s}),g.shape=n.outShape,x.push(S)}else{const v=n.outHeight*n.outWidth,w=at({inputs:{x:e},backend:s,attrs:{shape:f?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),k=at({inputs:{x:t},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=ag({a:f?w:k,b:f?k:w,transposeA:!f,transposeB:m,backend:s,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i});g=at({inputs:{x:C},backend:s,attrs:{shape:n.outShape}}),x.push(w),x.push(k),x.push(C)}for(const v of x)s.disposeIntermediateTensorInfo(v);return g}function jL({x:e,filter:t,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,g=h*d,x=[n.batchSize,m,g],y=!0,b=!1,v=[];if(o!=null){const R=lg(o.shape,p);R!=null&&(o=at({inputs:{x:o},backend:s,attrs:{shape:R}}),v.push(o))}if(r!=null){const R=lg(r.shape,p);R!=null&&(r=at({inputs:{x:r},backend:s,attrs:{shape:R}}),v.push(r))}const w=at({inputs:{x:t},backend:s,attrs:{shape:[1,m,Y(t.shape)/m]}});v.push(w);const k=new ict(x,n),C=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],S=s.runWebGLProgram(k,[e],"float32",C),I=at({inputs:{x:S},backend:s,attrs:{shape:x}});v.push(S),v.push(I);const $=r!=null,E=o!=null,A=a==="leakyrelu",L=a?Kd(a,!0):null,O=new OL(p?I.shape:w.shape,p?w.shape:I.shape,p?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],y,b,$,L,E,A),P=p?[I,w]:[w,I];if(r&&P.push(r),E&&P.push(o),A){const R=s.makeTensorInfo([],"float32",ea(i,"float32"));P.push(R),v.push(R)}const M=s.runWebGLProgram(O,P,"float32"),U=at({inputs:{x:M},backend:s,attrs:{shape:n.outShape}});v.push(M);for(const R of v)s.disposeIntermediateTensorInfo(R);return U}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function act(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,d=jo(l),h=dn(r.shape,o.shape,i,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=UL({x:r,filter:o,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const m=new WL(h),g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[r,o],"float32",g)}else if(K().getBool("WEBGL_CONV_IM2COL"))f=jL({x:r,filter:o,convInfo:h,backend:n});else{const m=new VL(h);f=n.runWebGLProgram(m,[r,o],"float32")}const p=at({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const lct={kernelName:ex,backendName:"webgl",kernelFunc:act};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cct{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,s=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class uct{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dataFormat==="channelsLast",a=n-1-t.padInfo.top,l=s-1-t.padInfo.left,c=i?1:2,u=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class dct{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,s=t.strideHeight,r=t.strideWidth,o=t.padInfo.front,i=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class hct{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,s=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,l=n-1-t.padInfo.front,c=s-1-t.padInfo.top,u=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,d=jo(l),h=dn(r.shape,u,i,1,a,c,!1,d),f=new cct(h);return n.runWebGLProgram(f,[r,o],"float32")}const pct={kernelName:Cw,backendName:"webgl",kernelFunc:fct};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mct{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=kn(this.outputShape.length);const n=t.filterHeight,s=t.filterWidth,r=n-1-t.padInfo.top,o=s-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gct(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=jo(c),h=dn(i,o.shape,a,1,l,u,!1,d);if(K().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],p=new mct(h);return n.runWebGLProgram(p,[r,o],"float32",f)}else{const f=new uct(h);return n.runWebGLProgram(f,[r,o],"float32")}}const xct={kernelName:nx,backendName:"webgl",kernelFunc:gct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:i,pad:a,dilations:l}=s,c=na(r.shape,o.shape,i,l,a),u=new oct(c);return n.runWebGLProgram(u,[r,o],"float32")}const bct={kernelName:sx,backendName:"webgl",kernelFunc:yct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:i,pad:a,filterShape:l}=s,c=na(r.shape,l,i,1,a),u=new dct(c);return n.runWebGLProgram(u,[r,o],"float32")}const wct={kernelName:Sw,backendName:"webgl",kernelFunc:vct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kct(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{pad:i,strides:a,inputShape:l}=s,c=na(l,o.shape,a,1,i),u=new hct(c);return n.runWebGLProgram(u,[r,o],"float32")}const Cct={kernelName:Iw,backendName:"webgl",kernelFunc:kct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sct=pu+`
  return cos(x);
`,Ict=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${$l}
  return result;
`,$ct=zt({opSnippet:Sct,packedOpSnippet:Ict}),Tct={kernelName:Sh,backendName:"webgl",kernelFunc:$ct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nct=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Ect=zt({opSnippet:Nct}),_ct={kernelName:Ih,backendName:"webgl",kernelFunc:Ect};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rct{constructor(t,n,s,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,c]=t,[u]=n,[d,h]=s;this.outputShape=[u,d,h,c];const f=r==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[g,x,y]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,v,w]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${v};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dct=e=>{const{inputs:t,backend:n,attrs:s}=e,{image:r,boxes:o,boxInd:i}=t,{cropSize:a,method:l,extrapolationValue:c}=s,u=new Rct(r.shape,o.shape,a,l,c);return n.runWebGLProgram(u,[r,o,i],"float32")},Act={kernelName:Tw,backendName:"webgl",kernelFunc:Dct};var qd;(function(e){e.Prod="*",e.Sum="+"})(qd||(qd={}));class F${constructor(t,n,s,r){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===qd.Prod?"1.0":"0.0",a=s?i:`getX(${P$(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${te(o)} coords = getOutputCoords();
        int end = ${M$(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${M$(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${P$(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function P$(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function M$(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GL(e,t,n,s,r,o){const i=t.shape.length,a=Ie([s],i);let l=t;a!=null&&(l=Mn({inputs:{x:t},backend:n,attrs:{perm:a}}));const c=Pe(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${s}`);const u=l.shape[c];let d=ms({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new F$(e,l.shape,!1,o),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(r){const h=new F$(e,l.shape,r,o),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=sa(a),f=Mn({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,exclusive:i,reverse:a}=s;return GL(qd.Prod,r,n,o,i,a)}const Fct={kernelName:$w,backendName:"webgl",kernelFunc:Oct};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,exclusive:i,reverse:a}=s;return GL(qd.Sum,r,n,o,i,a)}const Mct={kernelName:rx,backendName:"webgl",kernelFunc:Pct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:o}=t,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(o.dataId),u=IL(l,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(o),u=Wot(l,c,i,a);return n.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const zct={kernelName:Nw,backendName:"webgl",kernelFunc:Lct};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bct{constructor(t,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockSize:o,dataFormat:i}=s,a=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],c=i==="NHWC"?r.shape[2]:r.shape[3],u=i==="NHWC"?r.shape[3]:r.shape[1],d=l*o,h=c*o,f=u/(o*o),p=i==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new Bct(p,o,i);return n.runWebGLProgram(m,[r],r.dtype)}const Wct={kernelName:Ew,backendName:"webgl",kernelFunc:Vct};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HL{constructor(t,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=kn(this.outputShape.length);const i=t.filterHeight,a=t.filterWidth,l=t.outChannels/t.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KL{constructor(t,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=kn(this.outputShape.length);const i=t.outChannels/t.inChannels,a=t.padInfo.left,l=t.strideWidth,c=t.dilationWidth,u=t.filterHeight,d=t.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<d;x++)f+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let x=0;x<d;x++)f+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(h+1)/2;x++){const y=x*2;if(f+=`
          xC = xCCorner + ${y*c};
          `,l===1){if(y<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,c===1&&y>0?f+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<d)){const b=a%2===0?dw(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:f+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?f+=`
                    xC${y+1} = xTexelC${y};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<d&&(f+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<d&&(f+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<d&&(f+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),T(vn(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=dn(r.shape,o.shape,i,u,a,c,!0);let h;K().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new KL(d):h=new HL(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,o],"float32",f)}const jct={kernelName:ox,backendName:"webgl",kernelFunc:Uct};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gct{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,s=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Hct{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=n-1-t.padInfo.top,a=s-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kct(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,d=dn(r.shape,u,i,a,l,c,!0),h=new Gct(d);return n.runWebGLProgram(h,[r,o],"float32")}const Xct={kernelName:_w,backendName:"webgl",kernelFunc:Kct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qct(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,d=dn(u,o.shape,i,a,l,c,!0),h=new Hct(d);return n.runWebGLProgram(h,[r,o],"float32")}const Yct={kernelName:Rw,backendName:"webgl",kernelFunc:qct};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qct{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zct(e){const{inputs:t,backend:n}=e,{x:s}=t,r=[...s.shape,...s.shape],o=Y(s.shape),i=at({inputs:{x:s},backend:n,attrs:{shape:[o]}}),a=new Qct(o),l=n.runWebGLProgram(a,[i],i.dtype),c=at({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}const Jct={kernelName:ED,backendName:"webgl",kernelFunc:Zct};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tut{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=t,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eut(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:i,pad:a,dilations:l}=s,c=uf(r.shape,o.shape,i,a,"NHWC",l);let u;const d=new tut(c);u=n.runWebGLProgram(d,[r,o],"float32");const h=at({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const nut={kernelName:ix,backendName:"webgl",kernelFunc:eut};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sut(e){const{inputs:t,backend:n,attrs:s}=e,{equation:r}=s,o=t,{allDims:i,summedDims:a,idDims:l}=aC(r,o.length);cC(i.length,l,o);const{path:c,steps:u}=uC(a,l),d=u.length;let h=null,f=i.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:x,expandDims:y}=lC(f,l[g]);let b;dC(x)?b=o[g]:(b=Mn({inputs:{x:o[g]},backend:n,attrs:{perm:x}}),p.push(b));const v=b.shape.slice();for(let w=0;w<y.length;++w)v.splice(y[w],0,1);Ht(b.shape,v)||(b=at({inputs:{x:b},backend:n,attrs:{shape:v}}),p.push(b)),h===null?h=b:(h=ZC({inputs:{a:b,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=v0({inputs:{x:h},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const rut={kernelName:Dw,backendName:"webgl",kernelFunc:sut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const out="return (x >= 0.0) ? x : (exp(x) - 1.0);",iut=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,aut=zt({opSnippet:out,packedOpSnippet:iut}),lut={kernelName:Th,backendName:"webgl",kernelFunc:aut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cut="return (b >= 0.0) ? a : a * (b + 1.0);",uut=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,dut=e=>{const{inputs:t,backend:n}=e,{dy:s,y:r}=t,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fu(uut,s.shape,r.shape):new dl(cut,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],s.dtype)},hut={kernelName:Aw,backendName:"webgl",kernelFunc:dut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fut=`
  return vec4(equal(a, b));
`,put="return float(a == b);",mut=fn({opSnippet:put,packedOpSnippet:fut,dtype:"bool",cpuKernelImpl:Kot}),gut={kernelName:ax,backendName:"webgl",kernelFunc:mut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xut=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${tC};
  float a1 = ${eC};
  float a2 = ${nC};
  float a3 = ${sC};
  float a4 = ${rC};
  float a5 = ${oC};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,yut=zt({opSnippet:xut}),but={kernelName:Nh,backendName:"webgl",kernelFunc:yut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vut=pu+`
  return exp(x);
`,wut=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XL=zt({opSnippet:vut,packedOpSnippet:wut,cpuKernelImpl:Xot,dtype:"float32"}),kut={kernelName:Eh,backendName:"webgl",kernelFunc:XL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E1(e){const{inputs:t,attrs:n,backend:s}=e,{dim:r}=n,{input:o}=t,i=o.shape.length,a=o.shape.slice();let l=r;return r<0&&(T(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),a.splice(l,0,1),at({inputs:{x:o},backend:s,attrs:{shape:a}})}const Cut={kernelName:lx,backendName:"webgl",kernelFunc:E1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L$="return exp(x) - 1.0;",Sut=zt({opSnippet:L$,packedOpSnippet:L$,cpuKernelImpl:qot}),Iut={kernelName:_h,backendName:"webgl",kernelFunc:Sut};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z${constructor(t,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const o=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let a;if(t==="real")a="return real * expR - imag * expI;";else if(t==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(e,t,n){const s=n.texData.get(e.dataId),r=Y(e.shape),o=e.shape[e.shape.length-1],i=r/o,a=at({inputs:{x:e},backend:n,attrs:{shape:[i,o]}}),l=a.shape,c=new z$("real",l,t),u=new z$("imag",l,t),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=la({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=at({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ut(e){const{inputs:t,backend:n}=e,{input:s}=t;return qL(s,!1,n)}const Tut={kernelName:Ow,backendName:"webgl",kernelFunc:$ut};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nut{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rf(e){const{backend:t,attrs:n}=e,{shape:s,value:r}=n;let{dtype:o}=n;if(o=o||Jc(r),o==="string"){const i=De(o,Y(s));return i.fill(r),t.makeTensorInfo(s,o,i)}else{const i=new Nut(s,r),a=[[r]];return t.runWebGLProgram(i,[],o,a)}}const Eut={kernelName:Fw,backendName:"webgl",kernelFunc:Rf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ut{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rut={kernelName:Pw,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:n}=e,s=t,r=new _ut(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B$="return floor(x);",Dut=zt({opSnippet:B$,packedOpSnippet:B$,cpuKernelImpl:Yot}),Aut={kernelName:Rh,backendName:"webgl",kernelFunc:Dut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Out=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Fut=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Put=fn({opSnippet:Out,packedOpSnippet:Fut,dtype:"int32"}),Mut={kernelName:Dh,backendName:"webgl",kernelFunc:Put};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lut{constructor(t){this.variableNames=["A"];const n=Bn(),[s,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zut{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Bn(),[s,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const But={kernelName:MG,backendName:"webgl",kernelFunc:Vut};let Rl,Ey=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Vut(e){const{inputs:t,backend:n,attrs:s}=e;let{pixels:r}=t;const{numChannels:o}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,o];if(a||i){const m=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Rl==null||m!==Ey)&&(Ey=m,Rl=document.createElement("canvas").getContext("2d",{willReadFrequently:Ey})),Rl.canvas.width=l,Rl.canvas.height=c,Rl.drawImage(r,0,0,l,c),r=Rl.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=Is.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const f=K().getBool("WEBGL_PACK")?new zut(d):new Lut(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wut(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o,bias:i,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s,m=jo(u),g=dn(r.shape,o.shape,l,d,c,h,!1,m);let x;const y=[],b=i!=null,v=a!=null,w=f==="leakyrelu",k=()=>{const S=[r,o],I=($,E)=>{if(E==="NCHW"&&$.shape.length===1&&$.shape[0]!==1){const A=at({inputs:{x:$},backend:n,attrs:{shape:[$.shape[0],1,1]}});return y.push(A),A}return $};if(b&&S.push(I(i,u)),v&&S.push(I(a,u)),w){const $=n.makeTensorInfo([],"float32",ea(p,"float32"));S.push($),y.push($)}return S};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))x=UL({x:r,filter:o,convInfo:g,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const S=f?Kd(f,!0):null,I=new WL(g,b,S,v,w),$=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],E=k();x=n.runWebGLProgram(I,E,"float32",$)}else if(K().getBool("WEBGL_CONV_IM2COL"))x=jL({x:r,filter:o,convInfo:g,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const S=f?Kd(f,!1):null,I=new VL(g,b,S,v,w),$=k();x=n.runWebGLProgram(I,$,"float32")}const C=at({inputs:{x},backend:n,attrs:{shape:g.outShape}});return y.push(x),y.forEach(S=>n.disposeIntermediateTensorInfo(S)),C}const Uut={kernelName:Mm,backendName:"webgl",kernelFunc:Wut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jut(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o,bias:i,preluActivationWeights:a}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=s,p=[];let m=u;m==null&&(m=[1,1]),T(vn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=dn(r.shape,o.shape,l,m,c,d,!0),x=K().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,y=h?Kd(h,x):null,b=[r,o],v=i!=null,w=a!=null,k=h==="leakyrelu";if(v&&b.push(i),w&&b.push(a),k){const $=n.makeTensorInfo([],"float32",ea(f,"float32"));b.push($),p.push($)}let C;x?C=new KL(g,v,y,w,k):C=new HL(g,v,y,w,k);const S=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],I=n.runWebGLProgram(C,b,"float32",S);return p.forEach($=>n.disposeIntermediateTensorInfo($)),I}const Gut={kernelName:XD,backendName:"webgl",kernelFunc:jut};class Hut{constructor(t,n,s,r){this.sliceDim=t,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const o=te(s.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kut(e){const{inputs:t,backend:n}=e,{params:s,indices:r}=t,o=r.shape,i=o[o.length-1],a=Y(s.shape),[l,c,u,d]=Uk(s,r),h=at({inputs:{x:r},backend:n,attrs:{shape:[c,i]}}),f=at({inputs:{x:s},backend:n,attrs:{shape:[Y(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const x=n.readSync(r.dataId),y=n.bufferSync(s),b=Qot(x,y,s.dtype,c,i,u,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,b.values)}const p=new Hut(i,d,[c,u],s.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),g=at({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const Xut={kernelName:_D,backendName:"webgl",kernelFunc:Kut};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qut{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=te(this.rank),r=Yut(t);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function Yut(e,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<e.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YL(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,indices:o}=t,{axis:i,batchDims:a}=s,l=Rt(i,r.shape)[0];if(K().get("DEBUG")){const y=n.readSync(o.dataId),b=r.shape[l];for(let v=0;v<y.length;++v){const w=y[v];T(w<=b-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${b-1}]`)}}const c=fC(r,o,l,a),u=Y(o.shape),d=[],h=at({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=at({inputs:{x:o},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const y=n.bufferSync(f),b=n.bufferSync(h),v=Zot(b,y,p);return d.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(c.outputShape,v.dtype,v.values)}const m=new qut(h.shape,p),g=n.runWebGLProgram(m,[h,f],h.dtype);d.push(g);const x=at({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const Qut={kernelName:ux,backendName:"webgl",kernelFunc:YL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zut="return float(a > b);",Jut=`
  return vec4(greaterThan(a, b));
`,tdt=fn({opSnippet:Zut,packedOpSnippet:Jut,cpuKernelImpl:Jot,dtype:"bool"}),edt={kernelName:dx,backendName:"webgl",kernelFunc:tdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ndt="return float(a >= b);",sdt=`
  return vec4(greaterThanEqual(a, b));
`,rdt=fn({opSnippet:ndt,packedOpSnippet:sdt,dtype:"bool",cpuKernelImpl:tit}),odt={kernelName:Ah,backendName:"webgl",kernelFunc:rdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function idt(e){const{inputs:t,backend:n}=e,{input:s}=t;return qL(s,!0,n)}const adt={kernelName:Mw,backendName:"webgl",kernelFunc:idt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ldt="return float(!isnan(x) && !isinf(x));",cdt=zt({opSnippet:ldt,dtype:"bool"}),udt={kernelName:Fh,backendName:"webgl",kernelFunc:cdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ddt="return float(isinf(x));",hdt=zt({opSnippet:ddt,dtype:"bool"}),fdt={kernelName:Ph,backendName:"webgl",kernelFunc:hdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pdt="return float(isnan(x));",mdt=zt({opSnippet:pdt,dtype:"bool"}),gdt={kernelName:Mh,backendName:"webgl",kernelFunc:mdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xdt="return float(a < b);",ydt=`
  return vec4(lessThan(a, b));
`,bdt=fn({opSnippet:xdt,packedOpSnippet:ydt,cpuKernelImpl:eit,dtype:"bool"}),vdt={kernelName:fx,backendName:"webgl",kernelFunc:bdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wdt="return float(a <= b);",kdt=`
  return vec4(lessThanEqual(a, b));
`,Cdt=fn({opSnippet:wdt,packedOpSnippet:kdt,cpuKernelImpl:nit,dtype:"bool"}),Sdt={kernelName:px,backendName:"webgl",kernelFunc:Cdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Idt(e){const{backend:t,attrs:n}=e,{start:s,stop:r,num:o}=n,i=sit(s,r,o);return t.makeTensorInfo([i.length],"float32",i)}const $dt={kernelName:RD,backendName:"webgl",kernelFunc:Idt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tdt=pu+`
  return x < 0.0 ? 0./0. : log(x);
`,Ndt=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Edt=zt({opSnippet:Tdt,packedOpSnippet:Ndt,cpuKernelImpl:rit}),_dt={kernelName:Lh,backendName:"webgl",kernelFunc:Edt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rdt=pu+`
  return log(1.0 + x);
`,Ddt=zt({opSnippet:Rdt}),Adt={kernelName:zh,backendName:"webgl",kernelFunc:Ddt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Odt="return float(a >= 1.0 && b >= 1.0);",Fdt=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Pdt=fn({opSnippet:Odt,packedOpSnippet:Fdt,dtype:"bool"}),Mdt={kernelName:mx,backendName:"webgl",kernelFunc:Pdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ldt="return float(!(x >= 1.0));",zdt=zt({opSnippet:Ldt}),Bdt={kernelName:gx,backendName:"webgl",kernelFunc:zdt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vdt="return float(a >= 1.0 || b >= 1.0);",Wdt=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Udt=fn({opSnippet:Vdt,packedOpSnippet:Wdt,dtype:"bool"}),jdt={kernelName:xx,backendName:"webgl",kernelFunc:Udt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gdt{constructor(t,n,s,r,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=t[3]-1;this.outputShape=t;let l;const c=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hdt{constructor(t,n,s,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=t[3]-1;this.outputShape=t;let l;const c=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kdt=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{depthRadius:o,bias:i,alpha:a,beta:l}=s,c=K().getBool("WEBGL_PACK_NORMALIZATION")?new Hdt(r.shape,o,i,a,l):new Gdt(r.shape,o,i,a,l);return n.runWebGLProgram(c,[r],r.dtype)},Xdt={kernelName:yx,backendName:"webgl",kernelFunc:Kdt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qdt{constructor(t,n,s,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ydt=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r,y:o,dy:i}=t,{depthRadius:a,bias:l,alpha:c,beta:u}=s,d=new qdt(r.shape,a,l,c,u);return n.runWebGLProgram(d,[r,o,i],r.dtype)},Qdt={kernelName:zw,backendName:"webgl",kernelFunc:Ydt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zdt(e,t,n,s){const r=Y(t),i=Y(e.shape)/r,a=at({inputs:{x:e},attrs:{shape:[i,r]},backend:s}),l=Tl(a,e.dtype,"max",s),c=at({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QL(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reductionIndices:o,keepDims:i}=s,a=r.shape.length,l=Rt(o,r.shape);let c=l;const u=Ie(c,a),d=u!=null,h=n.shouldExecuteOnCPU([r]);let f=r;if(d){if(h){const b=n.texData.get(f.dataId).values,v=new Array(a);for(let C=0;C<v.length;C++)v[C]=r.shape[u[C]];const w=YC(b,r.shape,r.dtype,u,v);f=n.makeTensorInfo(v,r.dtype);const k=n.texData.get(f.dataId);k.values=w}else f=b0(r,u,n);c=Pe(c.length,a)}hn("max",c,a);const[p,m]=sn(f.shape,c);let g=p;i&&(g=Fe(p,l));let x;if(h){const b=n.texData.get(f.dataId).values,v=oit(b,Y(m),g,r.dtype);x=n.makeTensorInfo(g,r.dtype);const w=n.texData.get(x.dataId);w.values=v}else x=Zdt(f,m,g,n);return d&&n.disposeIntermediateTensorInfo(f),x}const Jdt={kernelName:bx,backendName:"webgl",kernelFunc:QL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tht=QC+`
  return max(a, b);
`,eht=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+$l+`
  return result;
`,nht=fn({opSnippet:tht,packedOpSnippet:eht,cpuKernelImpl:iit}),sht={kernelName:Bh,backendName:"webgl",kernelFunc:nht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rht(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;Nf(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(vn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=sr(r.shape,o,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Ht(u.inShape,u.outShape))return ms({inputs:{x:r},backend:n});const d=new Xd(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const oht={kernelName:vx,backendName:"webgl",kernelFunc:rht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iht(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],d=Uo(r.shape,o,i,u,a,c,l),h=new JC(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const aht={kernelName:wx,backendName:"webgl",kernelFunc:iht};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lht{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,s=t.strideWidth,r=t.dilationHeight,o=t.effectiveFilterHeight,i=t.effectiveFilterWidth,a=o-1-t.padInfo.top,l=i-1-t.padInfo.left,c=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class cht{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,s=t.strideHeight,r=t.strideWidth,o=t.dilationDepth,i=t.dilationHeight,a=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,u=t.effectiveFilterWidth,d=l-1-t.padInfo.front,h=c-1-t.padInfo.top,f=u-1-t.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uht(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,i=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=Uo(i.shape,a,l,d,c,u),f=new JC(h,"max",!0),p=n.runWebGLProgram(f,[i],i.dtype),m=new cht(h),g=n.runWebGLProgram(m,[r,p],i.dtype);return n.disposeIntermediateTensorInfo(p),g}const dht={kernelName:Vw,backendName:"webgl",kernelFunc:uht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hht(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o,output:i}=t,a=o;Nf([o,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=sr(a.shape,l,c,1,u,d),f=!0,p=new Xd(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),g=new lht(h),x=n.runWebGLProgram(g,[r,m],a.dtype);return n.disposeIntermediateTensorInfo(m),x}const fht={kernelName:Bw,backendName:"webgl",kernelFunc:hht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pht(e,t,n,s){let r=new Xd(n,"max",!1);const o=s.runWebGLProgram(r,[e],"float32");r=new Xd(n,"max",!0,!0,t);const i=s.runWebGLProgram(r,[e],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mht={kernelName:DD,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:s}=e,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=t,l=n;T(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];T(vn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=sr(s.shape,r,o,c,i),[d,h]=pht(s,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ght(e,t,n,s){const r=Y(t),i=Y(e.shape)/r,a=at({inputs:{x:e},attrs:{shape:[i,r]},backend:s}),l=Tl(a,"float32","mean",s),c=at({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xht={kernelName:kx,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:s}=e,{keepDims:r,axis:o}=t,i=n,a=s.shape.length,l=Rt(o,s.shape);let c=l;const u=Ie(c,a),d=u!=null,h=i.shouldExecuteOnCPU([s]),f=[];let p=s;if(d){if(h){const v=i.texData.get(p.dataId).values,w=new Array(a);for(let S=0;S<w.length;S++)w[S]=s.shape[u[S]];const k=YC(v,s.shape,s.dtype,u,w);p=i.makeTensorInfo(w,s.dtype);const C=i.texData.get(p.dataId);C.values=k}else p=b0(s,u,i);f.push(p),c=Pe(c.length,a)}hn("sum",c,a);const[m,g]=sn(p.shape,c);let x=m;r&&(x=Fe(m,l));const y=ght(p,g,x,i);for(const b of f)i.disposeIntermediateTensorInfo(b);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yht(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s,a=r.shape.length,l=Rt(o,r.shape);let c=l;const u=Ie(c,a);let d=r;u!=null&&(d=Mn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Pe(c.length,r.shape.length)),hn("min",c,a);const[h,f]=sn(d.shape,c),p=Y(f),m=at({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Tl(m,m.dtype,"min",n);let x;if(i){const y=Fe(h,l);x=at({inputs:{x:g},backend:n,attrs:{shape:y}})}else x=at({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),x}const bht={kernelName:Cx,backendName:"webgl",kernelFunc:yht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vht=QC+`
  return min(a, b);
`,wht=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+$l+`
  return result;
`,kht=fn({opSnippet:vht,packedOpSnippet:wht,cpuKernelImpl:ait}),Cht={kernelName:Vh,backendName:"webgl",kernelFunc:kht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sht{constructor(t,n,s){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+t[d]+u[1]);const r=t.length,o=te(r),i=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+t[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iht{constructor(t,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+t[m]+p[1]);const r=t.length,o=te(r),i=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+t[m]).join(","),l=Dn("rc",r),c=Dn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ht=({inputs:e,backend:t,attrs:n})=>{const{x:s}=e,{paddings:r,mode:o}=n,i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Iht(s.shape,r,o):new Sht(s.shape,r,o);return t.runWebGLProgram(i,[s],s.dtype)},Tht={kernelName:Sx,backendName:"webgl",kernelFunc:$ht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nht=`if (b == 0.0) return NAN;
  return mod(a, b);`,Eht=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+$l+`
  return result;
`,_ht=fn({opSnippet:Nht,packedOpSnippet:Eht}),Rht={kernelName:Wh,backendName:"webgl",kernelFunc:_ht};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dht{constructor(t,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aht=`
if (a == b) {
  return 1.0;
};
return a / b;`,Oht=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,ZL=fn({opSnippet:Aht,packedOpSnippet:Oht,checkOutOfBounds:!0}),Fht={kernelName:$h,backendName:"webgl",kernelFunc:ZL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V$="return a - b;",JL=fn({opSnippet:V$,packedOpSnippet:V$,supportsComplex:!0,cpuKernelImpl:Nit}),Pht={kernelName:rf,backendName:"webgl",kernelFunc:JL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t3(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{dim:o}=s,i=Rt([o],r.shape),a=QL({inputs:{x:r},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=Fe(a.shape,i),c=at({inputs:{x:a},backend:n,attrs:{shape:l}}),u=JL({inputs:{a:r,b:c},backend:n}),d=XL({inputs:{x:u},backend:n}),h=v0({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),f=at({inputs:{x:h},backend:n,attrs:{shape:l}}),p=ZL({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const Mht={kernelName:Wx,backendName:"webgl",kernelFunc:t3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lht(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{numSamples:o,seed:i,normalized:a}=s,l=a?r:t3({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new Dht(c,u,o),h=[[i]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const zht={kernelName:AD,backendName:"webgl",kernelFunc:Lht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bht=or+`
  return -x;
`,Vht=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Wht(e){const{inputs:t,backend:n}=e,{x:s}=t;if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId),[i,a]=cit(o.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,i)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new bi(s.shape,Vht):r=new Hr(s.shape,Bht),n.runWebGLProgram(r,[s],s.dtype)}const Uht={kernelName:Ix,backendName:"webgl",kernelFunc:Wht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jht=Lk;function Ght(e){Cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(o.dataId),{selectedIndices:d}=jht(c,u,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Hht={kernelName:Ww,backendName:"webgl",kernelFunc:Ght};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kht=zk;function Xht(e){Cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),d=n.readSync(o.dataId),{selectedIndices:h,validOutputs:f}=Kht(u,d,i,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const qht={kernelName:Uw,backendName:"webgl",kernelFunc:Xht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yht=Bk;function Qht(e){Cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),d=n.readSync(o.dataId),h=i,f=a,p=l,m=c,{selectedIndices:g,selectedScores:x}=Yht(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const Zht={kernelName:jw,backendName:"webgl",kernelFunc:Qht};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jht{constructor(t,n,s,r){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tft=e=>{const{inputs:t,backend:n,attrs:s}=e,{indices:r}=t,{dtype:o,depth:i,onValue:a,offValue:l}=s,c=Y(r.shape),u=new Jht(c,i,a,l),d=at({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],o);n.disposeIntermediateTensorInfo(d);const f=[...r.shape,i],p=at({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},eft={kernelName:Nx,backendName:"webgl",kernelFunc:tft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cg(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="complex64"){const r=_f({inputs:{input:s},backend:n}),o=cg({inputs:{x:r},backend:n}),i=w0({inputs:{input:s},backend:n}),a=cg({inputs:{x:i},backend:n}),l=la({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return Rf({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const nft={kernelName:Gx,backendName:"webgl",kernelFunc:cg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=_f({inputs:{input:s},backend:n}),o=e3({inputs:{x:r},backend:n}),i=w0({inputs:{input:s},backend:n}),a=cg({inputs:{x:i},backend:n}),l=la({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return Rf({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const sft={kernelName:Tx,backendName:"webgl",kernelFunc:e3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rft(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s;if(t.length===1)return E1({inputs:{input:t[0]},backend:n,attrs:{dim:r}});const o=t[0].shape,i=t[0].dtype;t.forEach(u=>{nr(o,u.shape,"All tensors passed to stack must have matching shapes"),T(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=t.map(u=>{const d=E1({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=BL({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const oft={kernelName:Ex,backendName:"webgl",kernelFunc:rft};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ift{constructor(t,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+t[u]+c[1]);const r=t.length,o=te(r),i=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+t[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aft{constructor(t,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,g)=>m[0]+t[g]+m[1]);const r=t.length,o=te(r),i=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+t[g]).join(","),l=Dn("rc",r),c=Dn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${o} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=r===1?2:4;m<g;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:o,constantValue:i}=s;if(Y(r.shape)===0){const c=o.map((u,d)=>u[0]+r.shape[d]+u[1]);return Rf({backend:n,attrs:{shape:c,value:i,dtype:r.dtype}})}const a=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aft(r.shape,o,i):new ift(r.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[r],r.dtype,l)},lft={kernelName:_x,backendName:"webgl",kernelFunc:n3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cft=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,uft=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+$l+`
  return result;
`,dft=fn({opSnippet:cft,packedOpSnippet:uft}),hft={kernelName:jh,backendName:"webgl",kernelFunc:dft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fft(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:i}=s,a=r.shape.length,l=[],c=Rt(o,r.shape);let u=c;const d=Ie(u,a);let h=r;d!=null&&(h=Mn({inputs:{x:r},backend:n,attrs:{perm:d}}),u=Pe(u.length,a),l.push(h)),hn("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:g,outDtype:x}=dit(h.shape,h.dtype,p,u);f=n.makeTensorInfo(g,x,m)}else{const[p,m]=sn(h.shape,u),g=Y(m),x=at({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),y=sk(r.dtype),b=Tl(x,y,"prod",n);f=at({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(x),l.push(b)}if(i){l.push(f);const p=Fe(f.shape,c);f=at({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const pft={kernelName:Dx,backendName:"webgl",kernelFunc:fft};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mft(e){const{inputs:t,backend:n,attrs:s}=e,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=t,{outputRaggedRank:a}=s,l=r.map(x=>n.readSync(x.dataId)),c=r.map(x=>x.shape),u=n.readSync(o.dataId),d=n.readSync(i.dataId),[h,f,p]=hit(l,c,u,o.shape,o.dtype,d,i.shape,a),m=h.map(x=>n.makeTensorInfo([x.length],"int32",x)),g=n.makeTensorInfo(p,o.dtype,f);return m.concat([g])}const gft={kernelName:OD,backendName:"webgl",kernelFunc:mft};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xft(e){const{inputs:t,backend:n}=e,{starts:s,limits:r,deltas:o}=t,i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=fit(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const yft={kernelName:FD,backendName:"webgl",kernelFunc:xft};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bft(e){const{inputs:t,backend:n,attrs:s}=e,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(o.dataId),d=n.readSync(i.dataId),h=a.map(g=>n.readSync(g.dataId)),f=a.map(g=>g.shape),[p,m]=pit(c,r.shape,u,o.shape,o.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(p,o.dtype,m)}const vft={kernelName:PD,backendName:"webgl",kernelFunc:bft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s3=e=>{const{backend:t,attrs:n}=e,{start:s,stop:r,step:o,dtype:i}=n,a=mit(s,r,o,i);return t.makeTensorInfo([a.length],i,a)},wft={kernelName:Gw,backendName:"webgl",kernelFunc:s3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kft="return 1.0 / x;",Cft=zt({opSnippet:kft}),Sft={kernelName:Gh,backendName:"webgl",kernelFunc:Cft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ift=or+`
  return (x < 0.0) ? 0.0 : x;
`,$ft=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Tft=zt({opSnippet:Ift,packedOpSnippet:$ft}),Nft={kernelName:Hh,backendName:"webgl",kernelFunc:Tft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eft=or+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,_ft=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Rft=zt({opSnippet:Eft,packedOpSnippet:_ft}),Dft={kernelName:Kh,backendName:"webgl",kernelFunc:Rft};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aft{constructor(t,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=t;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;o?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oft{constructor(t,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=t;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;o?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fft(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,c]=a,u=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Oft(r.shape,l,c,o,i):new Aft(r.shape,l,c,o,i);return n.runWebGLProgram(u,[r],"float32")}const Pft={kernelName:Fx,backendName:"webgl",kernelFunc:Fft};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mft{constructor(t,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=t,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],c=[s&&i>1?i-1:i,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lft(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:o}=t,{alignCorners:i}=s,a=new Mft(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const zft={kernelName:Xw,backendName:"webgl",kernelFunc:Lft};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bft{constructor(t,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=t;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;o?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vft{constructor(t,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=t;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;o?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wft(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,c]=a,u=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Vft(r.shape,l,c,o,i):new Bft(r.shape,l,c,o,i);return n.runWebGLProgram(u,[r],r.dtype)}const Uft={kernelName:Ox,backendName:"webgl",kernelFunc:Wft};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jft{constructor(t,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=t,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],c=[s&&i>1?i-1:i,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gft(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:o}=t,{alignCorners:i}=s,a=new jft(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const Hft={kernelName:Kw,backendName:"webgl",kernelFunc:Gft};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kft{constructor(t,n){this.variableNames=["x"];const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=t,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&t[a]!==1?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`,o=t.map((a,l)=>r(l)).join(","),i=te(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xft{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=t;const r=Dn("rc",s),o=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=te(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${o}){
            result.g = ${c(r.slice())};
          }
          if(${i}) {
            result.b = ${u(r.slice())};
            if(${o}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",h(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",h(p)}function d(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",h(p)}function h(p){const m=t.map((y,b)=>f(b,p)),g=m.join(","),x=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${x}))`}function f(p,m){return n.indexOf(p)!==-1&&t[p]!==1?`${t[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qft(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dims:o}=s,i=r.shape.length,a=Rt(o,r.shape);if(i===0)return ms({inputs:{x:r},backend:n});const l=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Xft(r.shape,a):new Kft(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const Yft={kernelName:Px,backendName:"webgl",kernelFunc:qft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qft{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=t[1],r=t[2];this.outputShape=t;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zft={kernelName:ek,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,{radians:r,fillValue:o,center:i}=t,a=n,l=new Qft(s.shape,o),[c,u]=Qk(i,s.shape[1],s.shape[2]),d=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jft=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,tpt=zt({opSnippet:Jft}),ept={kernelName:Xh,backendName:"webgl",kernelFunc:tpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const npt="return inversesqrt(x);",spt=zt({opSnippet:npt,cpuKernelImpl:git}),rpt={kernelName:qh,backendName:"webgl",kernelFunc:spt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tS{constructor(t,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const c=te(o.length),u=te(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class opt{constructor(t,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const c=te(o.length),u=te(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,x=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ipt(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r,updates:o}=t,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=wl(o,r,i),h=[d/c,c];if(d===0)return n.makeTensorInfo(i,r.dtype);const f=at({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=at({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;K().getBool("WEBGL_PACK")?g=new opt(l,a,f.shape.length,p.shape.length,u,h):g=new tS(l,a,f.shape.length,p.shape.length,u,h);const x=n.runWebGLProgram(g,[p,f,m],p.dtype),y=at({inputs:{x},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(m),y}const apt={kernelName:MD,backendName:"webgl",kernelFunc:ipt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lpt{constructor(t,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,s];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=K().getNumber("WEBGL_VERSION")===2?o:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpt(e){const{inputs:t,backend:n,attrs:s}=e,{sortedSequence:r,values:o}=t,{side:i}=s,a=new lpt(r.shape[0],r.shape[1],o.shape[1],i),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,o],"int32",l)}const upt={kernelName:zD,backendName:"webgl",kernelFunc:cpt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dpt{constructor(t,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,o;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)o="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<t&&l.push(`${a[u]}`);r=l.join(),o=c.join()}const i=te(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpt(e){const{inputs:t,backend:n}=e,{condition:s,t:r,e:o}=t,i=new dpt(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(i,[s,r,o],fs(r.dtype,o.dtype))}const fpt={kernelName:Mx,backendName:"webgl",kernelFunc:hpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppt=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${s0};
  float scale = ${r0};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,mpt=zt({opSnippet:ppt}),gpt={kernelName:Yh,backendName:"webgl",kernelFunc:mpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpt=pu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,ypt=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,bpt=zt({opSnippet:xpt,packedOpSnippet:ypt,cpuKernelImpl:yit}),vpt={kernelName:tf,backendName:"webgl",kernelFunc:bpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpt=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,kpt=zt({opSnippet:wpt}),Cpt={kernelName:Jh,backendName:"webgl",kernelFunc:kpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Spt=pu+`
  return sin(x);
`,Ipt=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${$l}
  return result;
`,$pt=zt({opSnippet:Spt,packedOpSnippet:Ipt}),Tpt={kernelName:Qh,backendName:"webgl",kernelFunc:$pt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npt=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Ept=zt({opSnippet:Npt}),_pt={kernelName:Zh,backendName:"webgl",kernelFunc:Ept};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rpt=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Dpt=zt({opSnippet:Rpt}),Apt={kernelName:ef,backendName:"webgl",kernelFunc:Dpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Opt=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:o,paddings:i}=s;T(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((x,y)=>x*y),l=[[0,0]];l.push(...i);for(let x=1+o.length;x<r.shape.length;++x)l.push([0,0]);const c=[],u=n3({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=mf(u.shape,o,a,!1),h=gf(d.length,o.length,!1),f=xf(u.shape,o,a,!1),p=at({inputs:{x:u},backend:n,attrs:{shape:d}}),m=Mn({inputs:{x:p},backend:n,attrs:{perm:h}}),g=at({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),g},Fpt={kernelName:Bx,backendName:"webgl",kernelFunc:Opt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppt(e){const{inputs:t,backend:n}=e,{indices:s,values:r,denseShape:o,defaultValue:i}=t;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(o.dataId),u=n.readSync(i.dataId)[0],[d,h,f,p,m]=vit(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const Mpt={kernelName:BD,backendName:"webgl",kernelFunc:Ppt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lpt(e){const{inputs:t,backend:n}=e,{inputIndices:s,inputShape:r,newShape:o}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(o.dataId)),[c,u,d]=wit(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const zpt={kernelName:VD,backendName:"webgl",kernelFunc:Lpt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpt(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:o}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=TL(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const Vpt={kernelName:WD,backendName:"webgl",kernelFunc:Bpt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wpt(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:o}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=TL(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const Upt={kernelName:UD,backendName:"webgl",kernelFunc:Wpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jpt(e){const{inputs:t,backend:n,attrs:s}=e,{sparseIndices:r,sparseValues:o,defaultValue:i}=t,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=wl(o,r,a),f=!1;if(o.dtype==="string"){const x=n.bufferSync(r),y=n.bufferSync(o),b=Ui(n.readSync(i.dataId)[0]),v=xit(x,y,a,h,u,c,l,d,b,f);return n.makeTensorInfo(a,v.dtype,v.values)}const p=new tS(c,l,r.shape.length,o.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[o,r,i],o.dtype),g=at({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}const Gpt={kernelName:jD,backendName:"webgl",kernelFunc:jpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{numOrSizeSplits:o,axis:i}=s,a=Rt(i,r.shape)[0],l=hC(r,o,a),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=mu({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,p})}const Kpt={kernelName:Vx,backendName:"webgl",kernelFunc:Hpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W$="return sqrt(x);",Xpt=zt({opSnippet:W$,packedOpSnippet:W$,cpuKernelImpl:kit}),qpt={kernelName:nf,backendName:"webgl",kernelFunc:Xpt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ypt="return x * x;",Qpt=zt({opSnippet:Ypt}),Zpt={kernelName:qw,backendName:"webgl",kernelFunc:Qpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U$="return (a - b) * (a - b);",Jpt=fn({opSnippet:U$,packedOpSnippet:U$}),tmt={kernelName:sf,backendName:"webgl",kernelFunc:Jpt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function emt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(r.dataId),i=Bo(o),a=Cit(i,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const nmt={kernelName:Yw,backendName:"webgl",kernelFunc:emt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function smt({inputs:e,attrs:t,backend:n}){const{x:s}=e,r=or+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,o=new Hr(s.shape,r);return n.runWebGLProgram(o,[s],s.dtype)}const rmt={kernelName:cf,backendName:"webgl",kernelFunc:smt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class omt{constructor(t,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,o=te(s.length),i=te(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${t});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function imt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:o,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:x,begin:y,end:b,strides:v}=Xk(r.shape,o,i,a,l,c,u,d,h);let w;if(m)w=at({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||x){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const C=Gk(y,b,v),S=mu({inputs:{x:r},backend:n,attrs:{begin:y,size:C}});w=at({inputs:{x:S},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(S)}else if(n.shouldExecuteOnCPU([r])){const S=n.readSync(r.dataId),I=_t(r.shape,r.dtype,S),$=Sit(f,I,v,y);w=n.makeTensorInfo(p,r.dtype,$.values)}else{const S=new omt(y,v,f);w=n.runWebGLProgram(S,[r],r.dtype)}const k=at({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),k}const amt={kernelName:Qw,backendName:"webgl",kernelFunc:imt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lmt(e){const{inputs:t,backend:n,attrs:s}=e,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=t,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,m]=Iit(h,f,r,o,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const cmt={kernelName:GD,backendName:"webgl",kernelFunc:lmt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function umt(e){const{inputs:t,backend:n,attrs:s}=e,{skipEmpty:r}=s,{input:o,delimiter:i}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[c,u,d]=$it(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const dmt={kernelName:HD,backendName:"webgl",kernelFunc:umt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hmt(e){const{inputs:t,backend:n,attrs:s}=e,{numBuckets:r}=s,{input:o}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=Tit(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const fmt={kernelName:KD,backendName:"webgl",kernelFunc:hmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pmt="return tan(x);",mmt=zt({opSnippet:pmt}),gmt={kernelName:of,backendName:"webgl",kernelFunc:mmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xmt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,ymt=zt({opSnippet:xmt}),bmt={kernelName:af,backendName:"webgl",kernelFunc:ymt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vmt(e){const{inputs:t,backend:n,attrs:s}=e,{tensor:r,indices:o,updates:i}=t,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=wl(i,o,r.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(r.shape,o.dtype);const f=at({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=at({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=at({inputs:{x:r},backend:n,attrs:{shape:h}}),g=new tS(l,a,f.shape.length,p.shape.length,u,h,!1,!0),x=n.runWebGLProgram(g,[p,f,m],m.dtype),y=at({inputs:{x},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),y}const wmt={kernelName:LD,backendName:"webgl",kernelFunc:vmt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kmt{constructor(t,n){this.variableNames=["A"];const s=new Array(t.length);for(let i=0;i<s.length;i++)s[i]=t[i]*n[i];this.outputShape=s,this.rank=s.length;const r=te(this.rank),o=Cmt(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function Cmt(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<e.length;r++)s.push(`imod(${n[r]}, ${e[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reps:o}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(h=>Ui(h)):l,u=_t(r.shape,r.dtype,c),d=Eit(u,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new kmt(r.shape,o);return n.runWebGLProgram(i,[r],r.dtype)}const Smt={kernelName:lf,backendName:"webgl",kernelFunc:r3};class Imt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class $mt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ha(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function j$(e){let t=1;for(;t<e;)t*=2;return t}function Tmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{k:o,sorted:i}=s,a=K().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=K().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||o>l){const $=n.readSync(r.dataId),[E,A]=_it($,c,r.dtype,o,i);return[n.makeTensorInfo(E.shape,E.dtype,E.values),n.makeTensorInfo(A.shape,A.dtype,A.values)]}if(o===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,Rf({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(r):r,m=Y(c)/u,g=at({inputs:{x:f},attrs:{shape:[m,u]},backend:n});h&&ha(n,f);const x=j$(o),y=j$(u);let b=null;const v=()=>b===null?[g,g]:[g,b],w=($,E,A)=>{const L=v(),O=new Imt(A),M=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[$],[E]],U=b;b=n.runWebGLProgram(O,L,"int32",M),ha(n,U)};for(let $=1;$<x;$*=2){const E=$*2;for(let A=$;A>=1;A/=2)w(E,A,[m,y])}for(let $=y;$>x;$/=2){const E=v(),A=new $mt([m,$/2]),O=[[u],[b===null?1:0],[x]],P=b;b=n.runWebGLProgram(A,E,"int32",O),ha(n,P);const M=x/2,U=M*2;for(let R=M;R>=1;R/=2)w(U,R,b.shape)}let k=b;b=mu({inputs:{x:b},backend:n,attrs:{begin:0,size:[m,o]}}),ha(n,k);let C=YL({inputs:{x:g,indices:b},backend:n,attrs:{axis:1,batchDims:1}});ha(n,g);const S=c.slice(0,-1);S.push(o),k=b,b=at({inputs:{x:b},attrs:{shape:S},backend:n}),ha(n,k);const I=C;return C=at({inputs:{x:C},attrs:{shape:S},backend:n}),ha(n,I),[C,b]}const Nmt={kernelName:Zw,backendName:"webgl",kernelFunc:Tmt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Emt{constructor(t,n,s,r,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _mt(e){const{inputs:t,backend:n,attrs:s}=e,{image:r,transforms:o}=t,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=s,[u,d,h,f]=r.shape,[p,m]=c??[d,h],g=[u,p,m,f],x=new Emt(d,h,i,a,l,g);return n.runWebGLProgram(x,[r,o],"float32")}const Rmt={kernelName:Jw,backendName:"webgl",kernelFunc:_mt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dmt(e){const{inputs:t,attrs:n,backend:s}=e,{axis:r}=n,{x:o}=t;Nf(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(o.dataId),{outputValues:a,outputShape:l,indices:c}=Rit(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const Amt={kernelName:tk,backendName:"webgl",kernelFunc:Dmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Omt(e){const{inputs:t,backend:n,attrs:s}=e,{value:r}=t;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r,a=i.shape.length,l=r.shape[o],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==o&&(c[u++]=i.shape[m]);const d=[],h=new Array(a).fill(0),f=i.shape.slice();f[o]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[o]=m;const g=mu({inputs:{x:i},backend:n,attrs:{begin:h,size:f}}),x=at({inputs:{x:g},backend:n,attrs:{shape:c}});p[m]=x,d.push(g)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Fmt={kernelName:Ux,backendName:"webgl",kernelFunc:Omt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pmt{constructor(t,n){this.variableNames=["x","segmentIds"];const s=t.windowSize,r=t.batchSize,o=t.inSize,i=t.numSegments,a=i*Math.ceil(o/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";o%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let p="";o%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,segmentIds:o}=t,{numSegments:i}=s,a=r.shape.length,l=[];let c=0;const u=Ie([c],a);let d=r;u!=null&&(d=Mn({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=Pe(1,a)[0]);const h=BO(d.shape,c,i),f=Y([d.shape[c]]),p=at({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=sk(r.dtype),g=(v,w,k,C,S)=>{const I=v.shape[0],$=v.shape[1],E=zO($,S),A={windowSize:E,inSize:$,batchSize:I,numSegments:S},L=new Pmt(A,w),O=n.compileAndRun(L,[v,k],C);if(l.push(O),O.shape[1]===S)return O;const P=s3({backend:n,attrs:{start:0,stop:S,step:1,dtype:"float32"}}),M=r3({inputs:{x:P},backend:n,attrs:{reps:[$/E]}});return l.push(P),l.push(M),g(O,w,M,C,S)},x=g(p,"unsortedSegmentSum",o,m,i),y=at({inputs:{x},backend:n,attrs:{shape:h}});let b=y;if(u!=null){l.push(y);const v=sa(u);b=Mn({inputs:{x:b},backend:n,attrs:{perm:v}})}return l.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const Lmt={kernelName:jx,backendName:"webgl",kernelFunc:Mmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zmt=[kat,Sat,Tat,_at,Dat,Fat,Mat,zat,Uat,Gat,Xat,Qat,tlt,rlt,alt,clt,dlt,mlt,xlt,blt,Clt,_lt,Dlt,Plt,Llt,jlt,Hlt,Ylt,oat,Jlt,rct,lct,pct,xct,bct,wct,Cct,Tct,_ct,Act,Fct,Mct,zct,Wct,jct,Xct,Yct,Jct,nut,rut,lut,hut,gut,but,kut,Cut,Iut,Tut,Eut,Rut,Aut,Mut,But,Uut,Gut,Xut,Qut,edt,odt,rat,adt,nct,udt,fdt,gdt,aat,vdt,Sdt,$dt,_dt,Adt,Mdt,Bdt,jdt,Xdt,Qdt,Jdt,sht,oht,aht,dht,fht,mht,xht,bht,Cht,Tht,Rht,zht,uat,Uht,Hht,qht,Zht,Blt,eft,sft,oft,lft,hft,cat,pft,gft,yft,vft,wft,Vlt,Fht,Sft,Nft,Dft,hat,Pft,zft,Uft,Hft,Yft,Zft,ept,rpt,apt,upt,fpt,gpt,vpt,Cpt,Tpt,_pt,Nlt,Mht,Apt,Fpt,Mpt,zpt,Vpt,Upt,Gpt,Kpt,qpt,Zpt,tmt,nmt,rmt,amt,cmt,dmt,fmt,Pht,bat,gmt,bmt,wmt,Smt,Nmt,Rmt,vat,Amt,Fmt,Lmt,nft];for(const e of zmt)qD(e);function qp(){const e=eQ({layers:[Cy({inputShape:[1],units:64,activation:"relu",kernelInitializer:"randomNormal"}),Cy({units:64,activation:"relu",kernelInitializer:"randomNormal"}),Cy({units:1,kernelInitializer:"randomNormal"})]});return e.compile({optimizer:bo.sgd(.01),loss:"meanSquaredError"}),e}function Bmt(e){const t=qp();return t.setWeights(e.getWeights()),t}async function G$(e,t,n){const s=e.predict(t),r=Gm.meanSquaredError(n,s),o=await r.data();return s.dispose(),r.dispose(),o[0]}class Vmt{constructor(t,n=.001,s=.01,r=5){this.model=t,this.metaLearningRate=n,this.innerLearningRate=s,this.innerSteps=r}async metaUpdate(t){const n=this.model.getWeights(),s=[];let r=0;for(const o of t){const i=Bmt(this.model),a=bo.sgd(this.innerLearningRate);for(let f=0;f<this.innerSteps;f++)a.minimize(()=>{const p=i.predict(o.trainX);return Gm.meanSquaredError(o.trainY,p)});const l=i.predict(o.testX),c=Gm.meanSquaredError(o.testY,l),u=await c.data();r+=u[0];const h=i.getWeights().map((f,p)=>f.sub(n[p]));s.push(...h),l.dispose(),c.dispose(),i.dispose()}if(s.length>0){const o=this.averageUpdates(s,t.length),i=n.map((a,l)=>a.add(o[l].mul(this.metaLearningRate)));this.model.setWeights(i),o.forEach(a=>a.dispose()),i.forEach(a=>a.dispose())}return s.forEach(o=>o.dispose()),r/t.length}averageUpdates(t,n){const s=t.length/n,r=[];for(let o=0;o<s;o++){let i=t[o];for(let a=1;a<n;a++){const l=a*s+o;i=i.add(t[l])}r.push(i.div(n))}return r}getModel(){return this.model}updateHyperparameters(t,n,s){t!==void 0&&(this.metaLearningRate=t),n!==void 0&&(this.innerLearningRate=n),s!==void 0&&(this.innerSteps=s)}}function o3(){const e=Math.random()*4.9+.1,t=Math.random()*Math.PI,n=[],s=[];for(let i=0;i<10;i++){const a=Math.random()*10-5,l=e*Math.sin(a+t);n.push(a),s.push(l)}const r=[],o=[];for(let i=0;i<10;i++){const a=Math.random()*10-5,l=e*Math.sin(a+t);r.push(a),o.push(l)}return{amplitude:e,phase:t,trainX:_a(n,[10,1]),trainY:_a(s,[10,1]),testX:_a(r,[10,1]),testY:_a(o,[10,1])}}function i3(e,t,n=100){const s=[],r=[];for(let o=0;o<n;o++){const i=o/(n-1)*10-5,a=e*Math.sin(i+t);s.push(i),r.push(a)}return{x:s,y:r}}function Wmt(e){const t=[];for(let n=0;n<e;n++)t.push(o3());return t}function Umt(){const[e,t]=D.useState({isTraining:!1,isPaused:!1,currentIteration:0,maxIterations:1e3,metaLoss:0,progressPercentage:0,elapsedTime:0,lossHistory:[],currentBatch:[]}),[n,s]=D.useState({metaLearningRate:.001,innerLearningRate:.01,innerSteps:5,tasksPerBatch:5,metaIterations:1e3}),[r,o]=D.useState({beforeFineTuning:0,afterFineTuning:0,improvementFactor:0}),i=D.useRef(null),a=D.useRef(0),l=D.useRef(0),c=D.useCallback(()=>{const m=qp();i.current=new Vmt(m,n.metaLearningRate,n.innerLearningRate,n.innerSteps)},[n]),u=D.useCallback(async()=>{i.current||c(),t(g=>({...g,isTraining:!0,isPaused:!1,currentIteration:0,maxIterations:n.metaIterations,lossHistory:[],elapsedTime:0})),a.current=Date.now();const m=async()=>{if(!i.current)return;t(x=>x.currentIteration>=n.metaIterations?{...x,isTraining:!1}:x);const g=Wmt(n.tasksPerBatch);try{const x=await i.current.metaUpdate(g);t(y=>{const b=y.currentIteration+1,v=[...y.lossHistory,x],w=b/n.metaIterations*100,k=Math.floor((Date.now()-a.current)/1e3),C=b<n.metaIterations&&y.isTraining&&!y.isPaused;return C||setTimeout(()=>f(),100),{...y,currentIteration:b,metaLoss:x,lossHistory:v.slice(-100),progressPercentage:w,elapsedTime:k,isTraining:C,currentBatch:g.map(S=>({amplitude:S.amplitude,phase:S.phase,loss:x}))}}),setTimeout(()=>{t(y=>(y.currentIteration<n.metaIterations&&y.isTraining&&!y.isPaused&&m(),y))},50)}catch(x){console.error("Training step failed:",x),t(y=>({...y,isTraining:!1}))}};m()},[n]),d=D.useCallback(()=>{t(m=>({...m,isPaused:!m.isPaused})),l.current&&cancelAnimationFrame(l.current)},[]),h=D.useCallback(()=>{l.current&&cancelAnimationFrame(l.current),t({isTraining:!1,isPaused:!1,currentIteration:0,maxIterations:n.metaIterations,metaLoss:0,progressPercentage:0,elapsedTime:0,lossHistory:[],currentBatch:[]}),c()},[n.metaIterations,c]),f=D.useCallback(async()=>{if(i.current)try{const m=o3(),g=qp(),x=await G$(g,m.testX,m.testY),y=i.current.getModel(),b=qp();b.setWeights(y.getWeights());const v=bo.sgd(.01);for(let C=0;C<3;C++)v.minimize(()=>{const S=b.predict(m.trainX);return Gm.meanSquaredError(m.trainY,S)});const w=await G$(b,m.testX,m.testY),k=x>0?x/w:1;o({beforeFineTuning:x,afterFineTuning:w,improvementFactor:k}),m.trainX.dispose(),m.trainY.dispose(),m.testX.dispose(),m.testY.dispose(),g.dispose(),b.dispose()}catch(m){console.error("Evaluation failed:",m)}},[]),p=D.useCallback(m=>{s(g=>({...g,...m})),i.current&&i.current.updateHyperparameters(m.metaLearningRate,m.innerLearningRate,m.innerSteps)},[]);return{trainingState:e,hyperParams:n,evaluationResults:r,startTraining:u,pauseTraining:d,resetTraining:h,updateHyperParameters:p,initializeModel:c}}const ao=D.forwardRef(({className:e,...t},n)=>N.jsx("div",{ref:n,className:zn("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));ao.displayName="Card";const jmt=D.forwardRef(({className:e,...t},n)=>N.jsx("div",{ref:n,className:zn("flex flex-col space-y-1.5 p-6",e),...t}));jmt.displayName="CardHeader";const Gmt=D.forwardRef(({className:e,...t},n)=>N.jsx("div",{ref:n,className:zn("text-2xl font-semibold leading-none tracking-tight",e),...t}));Gmt.displayName="CardTitle";const Hmt=D.forwardRef(({className:e,...t},n)=>N.jsx("div",{ref:n,className:zn("text-sm text-muted-foreground",e),...t}));Hmt.displayName="CardDescription";const a3=D.forwardRef(({className:e,...t},n)=>N.jsx("div",{ref:n,className:zn("p-6 pt-0",e),...t}));a3.displayName="CardContent";const Kmt=D.forwardRef(({className:e,...t},n)=>N.jsx("div",{ref:n,className:zn("flex items-center p-6 pt-0",e),...t}));Kmt.displayName="CardFooter";function Xmt(){return N.jsxs(ao,{className:"p-8 floating-card",children:[N.jsx("h2",{className:"text-2xl font-semibold mb-6 text-center",children:"Neural Network Architecture"}),N.jsx("div",{className:"flex justify-center",children:N.jsxs("svg",{width:"600",height:"300",className:"border border-border rounded-lg bg-muted/10 backdrop-blur-sm",children:[N.jsxs("g",{"data-testid":"input-layer",children:[N.jsx("text",{x:"50",y:"30",className:"text-sm fill-foreground font-medium",children:"Input (x)"}),N.jsx("circle",{cx:"75",cy:"150",r:"20",className:"neural-node fill-primary"}),N.jsx("text",{x:"70",y:"155",className:"text-xs fill-primary-foreground",children:"x"})]}),N.jsxs("g",{"data-testid":"hidden-layer-1",children:[N.jsx("text",{x:"180",y:"30",className:"text-sm fill-foreground font-medium",children:"Hidden Layer 1 (64)"}),N.jsx("circle",{cx:"200",cy:"80",r:"15",className:"neural-node fill-primary"}),N.jsx("circle",{cx:"200",cy:"120",r:"15",className:"neural-node fill-primary"}),N.jsx("circle",{cx:"200",cy:"160",r:"15",className:"neural-node fill-primary"}),N.jsx("circle",{cx:"200",cy:"200",r:"15",className:"neural-node fill-primary"}),N.jsx("text",{x:"195",y:"240",className:"text-xs fill-muted-foreground",children:"+60 more"})]}),N.jsxs("g",{"data-testid":"hidden-layer-2",children:[N.jsx("text",{x:"320",y:"30",className:"text-sm fill-foreground font-medium",children:"Hidden Layer 2 (64)"}),N.jsx("circle",{cx:"350",cy:"80",r:"15",className:"neural-node fill-primary"}),N.jsx("circle",{cx:"350",cy:"120",r:"15",className:"neural-node fill-primary"}),N.jsx("circle",{cx:"350",cy:"160",r:"15",className:"neural-node fill-primary"}),N.jsx("circle",{cx:"350",cy:"200",r:"15",className:"neural-node fill-primary"}),N.jsx("text",{x:"345",y:"240",className:"text-xs fill-muted-foreground",children:"+60 more"})]}),N.jsxs("g",{"data-testid":"output-layer",children:[N.jsx("text",{x:"480",y:"30",className:"text-sm fill-foreground font-medium",children:"Output (y)"}),N.jsx("circle",{cx:"500",cy:"150",r:"20",className:"neural-node fill-primary"}),N.jsx("text",{x:"495",y:"155",className:"text-xs fill-primary-foreground",children:"y"})]}),N.jsxs("g",{"data-testid":"connections",children:[N.jsx("line",{x1:"95",y1:"150",x2:"185",y2:"80",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"95",y1:"150",x2:"185",y2:"120",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"95",y1:"150",x2:"185",y2:"160",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"95",y1:"150",x2:"185",y2:"200",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"215",y1:"80",x2:"335",y2:"80",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"215",y1:"120",x2:"335",y2:"120",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"215",y1:"160",x2:"335",y2:"160",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"215",y1:"200",x2:"335",y2:"200",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"365",y1:"80",x2:"480",y2:"150",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"365",y1:"120",x2:"480",y2:"150",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"365",y1:"160",x2:"480",y2:"150",className:"connection-line stroke-muted-foreground opacity-60"}),N.jsx("line",{x1:"365",y1:"200",x2:"480",y2:"150",className:"connection-line stroke-muted-foreground opacity-60"})]})]})}),N.jsx("div",{className:"mt-4 text-center text-sm text-muted-foreground",children:N.jsx("p",{children:"2 Hidden Layers  64 Units + ReLU Activation"})})]})}const qmt=DR("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),vi=D.forwardRef(({className:e,variant:t,size:n,asChild:s=!1,...r},o)=>{const i=s?mW:"button";return N.jsx(i,{className:zn(qmt({variant:t,size:n,className:e})),ref:o,...r})});vi.displayName="Button";var eS="Progress",nS=100,[Ymt,J1t]=Xc(eS),[Qmt,Zmt]=Ymt(eS),l3=D.forwardRef((e,t)=>{const{__scopeProgress:n,value:s=null,max:r,getValueLabel:o=Jmt,...i}=e;(r||r===0)&&!H$(r)&&console.error(tgt(`${r}`,"Progress"));const a=H$(r)?r:nS;s!==null&&!K$(s,a)&&console.error(egt(`${s}`,"Progress"));const l=K$(s,a)?s:null,c=ug(l)?o(l,a):void 0;return N.jsx(Qmt,{scope:n,value:l,max:a,children:N.jsx(Xe.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":ug(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":d3(l,a),"data-value":l??void 0,"data-max":a,...i,ref:t})})});l3.displayName=eS;var c3="ProgressIndicator",u3=D.forwardRef((e,t)=>{const{__scopeProgress:n,...s}=e,r=Zmt(c3,n);return N.jsx(Xe.div,{"data-state":d3(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...s,ref:t})});u3.displayName=c3;function Jmt(e,t){return`${Math.round(e/t*100)}%`}function d3(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function ug(e){return typeof e=="number"}function H$(e){return ug(e)&&!isNaN(e)&&e>0}function K$(e,t){return ug(e)&&!isNaN(e)&&e<=t&&e>=0}function tgt(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${nS}\`.`}function egt(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${nS} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var h3=l3,ngt=u3;const f3=D.forwardRef(({className:e,value:t,...n},s)=>N.jsx(h3,{ref:s,className:zn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:N.jsx(ngt,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));f3.displayName=h3.displayName;function p3(e,[t,n]){return Math.min(n,Math.max(t,e))}var sgt=D.createContext(void 0);function rgt(e){const t=D.useContext(sgt);return e||t||"ltr"}function ogt(e){const t=D.useRef({value:e,previous:e});return D.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var m3=["PageUp","PageDown"],g3=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],x3={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},gu="Slider",[_1,igt,agt]=rR(gu),[y3,tvt]=Xc(gu,[agt]),[lgt,k0]=y3(gu),b3=D.forwardRef((e,t)=>{const{name:n,min:s=0,max:r=100,step:o=1,orientation:i="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[s],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,form:p,...m}=e,g=D.useRef(new Set),x=D.useRef(0),b=i==="horizontal"?cgt:ugt,[v=[],w]=uR({prop:u,defaultProp:c,onChange:E=>{var L;(L=[...g.current][x.current])==null||L.focus(),d(E)}}),k=D.useRef(v);function C(E){const A=mgt(v,E);$(E,A)}function S(E){$(E,x.current)}function I(){const E=k.current[x.current];v[x.current]!==E&&h(v)}function $(E,A,{commit:L}={commit:!1}){const O=bgt(o),P=vgt(Math.round((E-s)/o)*o+s,O),M=p3(P,[s,r]);w((U=[])=>{const R=fgt(U,M,A);if(ygt(R,l*o)){x.current=R.indexOf(M);const z=String(R)!==String(U);return z&&L&&h(R),z?R:U}else return U})}return N.jsx(lgt,{scope:e.__scopeSlider,name:n,disabled:a,min:s,max:r,valueIndexToChangeRef:x,thumbs:g.current,values:v,orientation:i,form:p,children:N.jsx(_1.Provider,{scope:e.__scopeSlider,children:N.jsx(_1.Slot,{scope:e.__scopeSlider,children:N.jsx(b,{"aria-disabled":a,"data-disabled":a?"":void 0,...m,ref:t,onPointerDown:me(m.onPointerDown,()=>{a||(k.current=v)}),min:s,max:r,inverted:f,onSlideStart:a?void 0:C,onSlideMove:a?void 0:S,onSlideEnd:a?void 0:I,onHomeKeyDown:()=>!a&&$(s,0,{commit:!0}),onEndKeyDown:()=>!a&&$(r,v.length-1,{commit:!0}),onStepKeyDown:({event:E,direction:A})=>{if(!a){const P=m3.includes(E.key)||E.shiftKey&&g3.includes(E.key)?10:1,M=x.current,U=v[M],R=o*P*A;$(U+R,M,{commit:!0})}}})})})})});b3.displayName=gu;var[v3,w3]=y3(gu,{startEdge:"left",endEdge:"right",size:"width",direction:1}),cgt=D.forwardRef((e,t)=>{const{min:n,max:s,dir:r,inverted:o,onSlideStart:i,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=D.useState(null),f=Pn(t,b=>h(b)),p=D.useRef(void 0),m=rgt(r),g=m==="ltr",x=g&&!o||!g&&o;function y(b){const v=p.current||d.getBoundingClientRect(),w=[0,v.width],C=sS(w,x?[n,s]:[s,n]);return p.current=v,C(b-v.left)}return N.jsx(v3,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:N.jsx(k3,{dir:m,"data-orientation":"horizontal",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const v=y(b.clientX);i==null||i(v)},onSlideMove:b=>{const v=y(b.clientX);a==null||a(v)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:b=>{const w=x3[x?"from-left":"from-right"].includes(b.key);c==null||c({event:b,direction:w?-1:1})}})})}),ugt=D.forwardRef((e,t)=>{const{min:n,max:s,inverted:r,onSlideStart:o,onSlideMove:i,onSlideEnd:a,onStepKeyDown:l,...c}=e,u=D.useRef(null),d=Pn(t,u),h=D.useRef(void 0),f=!r;function p(m){const g=h.current||u.current.getBoundingClientRect(),x=[0,g.height],b=sS(x,f?[s,n]:[n,s]);return h.current=g,b(m-g.top)}return N.jsx(v3,{scope:e.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:N.jsx(k3,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:m=>{const g=p(m.clientY);o==null||o(g)},onSlideMove:m=>{const g=p(m.clientY);i==null||i(g)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:m=>{const x=x3[f?"from-bottom":"from-top"].includes(m.key);l==null||l({event:m,direction:x?-1:1})}})})}),k3=D.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:s,onSlideMove:r,onSlideEnd:o,onHomeKeyDown:i,onEndKeyDown:a,onStepKeyDown:l,...c}=e,u=k0(gu,n);return N.jsx(Xe.span,{...c,ref:t,onKeyDown:me(e.onKeyDown,d=>{d.key==="Home"?(i(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):m3.concat(g3).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:me(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():s(d)}),onPointerMove:me(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&r(d)}),onPointerUp:me(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),o(d))})})}),C3="SliderTrack",S3=D.forwardRef((e,t)=>{const{__scopeSlider:n,...s}=e,r=k0(C3,n);return N.jsx(Xe.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...s,ref:t})});S3.displayName=C3;var R1="SliderRange",I3=D.forwardRef((e,t)=>{const{__scopeSlider:n,...s}=e,r=k0(R1,n),o=w3(R1,n),i=D.useRef(null),a=Pn(t,i),l=r.values.length,c=r.values.map(h=>T3(h,r.min,r.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return N.jsx(Xe.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...s,ref:a,style:{...e.style,[o.startEdge]:u+"%",[o.endEdge]:d+"%"}})});I3.displayName=R1;var D1="SliderThumb",$3=D.forwardRef((e,t)=>{const n=igt(e.__scopeSlider),[s,r]=D.useState(null),o=Pn(t,a=>r(a)),i=D.useMemo(()=>s?n().findIndex(a=>a.ref.current===s):-1,[n,s]);return N.jsx(dgt,{...e,ref:o,index:i})}),dgt=D.forwardRef((e,t)=>{const{__scopeSlider:n,index:s,name:r,...o}=e,i=k0(D1,n),a=w3(D1,n),[l,c]=D.useState(null),u=Pn(t,y=>c(y)),d=l?i.form||!!l.closest("form"):!0,h=eD(l),f=i.values[s],p=f===void 0?0:T3(f,i.min,i.max),m=pgt(s,i.values.length),g=h==null?void 0:h[a.size],x=g?ggt(g,p,a.direction):0;return D.useEffect(()=>{if(l)return i.thumbs.add(l),()=>{i.thumbs.delete(l)}},[l,i.thumbs]),N.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${x}px)`},children:[N.jsx(_1.ItemSlot,{scope:e.__scopeSlider,children:N.jsx(Xe.span,{role:"slider","aria-label":e["aria-label"]||m,"aria-valuemin":i.min,"aria-valuenow":f,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0,...o,ref:u,style:f===void 0?{display:"none"}:e.style,onFocus:me(e.onFocus,()=>{i.valueIndexToChangeRef.current=s})})}),d&&N.jsx(hgt,{name:r??(i.name?i.name+(i.values.length>1?"[]":""):void 0),form:i.form,value:f},s)]})});$3.displayName=D1;var hgt=e=>{const{value:t,...n}=e,s=D.useRef(null),r=ogt(t);return D.useEffect(()=>{const o=s.current,i=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(i,"value").set;if(r!==t&&l){const c=new Event("input",{bubbles:!0});l.call(o,t),o.dispatchEvent(c)}},[r,t]),N.jsx("input",{style:{display:"none"},...n,ref:s,defaultValue:t})};function fgt(e=[],t,n){const s=[...e];return s[n]=t,s.sort((r,o)=>r-o)}function T3(e,t,n){const o=100/(n-t)*(e-t);return p3(o,[0,100])}function pgt(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function mgt(e,t){if(e.length===1)return 0;const n=e.map(r=>Math.abs(r-t)),s=Math.min(...n);return n.indexOf(s)}function ggt(e,t,n){const s=e/2,o=sS([0,50],[0,s]);return(s-o(t)*n)*n}function xgt(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function ygt(e,t){if(t>0){const n=xgt(e);return Math.min(...n)>=t}return!0}function sS(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(n-e[0])}}function bgt(e){return(String(e).split(".")[1]||"").length}function vgt(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var N3=b3,wgt=S3,kgt=I3,Cgt=$3;const Ku=D.forwardRef(({className:e,...t},n)=>N.jsxs(N3,{ref:n,className:zn("relative flex w-full touch-none select-none items-center",e),...t,children:[N.jsx(wgt,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:N.jsx(kgt,{className:"absolute h-full bg-primary"})}),N.jsx(Cgt,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Ku.displayName=N3.displayName;function Sgt({isTraining:e,isPaused:t,currentIteration:n,maxIterations:s,metaLoss:r,progressPercentage:o,elapsedTime:i,hyperParams:a,onStart:l,onPause:c,onReset:u,onExport:d,onUpdateHyperParams:h}){const f=p=>{const m=Math.floor(p/60),g=p%60;return`${m.toString().padStart(2,"0")}:${g.toString().padStart(2,"0")}`};return N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[N.jsxs(ao,{className:"p-6 floating-card",children:[N.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Hyperparameters"}),N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium mb-2",children:"Meta Learning Rate"}),N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx(Ku,{value:[a.metaLearningRate],onValueChange:([p])=>h({metaLearningRate:p}),min:1e-4,max:.01,step:1e-4,className:"flex-1","data-testid":"slider-meta-lr"}),N.jsx("span",{className:"text-sm text-muted-foreground min-w-[60px]","data-testid":"value-meta-lr",children:a.metaLearningRate.toFixed(4)})]})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium mb-2",children:"Inner Learning Rate"}),N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx(Ku,{value:[a.innerLearningRate],onValueChange:([p])=>h({innerLearningRate:p}),min:.001,max:.1,step:.001,className:"flex-1","data-testid":"slider-inner-lr"}),N.jsx("span",{className:"text-sm text-muted-foreground min-w-[60px]","data-testid":"value-inner-lr",children:a.innerLearningRate.toFixed(3)})]})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium mb-2",children:"Meta Iterations"}),N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx(Ku,{value:[a.metaIterations],onValueChange:([p])=>h({metaIterations:p}),min:100,max:2e3,step:50,className:"flex-1","data-testid":"slider-iterations"}),N.jsx("span",{className:"text-sm text-muted-foreground min-w-[60px]","data-testid":"value-iterations",children:a.metaIterations})]})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tasks per Batch"}),N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx(Ku,{value:[a.tasksPerBatch],onValueChange:([p])=>h({tasksPerBatch:p}),min:2,max:10,step:1,className:"flex-1","data-testid":"slider-batch-size"}),N.jsx("span",{className:"text-sm text-muted-foreground min-w-[60px]","data-testid":"value-batch-size",children:a.tasksPerBatch})]})]})]})]}),N.jsxs(ao,{className:"p-6 floating-card",children:[N.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Training Progress"}),N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-sm text-muted-foreground",children:"Current Iteration:"}),N.jsx("span",{className:"font-mono text-primary","data-testid":"current-iteration",children:n})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-sm text-muted-foreground",children:"Meta Loss:"}),N.jsx("span",{className:"font-mono text-accent","data-testid":"meta-loss",children:r>0?r.toFixed(3):"--"})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-sm text-muted-foreground",children:"Elapsed Time:"}),N.jsx("span",{className:"font-mono text-foreground","data-testid":"elapsed-time",children:f(i)})]}),N.jsx("div",{className:"w-full",children:N.jsx(f3,{value:o,className:"w-full","data-testid":"progress-bar"})}),N.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[e?N.jsxs(vi,{onClick:c,variant:"secondary",className:"w-full","data-testid":"button-pause",children:[N.jsx(aU,{className:"w-4 h-4 mr-2"}),t?"Resume":"Pause"]}):N.jsxs(vi,{onClick:l,className:"w-full","data-testid":"button-start",children:[N.jsx(lU,{className:"w-4 h-4 mr-2"}),"Start"]}),N.jsxs(vi,{onClick:u,variant:"destructive",className:"w-full","data-testid":"button-reset",children:[N.jsx(cU,{className:"w-4 h-4 mr-2"}),"Reset"]}),N.jsxs(vi,{onClick:d,variant:"outline",className:"w-full","data-testid":"button-export",children:[N.jsx(iU,{className:"w-4 h-4 mr-2"}),"Export"]})]})]})]})]})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Df(e){return e+.5|0}const wi=(e,t,n)=>Math.max(Math.min(e,n),t);function Xu(e){return wi(Df(e*2.55),0,255)}function Mi(e){return wi(Df(e*255),0,255)}function wo(e){return wi(Df(e/2.55)/100,0,1)}function X$(e){return wi(Df(e*100),0,100)}const Ls={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},A1=[..."0123456789ABCDEF"],Igt=e=>A1[e&15],$gt=e=>A1[(e&240)>>4]+A1[e&15],xp=e=>(e&240)>>4===(e&15),Tgt=e=>xp(e.r)&&xp(e.g)&&xp(e.b)&&xp(e.a);function Ngt(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&Ls[e[1]]*17,g:255&Ls[e[2]]*17,b:255&Ls[e[3]]*17,a:t===5?Ls[e[4]]*17:255}:(t===7||t===9)&&(n={r:Ls[e[1]]<<4|Ls[e[2]],g:Ls[e[3]]<<4|Ls[e[4]],b:Ls[e[5]]<<4|Ls[e[6]],a:t===9?Ls[e[7]]<<4|Ls[e[8]]:255})),n}const Egt=(e,t)=>e<255?t(e):"";function _gt(e){var t=Tgt(e)?Igt:$gt;return e?"#"+t(e.r)+t(e.g)+t(e.b)+Egt(e.a,t):void 0}const Rgt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function E3(e,t,n){const s=t*Math.min(n,1-n),r=(o,i=(o+e/30)%12)=>n-s*Math.max(Math.min(i-3,9-i,1),-1);return[r(0),r(8),r(4)]}function Dgt(e,t,n){const s=(r,o=(r+e/60)%6)=>n-n*t*Math.max(Math.min(o,4-o,1),0);return[s(5),s(3),s(1)]}function Agt(e,t,n){const s=E3(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)s[r]*=1-t-n,s[r]+=t;return s}function Ogt(e,t,n,s,r){return e===r?(t-n)/s+(t<n?6:0):t===r?(n-e)/s+2:(e-t)/s+4}function rS(e){const n=e.r/255,s=e.g/255,r=e.b/255,o=Math.max(n,s,r),i=Math.min(n,s,r),a=(o+i)/2;let l,c,u;return o!==i&&(u=o-i,c=a>.5?u/(2-o-i):u/(o+i),l=Ogt(n,s,r,u,o),l=l*60+.5),[l|0,c||0,a]}function oS(e,t,n,s){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,s)).map(Mi)}function iS(e,t,n){return oS(E3,e,t,n)}function Fgt(e,t,n){return oS(Agt,e,t,n)}function Pgt(e,t,n){return oS(Dgt,e,t,n)}function _3(e){return(e%360+360)%360}function Mgt(e){const t=Rgt.exec(e);let n=255,s;if(!t)return;t[5]!==s&&(n=t[6]?Xu(+t[5]):Mi(+t[5]));const r=_3(+t[2]),o=+t[3]/100,i=+t[4]/100;return t[1]==="hwb"?s=Fgt(r,o,i):t[1]==="hsv"?s=Pgt(r,o,i):s=iS(r,o,i),{r:s[0],g:s[1],b:s[2],a:n}}function Lgt(e,t){var n=rS(e);n[0]=_3(n[0]+t),n=iS(n),e.r=n[0],e.g=n[1],e.b=n[2]}function zgt(e){if(!e)return;const t=rS(e),n=t[0],s=X$(t[1]),r=X$(t[2]);return e.a<255?`hsla(${n}, ${s}%, ${r}%, ${wo(e.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const q$={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Y$={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Bgt(){const e={},t=Object.keys(Y$),n=Object.keys(q$);let s,r,o,i,a;for(s=0;s<t.length;s++){for(i=a=t[s],r=0;r<n.length;r++)o=n[r],a=a.replace(o,q$[o]);o=parseInt(Y$[i],16),e[a]=[o>>16&255,o>>8&255,o&255]}return e}let yp;function Vgt(e){yp||(yp=Bgt(),yp.transparent=[0,0,0,0]);const t=yp[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const Wgt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Ugt(e){const t=Wgt.exec(e);let n=255,s,r,o;if(t){if(t[7]!==s){const i=+t[7];n=t[8]?Xu(i):wi(i*255,0,255)}return s=+t[1],r=+t[3],o=+t[5],s=255&(t[2]?Xu(s):wi(s,0,255)),r=255&(t[4]?Xu(r):wi(r,0,255)),o=255&(t[6]?Xu(o):wi(o,0,255)),{r:s,g:r,b:o,a:n}}}function jgt(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${wo(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const _y=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Dl=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Ggt(e,t,n){const s=Dl(wo(e.r)),r=Dl(wo(e.g)),o=Dl(wo(e.b));return{r:Mi(_y(s+n*(Dl(wo(t.r))-s))),g:Mi(_y(r+n*(Dl(wo(t.g))-r))),b:Mi(_y(o+n*(Dl(wo(t.b))-o))),a:e.a+n*(t.a-e.a)}}function bp(e,t,n){if(e){let s=rS(e);s[t]=Math.max(0,Math.min(s[t]+s[t]*n,t===0?360:1)),s=iS(s),e.r=s[0],e.g=s[1],e.b=s[2]}}function R3(e,t){return e&&Object.assign(t||{},e)}function Q$(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Mi(e[3]))):(t=R3(e,{r:0,g:0,b:0,a:1}),t.a=Mi(t.a)),t}function Hgt(e){return e.charAt(0)==="r"?Ugt(e):Mgt(e)}class Yd{constructor(t){if(t instanceof Yd)return t;const n=typeof t;let s;n==="object"?s=Q$(t):n==="string"&&(s=Ngt(t)||Vgt(t)||Hgt(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=R3(this._rgb);return t&&(t.a=wo(t.a)),t}set rgb(t){this._rgb=Q$(t)}rgbString(){return this._valid?jgt(this._rgb):void 0}hexString(){return this._valid?_gt(this._rgb):void 0}hslString(){return this._valid?zgt(this._rgb):void 0}mix(t,n){if(t){const s=this.rgb,r=t.rgb;let o;const i=n===o?.5:n,a=2*i-1,l=s.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;o=1-c,s.r=255&c*s.r+o*r.r+.5,s.g=255&c*s.g+o*r.g+.5,s.b=255&c*s.b+o*r.b+.5,s.a=i*s.a+(1-i)*r.a,this.rgb=s}return this}interpolate(t,n){return t&&(this._rgb=Ggt(this._rgb,t._rgb,n)),this}clone(){return new Yd(this.rgb)}alpha(t){return this._rgb.a=Mi(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=Df(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return bp(this._rgb,2,t),this}darken(t){return bp(this._rgb,2,-t),this}saturate(t){return bp(this._rgb,1,t),this}desaturate(t){return bp(this._rgb,1,-t),this}rotate(t){return Lgt(this._rgb,t),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function fo(){}const Kgt=(()=>{let e=0;return()=>e++})();function Ot(e){return e==null}function ke(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Pt(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Ae(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function ys(e,t){return Ae(e)?e:t}function It(e,t){return typeof e>"u"?t:e}const Xgt=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,D3=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function ce(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function Zt(e,t,n,s){let r,o,i;if(ke(e))for(o=e.length,r=0;r<o;r++)t.call(n,e[r],r);else if(Pt(e))for(i=Object.keys(e),o=i.length,r=0;r<o;r++)t.call(n,e[i[r]],i[r])}function dg(e,t){let n,s,r,o;if(!e||!t||e.length!==t.length)return!1;for(n=0,s=e.length;n<s;++n)if(r=e[n],o=t[n],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function hg(e){if(ke(e))return e.map(hg);if(Pt(e)){const t=Object.create(null),n=Object.keys(e),s=n.length;let r=0;for(;r<s;++r)t[n[r]]=hg(e[n[r]]);return t}return e}function A3(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function qgt(e,t,n,s){if(!A3(e))return;const r=t[e],o=n[e];Pt(r)&&Pt(o)?Qd(r,o,s):t[e]=hg(o)}function Qd(e,t,n){const s=ke(t)?t:[t],r=s.length;if(!Pt(e))return e;n=n||{};const o=n.merger||qgt;let i;for(let a=0;a<r;++a){if(i=s[a],!Pt(i))continue;const l=Object.keys(i);for(let c=0,u=l.length;c<u;++c)o(l[c],e,i,n)}return e}function hd(e,t){return Qd(e,t,{merger:Ygt})}function Ygt(e,t,n){if(!A3(e))return;const s=t[e],r=n[e];Pt(s)&&Pt(r)?hd(s,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=hg(r))}const Z$={"":e=>e,x:e=>e.x,y:e=>e.y};function Qgt(e){const t=e.split("."),n=[];let s="";for(const r of t)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Zgt(e){const t=Qgt(e);return n=>{for(const s of t){if(s==="")break;n=n&&n[s]}return n}}function qi(e,t){return(Z$[t]||(Z$[t]=Zgt(t)))(e)}function aS(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Zd=e=>typeof e<"u",Yi=e=>typeof e=="function",J$=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function Jgt(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Gt=Math.PI,ye=2*Gt,txt=ye+Gt,fg=Number.POSITIVE_INFINITY,ext=Gt/180,Be=Gt/2,fa=Gt/4,tT=Gt*2/3,ki=Math.log10,eo=Math.sign;function fd(e,t,n){return Math.abs(e-t)<n}function eT(e){const t=Math.round(e);e=fd(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(ki(e))),s=e/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function nxt(e){const t=[],n=Math.sqrt(e);let s;for(s=1;s<n;s++)e%s===0&&(t.push(s),t.push(e/s));return n===(n|0)&&t.push(n),t.sort((r,o)=>r-o).pop(),t}function sxt(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Wc(e){return!sxt(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function rxt(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function O3(e,t,n){let s,r,o;for(s=0,r=e.length;s<r;s++)o=e[s][n],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function yr(e){return e*(Gt/180)}function lS(e){return e*(180/Gt)}function nT(e){if(!Ae(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function F3(e,t){const n=t.x-e.x,s=t.y-e.y,r=Math.sqrt(n*n+s*s);let o=Math.atan2(s,n);return o<-.5*Gt&&(o+=ye),{angle:o,distance:r}}function O1(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function oxt(e,t){return(e-t+txt)%ye-Gt}function En(e){return(e%ye+ye)%ye}function Jd(e,t,n,s){const r=En(e),o=En(t),i=En(n),a=En(o-r),l=En(i-r),c=En(r-o),u=En(r-i);return r===o||r===i||s&&o===i||a>l&&c<u}function ln(e,t,n){return Math.max(t,Math.min(n,e))}function ixt(e){return ln(e,-32768,32767)}function $o(e,t,n,s=1e-6){return e>=Math.min(t,n)-s&&e<=Math.max(t,n)+s}function cS(e,t,n){n=n||(i=>e[i]<t);let s=e.length-1,r=0,o;for(;s-r>1;)o=r+s>>1,n(o)?r=o:s=o;return{lo:r,hi:s}}const To=(e,t,n,s)=>cS(e,n,s?r=>{const o=e[r][t];return o<n||o===n&&e[r+1][t]===n}:r=>e[r][t]<n),axt=(e,t,n)=>cS(e,n,s=>e[s][t]>=n);function lxt(e,t,n){let s=0,r=e.length;for(;s<r&&e[s]<t;)s++;for(;r>s&&e[r-1]>n;)r--;return s>0||r<e.length?e.slice(s,r):e}const P3=["push","pop","shift","splice","unshift"];function cxt(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),P3.forEach(n=>{const s="_onData"+aS(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...o){const i=r.apply(this,o);return e._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...o)}),i}})})}function sT(e,t){const n=e._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(t);r!==-1&&s.splice(r,1),!(s.length>0)&&(P3.forEach(o=>{delete e[o]}),delete e._chartjs)}function M3(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const L3=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function z3(e,t){let n=[],s=!1;return function(...r){n=r,s||(s=!0,L3.call(window,()=>{s=!1,e.apply(t,n)}))}}function uxt(e,t){let n;return function(...s){return t?(clearTimeout(n),n=setTimeout(e,t,s)):e.apply(this,s),t}}const uS=e=>e==="start"?"left":e==="end"?"right":"center",Tn=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,dxt=(e,t,n,s)=>e===(s?"left":"right")?n:e==="center"?(t+n)/2:t;function B3(e,t,n){const s=t.length;let r=0,o=s;if(e._sorted){const{iScale:i,vScale:a,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,u=i.axis,{min:d,max:h,minDefined:f,maxDefined:p}=i.getUserBounds();if(f){if(r=Math.min(To(l,u,d).lo,n?s:To(t,u,i.getPixelForValue(d)).lo),c){const m=l.slice(0,r+1).reverse().findIndex(g=>!Ot(g[a.axis]));r-=Math.max(0,m)}r=ln(r,0,s-1)}if(p){let m=Math.max(To(l,i.axis,h,!0).hi+1,n?0:To(t,u,i.getPixelForValue(h),!0).hi+1);if(c){const g=l.slice(m-1).findIndex(x=>!Ot(x[a.axis]));m+=Math.max(0,g)}o=ln(m,r,s)-r}else o=s-r}return{start:r,count:o}}function V3(e){const{xScale:t,yScale:n,_scaleRanges:s}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!s)return e._scaleRanges=r,!0;const o=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),o}const vp=e=>e===0||e===1,rT=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*ye/n)),oT=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*ye/n)+1,pd={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Be)+1,easeOutSine:e=>Math.sin(e*Be),easeInOutSine:e=>-.5*(Math.cos(Gt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>vp(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>vp(e)?e:rT(e,.075,.3),easeOutElastic:e=>vp(e)?e:oT(e,.075,.3),easeInOutElastic(e){return vp(e)?e:e<.5?.5*rT(e*2,.1125,.45):.5+.5*oT(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-pd.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?pd.easeInBounce(e*2)*.5:pd.easeOutBounce(e*2-1)*.5+.5};function dS(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function iT(e){return dS(e)?e:new Yd(e)}function Ry(e){return dS(e)?e:new Yd(e).saturate(.5).darken(.1).hexString()}const hxt=["x","y","borderWidth","radius","tension"],fxt=["color","borderColor","backgroundColor"];function pxt(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:fxt},numbers:{type:"number",properties:hxt}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function mxt(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const aT=new Map;function gxt(e,t){t=t||{};const n=e+JSON.stringify(t);let s=aT.get(n);return s||(s=new Intl.NumberFormat(e,t),aT.set(n,s)),s}function Af(e,t,n){return gxt(t,n).format(e)}const W3={values(e){return ke(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const s=this.chart.options.locale;let r,o=e;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),o=xxt(e,n)}const i=ki(Math.abs(o)),a=isNaN(i)?1:Math.max(Math.min(-1*Math.floor(i),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Af(e,s,l)},logarithmic(e,t,n){if(e===0)return"0";const s=n[t].significand||e/Math.pow(10,Math.floor(ki(e)));return[1,2,3,5,10,15].includes(s)||t>.8*n.length?W3.numeric.call(this,e,t,n):""}};function xxt(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var C0={formatters:W3};function yxt(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:C0.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const hl=Object.create(null),F1=Object.create(null);function md(e,t){if(!t)return e;const n=t.split(".");for(let s=0,r=n.length;s<r;++s){const o=n[s];e=e[o]||(e[o]=Object.create(null))}return e}function Dy(e,t,n){return typeof t=="string"?Qd(md(e,t),n):Qd(md(e,""),t)}class bxt{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Ry(r.backgroundColor),this.hoverBorderColor=(s,r)=>Ry(r.borderColor),this.hoverColor=(s,r)=>Ry(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return Dy(this,t,n)}get(t){return md(this,t)}describe(t,n){return Dy(F1,t,n)}override(t,n){return Dy(hl,t,n)}route(t,n,s,r){const o=md(this,t),i=md(this,s),a="_"+n;Object.defineProperties(o,{[a]:{value:o[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=i[r];return Pt(l)?Object.assign({},c,l):It(l,c)},set(l){this[a]=l}}})}apply(t){t.forEach(n=>n(this))}}var Se=new bxt({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[pxt,mxt,yxt]);function vxt(e){return!e||Ot(e.size)||Ot(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function pg(e,t,n,s,r){let o=t[r];return o||(o=t[r]=e.measureText(r).width,n.push(r)),o>s&&(s=o),s}function wxt(e,t,n,s){s=s||{};let r=s.data=s.data||{},o=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(r=s.data={},o=s.garbageCollect=[],s.font=t),e.save(),e.font=t;let i=0;const a=n.length;let l,c,u,d,h;for(l=0;l<a;l++)if(d=n[l],d!=null&&!ke(d))i=pg(e,r,o,i,d);else if(ke(d))for(c=0,u=d.length;c<u;c++)h=d[c],h!=null&&!ke(h)&&(i=pg(e,r,o,i,h));e.restore();const f=o.length/2;if(f>n.length){for(l=0;l<f;l++)delete r[o[l]];o.splice(0,f)}return i}function pa(e,t,n){const s=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*s)/s+r}function lT(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function P1(e,t,n,s){U3(e,t,n,s,null)}function U3(e,t,n,s,r){let o,i,a,l,c,u,d,h;const f=t.pointStyle,p=t.rotation,m=t.radius;let g=(p||0)*ext;if(f&&typeof f=="object"&&(o=f.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){e.save(),e.translate(n,s),e.rotate(g),e.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),e.restore();return}if(!(isNaN(m)||m<=0)){switch(e.beginPath(),f){default:r?e.ellipse(n,s,r/2,m,0,0,ye):e.arc(n,s,m,0,ye),e.closePath();break;case"triangle":u=r?r/2:m,e.moveTo(n+Math.sin(g)*u,s-Math.cos(g)*m),g+=tT,e.lineTo(n+Math.sin(g)*u,s-Math.cos(g)*m),g+=tT,e.lineTo(n+Math.sin(g)*u,s-Math.cos(g)*m),e.closePath();break;case"rectRounded":c=m*.516,l=m-c,i=Math.cos(g+fa)*l,d=Math.cos(g+fa)*(r?r/2-c:l),a=Math.sin(g+fa)*l,h=Math.sin(g+fa)*(r?r/2-c:l),e.arc(n-d,s-a,c,g-Gt,g-Be),e.arc(n+h,s-i,c,g-Be,g),e.arc(n+d,s+a,c,g,g+Be),e.arc(n-h,s+i,c,g+Be,g+Gt),e.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,u=r?r/2:l,e.rect(n-u,s-l,2*u,2*l);break}g+=fa;case"rectRot":d=Math.cos(g)*(r?r/2:m),i=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),e.moveTo(n-d,s-a),e.lineTo(n+h,s-i),e.lineTo(n+d,s+a),e.lineTo(n-h,s+i),e.closePath();break;case"crossRot":g+=fa;case"cross":d=Math.cos(g)*(r?r/2:m),i=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),e.moveTo(n-d,s-a),e.lineTo(n+d,s+a),e.moveTo(n+h,s-i),e.lineTo(n-h,s+i);break;case"star":d=Math.cos(g)*(r?r/2:m),i=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),e.moveTo(n-d,s-a),e.lineTo(n+d,s+a),e.moveTo(n+h,s-i),e.lineTo(n-h,s+i),g+=fa,d=Math.cos(g)*(r?r/2:m),i=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),e.moveTo(n-d,s-a),e.lineTo(n+d,s+a),e.moveTo(n+h,s-i),e.lineTo(n-h,s+i);break;case"line":i=r?r/2:Math.cos(g)*m,a=Math.sin(g)*m,e.moveTo(n-i,s-a),e.lineTo(n+i,s+a);break;case"dash":e.moveTo(n,s),e.lineTo(n+Math.cos(g)*(r?r/2:m),s+Math.sin(g)*m);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function No(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function S0(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function I0(e){e.restore()}function kxt(e,t,n,s,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const o=(t.x+n.x)/2;e.lineTo(o,t.y),e.lineTo(o,n.y)}else r==="after"!=!!s?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Cxt(e,t,n,s){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function Sxt(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Ot(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function Ixt(e,t,n,s,r){if(r.strikethrough||r.underline){const o=e.measureText(s),i=t-o.actualBoundingBoxLeft,a=t+o.actualBoundingBoxRight,l=n-o.actualBoundingBoxAscent,c=n+o.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(i,u),e.lineTo(a,u),e.stroke()}}function $xt(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function fl(e,t,n,s,r,o={}){const i=ke(t)?t:[t],a=o.strokeWidth>0&&o.strokeColor!=="";let l,c;for(e.save(),e.font=r.string,Sxt(e,o),l=0;l<i.length;++l)c=i[l],o.backdrop&&$xt(e,o.backdrop),a&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),Ot(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(c,n,s,o.maxWidth)),e.fillText(c,n,s,o.maxWidth),Ixt(e,n,s,c,o),s+=Number(r.lineHeight);e.restore()}function th(e,t){const{x:n,y:s,w:r,h:o,radius:i}=t;e.arc(n+i.topLeft,s+i.topLeft,i.topLeft,1.5*Gt,Gt,!0),e.lineTo(n,s+o-i.bottomLeft),e.arc(n+i.bottomLeft,s+o-i.bottomLeft,i.bottomLeft,Gt,Be,!0),e.lineTo(n+r-i.bottomRight,s+o),e.arc(n+r-i.bottomRight,s+o-i.bottomRight,i.bottomRight,Be,0,!0),e.lineTo(n+r,s+i.topRight),e.arc(n+r-i.topRight,s+i.topRight,i.topRight,0,-Be,!0),e.lineTo(n+i.topLeft,s)}const Txt=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Nxt=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Ext(e,t){const n=(""+e).match(Txt);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const _xt=e=>+e||0;function hS(e,t){const n={},s=Pt(t),r=s?Object.keys(t):t,o=Pt(e)?s?i=>It(e[i],e[t[i]]):i=>e[i]:()=>e;for(const i of r)n[i]=_xt(o(i));return n}function j3(e){return hS(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Wa(e){return hS(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Ln(e){const t=j3(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function nn(e,t){e=e||{},t=t||Se.font;let n=It(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let s=It(e.style,t.style);s&&!(""+s).match(Nxt)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:It(e.family,t.family),lineHeight:Ext(It(e.lineHeight,t.lineHeight),n),size:n,style:s,weight:It(e.weight,t.weight),string:""};return r.string=vxt(r),r}function qu(e,t,n,s){let r,o,i;for(r=0,o=e.length;r<o;++r)if(i=e[r],i!==void 0&&i!==void 0)return i}function Rxt(e,t,n){const{min:s,max:r}=e,o=D3(t,(r-s)/2),i=(a,l)=>n&&a===0?0:a+l;return{min:i(s,-Math.abs(o)),max:i(r,o)}}function ca(e,t){return Object.assign(Object.create(e),t)}function fS(e,t=[""],n,s,r=()=>e[0]){const o=n||e;typeof s>"u"&&(s=X3("_fallback",e));const i={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:o,_fallback:s,_getTarget:r,override:a=>fS([a,...e],t,o,s)};return new Proxy(i,{deleteProperty(a,l){return delete a[l],delete a._keys,delete e[0][l],!0},get(a,l){return H3(a,l,()=>zxt(l,t,e,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(a,l){return uT(a).includes(l)},ownKeys(a){return uT(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function Uc(e,t,n,s){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:G3(e,s),setContext:o=>Uc(e,o,n,s),override:o=>Uc(e.override(o),t,n,s)};return new Proxy(r,{deleteProperty(o,i){return delete o[i],delete e[i],!0},get(o,i,a){return H3(o,i,()=>Axt(o,i,a))},getOwnPropertyDescriptor(o,i){return o._descriptors.allKeys?Reflect.has(e,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,i)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(o,i){return Reflect.has(e,i)},ownKeys(){return Reflect.ownKeys(e)},set(o,i,a){return e[i]=a,delete o[i],!0}})}function G3(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:s=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Yi(n)?n:()=>n,isIndexable:Yi(s)?s:()=>s}}const Dxt=(e,t)=>e?e+aS(t):t,pS=(e,t)=>Pt(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function H3(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const s=n();return e[t]=s,s}function Axt(e,t,n){const{_proxy:s,_context:r,_subProxy:o,_descriptors:i}=e;let a=s[t];return Yi(a)&&i.isScriptable(t)&&(a=Oxt(t,a,e,n)),ke(a)&&a.length&&(a=Fxt(t,a,e,i.isIndexable)),pS(t,a)&&(a=Uc(a,r,o&&o[t],i)),a}function Oxt(e,t,n,s){const{_proxy:r,_context:o,_subProxy:i,_stack:a}=n;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e);let l=t(o,i||s);return a.delete(e),pS(e,l)&&(l=mS(r._scopes,r,e,l)),l}function Fxt(e,t,n,s){const{_proxy:r,_context:o,_subProxy:i,_descriptors:a}=n;if(typeof o.index<"u"&&s(e))return t[o.index%t.length];if(Pt(t[0])){const l=t,c=r._scopes.filter(u=>u!==l);t=[];for(const u of l){const d=mS(c,r,e,u);t.push(Uc(d,o,i&&i[e],a))}}return t}function K3(e,t,n){return Yi(e)?e(t,n):e}const Pxt=(e,t)=>e===!0?t:typeof e=="string"?qi(t,e):void 0;function Mxt(e,t,n,s,r){for(const o of t){const i=Pxt(n,o);if(i){e.add(i);const a=K3(i._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(i===!1&&typeof s<"u"&&n!==s)return null}return!1}function mS(e,t,n,s){const r=t._rootScopes,o=K3(t._fallback,n,s),i=[...e,...r],a=new Set;a.add(s);let l=cT(a,i,n,o||n,s);return l===null||typeof o<"u"&&o!==n&&(l=cT(a,i,o,l,s),l===null)?!1:fS(Array.from(a),[""],r,o,()=>Lxt(t,n,s))}function cT(e,t,n,s,r){for(;n;)n=Mxt(e,t,n,s,r);return n}function Lxt(e,t,n){const s=e._getTarget();t in s||(s[t]={});const r=s[t];return ke(r)&&Pt(n)?n:r||{}}function zxt(e,t,n,s){let r;for(const o of t)if(r=X3(Dxt(o,e),n),typeof r<"u")return pS(e,r)?mS(n,s,e,r):r}function X3(e,t){for(const n of t){if(!n)continue;const s=n[e];if(typeof s<"u")return s}}function uT(e){let t=e._keys;return t||(t=e._keys=Bxt(e._scopes)),t}function Bxt(e){const t=new Set;for(const n of e)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(s);return Array.from(t)}function q3(e,t,n,s){const{iScale:r}=e,{key:o="r"}=this._parsing,i=new Array(s);let a,l,c,u;for(a=0,l=s;a<l;++a)c=a+n,u=t[c],i[a]={r:r.parse(qi(u,o),c)};return i}const Vxt=Number.EPSILON||1e-14,jc=(e,t)=>t<e.length&&!e[t].skip&&e[t],Y3=e=>e==="x"?"y":"x";function Wxt(e,t,n,s){const r=e.skip?t:e,o=t,i=n.skip?t:n,a=O1(o,r),l=O1(i,o);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=s*c,h=s*u;return{previous:{x:o.x-d*(i.x-r.x),y:o.y-d*(i.y-r.y)},next:{x:o.x+h*(i.x-r.x),y:o.y+h*(i.y-r.y)}}}function Uxt(e,t,n){const s=e.length;let r,o,i,a,l,c=jc(e,0);for(let u=0;u<s-1;++u)if(l=c,c=jc(e,u+1),!(!l||!c)){if(fd(t[u],0,Vxt)){n[u]=n[u+1]=0;continue}r=n[u]/t[u],o=n[u+1]/t[u],a=Math.pow(r,2)+Math.pow(o,2),!(a<=9)&&(i=3/Math.sqrt(a),n[u]=r*i*t[u],n[u+1]=o*i*t[u])}}function jxt(e,t,n="x"){const s=Y3(n),r=e.length;let o,i,a,l=jc(e,0);for(let c=0;c<r;++c){if(i=a,a=l,l=jc(e,c+1),!a)continue;const u=a[n],d=a[s];i&&(o=(u-i[n])/3,a[`cp1${n}`]=u-o,a[`cp1${s}`]=d-o*t[c]),l&&(o=(l[n]-u)/3,a[`cp2${n}`]=u+o,a[`cp2${s}`]=d+o*t[c])}}function Gxt(e,t="x"){const n=Y3(t),s=e.length,r=Array(s).fill(0),o=Array(s);let i,a,l,c=jc(e,0);for(i=0;i<s;++i)if(a=l,l=c,c=jc(e,i+1),!!l){if(c){const u=c[t]-l[t];r[i]=u!==0?(c[n]-l[n])/u:0}o[i]=a?c?eo(r[i-1])!==eo(r[i])?0:(r[i-1]+r[i])/2:r[i-1]:r[i]}Uxt(e,r,o),jxt(e,o,t)}function wp(e,t,n){return Math.max(Math.min(e,n),t)}function Hxt(e,t){let n,s,r,o,i,a=No(e[0],t);for(n=0,s=e.length;n<s;++n)i=o,o=a,a=n<s-1&&No(e[n+1],t),o&&(r=e[n],i&&(r.cp1x=wp(r.cp1x,t.left,t.right),r.cp1y=wp(r.cp1y,t.top,t.bottom)),a&&(r.cp2x=wp(r.cp2x,t.left,t.right),r.cp2y=wp(r.cp2y,t.top,t.bottom)))}function Kxt(e,t,n,s,r){let o,i,a,l;if(t.spanGaps&&(e=e.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")Gxt(e,r);else{let c=s?e[e.length-1]:e[0];for(o=0,i=e.length;o<i;++o)a=e[o],l=Wxt(c,a,e[Math.min(o+1,i-(s?0:1))%i],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&Hxt(e,n)}function gS(){return typeof window<"u"&&typeof document<"u"}function xS(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function mg(e,t,n){let s;return typeof e=="string"?(s=parseInt(e,10),e.indexOf("%")!==-1&&(s=s/100*t.parentNode[n])):s=e,s}const $0=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function Xxt(e,t){return $0(e).getPropertyValue(t)}const qxt=["top","right","bottom","left"];function Ua(e,t,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const o=qxt[r];s[o]=parseFloat(e[t+"-"+o+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Yxt=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function Qxt(e,t){const n=e.touches,s=n&&n.length?n[0]:e,{offsetX:r,offsetY:o}=s;let i=!1,a,l;if(Yxt(r,o,e.target))a=r,l=o;else{const c=t.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,i=!0}return{x:a,y:l,box:i}}function va(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:s}=t,r=$0(n),o=r.boxSizing==="border-box",i=Ua(r,"padding"),a=Ua(r,"border","width"),{x:l,y:c,box:u}=Qxt(e,n),d=i.left+(u&&a.left),h=i.top+(u&&a.top);let{width:f,height:p}=t;return o&&(f-=i.width+a.width,p-=i.height+a.height),{x:Math.round((l-d)/f*n.width/s),y:Math.round((c-h)/p*n.height/s)}}function Zxt(e,t,n){let s,r;if(t===void 0||n===void 0){const o=e&&xS(e);if(!o)t=e.clientWidth,n=e.clientHeight;else{const i=o.getBoundingClientRect(),a=$0(o),l=Ua(a,"border","width"),c=Ua(a,"padding");t=i.width-c.width-l.width,n=i.height-c.height-l.height,s=mg(a.maxWidth,o,"clientWidth"),r=mg(a.maxHeight,o,"clientHeight")}}return{width:t,height:n,maxWidth:s||fg,maxHeight:r||fg}}const kp=e=>Math.round(e*10)/10;function Jxt(e,t,n,s){const r=$0(e),o=Ua(r,"margin"),i=mg(r.maxWidth,e,"clientWidth")||fg,a=mg(r.maxHeight,e,"clientHeight")||fg,l=Zxt(e,t,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const h=Ua(r,"border","width"),f=Ua(r,"padding");c-=f.width+h.width,u-=f.height+h.height}return c=Math.max(0,c-o.width),u=Math.max(0,s?c/s:u-o.height),c=kp(Math.min(c,i,l.maxWidth)),u=kp(Math.min(u,a,l.maxHeight)),c&&!u&&(u=kp(c/2)),(t!==void 0||n!==void 0)&&s&&l.height&&u>l.height&&(u=l.height,c=kp(Math.floor(u*s))),{width:c,height:u}}function dT(e,t,n){const s=t||1,r=Math.floor(e.height*s),o=Math.floor(e.width*s);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const i=e.canvas;return i.style&&(n||!i.style.height&&!i.style.width)&&(i.style.height=`${e.height}px`,i.style.width=`${e.width}px`),e.currentDevicePixelRatio!==s||i.height!==r||i.width!==o?(e.currentDevicePixelRatio=s,i.height=r,i.width=o,e.ctx.setTransform(s,0,0,s,0,0),!0):!1}const t0t=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};gS()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function hT(e,t){const n=Xxt(e,t),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function wa(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function e0t(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:s==="middle"?n<.5?e.y:t.y:s==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function n0t(e,t,n,s){const r={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},i=wa(e,r,n),a=wa(r,o,n),l=wa(o,t,n),c=wa(i,a,n),u=wa(a,l,n);return wa(c,u,n)}const s0t=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},r0t=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function cc(e,t,n){return e?s0t(t,n):r0t()}function Q3(e,t){let n,s;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=s)}function Z3(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function J3(e){return e==="angle"?{between:Jd,compare:oxt,normalize:En}:{between:$o,compare:(t,n)=>t-n,normalize:t=>t}}function fT({start:e,end:t,count:n,loop:s,style:r}){return{start:e%n,end:t%n,loop:s&&(t-e+1)%n===0,style:r}}function o0t(e,t,n){const{property:s,start:r,end:o}=n,{between:i,normalize:a}=J3(s),l=t.length;let{start:c,end:u,loop:d}=e,h,f;if(d){for(c+=l,u+=l,h=0,f=l;h<f&&i(a(t[c%l][s]),r,o);++h)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:e.style}}function tz(e,t,n){if(!n)return[e];const{property:s,start:r,end:o}=n,i=t.length,{compare:a,between:l,normalize:c}=J3(s),{start:u,end:d,loop:h,style:f}=o0t(e,t,n),p=[];let m=!1,g=null,x,y,b;const v=()=>l(r,b,x)&&a(r,b)!==0,w=()=>a(o,x)===0||l(o,b,x),k=()=>m||v(),C=()=>!m||w();for(let S=u,I=u;S<=d;++S)y=t[S%i],!y.skip&&(x=c(y[s]),x!==b&&(m=l(x,r,o),g===null&&k()&&(g=a(x,r)===0?S:I),g!==null&&C()&&(p.push(fT({start:g,end:S,loop:h,count:i,style:f})),g=null),I=S,b=x));return g!==null&&p.push(fT({start:g,end:d,loop:h,count:i,style:f})),p}function ez(e,t){const n=[],s=e.segments;for(let r=0;r<s.length;r++){const o=tz(s[r],e.points,t);o.length&&n.push(...o)}return n}function i0t(e,t,n,s){let r=0,o=t-1;if(n&&!s)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(o+=r);o>r&&e[o%t].skip;)o--;return o%=t,{start:r,end:o}}function a0t(e,t,n,s){const r=e.length,o=[];let i=t,a=e[t],l;for(l=t+1;l<=n;++l){const c=e[l%r];c.skip||c.stop?a.skip||(s=!1,o.push({start:t%r,end:(l-1)%r,loop:s}),t=i=c.stop?l:null):(i=l,a.skip&&(t=l)),a=c}return i!==null&&o.push({start:t%r,end:i%r,loop:s}),o}function l0t(e,t){const n=e.points,s=e.options.spanGaps,r=n.length;if(!r)return[];const o=!!e._loop,{start:i,end:a}=i0t(n,r,o,s);if(s===!0)return pT(e,[{start:i,end:a,loop:o}],n,t);const l=a<i?a+r:a,c=!!e._fullLoop&&i===0&&a===r-1;return pT(e,a0t(n,i,l,c),n,t)}function pT(e,t,n,s){return!s||!s.setContext||!n?t:c0t(e,t,n,s)}function c0t(e,t,n,s){const r=e._chart.getContext(),o=mT(e.options),{_datasetIndex:i,options:{spanGaps:a}}=e,l=n.length,c=[];let u=o,d=t[0].start,h=d;function f(p,m,g,x){const y=a?-1:1;if(p!==m){for(p+=l;n[p%l].skip;)p-=y;for(;n[m%l].skip;)m+=y;p%l!==m%l&&(c.push({start:p%l,end:m%l,loop:g,style:x}),u=x,d=m%l)}}for(const p of t){d=a?d:p.start;let m=n[d%l],g;for(h=d+1;h<=p.end;h++){const x=n[h%l];g=mT(s.setContext(ca(r,{type:"segment",p0:m,p1:x,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:i}))),u0t(g,u)&&f(d,h-1,p.loop,u),m=x,u=g}d<h-1&&f(d,h-1,p.loop,u)}return c}function mT(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function u0t(e,t){if(!t)return!1;const n=[],s=function(r,o){return dS(o)?(n.includes(o)||n.push(o),n.indexOf(o)):o};return JSON.stringify(e,s)!==JSON.stringify(t,s)}function Cp(e,t,n){return e.options.clip?e[n]:t[n]}function d0t(e,t){const{xScale:n,yScale:s}=e;return n&&s?{left:Cp(n,t,"left"),right:Cp(n,t,"right"),top:Cp(s,t,"top"),bottom:Cp(s,t,"bottom")}:t}function nz(e,t){const n=t._clip;if(n.disabled)return!1;const s=d0t(t,e.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?e.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?e.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class h0t{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,s,r){const o=n.listeners[r],i=n.duration;o.forEach(a=>a({chart:t,initial:n.initial,numSteps:i,currentStep:Math.min(s-n.start,i)}))}_refresh(){this._request||(this._running=!0,this._request=L3.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const o=s.items;let i=o.length-1,a=!1,l;for(;i>=0;--i)l=o[i],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(t),a=!0):(o[i]=o[o.length-1],o.pop());a&&(r.draw(),this._notify(r,s,t,"progress")),o.length||(s.running=!1,this._notify(r,s,t,"complete"),s.initial=!1),n+=o.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let s=n.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,s)),s}listen(t,n,s){this._getAnims(t).listeners[n].push(s)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var mo=new h0t;const gT="transparent",f0t={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const s=iT(e||gT),r=s.valid&&iT(t||gT);return r&&r.valid?r.mix(s,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class p0t{constructor(t,n,s,r){const o=n[s];r=qu([t.to,r,o,t.from]);const i=qu([t.from,o,r]);this._active=!0,this._fn=t.fn||f0t[t.type||typeof i],this._easing=pd[t.easing]||pd.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=s,this._from=i,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],o=s-this._start,i=this._duration-o;this._start=s,this._duration=Math.floor(Math.max(i,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=qu([t.to,n,r,t.from]),this._from=qu([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,s=this._duration,r=this._prop,o=this._from,i=this._loop,a=this._to;let l;if(this._active=o!==a&&(i||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=o;return}l=n/s%2,l=i&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(o,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,s)=>{t.push({res:n,rej:s})})}_notify(t){const n=t?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class sz{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!Pt(t))return;const n=Object.keys(Se.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const o=t[r];if(!Pt(o))return;const i={};for(const a of n)i[a]=o[a];(ke(o.properties)&&o.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,i)})})}_animateOptions(t,n){const s=n.options,r=g0t(t,s);if(!r)return[];const o=this._createAnimations(r,s);return s.$shared&&m0t(t.options.$animations,s).then(()=>{t.options=s},()=>{}),o}_createAnimations(t,n){const s=this._properties,r=[],o=t.$animations||(t.$animations={}),i=Object.keys(n),a=Date.now();let l;for(l=i.length-1;l>=0;--l){const c=i[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(t,n));continue}const u=n[c];let d=o[c];const h=s.get(c);if(d)if(h&&d.active()){d.update(h,u,a);continue}else d.cancel();if(!h||!h.duration){t[c]=u;continue}o[c]=d=new p0t(h,t,c,u),r.push(d)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const s=this._createAnimations(t,n);if(s.length)return mo.add(this._chart,s),!0}}function m0t(e,t){const n=[],s=Object.keys(t);for(let r=0;r<s.length;r++){const o=e[s[r]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}function g0t(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function xT(e,t){const n=e&&e.options||{},s=n.reverse,r=n.min===void 0?t:0,o=n.max===void 0?t:0;return{start:s?o:r,end:s?r:o}}function x0t(e,t,n){if(n===!1)return!1;const s=xT(e,n),r=xT(t,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function y0t(e){let t,n,s,r;return Pt(e)?(t=e.top,n=e.right,s=e.bottom,r=e.left):t=n=s=r=e,{top:t,right:n,bottom:s,left:r,disabled:e===!1}}function rz(e,t){const n=[],s=e._getSortedDatasetMetas(t);let r,o;for(r=0,o=s.length;r<o;++r)n.push(s[r].index);return n}function yT(e,t,n,s={}){const r=e.keys,o=s.mode==="single";let i,a,l,c;if(t===null)return;let u=!1;for(i=0,a=r.length;i<a;++i){if(l=+r[i],l===n){if(u=!0,s.all)continue;break}c=e.values[l],Ae(c)&&(o||t===0||eo(t)===eo(c))&&(t+=c)}return!u&&!s.all?0:t}function b0t(e,t){const{iScale:n,vScale:s}=t,r=n.axis==="x"?"x":"y",o=s.axis==="x"?"x":"y",i=Object.keys(e),a=new Array(i.length);let l,c,u;for(l=0,c=i.length;l<c;++l)u=i[l],a[l]={[r]:u,[o]:e[u]};return a}function Ay(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function v0t(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function w0t(e){const{min:t,max:n,minDefined:s,maxDefined:r}=e.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function k0t(e,t,n){const s=e[t]||(e[t]={});return s[n]||(s[n]={})}function bT(e,t,n,s){for(const r of t.getMatchingVisibleMetas(s).reverse()){const o=e[r.index];if(n&&o>0||!n&&o<0)return r.index}return null}function vT(e,t){const{chart:n,_cachedMeta:s}=e,r=n._stacks||(n._stacks={}),{iScale:o,vScale:i,index:a}=s,l=o.axis,c=i.axis,u=v0t(o,i,s),d=t.length;let h;for(let f=0;f<d;++f){const p=t[f],{[l]:m,[c]:g}=p,x=p._stacks||(p._stacks={});h=x[c]=k0t(r,u,m),h[a]=g,h._top=bT(h,i,!0,s.type),h._bottom=bT(h,i,!1,s.type);const y=h._visualValues||(h._visualValues={});y[a]=g}}function Oy(e,t){const n=e.scales;return Object.keys(n).filter(s=>n[s].axis===t).shift()}function C0t(e,t){return ca(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function S0t(e,t,n){return ca(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Du(e,t){const n=e.controller.index,s=e.vScale&&e.vScale.axis;if(s){t=t||e._parsed;for(const r of t){const o=r._stacks;if(!o||o[s]===void 0||o[s][n]===void 0)return;delete o[s][n],o[s]._visualValues!==void 0&&o[s]._visualValues[n]!==void 0&&delete o[s]._visualValues[n]}}}const Fy=e=>e==="reset"||e==="none",wT=(e,t)=>t?e:Object.assign({},e),I0t=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:rz(n,!0),values:null};class Sr{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Ay(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Du(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(d,h,f,p)=>d==="x"?h:d==="r"?p:f,o=n.xAxisID=It(s.xAxisID,Oy(t,"x")),i=n.yAxisID=It(s.yAxisID,Oy(t,"y")),a=n.rAxisID=It(s.rAxisID,Oy(t,"r")),l=n.indexAxis,c=n.iAxisID=r(l,o,i,a),u=n.vAxisID=r(l,i,o,a);n.xScale=this.getScaleForId(o),n.yScale=this.getScaleForId(i),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&sT(this._data,this),t._stacked&&Du(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),s=this._data;if(Pt(n)){const r=this._cachedMeta;this._data=b0t(n,r)}else if(s!==n){if(s){sT(s,this);const r=this._cachedMeta;Du(r),r._parsed=[]}n&&Object.isExtensible(n)&&cxt(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const o=n._stacked;n._stacked=Ay(n.vScale,n),n.stack!==s.stack&&(r=!0,Du(n),n.stack=s.stack),this._resyncElements(t),(r||o!==n._stacked)&&(vT(this,n._parsed),n._stacked=Ay(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:s,_data:r}=this,{iScale:o,_stacked:i}=s,a=o.axis;let l=t===0&&n===r.length?!0:s._sorted,c=t>0&&s._parsed[t-1],u,d,h;if(this._parsing===!1)s._parsed=r,s._sorted=!0,h=r;else{ke(r[t])?h=this.parseArrayData(s,r,t,n):Pt(r[t])?h=this.parseObjectData(s,r,t,n):h=this.parsePrimitiveData(s,r,t,n);const f=()=>d[a]===null||c&&d[a]<c[a];for(u=0;u<n;++u)s._parsed[u+t]=d=h[u],l&&(f()&&(l=!1),c=d);s._sorted=l}i&&vT(this,h)}parsePrimitiveData(t,n,s,r){const{iScale:o,vScale:i}=t,a=o.axis,l=i.axis,c=o.getLabels(),u=o===i,d=new Array(r);let h,f,p;for(h=0,f=r;h<f;++h)p=h+s,d[h]={[a]:u||o.parse(c[p],p),[l]:i.parse(n[p],p)};return d}parseArrayData(t,n,s,r){const{xScale:o,yScale:i}=t,a=new Array(r);let l,c,u,d;for(l=0,c=r;l<c;++l)u=l+s,d=n[u],a[l]={x:o.parse(d[0],u),y:i.parse(d[1],u)};return a}parseObjectData(t,n,s,r){const{xScale:o,yScale:i}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,d,h,f;for(u=0,d=r;u<d;++u)h=u+s,f=n[h],c[u]={x:o.parse(qi(f,a),h),y:i.parse(qi(f,l),h)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,s){const r=this.chart,o=this._cachedMeta,i=n[t.axis],a={keys:rz(r,!0),values:n._stacks[t.axis]._visualValues};return yT(a,i,o.index,{mode:s})}updateRangeFromParsed(t,n,s,r){const o=s[n.axis];let i=o===null?NaN:o;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,i=yT(r,o,this._cachedMeta.index)),t.min=Math.min(t.min,i),t.max=Math.max(t.max,i)}getMinMax(t,n){const s=this._cachedMeta,r=s._parsed,o=s._sorted&&t===s.iScale,i=r.length,a=this._getOtherScale(t),l=I0t(n,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=w0t(a);let h,f;function p(){f=r[h];const m=f[a.axis];return!Ae(f[t.axis])||u>m||d<m}for(h=0;h<i&&!(!p()&&(this.updateRangeFromParsed(c,t,f,l),o));++h);if(o){for(h=i-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(c,t,f,l);break}}return c}getAllParsedValues(t){const n=this._cachedMeta._parsed,s=[];let r,o,i;for(r=0,o=n.length;r<o;++r)i=n[r][t.axis],Ae(i)&&s.push(i);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,s=n.iScale,r=n.vScale,o=this.getParsed(t);return{label:s?""+s.getLabelForValue(o[s.axis]):"",value:r?""+r.getLabelForValue(o[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=y0t(It(this.options.clip,x0t(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],o=n.chartArea,i=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(t,o,a,l),u=a;u<a+l;++u){const d=r[u];d.hidden||(d.active&&c?i.push(d):d.draw(t,o))}for(u=0;u<i.length;++u)i[u].draw(t,o)}getStyle(t,n){const s=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,n,s){const r=this.getDataset();let o;if(t>=0&&t<this._cachedMeta.data.length){const i=this._cachedMeta.data[t];o=i.$context||(i.$context=S0t(this.getContext(),t,i)),o.parsed=this.getParsed(t),o.raw=r.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=C0t(this.chart.getContext(),this.index)),o.dataset=r,o.index=o.datasetIndex=this.index;return o.active=!!n,o.mode=s,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",s){const r=n==="active",o=this._cachedDataOpts,i=t+"-"+n,a=o[i],l=this.enableOptionSharing&&Zd(s);if(a)return wT(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),d=r?[`${t}Hover`,"hover",t,""]:[t,""],h=c.getOptionScopes(this.getDataset(),u),f=Object.keys(Se.elements[t]),p=()=>this.getContext(s,r,n),m=c.resolveNamedOptions(h,f,p,d);return m.$shared&&(m.$shared=l,o[i]=Object.freeze(wT(m,l))),m}_resolveAnimations(t,n,s){const r=this.chart,o=this._cachedDataOpts,i=`animation-${n}`,a=o[i];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,n),h=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(h,this.getContext(t,s,n))}const c=new sz(r,l&&l.animations);return l&&l._cacheable&&(o[i]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||Fy(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const s=this.resolveDataElementOptions(t,n),r=this._sharedOptions,o=this.getSharedOptions(s),i=this.includeOptions(n,o)||o!==r;return this.updateSharedOptions(o,n,s),{sharedOptions:o,includeOptions:i}}updateElement(t,n,s,r){Fy(r)?Object.assign(t,s):this._resolveAnimations(n,r).update(t,s)}updateSharedOptions(t,n,s){t&&!Fy(n)&&this._resolveAnimations(void 0,n).update(t,s)}_setStyle(t,n,s,r){t.active=r;const o=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(t,{options:!r&&this.getSharedOptions(o)||o})}removeHoverStyle(t,n,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,n,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=s.length,o=n.length,i=Math.min(o,r);i&&this.parse(0,i),o>r?this._insertElements(r,o-r,t):o<r&&this._removeElements(o,r-o)}_insertElements(t,n,s=!0){const r=this._cachedMeta,o=r.data,i=t+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=i;a--)c[a]=c[a-n]};for(l(o),a=t;a<i;++a)o[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(t,n),s&&this.updateElements(o,t,n,"reset")}updateElements(t,n,s,r){}_removeElements(t,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(t,n);s._stacked&&Du(s,r)}s.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,s,r]=t;this[n](s,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}it(Sr,"defaults",{}),it(Sr,"datasetElementType",null),it(Sr,"dataElementType",null);function $0t(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let s=[];for(let r=0,o=n.length;r<o;r++)s=s.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=M3(s.sort((r,o)=>r-o))}return e._cache.$bar}function T0t(e){const t=e.iScale,n=$0t(t,e.type);let s=t._length,r,o,i,a;const l=()=>{i===32767||i===-32768||(Zd(a)&&(s=Math.min(s,Math.abs(i-a)||s)),a=i)};for(r=0,o=n.length;r<o;++r)i=t.getPixelForValue(n[r]),l();for(a=void 0,r=0,o=t.ticks.length;r<o;++r)i=t.getPixelForTick(r),l();return s}function N0t(e,t,n,s){const r=n.barThickness;let o,i;return Ot(r)?(o=t.min*n.categoryPercentage,i=n.barPercentage):(o=r*s,i=1),{chunk:o/s,ratio:i,start:t.pixels[e]-o/2}}function E0t(e,t,n,s){const r=t.pixels,o=r[e];let i=e>0?r[e-1]:null,a=e<r.length-1?r[e+1]:null;const l=n.categoryPercentage;i===null&&(i=o-(a===null?t.end-t.start:a-o)),a===null&&(a=o+o-i);const c=o-(o-Math.min(i,a))/2*l;return{chunk:Math.abs(a-i)/2*l/s,ratio:n.barPercentage,start:c}}function _0t(e,t,n,s){const r=n.parse(e[0],s),o=n.parse(e[1],s),i=Math.min(r,o),a=Math.max(r,o);let l=i,c=a;Math.abs(i)>Math.abs(a)&&(l=a,c=i),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:o,min:i,max:a}}function oz(e,t,n,s){return ke(e)?_0t(e,t,n,s):t[n.axis]=n.parse(e,s),t}function kT(e,t,n,s){const r=e.iScale,o=e.vScale,i=r.getLabels(),a=r===o,l=[];let c,u,d,h;for(c=n,u=n+s;c<u;++c)h=t[c],d={},d[r.axis]=a||r.parse(i[c],c),l.push(oz(h,d,o,c));return l}function Py(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function R0t(e,t,n){return e!==0?eo(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function D0t(e){let t,n,s,r,o;return e.horizontal?(t=e.base>e.x,n="left",s="right"):(t=e.base<e.y,n="bottom",s="top"),t?(r="end",o="start"):(r="start",o="end"),{start:n,end:s,reverse:t,top:r,bottom:o}}function A0t(e,t,n,s){let r=t.borderSkipped;const o={};if(!r){e.borderSkipped=o;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:i,end:a,reverse:l,top:c,bottom:u}=D0t(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===s?r=c:(n._bottom||0)===s?r=u:(o[CT(u,i,a,l)]=!0,r=c)),o[CT(r,i,a,l)]=!0,e.borderSkipped=o}function CT(e,t,n,s){return s?(e=O0t(e,t,n),e=ST(e,n,t)):e=ST(e,t,n),e}function O0t(e,t,n){return e===t?n:e===n?t:e}function ST(e,t,n){return e==="start"?t:e==="end"?n:e}function F0t(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class Yp extends Sr{parsePrimitiveData(t,n,s,r){return kT(t,n,s,r)}parseArrayData(t,n,s,r){return kT(t,n,s,r)}parseObjectData(t,n,s,r){const{iScale:o,vScale:i}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=o.axis==="x"?a:l,u=i.axis==="x"?a:l,d=[];let h,f,p,m;for(h=s,f=s+r;h<f;++h)m=n[h],p={},p[o.axis]=o.parse(qi(m,c),h),d.push(oz(qi(m,u),p,i,h));return d}updateRangeFromParsed(t,n,s,r){super.updateRangeFromParsed(t,n,s,r);const o=s._custom;o&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:s,vScale:r}=n,o=this.getParsed(t),i=o._custom,a=Py(i)?"["+i.start+", "+i.end+"]":""+r.getLabelForValue(o[r.axis]);return{label:""+s.getLabelForValue(o[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,s,r){const o=r==="reset",{index:i,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:h}=this._getSharedOptions(n,r);for(let f=n;f<n+s;f++){const p=this.getParsed(f),m=o||Ot(p[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),g=this._calculateBarIndexPixels(f,u),x=(p._stacks||{})[a.axis],y={horizontal:c,base:m.base,enableBorderRadius:!x||Py(p._custom)||i===x._top||i===x._bottom,x:c?m.head:g.center,y:c?g.center:m.head,height:c?g.size:Math.abs(m.size),width:c?Math.abs(m.size):g.size};h&&(y.options=d||this.resolveDataElementOptions(f,t[f].active?"active":r));const b=y.options||t[f].options;A0t(y,b,x,i),F0t(y,b,u.ratio),this.updateElement(t[f],f,y,r)}}_getStacks(t,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),o=s.options.stacked,i=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[s.axis],c=u=>{const d=u._parsed.find(f=>f[s.axis]===l),h=d&&d[u.vScale.axis];if(Ot(h)||isNaN(h))return!0};for(const u of r)if(!(n!==void 0&&c(u))&&((o===!1||i.indexOf(u.stack)===-1||o===void 0&&u.stack===void 0)&&i.push(u.stack),u.index===t))break;return i.length||i.push(void 0),i}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(t).filter(s=>t[s].axis===n).shift()}_getAxis(){const t={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)t[It(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(t)}_getStackIndex(t,n,s){const r=this._getStacks(t,s),o=n!==void 0?r.indexOf(n):-1;return o===-1?r.length-1:o}_getRuler(){const t=this.options,n=this._cachedMeta,s=n.iScale,r=[];let o,i;for(o=0,i=n.data.length;o<i;++o)r.push(s.getPixelForValue(this.getParsed(o)[s.axis],o));const a=t.barThickness;return{min:a||T0t(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:o,minBarLength:i}}=this,a=o||0,l=this.getParsed(t),c=l._custom,u=Py(c);let d=l[n.axis],h=0,f=s?this.applyStack(n,l,s):d,p,m;f!==d&&(h=f-d,f=d),u&&(d=c.barStart,f=c.barEnd-c.barStart,d!==0&&eo(d)!==eo(c.barEnd)&&(h=0),h+=d);const g=!Ot(o)&&!u?o:h;let x=n.getPixelForValue(g);if(this.chart.getDataVisibility(t)?p=n.getPixelForValue(h+f):p=x,m=p-x,Math.abs(m)<i){m=R0t(m,n,a)*i,d===a&&(x-=m/2);const y=n.getPixelForDecimal(0),b=n.getPixelForDecimal(1),v=Math.min(y,b),w=Math.max(y,b);x=Math.max(Math.min(x,w),v),p=x+m,s&&!u&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(p)-n.getValueForPixel(x))}if(x===n.getPixelForValue(a)){const y=eo(m)*n.getLineWidthForValue(a)/2;x+=y,m-=y}return{size:m,base:x,head:p,center:p+m/2}}_calculateBarIndexPixels(t,n){const s=n.scale,r=this.options,o=r.skipNull,i=It(r.maxBarThickness,1/0);let a,l;const c=this._getAxisCount();if(n.grouped){const u=o?this._getStackCount(t):n.stackCount,d=r.barThickness==="flex"?E0t(t,n,r,u*c):N0t(t,n,r,u*c),h=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,f=this._getAxis().indexOf(It(h,this.getFirstScaleIdForIndexAxis())),p=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0)+f;a=d.start+d.chunk*p+d.chunk/2,l=Math.min(i,d.chunk*d.ratio)}else a=s.getPixelForValue(this.getParsed(t)[s.axis],t),l=Math.min(i,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,n=t.vScale,s=t.data,r=s.length;let o=0;for(;o<r;++o)this.getParsed(o)[n.axis]!==null&&!s[o].hidden&&s[o].draw(this._ctx)}}it(Yp,"id","bar"),it(Yp,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),it(Yp,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Qp extends Sr{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,s,r){const o=super.parsePrimitiveData(t,n,s,r);for(let i=0;i<o.length;i++)o[i]._custom=this.resolveDataElementOptions(i+s).radius;return o}parseArrayData(t,n,s,r){const o=super.parseArrayData(t,n,s,r);for(let i=0;i<o.length;i++){const a=n[s+i];o[i]._custom=It(a[2],this.resolveDataElementOptions(i+s).radius)}return o}parseObjectData(t,n,s,r){const o=super.parseObjectData(t,n,s,r);for(let i=0;i<o.length;i++){const a=n[s+i];o[i]._custom=It(a&&a.r&&+a.r,this.resolveDataElementOptions(i+s).radius)}return o}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let s=t.length-1;s>=0;--s)n=Math.max(n,t[s].size(this.resolveDataElementOptions(s))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:o}=n,i=this.getParsed(t),a=r.getLabelForValue(i.x),l=o.getLabelForValue(i.y),c=i._custom;return{label:s[t]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,s,r){const o=r==="reset",{iScale:i,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(n,r),u=i.axis,d=a.axis;for(let h=n;h<n+s;h++){const f=t[h],p=!o&&this.getParsed(h),m={},g=m[u]=o?i.getPixelForDecimal(.5):i.getPixelForValue(p[u]),x=m[d]=o?a.getBasePixel():a.getPixelForValue(p[d]);m.skip=isNaN(g)||isNaN(x),c&&(m.options=l||this.resolveDataElementOptions(h,f.active?"active":r),o&&(m.options.radius=0)),this.updateElement(f,h,m,r)}}resolveDataElementOptions(t,n){const s=this.getParsed(t);let r=super.resolveDataElementOptions(t,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const o=r.radius;return n!=="active"&&(r.radius=0),r.radius+=It(s&&s._custom,o),r}}it(Qp,"id","bubble"),it(Qp,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),it(Qp,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function P0t(e,t,n){let s=1,r=1,o=0,i=0;if(t<ye){const a=e,l=a+t,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),h=Math.sin(l),f=(b,v,w)=>Jd(b,a,l,!0)?1:Math.max(v,v*n,w,w*n),p=(b,v,w)=>Jd(b,a,l,!0)?-1:Math.min(v,v*n,w,w*n),m=f(0,c,d),g=f(Be,u,h),x=p(Gt,c,d),y=p(Gt+Be,u,h);s=(m-x)/2,r=(g-y)/2,o=-(m+x)/2,i=-(g+y)/2}return{ratioX:s,ratioY:r,offsetX:o,offsetY:i}}class Da extends Sr{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let o=l=>+s[l];if(Pt(s[t])){const{key:l="value"}=this._parsing;o=c=>+qi(s[c],l)}let i,a;for(i=t,a=t+n;i<a;++i)r._parsed[i]=o(i)}}_getRotation(){return yr(this.options.rotation-90)}_getCircumference(){return yr(this.options.circumference)}_getRotationExtents(){let t=ye,n=-ye;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,o=r._getRotation(),i=r._getCircumference();t=Math.min(t,o),n=Math.max(n,o+i)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,o=r.data,i=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-i)/2,0),l=Math.min(Xgt(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:h,ratioY:f,offsetX:p,offsetY:m}=P0t(d,u,l),g=(s.width-i)/h,x=(s.height-i)/f,y=Math.max(Math.min(g,x)/2,0),b=D3(this.options.radius,y),v=Math.max(b*l,0),w=(b-v)/this._getVisibleDatasetWeightTotal();this.offsetX=p*b,this.offsetY=m*b,r.total=this.calculateTotal(),this.outerRadius=b-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*c,0),this.updateElements(o,0,o.length,t)}_circumference(t,n){const s=this.options,r=this._cachedMeta,o=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*o/ye)}updateElements(t,n,s,r){const o=r==="reset",i=this.chart,a=i.chartArea,c=i.options.animation,u=(a.left+a.right)/2,d=(a.top+a.bottom)/2,h=o&&c.animateScale,f=h?0:this.innerRadius,p=h?0:this.outerRadius,{sharedOptions:m,includeOptions:g}=this._getSharedOptions(n,r);let x=this._getRotation(),y;for(y=0;y<n;++y)x+=this._circumference(y,o);for(y=n;y<n+s;++y){const b=this._circumference(y,o),v=t[y],w={x:u+this.offsetX,y:d+this.offsetY,startAngle:x,endAngle:x+b,circumference:b,outerRadius:p,innerRadius:f};g&&(w.options=m||this.resolveDataElementOptions(y,v.active?"active":r)),x+=b,this.updateElement(v,y,w,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let s=0,r;for(r=0;r<n.length;r++){const o=t._parsed[r];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(o))}return s}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?ye*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],o=Af(n._parsed[t],s.options.locale);return{label:r[t]||"",value:o}}getMaxBorderWidth(t){let n=0;const s=this.chart;let r,o,i,a,l;if(!t){for(r=0,o=s.data.datasets.length;r<o;++r)if(s.isDatasetVisible(r)){i=s.getDatasetMeta(r),t=i.data,a=i.controller;break}}if(!t)return 0;for(r=0,o=t.length;r<o;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let s=0,r=t.length;s<r;++s){const o=this.resolveDataElementOptions(s);n=Math.max(n,o.offset||0,o.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(t){return Math.max(It(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}it(Da,"id","doughnut"),it(Da,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),it(Da,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),it(Da,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=t.legend.options;return n.labels.map((o,i)=>{const l=t.getDatasetMeta(0).controller.getStyle(i);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(i),index:i}})}return[]}},onClick(t,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class Zp extends Sr{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:o}=n,i=this.chart._animationsDisabled;let{start:a,count:l}=B3(n,r,i);this._drawStart=a,this._drawCount=l,V3(n)&&(a=0,l=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!o._decimated,s.points=r;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!i,options:c},t),this.updateElements(r,a,l,t)}updateElements(t,n,s,r){const o=r==="reset",{iScale:i,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(n,r),h=i.axis,f=a.axis,{spanGaps:p,segment:m}=this.options,g=Wc(p)?p:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||o||r==="none",y=n+s,b=t.length;let v=n>0&&this.getParsed(n-1);for(let w=0;w<b;++w){const k=t[w],C=x?k:{};if(w<n||w>=y){C.skip=!0;continue}const S=this.getParsed(w),I=Ot(S[f]),$=C[h]=i.getPixelForValue(S[h],w),E=C[f]=o||I?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,S,l):S[f],w);C.skip=isNaN($)||isNaN(E)||I,C.stop=w>0&&Math.abs(S[h]-v[h])>g,m&&(C.parsed=S,C.raw=c.data[w]),d&&(C.options=u||this.resolveDataElementOptions(w,k.active?"active":r)),x||this.updateElement(k,w,C,r),v=S}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,s=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return s;const o=r[0].size(this.resolveDataElementOptions(0)),i=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,o,i)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}it(Zp,"id","line"),it(Zp,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),it(Zp,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class gd extends Sr{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],o=Af(n._parsed[t].r,s.options.locale);return{label:r[t]||"",value:o}}parseObjectData(t,n,s,r){return q3.bind(this)(t,n,s,r)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,r)=>{const o=this.getParsed(r).r;!isNaN(o)&&this.chart.getDataVisibility(r)&&(o<n.min&&(n.min=o),o>n.max&&(n.max=o))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,s=t.options,r=Math.min(n.right-n.left,n.bottom-n.top),o=Math.max(r/2,0),i=Math.max(s.cutoutPercentage?o/100*s.cutoutPercentage:1,0),a=(o-i)/t.getVisibleDatasetCount();this.outerRadius=o-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,n,s,r){const o=r==="reset",i=this.chart,l=i.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,d=c.yCenter,h=c.getIndexAngle(0)-.5*Gt;let f=h,p;const m=360/this.countVisibleElements();for(p=0;p<n;++p)f+=this._computeAngle(p,r,m);for(p=n;p<n+s;p++){const g=t[p];let x=f,y=f+this._computeAngle(p,r,m),b=i.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;f=y,o&&(l.animateScale&&(b=0),l.animateRotate&&(x=y=h));const v={x:u,y:d,innerRadius:0,outerRadius:b,startAngle:x,endAngle:y,options:this.resolveDataElementOptions(p,g.active?"active":r)};this.updateElement(g,p,v,r)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((s,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(t,n,s){return this.chart.getDataVisibility(t)?yr(this.resolveDataElementOptions(t,n).angle||s):0}}it(gd,"id","polarArea"),it(gd,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),it(gd,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=t.legend.options;return n.labels.map((o,i)=>{const l=t.getDatasetMeta(0).controller.getStyle(i);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(i),index:i}})}return[]}},onClick(t,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class M1 extends Da{}it(M1,"id","pie"),it(M1,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Jp extends Sr{getLabelAndValue(t){const n=this._cachedMeta.vScale,s=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(s[n.axis])}}parseObjectData(t,n,s,r){return q3.bind(this)(t,n,s,r)}update(t){const n=this._cachedMeta,s=n.dataset,r=n.data||[],o=n.iScale.getLabels();if(s.points=r,t!=="resize"){const i=this.resolveDatasetElementOptions(t);this.options.showLine||(i.borderWidth=0);const a={_loop:!0,_fullLoop:o.length===r.length,options:i};this.updateElement(s,void 0,a,t)}this.updateElements(r,0,r.length,t)}updateElements(t,n,s,r){const o=this._cachedMeta.rScale,i=r==="reset";for(let a=n;a<n+s;a++){const l=t[a],c=this.resolveDataElementOptions(a,l.active?"active":r),u=o.getPointPositionForValue(a,this.getParsed(a).r),d=i?o.xCenter:u.x,h=i?o.yCenter:u.y,f={x:d,y:h,angle:u.angle,skip:isNaN(d)||isNaN(h),options:c};this.updateElement(l,a,f,r)}}}it(Jp,"id","radar"),it(Jp,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),it(Jp,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class tm extends Sr{getLabelAndValue(t){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:o}=n,i=this.getParsed(t),a=r.getLabelForValue(i.x),l=o.getLabelForValue(i.y);return{label:s[t]||"",value:"("+a+", "+l+")"}}update(t){const n=this._cachedMeta,{data:s=[]}=n,r=this.chart._animationsDisabled;let{start:o,count:i}=B3(n,s,r);if(this._drawStart=o,this._drawCount=i,V3(n)&&(o=0,i=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=n;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=s;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!r,options:c},t)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(s,o,i,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,n,s,r){const o=r==="reset",{iScale:i,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(n,r),d=this.getSharedOptions(u),h=this.includeOptions(r,d),f=i.axis,p=a.axis,{spanGaps:m,segment:g}=this.options,x=Wc(m)?m:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||o||r==="none";let b=n>0&&this.getParsed(n-1);for(let v=n;v<n+s;++v){const w=t[v],k=this.getParsed(v),C=y?w:{},S=Ot(k[p]),I=C[f]=i.getPixelForValue(k[f],v),$=C[p]=o||S?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,k,l):k[p],v);C.skip=isNaN(I)||isNaN($)||S,C.stop=v>0&&Math.abs(k[f]-b[f])>x,g&&(C.parsed=k,C.raw=c.data[v]),h&&(C.options=d||this.resolveDataElementOptions(v,w.active?"active":r)),y||this.updateElement(w,v,C,r),b=k}this.updateSharedOptions(d,r,u)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let a=0;for(let l=n.length-1;l>=0;--l)a=Math.max(a,n[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const s=t.dataset,r=s.options&&s.options.borderWidth||0;if(!n.length)return r;const o=n[0].size(this.resolveDataElementOptions(0)),i=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,o,i)/2}}it(tm,"id","scatter"),it(tm,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),it(tm,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var M0t=Object.freeze({__proto__:null,BarController:Yp,BubbleController:Qp,DoughnutController:Da,LineController:Zp,PieController:M1,PolarAreaController:gd,RadarController:Jp,ScatterController:tm});function ma(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class yS{constructor(t){it(this,"options");this.options=t||{}}static override(t){Object.assign(yS.prototype,t)}init(){}formats(){return ma()}parse(){return ma()}format(){return ma()}add(){return ma()}diff(){return ma()}startOf(){return ma()}endOf(){return ma()}}var L0t={_date:yS};function z0t(e,t,n,s){const{controller:r,data:o,_sorted:i}=e,a=r._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(a&&t===a.axis&&t!=="r"&&i&&o.length){const c=a._reversePixels?axt:To;if(s){if(r._sharedOptions){const u=o[0],d=typeof u.getRange=="function"&&u.getRange(t);if(d){const h=c(o,t,n-d),f=c(o,t,n+d);return{lo:h.lo,hi:f.hi}}}}else{const u=c(o,t,n);if(l){const{vScale:d}=r._cachedMeta,{_parsed:h}=e,f=h.slice(0,u.lo+1).reverse().findIndex(m=>!Ot(m[d.axis]));u.lo-=Math.max(0,f);const p=h.slice(u.hi).findIndex(m=>!Ot(m[d.axis]));u.hi+=Math.max(0,p)}return u}}return{lo:0,hi:o.length-1}}function Of(e,t,n,s,r){const o=e.getSortedVisibleDatasetMetas(),i=n[t];for(let a=0,l=o.length;a<l;++a){const{index:c,data:u}=o[a],{lo:d,hi:h}=z0t(o[a],t,i,r);for(let f=d;f<=h;++f){const p=u[f];p.skip||s(p,c,f)}}}function B0t(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(s,r){const o=t?Math.abs(s.x-r.x):0,i=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(i,2))}}function My(e,t,n,s,r){const o=[];return!r&&!e.isPointInArea(t)||Of(e,n,t,function(a,l,c){!r&&!No(a,e.chartArea,0)||a.inRange(t.x,t.y,s)&&o.push({element:a,datasetIndex:l,index:c})},!0),o}function V0t(e,t,n,s){let r=[];function o(i,a,l){const{startAngle:c,endAngle:u}=i.getProps(["startAngle","endAngle"],s),{angle:d}=F3(i,{x:t.x,y:t.y});Jd(d,c,u)&&r.push({element:i,datasetIndex:a,index:l})}return Of(e,n,t,o),r}function W0t(e,t,n,s,r,o){let i=[];const a=B0t(n);let l=Number.POSITIVE_INFINITY;function c(u,d,h){const f=u.inRange(t.x,t.y,r);if(s&&!f)return;const p=u.getCenterPoint(r);if(!(!!o||e.isPointInArea(p))&&!f)return;const g=a(t,p);g<l?(i=[{element:u,datasetIndex:d,index:h}],l=g):g===l&&i.push({element:u,datasetIndex:d,index:h})}return Of(e,n,t,c),i}function Ly(e,t,n,s,r,o){return!o&&!e.isPointInArea(t)?[]:n==="r"&&!s?V0t(e,t,n,r):W0t(e,t,n,s,r,o)}function IT(e,t,n,s,r){const o=[],i=n==="x"?"inXRange":"inYRange";let a=!1;return Of(e,n,t,(l,c,u)=>{l[i]&&l[i](t[n],r)&&(o.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(t.x,t.y,r))}),s&&!a?[]:o}var U0t={evaluateInteractionItems:Of,modes:{index(e,t,n,s){const r=va(t,e),o=n.axis||"x",i=n.includeInvisible||!1,a=n.intersect?My(e,r,o,s,i):Ly(e,r,o,!1,s,i),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(e,t,n,s){const r=va(t,e),o=n.axis||"xy",i=n.includeInvisible||!1;let a=n.intersect?My(e,r,o,s,i):Ly(e,r,o,!1,s,i);if(a.length>0){const l=a[0].datasetIndex,c=e.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(e,t,n,s){const r=va(t,e),o=n.axis||"xy",i=n.includeInvisible||!1;return My(e,r,o,s,i)},nearest(e,t,n,s){const r=va(t,e),o=n.axis||"xy",i=n.includeInvisible||!1;return Ly(e,r,o,n.intersect,s,i)},x(e,t,n,s){const r=va(t,e);return IT(e,r,"x",n.intersect,s)},y(e,t,n,s){const r=va(t,e);return IT(e,r,"y",n.intersect,s)}}};const iz=["left","top","right","bottom"];function Au(e,t){return e.filter(n=>n.pos===t)}function $T(e,t){return e.filter(n=>iz.indexOf(n.pos)===-1&&n.box.axis===t)}function Ou(e,t){return e.sort((n,s)=>{const r=t?s:n,o=t?n:s;return r.weight===o.weight?r.index-o.index:r.weight-o.weight})}function j0t(e){const t=[];let n,s,r,o,i,a;for(n=0,s=(e||[]).length;n<s;++n)r=e[n],{position:o,options:{stack:i,stackWeight:a=1}}=r,t.push({index:n,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:i&&o+i,stackWeight:a});return t}function G0t(e){const t={};for(const n of e){const{stack:s,pos:r,stackWeight:o}=n;if(!s||!iz.includes(r))continue;const i=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=o}return t}function H0t(e,t){const n=G0t(e),{vBoxMaxWidth:s,hBoxMaxHeight:r}=t;let o,i,a;for(o=0,i=e.length;o<i;++o){a=e[o];const{fullSize:l}=a.box,c=n[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*s:l&&t.availableWidth,a.height=r):(a.width=s,a.height=u?u*r:l&&t.availableHeight)}return n}function K0t(e){const t=j0t(e),n=Ou(t.filter(c=>c.box.fullSize),!0),s=Ou(Au(t,"left"),!0),r=Ou(Au(t,"right")),o=Ou(Au(t,"top"),!0),i=Ou(Au(t,"bottom")),a=$T(t,"x"),l=$T(t,"y");return{fullSize:n,leftAndTop:s.concat(o),rightAndBottom:r.concat(l).concat(i).concat(a),chartArea:Au(t,"chartArea"),vertical:s.concat(r).concat(l),horizontal:o.concat(i).concat(a)}}function TT(e,t,n,s){return Math.max(e[n],t[n])+Math.max(e[s],t[s])}function az(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function X0t(e,t,n,s){const{pos:r,box:o}=n,i=e.maxPadding;if(!Pt(r)){n.size&&(e[r]-=n.size);const d=s[n.stack]||{size:0,count:1};d.size=Math.max(d.size,n.horizontal?o.height:o.width),n.size=d.size/d.count,e[r]+=n.size}o.getPadding&&az(i,o.getPadding());const a=Math.max(0,t.outerWidth-TT(i,e,"left","right")),l=Math.max(0,t.outerHeight-TT(i,e,"top","bottom")),c=a!==e.w,u=l!==e.h;return e.w=a,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function q0t(e){const t=e.maxPadding;function n(s){const r=Math.max(t[s]-e[s],0);return e[s]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function Y0t(e,t){const n=t.maxPadding;function s(r){const o={left:0,top:0,right:0,bottom:0};return r.forEach(i=>{o[i]=Math.max(t[i],n[i])}),o}return s(e?["left","right"]:["top","bottom"])}function Yu(e,t,n,s){const r=[];let o,i,a,l,c,u;for(o=0,i=e.length,c=0;o<i;++o){a=e[o],l=a.box,l.update(a.width||t.w,a.height||t.h,Y0t(a.horizontal,t));const{same:d,other:h}=X0t(t,n,a,s);c|=d&&r.length,u=u||h,l.fullSize||r.push(a)}return c&&Yu(r,t,n,s)||u}function Sp(e,t,n,s,r){e.top=n,e.left=t,e.right=t+s,e.bottom=n+r,e.width=s,e.height=r}function NT(e,t,n,s){const r=n.padding;let{x:o,y:i}=t;for(const a of e){const l=a.box,c=s[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=t.w*u,h=c.size||l.height;Zd(c.start)&&(i=c.start),l.fullSize?Sp(l,r.left,i,n.outerWidth-r.right-r.left,h):Sp(l,t.left+c.placed,i,d,h),c.start=i,c.placed+=d,i=l.bottom}else{const d=t.h*u,h=c.size||l.width;Zd(c.start)&&(o=c.start),l.fullSize?Sp(l,o,r.top,h,n.outerHeight-r.bottom-r.top):Sp(l,o,t.top+c.placed,h,d),c.start=o,c.placed+=d,o=l.right}}t.x=o,t.y=i}var An={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,s){if(!e)return;const r=Ln(e.options.layout.padding),o=Math.max(t-r.width,0),i=Math.max(n-r.height,0),a=K0t(e.boxes),l=a.vertical,c=a.horizontal;Zt(e.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const u=l.reduce((m,g)=>g.box.options&&g.box.options.display===!1?m:m+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:o,availableHeight:i,vBoxMaxWidth:o/2/u,hBoxMaxHeight:i/2}),h=Object.assign({},r);az(h,Ln(s));const f=Object.assign({maxPadding:h,w:o,h:i,x:r.left,y:r.top},r),p=H0t(l.concat(c),d);Yu(a.fullSize,f,d,p),Yu(l,f,d,p),Yu(c,f,d,p)&&Yu(l,f,d,p),q0t(f),NT(a.leftAndTop,f,d,p),f.x+=f.w,f.y+=f.h,NT(a.rightAndBottom,f,d,p),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},Zt(a.chartArea,m=>{const g=m.box;Object.assign(g,e.chartArea),g.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class lz{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,s){}removeEventListener(t,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,s,r){return n=Math.max(0,n||t.width),s=s||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(t){return!0}updateConfig(t){}}class Q0t extends lz{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const em="$chartjs",Z0t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ET=e=>e===null||e==="";function J0t(e,t){const n=e.style,s=e.getAttribute("height"),r=e.getAttribute("width");if(e[em]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",ET(r)){const o=hT(e,"width");o!==void 0&&(e.width=o)}if(ET(s))if(e.style.height==="")e.height=e.width/(t||2);else{const o=hT(e,"height");o!==void 0&&(e.height=o)}return e}const cz=t0t?{passive:!0}:!1;function tyt(e,t,n){e&&e.addEventListener(t,n,cz)}function eyt(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,cz)}function nyt(e,t){const n=Z0t[e.type]||e.type,{x:s,y:r}=va(e,t);return{type:n,chart:t,native:e,x:s!==void 0?s:null,y:r!==void 0?r:null}}function gg(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function syt(e,t,n){const s=e.canvas,r=new MutationObserver(o=>{let i=!1;for(const a of o)i=i||gg(a.addedNodes,s),i=i&&!gg(a.removedNodes,s);i&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function ryt(e,t,n){const s=e.canvas,r=new MutationObserver(o=>{let i=!1;for(const a of o)i=i||gg(a.removedNodes,s),i=i&&!gg(a.addedNodes,s);i&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const eh=new Map;let _T=0;function uz(){const e=window.devicePixelRatio;e!==_T&&(_T=e,eh.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function oyt(e,t){eh.size||window.addEventListener("resize",uz),eh.set(e,t)}function iyt(e){eh.delete(e),eh.size||window.removeEventListener("resize",uz)}function ayt(e,t,n){const s=e.canvas,r=s&&xS(s);if(!r)return;const o=z3((a,l)=>{const c=r.clientWidth;n(a,l),c<r.clientWidth&&n()},window),i=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||o(c,u)});return i.observe(r),oyt(e,o),i}function zy(e,t,n){n&&n.disconnect(),t==="resize"&&iyt(e)}function lyt(e,t,n){const s=e.canvas,r=z3(o=>{e.ctx!==null&&n(nyt(o,e))},e);return tyt(s,t,r),r}class cyt extends lz{acquireContext(t,n){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(J0t(t,n),s):null}releaseContext(t){const n=t.canvas;if(!n[em])return!1;const s=n[em].initial;["height","width"].forEach(o=>{const i=s[o];Ot(i)?n.removeAttribute(o):n.setAttribute(o,i)});const r=s.style||{};return Object.keys(r).forEach(o=>{n.style[o]=r[o]}),n.width=n.width,delete n[em],!0}addEventListener(t,n,s){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),i={attach:syt,detach:ryt,resize:ayt}[n]||lyt;r[n]=i(t,n,s)}removeEventListener(t,n){const s=t.$proxies||(t.$proxies={}),r=s[n];if(!r)return;({attach:zy,detach:zy,resize:zy}[n]||eyt)(t,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,s,r){return Jxt(t,n,s,r)}isAttached(t){const n=t&&xS(t);return!!(n&&n.isConnected)}}function uyt(e){return!gS()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?Q0t:cyt}var Rp;let qo=(Rp=class{constructor(){it(this,"x");it(this,"y");it(this,"active",!1);it(this,"options");it(this,"$animations")}tooltipPosition(t){const{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}hasValue(){return Wc(this.x)&&Wc(this.y)}getProps(t,n){const s=this.$animations;if(!n||!s)return this;const r={};return t.forEach(o=>{r[o]=s[o]&&s[o].active()?s[o]._to:this[o]}),r}},it(Rp,"defaults",{}),it(Rp,"defaultRoutes"),Rp);function dyt(e,t){const n=e.options.ticks,s=hyt(e),r=Math.min(n.maxTicksLimit||s,s),o=n.major.enabled?pyt(t):[],i=o.length,a=o[0],l=o[i-1],c=[];if(i>r)return myt(t,c,o,i/r),c;const u=fyt(o,t,r);if(i>0){let d,h;const f=i>1?Math.round((l-a)/(i-1)):null;for(Ip(t,c,u,Ot(f)?0:a-f,a),d=0,h=i-1;d<h;d++)Ip(t,c,u,o[d],o[d+1]);return Ip(t,c,u,l,Ot(f)?t.length:l+f),c}return Ip(t,c,u),c}function hyt(e){const t=e.options.offset,n=e._tickSize(),s=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(s,r))}function fyt(e,t,n){const s=gyt(e),r=t.length/n;if(!s)return Math.max(r,1);const o=nxt(s);for(let i=0,a=o.length-1;i<a;i++){const l=o[i];if(l>r)return l}return Math.max(r,1)}function pyt(e){const t=[];let n,s;for(n=0,s=e.length;n<s;n++)e[n].major&&t.push(n);return t}function myt(e,t,n,s){let r=0,o=n[0],i;for(s=Math.ceil(s),i=0;i<e.length;i++)i===o&&(t.push(e[i]),r++,o=n[r*s])}function Ip(e,t,n,s,r){const o=It(s,0),i=Math.min(It(r,e.length),e.length);let a=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),u=o;u<0;)a++,u=Math.round(o+a*n);for(c=Math.max(o,0);c<i;c++)c===u&&(t.push(e[c]),a++,u=Math.round(o+a*n))}function gyt(e){const t=e.length;let n,s;if(t<2)return!1;for(s=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==s)return!1;return s}const xyt=e=>e==="left"?"right":e==="right"?"left":e,RT=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,DT=(e,t)=>Math.min(t||e,e);function AT(e,t){const n=[],s=e.length/t,r=e.length;let o=0;for(;o<r;o+=s)n.push(e[Math.floor(o)]);return n}function yyt(e,t,n){const s=e.ticks.length,r=Math.min(t,s-1),o=e._startPixel,i=e._endPixel,a=1e-6;let l=e.getPixelForTick(r),c;if(!(n&&(s===1?c=Math.max(l-o,i-l):t===0?c=(e.getPixelForTick(1)-l)/2:c=(l-e.getPixelForTick(r-1))/2,l+=r<t?c:-c,l<o-a||l>i+a)))return l}function byt(e,t){Zt(e,n=>{const s=n.gc,r=s.length/2;let o;if(r>t){for(o=0;o<r;++o)delete n.data[s[o]];s.splice(0,r)}})}function Fu(e){return e.drawTicks?e.tickLength:0}function OT(e,t){if(!e.display)return 0;const n=nn(e.font,t),s=Ln(e.padding);return(ke(e.text)?e.text.length:1)*n.lineHeight+s.height}function vyt(e,t){return ca(e,{scale:t,type:"scale"})}function wyt(e,t,n){return ca(e,{tick:n,index:t,type:"tick"})}function kyt(e,t,n){let s=uS(e);return(n&&t!=="right"||!n&&t==="right")&&(s=xyt(s)),s}function Cyt(e,t,n,s){const{top:r,left:o,bottom:i,right:a,chart:l}=e,{chartArea:c,scales:u}=l;let d=0,h,f,p;const m=i-r,g=a-o;if(e.isHorizontal()){if(f=Tn(s,o,a),Pt(n)){const x=Object.keys(n)[0],y=n[x];p=u[x].getPixelForValue(y)+m-t}else n==="center"?p=(c.bottom+c.top)/2+m-t:p=RT(e,n,t);h=a-o}else{if(Pt(n)){const x=Object.keys(n)[0],y=n[x];f=u[x].getPixelForValue(y)-g+t}else n==="center"?f=(c.left+c.right)/2-g+t:f=RT(e,n,t);p=Tn(s,i,r),d=n==="left"?-Be:Be}return{titleX:f,titleY:p,maxWidth:h,rotation:d}}class Nl extends qo{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return t=ys(t,Number.POSITIVE_INFINITY),n=ys(n,Number.NEGATIVE_INFINITY),s=ys(s,Number.POSITIVE_INFINITY),r=ys(r,Number.NEGATIVE_INFINITY),{min:ys(t,s),max:ys(n,r),minDefined:Ae(t),maxDefined:Ae(n)}}getMinMax(t){let{min:n,max:s,minDefined:r,maxDefined:o}=this.getUserBounds(),i;if(r&&o)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)i=a[l].controller.getMinMax(this,t),r||(n=Math.min(n,i.min)),o||(s=Math.max(s,i.max));return n=o&&n>s?s:n,s=r&&n>s?n:s,{min:ys(n,ys(s,n)),max:ys(s,ys(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ce(this.options.beforeUpdate,[this])}update(t,n,s){const{beginAtZero:r,grace:o,ticks:i}=this.options,a=i.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Rxt(this,o,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?AT(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),i.display&&(i.autoSkip||i.source==="auto")&&(this.ticks=dyt(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,t=!t),this._startPixel=n,this._endPixel=s,this._reversePixels=t,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ce(this.options.afterUpdate,[this])}beforeSetDimensions(){ce(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ce(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),ce(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ce(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let s,r,o;for(s=0,r=t.length;s<r;s++)o=t[s],o.label=ce(n.callback,[o.value,s,t],this)}afterTickToLabelConversion(){ce(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ce(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,s=DT(this.ticks.length,t.ticks.maxTicksLimit),r=n.minRotation||0,o=n.maxRotation;let i=r,a,l,c;if(!this._isVisible()||!n.display||r>=o||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),d=u.widest.width,h=u.highest.height,f=ln(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/s:f/(s-1),d+6>a&&(a=f/(s-(t.offset?.5:1)),l=this.maxHeight-Fu(t.grid)-n.padding-OT(t.title,this.chart.options.font),c=Math.sqrt(d*d+h*h),i=lS(Math.min(Math.asin(ln((u.highest.height+6)/a,-1,1)),Math.asin(ln(l/c,-1,1))-Math.asin(ln(h/c,-1,1)))),i=Math.max(r,Math.min(o,i))),this.labelRotation=i}afterCalculateLabelRotation(){ce(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ce(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:o}}=this,i=this._isVisible(),a=this.isHorizontal();if(i){const l=OT(r,n.options.font);if(a?(t.width=this.maxWidth,t.height=Fu(o)+l):(t.height=this.maxHeight,t.width=Fu(o)+l),s.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:h}=this._getLabelSizes(),f=s.padding*2,p=yr(this.labelRotation),m=Math.cos(p),g=Math.sin(p);if(a){const x=s.mirror?0:g*d.width+m*h.height;t.height=Math.min(this.maxHeight,t.height+x+f)}else{const x=s.mirror?0:m*d.width+g*h.height;t.width=Math.min(this.maxWidth,t.width+x+f)}this._calculatePadding(c,u,g,m)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,s,r){const{ticks:{align:o,padding:i},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,f=0;l?c?(h=r*t.width,f=s*n.height):(h=s*t.height,f=r*n.width):o==="start"?f=n.width:o==="end"?h=t.width:o!=="inner"&&(h=t.width/2,f=n.width/2),this.paddingLeft=Math.max((h-u+i)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-d+i)*this.width/(this.width-d),0)}else{let u=n.height/2,d=t.height/2;o==="start"?(u=0,d=t.height):o==="end"&&(u=n.height,d=0),this.paddingTop=u+i,this.paddingBottom=d+i}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ce(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,s;for(n=0,s=t.length;n<s;n++)Ot(t[n].label)&&(t.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=AT(s,n)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,s){const{ctx:r,_longestTextCache:o}=this,i=[],a=[],l=Math.floor(n/DT(n,s));let c=0,u=0,d,h,f,p,m,g,x,y,b,v,w;for(d=0;d<n;d+=l){if(p=t[d].label,m=this._resolveTickFontOptions(d),r.font=g=m.string,x=o[g]=o[g]||{data:{},gc:[]},y=m.lineHeight,b=v=0,!Ot(p)&&!ke(p))b=pg(r,x.data,x.gc,b,p),v=y;else if(ke(p))for(h=0,f=p.length;h<f;++h)w=p[h],!Ot(w)&&!ke(w)&&(b=pg(r,x.data,x.gc,b,w),v+=y);i.push(b),a.push(v),c=Math.max(b,c),u=Math.max(v,u)}byt(o,n);const k=i.indexOf(c),C=a.indexOf(u),S=I=>({width:i[I]||0,height:a[I]||0});return{first:S(0),last:S(n-1),widest:S(k),highest:S(C),widths:i,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return ixt(this._alignToPixels?pa(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const s=n[t];return s.$context||(s.$context=wyt(this.getContext(),t,s))}return this.$context||(this.$context=vyt(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=yr(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),o=this._getLabelSizes(),i=t.autoSkipPadding||0,a=o?o.widest.width+i:0,l=o?o.highest.height+i:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,s=this.chart,r=this.options,{grid:o,position:i,border:a}=r,l=o.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=Fu(o),f=[],p=a.setContext(this.getContext()),m=p.display?p.width:0,g=m/2,x=function(M){return pa(s,M,m)};let y,b,v,w,k,C,S,I,$,E,A,L;if(i==="top")y=x(this.bottom),C=this.bottom-h,I=y-g,E=x(t.top)+g,L=t.bottom;else if(i==="bottom")y=x(this.top),E=t.top,L=x(t.bottom)-g,C=y+g,I=this.top+h;else if(i==="left")y=x(this.right),k=this.right-h,S=y-g,$=x(t.left)+g,A=t.right;else if(i==="right")y=x(this.left),$=t.left,A=x(t.right)-g,k=y+g,S=this.left+h;else if(n==="x"){if(i==="center")y=x((t.top+t.bottom)/2+.5);else if(Pt(i)){const M=Object.keys(i)[0],U=i[M];y=x(this.chart.scales[M].getPixelForValue(U))}E=t.top,L=t.bottom,C=y+g,I=C+h}else if(n==="y"){if(i==="center")y=x((t.left+t.right)/2);else if(Pt(i)){const M=Object.keys(i)[0],U=i[M];y=x(this.chart.scales[M].getPixelForValue(U))}k=y-g,S=k-h,$=t.left,A=t.right}const O=It(r.ticks.maxTicksLimit,d),P=Math.max(1,Math.ceil(d/O));for(b=0;b<d;b+=P){const M=this.getContext(b),U=o.setContext(M),R=a.setContext(M),z=U.lineWidth,H=U.color,X=R.dash||[],Q=R.dashOffset,J=U.tickWidth,nt=U.tickColor,st=U.tickBorderDash||[],ot=U.tickBorderDashOffset;v=yyt(this,b,l),v!==void 0&&(w=pa(s,v,z),c?k=S=$=A=w:C=I=E=L=w,f.push({tx1:k,ty1:C,tx2:S,ty2:I,x1:$,y1:E,x2:A,y2:L,width:z,color:H,borderDash:X,borderDashOffset:Q,tickWidth:J,tickColor:nt,tickBorderDash:st,tickBorderDashOffset:ot}))}return this._ticksLength=d,this._borderValue=y,f}_computeLabelItems(t){const n=this.axis,s=this.options,{position:r,ticks:o}=s,i=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=o,h=Fu(s.grid),f=h+u,p=d?-u:f,m=-yr(this.labelRotation),g=[];let x,y,b,v,w,k,C,S,I,$,E,A,L="middle";if(r==="top")k=this.bottom-p,C=this._getXAxisLabelAlignment();else if(r==="bottom")k=this.top+p,C=this._getXAxisLabelAlignment();else if(r==="left"){const P=this._getYAxisLabelAlignment(h);C=P.textAlign,w=P.x}else if(r==="right"){const P=this._getYAxisLabelAlignment(h);C=P.textAlign,w=P.x}else if(n==="x"){if(r==="center")k=(t.top+t.bottom)/2+f;else if(Pt(r)){const P=Object.keys(r)[0],M=r[P];k=this.chart.scales[P].getPixelForValue(M)+f}C=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")w=(t.left+t.right)/2-f;else if(Pt(r)){const P=Object.keys(r)[0],M=r[P];w=this.chart.scales[P].getPixelForValue(M)}C=this._getYAxisLabelAlignment(h).textAlign}n==="y"&&(l==="start"?L="top":l==="end"&&(L="bottom"));const O=this._getLabelSizes();for(x=0,y=a.length;x<y;++x){b=a[x],v=b.label;const P=o.setContext(this.getContext(x));S=this.getPixelForTick(x)+o.labelOffset,I=this._resolveTickFontOptions(x),$=I.lineHeight,E=ke(v)?v.length:1;const M=E/2,U=P.color,R=P.textStrokeColor,z=P.textStrokeWidth;let H=C;i?(w=S,C==="inner"&&(x===y-1?H=this.options.reverse?"left":"right":x===0?H=this.options.reverse?"right":"left":H="center"),r==="top"?c==="near"||m!==0?A=-E*$+$/2:c==="center"?A=-O.highest.height/2-M*$+$:A=-O.highest.height+$/2:c==="near"||m!==0?A=$/2:c==="center"?A=O.highest.height/2-M*$:A=O.highest.height-E*$,d&&(A*=-1),m!==0&&!P.showLabelBackdrop&&(w+=$/2*Math.sin(m))):(k=S,A=(1-E)*$/2);let X;if(P.showLabelBackdrop){const Q=Ln(P.backdropPadding),J=O.heights[x],nt=O.widths[x];let st=A-Q.top,ot=0-Q.left;switch(L){case"middle":st-=J/2;break;case"bottom":st-=J;break}switch(C){case"center":ot-=nt/2;break;case"right":ot-=nt;break;case"inner":x===y-1?ot-=nt:x>0&&(ot-=nt/2);break}X={left:ot,top:st,width:nt+Q.width,height:J+Q.height,color:P.backdropColor}}g.push({label:v,font:I,textOffset:A,options:{rotation:m,color:U,strokeColor:R,strokeWidth:z,textAlign:H,textBaseline:L,translation:[w,k],backdrop:X}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-yr(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:s,mirror:r,padding:o}}=this.options,i=this._getLabelSizes(),a=t+o,l=i.widest.width;let c,u;return n==="left"?r?(u=this.right+o,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+o,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:s,top:r,width:o,height:i}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(s,r,o,i),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(o=>o.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let o,i;const a=(l,c,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(n.display)for(o=0,i=r.length;o<i;++o){const l=r[o];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:s,grid:r}}=this,o=s.setContext(this.getContext()),i=s.display?o.width:0;if(!i)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,h;this.isHorizontal()?(c=pa(t,this.left,i)-i/2,u=pa(t,this.right,a)+a/2,d=h=l):(d=pa(t,this.top,i)-i/2,h=pa(t,this.bottom,a)+a/2,c=u=l),n.save(),n.lineWidth=o.width,n.strokeStyle=o.color,n.beginPath(),n.moveTo(c,d),n.lineTo(u,h),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&S0(s,r);const o=this.getLabelItems(t);for(const i of o){const a=i.options,l=i.font,c=i.label,u=i.textOffset;fl(s,c,0,u,l,a)}r&&I0(s)}drawTitle(){const{ctx:t,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const o=nn(s.font),i=Ln(s.padding),a=s.align;let l=o.lineHeight/2;n==="bottom"||n==="center"||Pt(n)?(l+=i.bottom,ke(s.text)&&(l+=o.lineHeight*(s.text.length-1))):l+=i.top;const{titleX:c,titleY:u,maxWidth:d,rotation:h}=Cyt(this,l,n,a);fl(t,s.text,0,0,o,{color:s.color,maxWidth:d,rotation:h,textAlign:kyt(a,n,r),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,s=It(t.grid&&t.grid.z,-1),r=It(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Nl.prototype.draw?[{z:n,draw:o=>{this.draw(o)}}]:[{z:s,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let o,i;for(o=0,i=n.length;o<i;++o){const a=n[o];a[s]===this.id&&(!t||a.type===t)&&r.push(a)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return nn(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class $p{constructor(t,n,s){this.type=t,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let s;$yt(n)&&(s=this.register(n));const r=this.items,o=t.id,i=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in r||(r[o]=t,Syt(t,i,s),this.override&&Se.override(t.id,t.overrides)),i}get(t){return this.items[t]}unregister(t){const n=this.items,s=t.id,r=this.scope;s in n&&delete n[s],r&&s in Se[r]&&(delete Se[r][s],this.override&&delete hl[s])}}function Syt(e,t,n){const s=Qd(Object.create(null),[n?Se.get(n):{},Se.get(t),e.defaults]);Se.set(t,s),e.defaultRoutes&&Iyt(t,e.defaultRoutes),e.descriptors&&Se.describe(t,e.descriptors)}function Iyt(e,t){Object.keys(t).forEach(n=>{const s=n.split("."),r=s.pop(),o=[e].concat(s).join("."),i=t[n].split("."),a=i.pop(),l=i.join(".");Se.route(o,r,l,a)})}function $yt(e){return"id"in e&&"defaults"in e}class Tyt{constructor(){this.controllers=new $p(Sr,"datasets",!0),this.elements=new $p(qo,"elements"),this.plugins=new $p(Object,"plugins"),this.scales=new $p(Nl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,s){[...n].forEach(r=>{const o=s||this._getRegistryForType(r);s||o.isForType(r)||o===this.plugins&&r.id?this._exec(t,o,r):Zt(r,i=>{const a=s||this._getRegistryForType(i);this._exec(t,a,i)})})}_exec(t,n,s){const r=aS(t);ce(s["before"+r],[],s),n[t](s),ce(s["after"+r],[],s)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(t))return s}return this.plugins}_get(t,n,s){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return r}}var Mr=new Tyt;class Nyt{constructor(){this._init=[]}notify(t,n,s,r){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const o=r?this._descriptors(t).filter(r):this._descriptors(t),i=this._notify(o,t,n,s);return n==="afterDestroy"&&(this._notify(o,t,"stop"),this._notify(this._init,t,"uninstall")),i}_notify(t,n,s,r){r=r||{};for(const o of t){const i=o.plugin,a=i[s],l=[n,r,o.options];if(ce(a,l,i)===!1&&r.cancelable)return!1}return!0}invalidate(){Ot(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const s=t&&t.config,r=It(s.options&&s.options.plugins,{}),o=Eyt(s);return r===!1&&!n?[]:Ryt(t,o,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],s=this._cache,r=(o,i)=>o.filter(a=>!i.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),t,"stop"),this._notify(r(s,n),t,"start")}}function Eyt(e){const t={},n=[],s=Object.keys(Mr.plugins.items);for(let o=0;o<s.length;o++)n.push(Mr.getPlugin(s[o]));const r=e.plugins||[];for(let o=0;o<r.length;o++){const i=r[o];n.indexOf(i)===-1&&(n.push(i),t[i.id]=!0)}return{plugins:n,localIds:t}}function _yt(e,t){return!t&&e===!1?null:e===!0?{}:e}function Ryt(e,{plugins:t,localIds:n},s,r){const o=[],i=e.getContext();for(const a of t){const l=a.id,c=_yt(s[l],r);c!==null&&o.push({plugin:a,options:Dyt(e.config,{plugin:a,local:n[l]},c,i)})}return o}function Dyt(e,{plugin:t,local:n},s,r){const o=e.pluginScopeKeys(t),i=e.getOptionScopes(s,o);return n&&t.defaults&&i.push(t.defaults),e.createResolver(i,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function L1(e,t){const n=Se.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function Ayt(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function Oyt(e,t){return e===t?"_index_":"_value_"}function FT(e){if(e==="x"||e==="y"||e==="r")return e}function Fyt(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function z1(e,...t){if(FT(e))return e;for(const n of t){const s=n.axis||Fyt(n.position)||e.length>1&&FT(e[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function PT(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function Pyt(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(s=>s.xAxisID===e||s.yAxisID===e);if(n.length)return PT(e,"x",n[0])||PT(e,"y",n[0])}return{}}function Myt(e,t){const n=hl[e.type]||{scales:{}},s=t.scales||{},r=L1(e.type,t),o=Object.create(null);return Object.keys(s).forEach(i=>{const a=s[i];if(!Pt(a))return console.error(`Invalid scale configuration for scale: ${i}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${i}`);const l=z1(i,a,Pyt(i,e),Se.scales[a.type]),c=Oyt(l,r),u=n.scales||{};o[i]=hd(Object.create(null),[{axis:l},a,u[l],u[c]])}),e.data.datasets.forEach(i=>{const a=i.type||e.type,l=i.indexAxis||L1(a,t),u=(hl[a]||{}).scales||{};Object.keys(u).forEach(d=>{const h=Ayt(d,l),f=i[h+"AxisID"]||h;o[f]=o[f]||Object.create(null),hd(o[f],[{axis:h},s[f],u[d]])})}),Object.keys(o).forEach(i=>{const a=o[i];hd(a,[Se.scales[a.type],Se.scale])}),o}function dz(e){const t=e.options||(e.options={});t.plugins=It(t.plugins,{}),t.scales=Myt(e,t)}function hz(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function Lyt(e){return e=e||{},e.data=hz(e.data),dz(e),e}const MT=new Map,fz=new Set;function Tp(e,t){let n=MT.get(e);return n||(n=t(),MT.set(e,n),fz.add(n)),n}const Pu=(e,t,n)=>{const s=qi(t,n);s!==void 0&&e.add(s)};class zyt{constructor(t){this._config=Lyt(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=hz(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),dz(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Tp(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return Tp(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return Tp(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,s=this.type;return Tp(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const s=this._scopeCache;let r=s.get(t);return(!r||n)&&(r=new Map,s.set(t,r)),r}getOptionScopes(t,n,s){const{options:r,type:o}=this,i=this._cachedScopes(t,s),a=i.get(n);if(a)return a;const l=new Set;n.forEach(u=>{t&&(l.add(t),u.forEach(d=>Pu(l,t,d))),u.forEach(d=>Pu(l,r,d)),u.forEach(d=>Pu(l,hl[o]||{},d)),u.forEach(d=>Pu(l,Se,d)),u.forEach(d=>Pu(l,F1,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),fz.has(n)&&i.set(n,c),c}chartOptionScopes(){const{options:t,type:n}=this;return[t,hl[n]||{},Se.datasets[n]||{},{type:n},Se,F1]}resolveNamedOptions(t,n,s,r=[""]){const o={$shared:!0},{resolver:i,subPrefixes:a}=LT(this._resolverCache,t,r);let l=i;if(Vyt(i,n)){o.$shared=!1,s=Yi(s)?s():s;const c=this.createResolver(t,s,a);l=Uc(i,s,c)}for(const c of n)o[c]=l[c];return o}createResolver(t,n,s=[""],r){const{resolver:o}=LT(this._resolverCache,t,s);return Pt(n)?Uc(o,n,void 0,r):o}}function LT(e,t,n){let s=e.get(t);s||(s=new Map,e.set(t,s));const r=n.join();let o=s.get(r);return o||(o={resolver:fS(t,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,o)),o}const Byt=e=>Pt(e)&&Object.getOwnPropertyNames(e).some(t=>Yi(e[t]));function Vyt(e,t){const{isScriptable:n,isIndexable:s}=G3(e);for(const r of t){const o=n(r),i=s(r),a=(i||o)&&e[r];if(o&&(Yi(a)||Byt(a))||i&&ke(a))return!0}return!1}var Wyt="4.5.0";const Uyt=["top","bottom","left","right","chartArea"];function zT(e,t){return e==="top"||e==="bottom"||Uyt.indexOf(e)===-1&&t==="x"}function BT(e,t){return function(n,s){return n[e]===s[e]?n[t]-s[t]:n[e]-s[e]}}function VT(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),ce(n&&n.onComplete,[e],t)}function jyt(e){const t=e.chart,n=t.options.animation;ce(n&&n.onProgress,[e],t)}function pz(e){return gS()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const nm={},WT=e=>{const t=pz(e);return Object.values(nm).filter(n=>n.canvas===t).pop()};function Gyt(e,t,n){const s=Object.keys(e);for(const r of s){const o=+r;if(o>=t){const i=e[r];delete e[r],(n>0||o>t)&&(e[o+n]=i)}}}function Hyt(e,t,n,s){return!n||e.type==="mouseout"?null:s?t:e}class ks{static register(...t){Mr.add(...t),UT()}static unregister(...t){Mr.remove(...t),UT()}constructor(t,n){const s=this.config=new zyt(n),r=pz(t),o=WT(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const i=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||uyt(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,i.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=Kgt(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=i,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Nyt,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=uxt(d=>this.update(d),i.resizeDelay||0),this._dataChanges=[],nm[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}mo.listen(this,"complete",VT),mo.listen(this,"progress",jyt),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:s,height:r,_aspectRatio:o}=this;return Ot(t)?n&&o?o:r?s/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Mr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():dT(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return lT(this.canvas,this.ctx),this}stop(){return mo.stop(this),this}resize(t,n){mo.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const s=this.options,r=this.canvas,o=s.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(r,t,n,o),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,dT(this,a,!0)&&(this.notifyPlugins("resize",{size:i}),ce(s.onResize,[this,i],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Zt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,s=this.scales,r=Object.keys(s).reduce((i,a)=>(i[a]=!1,i),{});let o=[];n&&(o=o.concat(Object.keys(n).map(i=>{const a=n[i],l=z1(i,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Zt(o,i=>{const a=i.options,l=a.id,c=z1(l,a),u=It(a.type,i.dtype);(a.position===void 0||zT(a.position,c)!==zT(i.dposition))&&(a.position=i.dposition),r[l]=!0;let d=null;if(l in s&&s[l].type===u)d=s[l];else{const h=Mr.getScale(u);d=new h({id:l,type:u,ctx:this.ctx,chart:this}),s[d.id]=d}d.init(a,t)}),Zt(r,(i,a)=>{i||delete s[a]}),Zt(s,i=>{An.configure(this,i,i.options),An.addBox(this,i)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,s=t.length;if(t.sort((r,o)=>r.index-o.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);t.splice(n,s-n)}this._sortedMetasets=t.slice(0).sort(BT("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((s,r)=>{n.filter(o=>o===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const o=n[s];let i=this.getDatasetMeta(s);const a=o.type||this.config.type;if(i.type&&i.type!==a&&(this._destroyDatasetMeta(s),i=this.getDatasetMeta(s)),i.type=a,i.indexAxis=o.indexAxis||L1(a,this.options),i.order=o.order||0,i.index=s,i.label=""+o.label,i.visible=this.isDatasetVisible(s),i.controller)i.controller.updateIndex(s),i.controller.linkScales();else{const l=Mr.getController(a),{datasetElementType:c,dataElementType:u}=Se.datasets[a];Object.assign(l,{dataElementType:Mr.getElement(u),datasetElementType:c&&Mr.getElement(c)}),i.controller=new l(this,s),t.push(i.controller)}}return this._updateMetasets(),t}_resetElements(){Zt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let i=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),h=!r&&o.indexOf(d)===-1;d.buildOrUpdateElements(h),i=Math.max(+d.getMaxOverflow(),i)}i=this._minPadding=s.layout.autoPadding?i:0,this._updateLayout(i),r||Zt(o,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(BT("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Zt(this.scales,t=>{An.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!J$(n,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:o}of n){const i=s==="_removeElements"?-o:o;Gyt(t,r,i)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=o=>new Set(t.filter(i=>i[0]===o).map((i,a)=>a+","+i.splice(1).join(","))),r=s(0);for(let o=1;o<n;o++)if(!J$(r,s(o)))return;return Array.from(r).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;An.update(this,this.width,this.height,t);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],Zt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,o)=>{r._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Yi(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const s=this.getDatasetMeta(t),r={meta:s,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(mo.has(this)?this.attached&&!mo.running(this)&&mo.start(this):(this.draw(),VT({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,s=[];let r,o;for(r=0,o=n.length;r<o;++r){const i=n[r];(!t||i.visible)&&s.push(i)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,s={meta:t,index:t.index,cancelable:!0},r=nz(this,t);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&S0(n,r),t.controller.draw(),r&&I0(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return No(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,s,r){const o=U0t.modes[n];return typeof o=="function"?o(this,t,s,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],s=this._metasets;let r=s.filter(o=>o&&o._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=ca(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(t,n){const s=this.getDatasetMeta(t);s.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,s){const r=s?"show":"hide",o=this.getDatasetMeta(t),i=o.controller._resolveAnimations(void 0,r);Zd(n)?(o.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),i.update(o,{visible:s}),this.update(a=>a.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),mo.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),lT(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete nm[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,s=(o,i)=>{n.addEventListener(this,o,i),t[o]=i},r=(o,i,a)=>{o.offsetX=i,o.offsetY=a,this._eventHandler(o)};Zt(this.options.events,o=>s(o,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,s=(l,c)=>{n.addEventListener(this,l,c),t[l]=c},r=(l,c)=>{t[l]&&(n.removeEventListener(this,l,c),delete t[l])},o=(l,c)=>{this.canvas&&this.resize(l,c)};let i;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",o),s("detach",i)};i=()=>{this.attached=!1,r("resize",o),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():i()}unbindEvents(){Zt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},Zt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,s){const r=s?"set":"remove";let o,i,a,l;for(n==="dataset"&&(o=this.getDatasetMeta(t[0].datasetIndex),o.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){i=t[a];const c=i&&this.getDatasetMeta(i.datasetIndex).controller;c&&c[r+"HoverStyle"](i.element,i.datasetIndex,i.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],s=t.map(({datasetIndex:o,index:i})=>{const a=this.getDatasetMeta(o);if(!a)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:a.data[i],index:i}});!dg(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(t,n,s){return this._plugins.notify(this,t,n,s)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,s){const r=this.options.hover,o=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),i=o(n,t),a=s?t:o(t,n);i.length&&this.updateHoverStyle(i,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(t,n){const s={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=i=>(i.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const o=this._handleEvent(t,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(o||s.changed)&&this.render(),this}_handleEvent(t,n,s){const{_active:r=[],options:o}=this,i=n,a=this._getActiveElements(t,r,s,i),l=Jgt(t),c=Hyt(t,this._lastEvent,s,l);s&&(this._lastEvent=null,ce(o.onHover,[t,a,this],this),l&&ce(o.onClick,[t,a,this],this));const u=!dg(a,r);return(u||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=c,u}_getActiveElements(t,n,s,r){if(t.type==="mouseout")return[];if(!s)return n;const o=this.options.hover;return this.getElementsAtEventForMode(t,o.mode,o,r)}}it(ks,"defaults",Se),it(ks,"instances",nm),it(ks,"overrides",hl),it(ks,"registry",Mr),it(ks,"version",Wyt),it(ks,"getChart",WT);function UT(){return Zt(ks.instances,e=>e._plugins.invalidate())}function Kyt(e,t,n){const{startAngle:s,x:r,y:o,outerRadius:i,innerRadius:a,options:l}=t,{borderWidth:c,borderJoinStyle:u}=l,d=Math.min(c/i,En(s-n));if(e.beginPath(),e.arc(r,o,i-c/2,s+d/2,n-d/2),a>0){const h=Math.min(c/a,En(s-n));e.arc(r,o,a+c/2,n-h/2,s+h/2,!0)}else{const h=Math.min(c/2,i*En(s-n));if(u==="round")e.arc(r,o,h,n-Gt/2,s+Gt/2,!0);else if(u==="bevel"){const f=2*h*h,p=-f*Math.cos(n+Gt/2)+r,m=-f*Math.sin(n+Gt/2)+o,g=f*Math.cos(s+Gt/2)+r,x=f*Math.sin(s+Gt/2)+o;e.lineTo(p,m),e.lineTo(g,x)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function Xyt(e,t,n){const{startAngle:s,pixelMargin:r,x:o,y:i,outerRadius:a,innerRadius:l}=t;let c=r/a;e.beginPath(),e.arc(o,i,a,s-c,n+c),l>r?(c=r/l,e.arc(o,i,l,n+c,s-c,!0)):e.arc(o,i,r,n+Be,s-Be),e.closePath(),e.clip()}function qyt(e){return hS(e,["outerStart","outerEnd","innerStart","innerEnd"])}function Yyt(e,t,n,s){const r=qyt(e.options.borderRadius),o=(n-t)/2,i=Math.min(o,s*t/2),a=l=>{const c=(n-Math.min(o,l))*s/2;return ln(l,0,Math.min(o,c))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:ln(r.innerStart,0,i),innerEnd:ln(r.innerEnd,0,i)}}function Al(e,t,n,s){return{x:n+e*Math.cos(t),y:s+e*Math.sin(t)}}function xg(e,t,n,s,r,o){const{x:i,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,d=Math.max(t.outerRadius+s+n-c,0),h=u>0?u+s+n+c:0;let f=0;const p=r-l;if(s){const P=u>0?u-s:0,M=d>0?d-s:0,U=(P+M)/2,R=U!==0?p*U/(U+s):p;f=(p-R)/2}const m=Math.max(.001,p*d-n/Gt)/d,g=(p-m)/2,x=l+g+f,y=r-g-f,{outerStart:b,outerEnd:v,innerStart:w,innerEnd:k}=Yyt(t,h,d,y-x),C=d-b,S=d-v,I=x+b/C,$=y-v/S,E=h+w,A=h+k,L=x+w/E,O=y-k/A;if(e.beginPath(),o){const P=(I+$)/2;if(e.arc(i,a,d,I,P),e.arc(i,a,d,P,$),v>0){const z=Al(S,$,i,a);e.arc(z.x,z.y,v,$,y+Be)}const M=Al(A,y,i,a);if(e.lineTo(M.x,M.y),k>0){const z=Al(A,O,i,a);e.arc(z.x,z.y,k,y+Be,O+Math.PI)}const U=(y-k/h+(x+w/h))/2;if(e.arc(i,a,h,y-k/h,U,!0),e.arc(i,a,h,U,x+w/h,!0),w>0){const z=Al(E,L,i,a);e.arc(z.x,z.y,w,L+Math.PI,x-Be)}const R=Al(C,x,i,a);if(e.lineTo(R.x,R.y),b>0){const z=Al(C,I,i,a);e.arc(z.x,z.y,b,x-Be,I)}}else{e.moveTo(i,a);const P=Math.cos(I)*d+i,M=Math.sin(I)*d+a;e.lineTo(P,M);const U=Math.cos($)*d+i,R=Math.sin($)*d+a;e.lineTo(U,R)}e.closePath()}function Qyt(e,t,n,s,r){const{fullCircles:o,startAngle:i,circumference:a}=t;let l=t.endAngle;if(o){xg(e,t,n,s,l,r);for(let c=0;c<o;++c)e.fill();isNaN(a)||(l=i+(a%ye||ye))}return xg(e,t,n,s,l,r),e.fill(),l}function Zyt(e,t,n,s,r){const{fullCircles:o,startAngle:i,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:h,borderRadius:f}=l,p=l.borderAlign==="inner";if(!c)return;e.setLineDash(d||[]),e.lineDashOffset=h,p?(e.lineWidth=c*2,e.lineJoin=u||"round"):(e.lineWidth=c,e.lineJoin=u||"bevel");let m=t.endAngle;if(o){xg(e,t,n,s,m,r);for(let g=0;g<o;++g)e.stroke();isNaN(a)||(m=i+(a%ye||ye))}p&&Xyt(e,t,m),l.selfJoin&&m-i>=Gt&&f===0&&u!=="miter"&&Kyt(e,t,m),o||(xg(e,t,n,s,m,r),e.stroke())}class Qu extends qo{constructor(n){super();it(this,"circumference");it(this,"endAngle");it(this,"fullCircles");it(this,"innerRadius");it(this,"outerRadius");it(this,"pixelMargin");it(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const o=this.getProps(["x","y"],r),{angle:i,distance:a}=F3(o,{x:n,y:s}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:d,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),f=(this.options.spacing+this.options.borderWidth)/2,p=It(h,c-l),m=Jd(i,l,c)&&l!==c,g=p>=ye||m,x=$o(a,u+f,d+f);return g&&x}getCenterPoint(n){const{x:s,y:r,startAngle:o,endAngle:i,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:c,spacing:u}=this.options,d=(o+i)/2,h=(a+l+u+c)/2;return{x:s+Math.cos(d)*h,y:r+Math.sin(d)*h}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,o=(s.offset||0)/4,i=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>ye?Math.floor(r/ye):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*o,Math.sin(l)*o);const c=1-Math.sin(Math.min(Gt,r||0)),u=o*c;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,Qyt(n,this,u,i,a),Zyt(n,this,u,i,a),n.restore()}}it(Qu,"id","arc"),it(Qu,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),it(Qu,"defaultRoutes",{backgroundColor:"backgroundColor"}),it(Qu,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function mz(e,t,n=t){e.lineCap=It(n.borderCapStyle,t.borderCapStyle),e.setLineDash(It(n.borderDash,t.borderDash)),e.lineDashOffset=It(n.borderDashOffset,t.borderDashOffset),e.lineJoin=It(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=It(n.borderWidth,t.borderWidth),e.strokeStyle=It(n.borderColor,t.borderColor)}function Jyt(e,t,n){e.lineTo(n.x,n.y)}function tbt(e){return e.stepped?kxt:e.tension||e.cubicInterpolationMode==="monotone"?Cxt:Jyt}function gz(e,t,n={}){const s=e.length,{start:r=0,end:o=s-1}=n,{start:i,end:a}=t,l=Math.max(r,i),c=Math.min(o,a),u=r<i&&o<i||r>a&&o>a;return{count:s,start:l,loop:t.loop,ilen:c<l&&!u?s+c-l:c-l}}function ebt(e,t,n,s){const{points:r,options:o}=t,{count:i,start:a,loop:l,ilen:c}=gz(r,n,s),u=tbt(o);let{move:d=!0,reverse:h}=s||{},f,p,m;for(f=0;f<=c;++f)p=r[(a+(h?c-f:f))%i],!p.skip&&(d?(e.moveTo(p.x,p.y),d=!1):u(e,m,p,h,o.stepped),m=p);return l&&(p=r[(a+(h?c:0))%i],u(e,m,p,h,o.stepped)),!!l}function nbt(e,t,n,s){const r=t.points,{count:o,start:i,ilen:a}=gz(r,n,s),{move:l=!0,reverse:c}=s||{};let u=0,d=0,h,f,p,m,g,x;const y=v=>(i+(c?a-v:v))%o,b=()=>{m!==g&&(e.lineTo(u,g),e.lineTo(u,m),e.lineTo(u,x))};for(l&&(f=r[y(0)],e.moveTo(f.x,f.y)),h=0;h<=a;++h){if(f=r[y(h)],f.skip)continue;const v=f.x,w=f.y,k=v|0;k===p?(w<m?m=w:w>g&&(g=w),u=(d*u+v)/++d):(b(),e.lineTo(v,w),p=k,d=0,m=g=w),x=w}b()}function B1(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?nbt:ebt}function sbt(e){return e.stepped?e0t:e.tension||e.cubicInterpolationMode==="monotone"?n0t:wa}function rbt(e,t,n,s){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,s)&&r.closePath()),mz(e,t.options),e.stroke(r)}function obt(e,t,n,s){const{segments:r,options:o}=t,i=B1(t);for(const a of r)mz(e,o,a.style),e.beginPath(),i(e,t,a,{start:n,end:n+s-1})&&e.closePath(),e.stroke()}const ibt=typeof Path2D=="function";function abt(e,t,n,s){ibt&&!t.options.segment?rbt(e,t,n,s):obt(e,t,n,s)}class Ci extends qo{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;Kxt(this._points,s,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=l0t(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,s=t.length;return s&&n[t[s-1].end]}interpolate(t,n){const s=this.options,r=t[n],o=this.points,i=ez(this,{property:n,start:r,end:r});if(!i.length)return;const a=[],l=sbt(s);let c,u;for(c=0,u=i.length;c<u;++c){const{start:d,end:h}=i[c],f=o[d],p=o[h];if(f===p){a.push(f);continue}const m=Math.abs((r-f[n])/(p[n]-f[n])),g=l(f,p,m,s.stepped);g[n]=t[n],a.push(g)}return a.length===1?a[0]:a}pathSegment(t,n,s){return B1(this)(t,this,n,s)}path(t,n,s){const r=this.segments,o=B1(this);let i=this._loop;n=n||0,s=s||this.points.length-n;for(const a of r)i&=o(t,this,a,{start:n,end:n+s-1});return!!i}draw(t,n,s,r){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(t.save(),abt(t,this,s,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}it(Ci,"id","line"),it(Ci,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),it(Ci,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),it(Ci,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function jT(e,t,n,s){const r=e.options,{[n]:o}=e.getProps([n],s);return Math.abs(t-o)<r.radius+r.hitRadius}class sm extends qo{constructor(n){super();it(this,"parsed");it(this,"skip");it(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,s,r){const o=this.options,{x:i,y:a}=this.getProps(["x","y"],r);return Math.pow(n-i,2)+Math.pow(s-a,2)<Math.pow(o.hitRadius+o.radius,2)}inXRange(n,s){return jT(this,n,"x",s)}inYRange(n,s){return jT(this,n,"y",s)}getCenterPoint(n){const{x:s,y:r}=this.getProps(["x","y"],n);return{x:s,y:r}}size(n){n=n||this.options||{};let s=n.radius||0;s=Math.max(s,s&&n.hoverRadius||0);const r=s&&n.borderWidth||0;return(s+r)*2}draw(n,s){const r=this.options;this.skip||r.radius<.1||!No(this,s,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,P1(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}it(sm,"id","point"),it(sm,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),it(sm,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function xz(e,t){const{x:n,y:s,base:r,width:o,height:i}=e.getProps(["x","y","base","width","height"],t);let a,l,c,u,d;return e.horizontal?(d=i/2,a=Math.min(n,r),l=Math.max(n,r),c=s-d,u=s+d):(d=o/2,a=n-d,l=n+d,c=Math.min(s,r),u=Math.max(s,r)),{left:a,top:c,right:l,bottom:u}}function Si(e,t,n,s){return e?0:ln(t,n,s)}function lbt(e,t,n){const s=e.options.borderWidth,r=e.borderSkipped,o=j3(s);return{t:Si(r.top,o.top,0,n),r:Si(r.right,o.right,0,t),b:Si(r.bottom,o.bottom,0,n),l:Si(r.left,o.left,0,t)}}function cbt(e,t,n){const{enableBorderRadius:s}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,o=Wa(r),i=Math.min(t,n),a=e.borderSkipped,l=s||Pt(r);return{topLeft:Si(!l||a.top||a.left,o.topLeft,0,i),topRight:Si(!l||a.top||a.right,o.topRight,0,i),bottomLeft:Si(!l||a.bottom||a.left,o.bottomLeft,0,i),bottomRight:Si(!l||a.bottom||a.right,o.bottomRight,0,i)}}function ubt(e){const t=xz(e),n=t.right-t.left,s=t.bottom-t.top,r=lbt(e,n/2,s/2),o=cbt(e,n/2,s/2);return{outer:{x:t.left,y:t.top,w:n,h:s,radius:o},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,o.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(r.b,r.r))}}}}function By(e,t,n,s){const r=t===null,o=n===null,a=e&&!(r&&o)&&xz(e,s);return a&&(r||$o(t,a.left,a.right))&&(o||$o(n,a.top,a.bottom))}function dbt(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function hbt(e,t){e.rect(t.x,t.y,t.w,t.h)}function Vy(e,t,n={}){const s=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,o=(e.x+e.w!==n.x+n.w?t:0)-s,i=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+s,y:e.y+r,w:e.w+o,h:e.h+i,radius:e.radius}}class rm extends qo{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:o,outer:i}=ubt(this),a=dbt(i.radius)?th:hbt;t.save(),(i.w!==o.w||i.h!==o.h)&&(t.beginPath(),a(t,Vy(i,n,o)),t.clip(),a(t,Vy(o,-n,i)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),a(t,Vy(o,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,s){return By(this,t,n,s)}inXRange(t,n){return By(this,t,null,n)}inYRange(t,n){return By(this,null,t,n)}getCenterPoint(t){const{x:n,y:s,base:r,horizontal:o}=this.getProps(["x","y","base","horizontal"],t);return{x:o?(n+r)/2:n,y:o?s:(s+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}it(rm,"id","bar"),it(rm,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),it(rm,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var fbt=Object.freeze({__proto__:null,ArcElement:Qu,BarElement:rm,LineElement:Ci,PointElement:sm});const V1=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],GT=V1.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function yz(e){return V1[e%V1.length]}function bz(e){return GT[e%GT.length]}function pbt(e,t){return e.borderColor=yz(t),e.backgroundColor=bz(t),++t}function mbt(e,t){return e.backgroundColor=e.data.map(()=>yz(t++)),t}function gbt(e,t){return e.backgroundColor=e.data.map(()=>bz(t++)),t}function xbt(e){let t=0;return(n,s)=>{const r=e.getDatasetMeta(s).controller;r instanceof Da?t=mbt(n,t):r instanceof gd?t=gbt(n,t):r&&(t=pbt(n,t))}}function HT(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function ybt(e){return e&&(e.borderColor||e.backgroundColor)}function bbt(){return Se.borderColor!=="rgba(0,0,0,0.1)"||Se.backgroundColor!=="rgba(0,0,0,0.1)"}var vbt={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,n){if(!n.enabled)return;const{data:{datasets:s},options:r}=e.config,{elements:o}=r,i=HT(s)||ybt(r)||o&&HT(o)||bbt();if(!n.forceOverride&&i)return;const a=xbt(e);s.forEach(a)}};function wbt(e,t,n,s,r){const o=r.samples||s;if(o>=n)return e.slice(t,t+n);const i=[],a=(n-2)/(o-2);let l=0;const c=t+n-1;let u=t,d,h,f,p,m;for(i[l++]=e[u],d=0;d<o-2;d++){let g=0,x=0,y;const b=Math.floor((d+1)*a)+1+t,v=Math.min(Math.floor((d+2)*a)+1,n)+t,w=v-b;for(y=b;y<v;y++)g+=e[y].x,x+=e[y].y;g/=w,x/=w;const k=Math.floor(d*a)+1+t,C=Math.min(Math.floor((d+1)*a)+1,n)+t,{x:S,y:I}=e[u];for(f=p=-1,y=k;y<C;y++)p=.5*Math.abs((S-g)*(e[y].y-I)-(S-e[y].x)*(x-I)),p>f&&(f=p,h=e[y],m=y);i[l++]=h,u=m}return i[l++]=e[c],i}function kbt(e,t,n,s){let r=0,o=0,i,a,l,c,u,d,h,f,p,m;const g=[],x=t+n-1,y=e[t].x,v=e[x].x-y;for(i=t;i<t+n;++i){a=e[i],l=(a.x-y)/v*s,c=a.y;const w=l|0;if(w===u)c<p?(p=c,d=i):c>m&&(m=c,h=i),r=(o*r+a.x)/++o;else{const k=i-1;if(!Ot(d)&&!Ot(h)){const C=Math.min(d,h),S=Math.max(d,h);C!==f&&C!==k&&g.push({...e[C],x:r}),S!==f&&S!==k&&g.push({...e[S],x:r})}i>0&&k!==f&&g.push(e[k]),g.push(a),u=w,o=0,p=m=c,d=h=f=i}}return g}function vz(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function KT(e){e.data.datasets.forEach(t=>{vz(t)})}function Cbt(e,t){const n=t.length;let s=0,r;const{iScale:o}=e,{min:i,max:a,minDefined:l,maxDefined:c}=o.getUserBounds();return l&&(s=ln(To(t,o.axis,i).lo,0,n-1)),c?r=ln(To(t,o.axis,a).hi+1,s,n)-s:r=n-s,{start:s,count:r}}var Sbt={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){KT(e);return}const s=e.width;e.data.datasets.forEach((r,o)=>{const{_data:i,indexAxis:a}=r,l=e.getDatasetMeta(o),c=i||r.data;if(qu([a,e.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=e.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||e.options.parsing)return;let{start:d,count:h}=Cbt(l,c);const f=n.threshold||4*s;if(h<=f){vz(r);return}Ot(i)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(m){this._data=m}}));let p;switch(n.algorithm){case"lttb":p=wbt(c,d,h,s,n);break;case"min-max":p=kbt(c,d,h,s);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=p})},destroy(e){KT(e)}};function Ibt(e,t,n){const s=e.segments,r=e.points,o=t.points,i=[];for(const a of s){let{start:l,end:c}=a;c=T0(l,c,r);const u=W1(n,r[l],r[c],a.loop);if(!t.segments){i.push({source:a,target:u,start:r[l],end:r[c]});continue}const d=ez(t,u);for(const h of d){const f=W1(n,o[h.start],o[h.end],h.loop),p=tz(a,r,f);for(const m of p)i.push({source:m,target:h,start:{[n]:XT(u,f,"start",Math.max)},end:{[n]:XT(u,f,"end",Math.min)}})}}return i}function W1(e,t,n,s){if(s)return;let r=t[e],o=n[e];return e==="angle"&&(r=En(r),o=En(o)),{property:e,start:r,end:o}}function $bt(e,t){const{x:n=null,y:s=null}=e||{},r=t.points,o=[];return t.segments.forEach(({start:i,end:a})=>{a=T0(i,a,r);const l=r[i],c=r[a];s!==null?(o.push({x:l.x,y:s}),o.push({x:c.x,y:s})):n!==null&&(o.push({x:n,y:l.y}),o.push({x:n,y:c.y}))}),o}function T0(e,t,n){for(;t>e;t--){const s=n[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function XT(e,t,n,s){return e&&t?s(e[n],t[n]):e?e[n]:t?t[n]:0}function wz(e,t){let n=[],s=!1;return ke(e)?(s=!0,n=e):n=$bt(e,t),n.length?new Ci({points:n,options:{tension:0},_loop:s,_fullLoop:s}):null}function qT(e){return e&&e.fill!==!1}function Tbt(e,t,n){let r=e[t].fill;const o=[t];let i;if(!n)return r;for(;r!==!1&&o.indexOf(r)===-1;){if(!Ae(r))return r;if(i=e[r],!i)return!1;if(i.visible)return r;o.push(r),r=i.fill}return!1}function Nbt(e,t,n){const s=Dbt(e);if(Pt(s))return isNaN(s.value)?!1:s;let r=parseFloat(s);return Ae(r)&&Math.floor(r)===r?Ebt(s[0],t,r,n):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function Ebt(e,t,n,s){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=s?!1:n}function _bt(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:Pt(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function Rbt(e,t,n){let s;return e==="start"?s=n:e==="end"?s=t.options.reverse?t.min:t.max:Pt(e)?s=e.value:s=t.getBaseValue(),s}function Dbt(e){const t=e.options,n=t.fill;let s=It(n&&n.target,n);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function Abt(e){const{scale:t,index:n,line:s}=e,r=[],o=s.segments,i=s.points,a=Obt(t,n);a.push(wz({x:null,y:t.bottom},s));for(let l=0;l<o.length;l++){const c=o[l];for(let u=c.start;u<=c.end;u++)Fbt(r,i[u],a)}return new Ci({points:r,options:{}})}function Obt(e,t){const n=[],s=e.getMatchingVisibleMetas("line");for(let r=0;r<s.length;r++){const o=s[r];if(o.index===t)break;o.hidden||n.unshift(o.dataset)}return n}function Fbt(e,t,n){const s=[];for(let r=0;r<n.length;r++){const o=n[r],{first:i,last:a,point:l}=Pbt(o,t,"x");if(!(!l||i&&a)){if(i)s.unshift(l);else if(e.push(l),!a)break}}e.push(...s)}function Pbt(e,t,n){const s=e.interpolate(t,n);if(!s)return{};const r=s[n],o=e.segments,i=e.points;let a=!1,l=!1;for(let c=0;c<o.length;c++){const u=o[c],d=i[u.start][n],h=i[u.end][n];if($o(r,d,h)){a=r===d,l=r===h;break}}return{first:a,last:l,point:s}}class kz{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,s){const{x:r,y:o,radius:i}=this;return n=n||{start:0,end:ye},t.arc(r,o,i,n.end,n.start,!0),!s.bounds}interpolate(t){const{x:n,y:s,radius:r}=this,o=t.angle;return{x:n+Math.cos(o)*r,y:s+Math.sin(o)*r,angle:o}}}function Mbt(e){const{chart:t,fill:n,line:s}=e;if(Ae(n))return Lbt(t,n);if(n==="stack")return Abt(e);if(n==="shape")return!0;const r=zbt(e);return r instanceof kz?r:wz(r,s)}function Lbt(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function zbt(e){return(e.scale||{}).getPointPositionForValue?Vbt(e):Bbt(e)}function Bbt(e){const{scale:t={},fill:n}=e,s=_bt(n,t);if(Ae(s)){const r=t.isHorizontal();return{x:r?s:null,y:r?null:s}}return null}function Vbt(e){const{scale:t,fill:n}=e,s=t.options,r=t.getLabels().length,o=s.reverse?t.max:t.min,i=Rbt(n,t,o),a=[];if(s.grid.circular){const l=t.getPointPositionForValue(0,o);return new kz({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(i)})}for(let l=0;l<r;++l)a.push(t.getPointPositionForValue(l,i));return a}function Wy(e,t,n){const s=Mbt(t),{chart:r,index:o,line:i,scale:a,axis:l}=t,c=i.options,u=c.fill,d=c.backgroundColor,{above:h=d,below:f=d}=u||{},p=r.getDatasetMeta(o),m=nz(r,p);s&&i.points.length&&(S0(e,n),Wbt(e,{line:i,target:s,above:h,below:f,area:n,scale:a,axis:l,clip:m}),I0(e))}function Wbt(e,t){const{line:n,target:s,above:r,below:o,area:i,scale:a,clip:l}=t,c=n._loop?"angle":t.axis;e.save();let u=o;o!==r&&(c==="x"?(YT(e,s,i.top),Uy(e,{line:n,target:s,color:r,scale:a,property:c,clip:l}),e.restore(),e.save(),YT(e,s,i.bottom)):c==="y"&&(QT(e,s,i.left),Uy(e,{line:n,target:s,color:o,scale:a,property:c,clip:l}),e.restore(),e.save(),QT(e,s,i.right),u=r)),Uy(e,{line:n,target:s,color:u,scale:a,property:c,clip:l}),e.restore()}function YT(e,t,n){const{segments:s,points:r}=t;let o=!0,i=!1;e.beginPath();for(const a of s){const{start:l,end:c}=a,u=r[l],d=r[T0(l,c,r)];o?(e.moveTo(u.x,u.y),o=!1):(e.lineTo(u.x,n),e.lineTo(u.x,u.y)),i=!!t.pathSegment(e,a,{move:i}),i?e.closePath():e.lineTo(d.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function QT(e,t,n){const{segments:s,points:r}=t;let o=!0,i=!1;e.beginPath();for(const a of s){const{start:l,end:c}=a,u=r[l],d=r[T0(l,c,r)];o?(e.moveTo(u.x,u.y),o=!1):(e.lineTo(n,u.y),e.lineTo(u.x,u.y)),i=!!t.pathSegment(e,a,{move:i}),i?e.closePath():e.lineTo(n,d.y)}e.lineTo(n,t.first().y),e.closePath(),e.clip()}function Uy(e,t){const{line:n,target:s,property:r,color:o,scale:i,clip:a}=t,l=Ibt(n,s,r);for(const{source:c,target:u,start:d,end:h}of l){const{style:{backgroundColor:f=o}={}}=c,p=s!==!0;e.save(),e.fillStyle=f,Ubt(e,i,a,p&&W1(r,d,h)),e.beginPath();const m=!!n.pathSegment(e,c);let g;if(p){m?e.closePath():ZT(e,s,h,r);const x=!!s.pathSegment(e,u,{move:m,reverse:!0});g=m&&x,g||ZT(e,s,d,r)}e.closePath(),e.fill(g?"evenodd":"nonzero"),e.restore()}}function Ubt(e,t,n,s){const r=t.chart.chartArea,{property:o,start:i,end:a}=s||{};if(o==="x"||o==="y"){let l,c,u,d;o==="x"?(l=i,c=r.top,u=a,d=r.bottom):(l=r.left,c=i,u=r.right,d=a),e.beginPath(),n&&(l=Math.max(l,n.left),u=Math.min(u,n.right),c=Math.max(c,n.top),d=Math.min(d,n.bottom)),e.rect(l,c,u-l,d-c),e.clip()}}function ZT(e,t,n,s){const r=t.interpolate(n,s);r&&e.lineTo(r.x,r.y)}var jbt={id:"filler",afterDatasetsUpdate(e,t,n){const s=(e.data.datasets||[]).length,r=[];let o,i,a,l;for(i=0;i<s;++i)o=e.getDatasetMeta(i),a=o.dataset,l=null,a&&a.options&&a instanceof Ci&&(l={visible:e.isDatasetVisible(i),index:i,fill:Nbt(a,i,s),chart:e,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=l,r.push(l);for(i=0;i<s;++i)l=r[i],!(!l||l.fill===!1)&&(l.fill=Tbt(r,i,n.propagate))},beforeDraw(e,t,n){const s=n.drawTime==="beforeDraw",r=e.getSortedVisibleDatasetMetas(),o=e.chartArea;for(let i=r.length-1;i>=0;--i){const a=r[i].$filler;a&&(a.line.updateControlPoints(o,a.axis),s&&a.fill&&Wy(e.ctx,a,o))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const s=e.getSortedVisibleDatasetMetas();for(let r=s.length-1;r>=0;--r){const o=s[r].$filler;qT(o)&&Wy(e.ctx,o,e.chartArea)}},beforeDatasetDraw(e,t,n){const s=t.meta.$filler;!qT(s)||n.drawTime!=="beforeDatasetDraw"||Wy(e.ctx,s,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const JT=(e,t)=>{let{boxHeight:n=t,boxWidth:s=t}=e;return e.usePointStyle&&(n=Math.min(n,t),s=e.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(t,n)}},Gbt=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class tN extends qo{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,s){this.maxWidth=t,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=ce(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(s=>t.filter(s,this.chart.data))),t.sort&&(n=n.sort((s,r)=>t.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,r=nn(s.font),o=r.size,i=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=JT(s,o);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(i,o,a,l)+10):(u=this.maxHeight,c=this._fitCols(i,r,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,n,s,r){const{ctx:o,maxWidth:i,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let d=t;o.textAlign="left",o.textBaseline="middle";let h=-1,f=-u;return this.legendItems.forEach((p,m)=>{const g=s+n/2+o.measureText(p.text).width;(m===0||c[c.length-1]+g+2*a>i)&&(d+=u,c[c.length-(m>0?0:1)]=0,f+=u,h++),l[m]={left:0,top:f,row:h,width:g,height:r},c[c.length-1]+=g+a}),d}_fitCols(t,n,s,r){const{ctx:o,maxHeight:i,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=i-t;let d=a,h=0,f=0,p=0,m=0;return this.legendItems.forEach((g,x)=>{const{itemWidth:y,itemHeight:b}=Hbt(s,n,o,g,r);x>0&&f+b+2*a>u&&(d+=h+a,c.push({width:h,height:f}),p+=h+a,m++,h=f=0),l[x]={left:p,top:f,col:m,width:y,height:b},h=Math.max(h,y),f+=b+a}),d+=h,c.push({width:h,height:f}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:o}}=this,i=cc(o,this.left,this.width);if(this.isHorizontal()){let a=0,l=Tn(s,this.left+r,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=Tn(s,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+t+r,c.left=i.leftForLtr(i.x(l),c.width),l+=c.width+r}else{let a=0,l=Tn(s,this.top+t+r,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=Tn(s,this.top+t+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=i.leftForLtr(i.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;S0(t,this),this._draw(),I0(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:s,ctx:r}=this,{align:o,labels:i}=t,a=Se.color,l=cc(t.rtl,this.left,this.width),c=nn(i.font),{padding:u}=i,d=c.size,h=d/2;let f;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:g}=JT(i,d),x=function(k,C,S){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;r.save();const I=It(S.lineWidth,1);if(r.fillStyle=It(S.fillStyle,a),r.lineCap=It(S.lineCap,"butt"),r.lineDashOffset=It(S.lineDashOffset,0),r.lineJoin=It(S.lineJoin,"miter"),r.lineWidth=I,r.strokeStyle=It(S.strokeStyle,a),r.setLineDash(It(S.lineDash,[])),i.usePointStyle){const $={radius:m*Math.SQRT2/2,pointStyle:S.pointStyle,rotation:S.rotation,borderWidth:I},E=l.xPlus(k,p/2),A=C+h;U3(r,$,E,A,i.pointStyleWidth&&p)}else{const $=C+Math.max((d-m)/2,0),E=l.leftForLtr(k,p),A=Wa(S.borderRadius);r.beginPath(),Object.values(A).some(L=>L!==0)?th(r,{x:E,y:$,w:p,h:m,radius:A}):r.rect(E,$,p,m),r.fill(),I!==0&&r.stroke()}r.restore()},y=function(k,C,S){fl(r,S.text,k,C+g/2,c,{strikethrough:S.hidden,textAlign:l.textAlign(S.textAlign)})},b=this.isHorizontal(),v=this._computeTitleHeight();b?f={x:Tn(o,this.left+u,this.right-s[0]),y:this.top+u+v,line:0}:f={x:this.left+u,y:Tn(o,this.top+v+u,this.bottom-n[0].height),line:0},Q3(this.ctx,t.textDirection);const w=g+u;this.legendItems.forEach((k,C)=>{r.strokeStyle=k.fontColor,r.fillStyle=k.fontColor;const S=r.measureText(k.text).width,I=l.textAlign(k.textAlign||(k.textAlign=i.textAlign)),$=p+h+S;let E=f.x,A=f.y;l.setWidth(this.width),b?C>0&&E+$+u>this.right&&(A=f.y+=w,f.line++,E=f.x=Tn(o,this.left+u,this.right-s[f.line])):C>0&&A+w>this.bottom&&(E=f.x=E+n[f.line].width+u,f.line++,A=f.y=Tn(o,this.top+v+u,this.bottom-n[f.line].height));const L=l.x(E);if(x(L,A,k),E=dxt(I,E+p+h,b?E+$:this.right,t.rtl),y(l.x(E),A,k),b)f.x+=$+u;else if(typeof k.text!="string"){const O=c.lineHeight;f.y+=Cz(k,O)+u}else f.y+=w}),Z3(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,s=nn(n.font),r=Ln(n.padding);if(!n.display)return;const o=cc(t.rtl,this.left,this.width),i=this.ctx,a=n.position,l=s.size/2,c=r.top+l;let u,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+c,d=Tn(t.align,d,this.right-h);else{const p=this.columnSizes.reduce((m,g)=>Math.max(m,g.height),0);u=c+Tn(t.align,this.top,this.bottom-p-t.labels.padding-this._computeTitleHeight())}const f=Tn(a,d,d+h);i.textAlign=o.textAlign(uS(a)),i.textBaseline="middle",i.strokeStyle=n.color,i.fillStyle=n.color,i.font=s.string,fl(i,n.text,f,u,s)}_computeTitleHeight(){const t=this.options.title,n=nn(t.font),s=Ln(t.padding);return t.display?n.lineHeight+s.height:0}_getLegendItemAt(t,n){let s,r,o;if($o(t,this.left,this.right)&&$o(n,this.top,this.bottom)){for(o=this.legendHitBoxes,s=0;s<o.length;++s)if(r=o[s],$o(t,r.left,r.left+r.width)&&$o(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(t){const n=this.options;if(!qbt(t.type,n))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,o=Gbt(r,s);r&&!o&&ce(n.onLeave,[t,r,this],this),this._hoveredItem=s,s&&!o&&ce(n.onHover,[t,s,this],this)}else s&&ce(n.onClick,[t,s,this],this)}}function Hbt(e,t,n,s,r){const o=Kbt(s,e,t,n),i=Xbt(r,s,t.lineHeight);return{itemWidth:o,itemHeight:i}}function Kbt(e,t,n,s){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((o,i)=>o.length>i.length?o:i)),t+n.size/2+s.measureText(r).width}function Xbt(e,t,n){let s=e;return typeof t.text!="string"&&(s=Cz(t,n)),s}function Cz(e,t){const n=e.text?e.text.length:0;return t*n}function qbt(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var Ybt={id:"legend",_element:tN,start(e,t,n){const s=e.legend=new tN({ctx:e.ctx,options:n,chart:e});An.configure(e,s,n),An.addBox(e,s)},stop(e){An.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const s=e.legend;An.configure(e,s,n),s.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const s=t.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),t.hidden=!0):(r.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:o,useBorderRadius:i,borderRadius:a}}=e.legend.options;return e._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),u=Ln(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:o,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:i&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class bS extends qo{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=ke(s.text)?s.text.length:1;this._padding=Ln(s.padding);const o=r*nn(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:s,bottom:r,right:o,options:i}=this,a=i.align;let l=0,c,u,d;return this.isHorizontal()?(u=Tn(a,s,o),d=n+t,c=o-s):(i.position==="left"?(u=s+t,d=Tn(a,r,n),l=Gt*-.5):(u=o-t,d=Tn(a,n,r),l=Gt*.5),c=r-n),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const s=nn(n.font),o=s.lineHeight/2+this._padding.top,{titleX:i,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(o);fl(t,n.text,0,0,s,{color:n.color,maxWidth:l,rotation:c,textAlign:uS(n.align),textBaseline:"middle",translation:[i,a]})}}function Qbt(e,t){const n=new bS({ctx:e.ctx,options:t,chart:e});An.configure(e,n,t),An.addBox(e,n),e.titleBlock=n}var Zbt={id:"title",_element:bS,start(e,t,n){Qbt(e,n)},stop(e){const t=e.titleBlock;An.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const s=e.titleBlock;An.configure(e,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Np=new WeakMap;var Jbt={id:"subtitle",start(e,t,n){const s=new bS({ctx:e.ctx,options:n,chart:e});An.configure(e,s,n),An.addBox(e,s),Np.set(e,s)},stop(e){An.removeBox(e,Np.get(e)),Np.delete(e)},beforeUpdate(e,t,n){const s=Np.get(e);An.configure(e,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Zu={average(e){if(!e.length)return!1;let t,n,s=new Set,r=0,o=0;for(t=0,n=e.length;t<n;++t){const a=e[t].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++o}}return o===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/o}},nearest(e,t){if(!e.length)return!1;let n=t.x,s=t.y,r=Number.POSITIVE_INFINITY,o,i,a;for(o=0,i=e.length;o<i;++o){const l=e[o].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=O1(t,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function Or(e,t){return t&&(ke(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function go(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function t1t(e,t){const{element:n,datasetIndex:s,index:r}=t,o=e.getDatasetMeta(s).controller,{label:i,value:a}=o.getLabelAndValue(r);return{chart:e,label:i,parsed:o.getParsed(r),raw:e.data.datasets[s].data[r],formattedValue:a,dataset:o.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function eN(e,t){const n=e.chart.ctx,{body:s,footer:r,title:o}=e,{boxWidth:i,boxHeight:a}=t,l=nn(t.bodyFont),c=nn(t.titleFont),u=nn(t.footerFont),d=o.length,h=r.length,f=s.length,p=Ln(t.padding);let m=p.height,g=0,x=s.reduce((v,w)=>v+w.before.length+w.lines.length+w.after.length,0);if(x+=e.beforeBody.length+e.afterBody.length,d&&(m+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),x){const v=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;m+=f*v+(x-f)*l.lineHeight+(x-1)*t.bodySpacing}h&&(m+=t.footerMarginTop+h*u.lineHeight+(h-1)*t.footerSpacing);let y=0;const b=function(v){g=Math.max(g,n.measureText(v).width+y)};return n.save(),n.font=c.string,Zt(e.title,b),n.font=l.string,Zt(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?i+2+t.boxPadding:0,Zt(s,v=>{Zt(v.before,b),Zt(v.lines,b),Zt(v.after,b)}),y=0,n.font=u.string,Zt(e.footer,b),n.restore(),g+=p.width,{width:g,height:m}}function e1t(e,t){const{y:n,height:s}=t;return n<s/2?"top":n>e.height-s/2?"bottom":"center"}function n1t(e,t,n,s){const{x:r,width:o}=s,i=n.caretSize+n.caretPadding;if(e==="left"&&r+o+i>t.width||e==="right"&&r-o-i<0)return!0}function s1t(e,t,n,s){const{x:r,width:o}=n,{width:i,chartArea:{left:a,right:l}}=e;let c="center";return s==="center"?c=r<=(a+l)/2?"left":"right":r<=o/2?c="left":r>=i-o/2&&(c="right"),n1t(c,e,t,n)&&(c="center"),c}function nN(e,t,n){const s=n.yAlign||t.yAlign||e1t(e,n);return{xAlign:n.xAlign||t.xAlign||s1t(e,t,n,s),yAlign:s}}function r1t(e,t){let{x:n,width:s}=e;return t==="right"?n-=s:t==="center"&&(n-=s/2),n}function o1t(e,t,n){let{y:s,height:r}=e;return t==="top"?s+=n:t==="bottom"?s-=r+n:s-=r/2,s}function sN(e,t,n,s){const{caretSize:r,caretPadding:o,cornerRadius:i}=e,{xAlign:a,yAlign:l}=n,c=r+o,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:f}=Wa(i);let p=r1t(t,a);const m=o1t(t,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,h)+r:a==="right"&&(p+=Math.max(d,f)+r),{x:ln(p,0,s.width-t.width),y:ln(m,0,s.height-t.height)}}function Ep(e,t,n){const s=Ln(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-s.right:e.x+s.left}function rN(e){return Or([],go(e))}function i1t(e,t,n){return ca(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function oN(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const Sz={beforeTitle:fo,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return n[t.dataIndex]}return""},afterTitle:fo,beforeBody:fo,beforeLabel:fo,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return Ot(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:fo,afterBody:fo,beforeFooter:fo,footer:fo,afterFooter:fo};function ss(e,t,n,s){const r=e[t].call(n,s);return typeof r>"u"?Sz[t].call(n,s):r}class U1 extends qo{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,o=new sz(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=i1t(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:s}=n,r=ss(s,"beforeTitle",this,t),o=ss(s,"title",this,t),i=ss(s,"afterTitle",this,t);let a=[];return a=Or(a,go(r)),a=Or(a,go(o)),a=Or(a,go(i)),a}getBeforeBody(t,n){return rN(ss(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:s}=n,r=[];return Zt(t,o=>{const i={before:[],lines:[],after:[]},a=oN(s,o);Or(i.before,go(ss(a,"beforeLabel",this,o))),Or(i.lines,ss(a,"label",this,o)),Or(i.after,go(ss(a,"afterLabel",this,o))),r.push(i)}),r}getAfterBody(t,n){return rN(ss(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:s}=n,r=ss(s,"beforeFooter",this,t),o=ss(s,"footer",this,t),i=ss(s,"afterFooter",this,t);let a=[];return a=Or(a,go(r)),a=Or(a,go(o)),a=Or(a,go(i)),a}_createItems(t){const n=this._active,s=this.chart.data,r=[],o=[],i=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(t1t(this.chart,n[l]));return t.filter&&(a=a.filter((u,d,h)=>t.filter(u,d,h,s))),t.itemSort&&(a=a.sort((u,d)=>t.itemSort(u,d,s))),Zt(a,u=>{const d=oN(t.callbacks,u);r.push(ss(d,"labelColor",this,u)),o.push(ss(d,"labelPointStyle",this,u)),i.push(ss(d,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=i,this.dataPoints=a,a}update(t,n){const s=this.options.setContext(this.getContext()),r=this._active;let o,i=[];if(!r.length)this.opacity!==0&&(o={opacity:0});else{const a=Zu[s.position].call(this,r,this._eventPosition);i=this._createItems(s),this.title=this.getTitle(i,s),this.beforeBody=this.getBeforeBody(i,s),this.body=this.getBody(i,s),this.afterBody=this.getAfterBody(i,s),this.footer=this.getFooter(i,s);const l=this._size=eN(this,s),c=Object.assign({},a,l),u=nN(this.chart,s,c),d=sN(s,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,o={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=i,this.$context=void 0,o&&this._resolveAnimations().update(this,o),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,s,r){const o=this.getCaretPosition(t,s,r);n.lineTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineTo(o.x3,o.y3)}getCaretPosition(t,n,s){const{xAlign:r,yAlign:o}=this,{caretSize:i,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=Wa(a),{x:h,y:f}=t,{width:p,height:m}=n;let g,x,y,b,v,w;return o==="center"?(v=f+m/2,r==="left"?(g=h,x=g-i,b=v+i,w=v-i):(g=h+p,x=g+i,b=v-i,w=v+i),y=g):(r==="left"?x=h+Math.max(l,u)+i:r==="right"?x=h+p-Math.max(c,d)-i:x=this.caretX,o==="top"?(b=f,v=b-i,g=x-i,y=x+i):(b=f+m,v=b+i,g=x+i,y=x-i),w=b),{x1:g,x2:x,x3:y,y1:b,y2:v,y3:w}}drawTitle(t,n,s){const r=this.title,o=r.length;let i,a,l;if(o){const c=cc(s.rtl,this.x,this.width);for(t.x=Ep(this,s.titleAlign,s),n.textAlign=c.textAlign(s.titleAlign),n.textBaseline="middle",i=nn(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=i.string,l=0;l<o;++l)n.fillText(r[l],c.x(t.x),t.y+i.lineHeight/2),t.y+=i.lineHeight+a,l+1===o&&(t.y+=s.titleMarginBottom-a)}}_drawColorBox(t,n,s,r,o){const i=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=o,u=nn(o.bodyFont),d=Ep(this,"left",o),h=r.x(d),f=l<u.lineHeight?(u.lineHeight-l)/2:0,p=n.y+f;if(o.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},g=r.leftForLtr(h,c)+c/2,x=p+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,P1(t,m,g,x),t.strokeStyle=i.borderColor,t.fillStyle=i.backgroundColor,P1(t,m,g,x)}else{t.lineWidth=Pt(i.borderWidth)?Math.max(...Object.values(i.borderWidth)):i.borderWidth||1,t.strokeStyle=i.borderColor,t.setLineDash(i.borderDash||[]),t.lineDashOffset=i.borderDashOffset||0;const m=r.leftForLtr(h,c),g=r.leftForLtr(r.xPlus(h,1),c-2),x=Wa(i.borderRadius);Object.values(x).some(y=>y!==0)?(t.beginPath(),t.fillStyle=o.multiKeyBackground,th(t,{x:m,y:p,w:c,h:l,radius:x}),t.fill(),t.stroke(),t.fillStyle=i.backgroundColor,t.beginPath(),th(t,{x:g,y:p+1,w:c-2,h:l-2,radius:x}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(m,p,c,l),t.strokeRect(m,p,c,l),t.fillStyle=i.backgroundColor,t.fillRect(g,p+1,c-2,l-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,n,s){const{body:r}=this,{bodySpacing:o,bodyAlign:i,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=s,d=nn(s.bodyFont);let h=d.lineHeight,f=0;const p=cc(s.rtl,this.x,this.width),m=function(S){n.fillText(S,p.x(t.x+f),t.y+h/2),t.y+=h+o},g=p.textAlign(i);let x,y,b,v,w,k,C;for(n.textAlign=i,n.textBaseline="middle",n.font=d.string,t.x=Ep(this,g,s),n.fillStyle=s.bodyColor,Zt(this.beforeBody,m),f=a&&g!=="right"?i==="center"?c/2+u:c+2+u:0,v=0,k=r.length;v<k;++v){for(x=r[v],y=this.labelTextColors[v],n.fillStyle=y,Zt(x.before,m),b=x.lines,a&&b.length&&(this._drawColorBox(n,t,v,p,s),h=Math.max(d.lineHeight,l)),w=0,C=b.length;w<C;++w)m(b[w]),h=d.lineHeight;Zt(x.after,m)}f=0,h=d.lineHeight,Zt(this.afterBody,m),t.y-=o}drawFooter(t,n,s){const r=this.footer,o=r.length;let i,a;if(o){const l=cc(s.rtl,this.x,this.width);for(t.x=Ep(this,s.footerAlign,s),t.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",i=nn(s.footerFont),n.fillStyle=s.footerColor,n.font=i.string,a=0;a<o;++a)n.fillText(r[a],l.x(t.x),t.y+i.lineHeight/2),t.y+=i.lineHeight+s.footerSpacing}}drawBackground(t,n,s,r){const{xAlign:o,yAlign:i}=this,{x:a,y:l}=t,{width:c,height:u}=s,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Wa(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+d,l),i==="top"&&this.drawCaret(t,n,s,r),n.lineTo(a+c-h,l),n.quadraticCurveTo(a+c,l,a+c,l+h),i==="center"&&o==="right"&&this.drawCaret(t,n,s,r),n.lineTo(a+c,l+u-p),n.quadraticCurveTo(a+c,l+u,a+c-p,l+u),i==="bottom"&&this.drawCaret(t,n,s,r),n.lineTo(a+f,l+u),n.quadraticCurveTo(a,l+u,a,l+u-f),i==="center"&&o==="left"&&this.drawCaret(t,n,s,r),n.lineTo(a,l+d),n.quadraticCurveTo(a,l,a+d,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,s=this.$animations,r=s&&s.x,o=s&&s.y;if(r||o){const i=Zu[t.position].call(this,this._active,this._eventPosition);if(!i)return;const a=this._size=eN(this,t),l=Object.assign({},i,this._size),c=nN(n,t,l),u=sN(t,l,c,n);(r._to!==u.x||o._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},o={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const i=Ln(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(t.save(),t.globalAlpha=s,this.drawBackground(o,t,r,n),Q3(t,n.textDirection),o.y+=i.top,this.drawTitle(o,t,n),this.drawBody(o,t,n),this.drawFooter(o,t,n),Z3(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const s=this._active,r=t.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),o=!dg(s,r),i=this._positionChanged(r,n);(o||i)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,o=this._active||[],i=this._getActiveElements(t,o,n,s),a=this._positionChanged(i,t),l=n||!dg(i,o)||a;return l&&(this._active=i,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),l}_getActiveElements(t,n,s,r){const o=this.options;if(t.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const i=this.chart.getElementsAtEventForMode(t,o.mode,o,s);return o.reverse&&i.reverse(),i}_positionChanged(t,n){const{caretX:s,caretY:r,options:o}=this,i=Zu[o.position].call(this,t,n);return i!==!1&&(s!==i.x||r!==i.y)}}it(U1,"positioners",Zu);var a1t={id:"tooltip",_element:U1,positioners:Zu,afterInit(e,t,n){n&&(e.tooltip=new U1({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Sz},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},l1t=Object.freeze({__proto__:null,Colors:vbt,Decimation:Sbt,Filler:jbt,Legend:Ybt,SubTitle:Jbt,Title:Zbt,Tooltip:a1t});const c1t=(e,t,n,s)=>(typeof t=="string"?(n=e.push(t)-1,s.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function u1t(e,t,n,s){const r=e.indexOf(t);if(r===-1)return c1t(e,t,n,s);const o=e.lastIndexOf(t);return r!==o?n:r}const d1t=(e,t)=>e===null?null:ln(Math.round(e),0,t);function iN(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class j1 extends Nl{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:o}of n)s[r]===o&&s.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(Ot(t))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===t?n:u1t(s,t,It(n,t),this._addedLabels),d1t(n,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const t=this.min,n=this.max,s=this.options.offset,r=[];let o=this.getLabels();o=t===0&&n===o.length-1?o:o.slice(t,n+1),this._valueRange=Math.max(o.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let i=t;i<=n;i++)r.push({value:i});return r}getLabelForValue(t){return iN.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}it(j1,"id","category"),it(j1,"defaults",{ticks:{callback:iN}});function h1t(e,t){const n=[],{bounds:r,step:o,min:i,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:h}=e,f=o||1,p=u-1,{min:m,max:g}=t,x=!Ot(i),y=!Ot(a),b=!Ot(c),v=(g-m)/(d+1);let w=eT((g-m)/p/f)*f,k,C,S,I;if(w<1e-14&&!x&&!y)return[{value:m},{value:g}];I=Math.ceil(g/w)-Math.floor(m/w),I>p&&(w=eT(I*w/p/f)*f),Ot(l)||(k=Math.pow(10,l),w=Math.ceil(w*k)/k),r==="ticks"?(C=Math.floor(m/w)*w,S=Math.ceil(g/w)*w):(C=m,S=g),x&&y&&o&&rxt((a-i)/o,w/1e3)?(I=Math.round(Math.min((a-i)/w,u)),w=(a-i)/I,C=i,S=a):b?(C=x?i:C,S=y?a:S,I=c-1,w=(S-C)/I):(I=(S-C)/w,fd(I,Math.round(I),w/1e3)?I=Math.round(I):I=Math.ceil(I));const $=Math.max(nT(w),nT(C));k=Math.pow(10,Ot(l)?$:l),C=Math.round(C*k)/k,S=Math.round(S*k)/k;let E=0;for(x&&(h&&C!==i?(n.push({value:i}),C<i&&E++,fd(Math.round((C+E*w)*k)/k,i,aN(i,v,e))&&E++):C<i&&E++);E<I;++E){const A=Math.round((C+E*w)*k)/k;if(y&&A>a)break;n.push({value:A})}return y&&h&&S!==a?n.length&&fd(n[n.length-1].value,a,aN(a,v,e))?n[n.length-1].value=a:n.push({value:a}):(!y||S===a)&&n.push({value:S}),n}function aN(e,t,{horizontal:n,minRotation:s}){const r=yr(s),o=(n?Math.sin(r):Math.cos(r))||.001,i=.75*t*(""+e).length;return Math.min(t/o,i)}class yg extends Nl{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return Ot(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:o}=this;const i=l=>r=n?r:l,a=l=>o=s?o:l;if(t){const l=eo(r),c=eo(o);l<0&&c<0?a(0):l>0&&c>0&&i(0)}if(r===o){let l=o===0?1:Math.abs(o*.05);a(o+l),t||i(r-l)}this.min=r,this.max=o}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=t,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},o=this._range||this,i=h1t(r,o);return t.bounds==="ticks"&&O3(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const t=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const r=(s-n)/Math.max(t.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(t){return Af(t,this.chart.options.locale,this.options.ticks.format)}}class G1 extends yg{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Ae(t)?t:0,this.max=Ae(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,s=yr(this.options.ticks.minRotation),r=(t?Math.sin(s):Math.cos(s))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}it(G1,"id","linear"),it(G1,"defaults",{ticks:{callback:C0.formatters.numeric}});const nh=e=>Math.floor(ki(e)),ga=(e,t)=>Math.pow(10,nh(e)+t);function lN(e){return e/Math.pow(10,nh(e))===1}function cN(e,t,n){const s=Math.pow(10,n),r=Math.floor(e/s);return Math.ceil(t/s)-r}function f1t(e,t){const n=t-e;let s=nh(n);for(;cN(e,t,s)>10;)s++;for(;cN(e,t,s)<10;)s--;return Math.min(s,nh(e))}function p1t(e,{min:t,max:n}){t=ys(e.min,t);const s=[],r=nh(t);let o=f1t(t,n),i=o<0?Math.pow(10,Math.abs(o)):1;const a=Math.pow(10,o),l=r>o?Math.pow(10,r):0,c=Math.round((t-l)*i)/i,u=Math.floor((t-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,o)),h=ys(e.min,Math.round((l+u+d*Math.pow(10,o))*i)/i);for(;h<n;)s.push({value:h,major:lN(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(o++,d=2,i=o>=0?1:i),h=Math.round((l+u+d*Math.pow(10,o))*i)/i;const f=ys(e.max,h);return s.push({value:f,major:lN(f),significand:d}),s}class H1 extends Nl{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const s=yg.prototype.parse.apply(this,[t,n]);if(s===0){this._zero=!0;return}return Ae(s)&&s>0?s:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Ae(t)?Math.max(0,t):null,this.max=Ae(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Ae(this._userMin)&&(this.min=t===ga(this.min,0)?ga(this.min,-1):ga(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let s=this.min,r=this.max;const o=a=>s=t?s:a,i=a=>r=n?r:a;s===r&&(s<=0?(o(1),i(10)):(o(ga(s,-1)),i(ga(r,1)))),s<=0&&o(ga(r,-1)),r<=0&&i(ga(s,1)),this.min=s,this.max=r}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},s=p1t(n,this);return t.bounds==="ticks"&&O3(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":Af(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=ki(t),this._valueRange=ki(this.max)-ki(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(ki(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}it(H1,"id","logarithmic"),it(H1,"defaults",{ticks:{callback:C0.formatters.logarithmic,major:{enabled:!0}}});function K1(e){const t=e.ticks;if(t.display&&e.display){const n=Ln(t.backdropPadding);return It(t.font&&t.font.size,Se.font.size)+n.height}return 0}function m1t(e,t,n){return n=ke(n)?n:[n],{w:wxt(e,t.string,n),h:n.length*t.lineHeight}}function uN(e,t,n,s,r){return e===s||e===r?{start:t-n/2,end:t+n/2}:e<s||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function g1t(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),s=[],r=[],o=e._pointLabels.length,i=e.options.pointLabels,a=i.centerPointLabels?Gt/o:0;for(let l=0;l<o;l++){const c=i.setContext(e.getPointLabelContext(l));r[l]=c.padding;const u=e.getPointPosition(l,e.drawingArea+r[l],a),d=nn(c.font),h=m1t(e.ctx,d,e._pointLabels[l]);s[l]=h;const f=En(e.getIndexAngle(l)+a),p=Math.round(lS(f)),m=uN(p,u.x,h.w,0,180),g=uN(p,u.y,h.h,90,270);x1t(n,t,f,m,g)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=v1t(e,s,r)}function x1t(e,t,n,s,r){const o=Math.abs(Math.sin(n)),i=Math.abs(Math.cos(n));let a=0,l=0;s.start<t.l?(a=(t.l-s.start)/o,e.l=Math.min(e.l,t.l-a)):s.end>t.r&&(a=(s.end-t.r)/o,e.r=Math.max(e.r,t.r+a)),r.start<t.t?(l=(t.t-r.start)/i,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/i,e.b=Math.max(e.b,t.b+l))}function y1t(e,t,n){const s=e.drawingArea,{extra:r,additionalAngle:o,padding:i,size:a}=n,l=e.getPointPosition(t,s+r+i,o),c=Math.round(lS(En(l.angle+Be))),u=C1t(l.y,a.h,c),d=w1t(c),h=k1t(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}function b1t(e,t){if(!t)return!0;const{left:n,top:s,right:r,bottom:o}=e;return!(No({x:n,y:s},t)||No({x:n,y:o},t)||No({x:r,y:s},t)||No({x:r,y:o},t))}function v1t(e,t,n){const s=[],r=e._pointLabels.length,o=e.options,{centerPointLabels:i,display:a}=o.pointLabels,l={extra:K1(o)/2,additionalAngle:i?Gt/r:0};let c;for(let u=0;u<r;u++){l.padding=n[u],l.size=t[u];const d=y1t(e,u,l);s.push(d),a==="auto"&&(d.visible=b1t(d,c),d.visible&&(c=d))}return s}function w1t(e){return e===0||e===180?"center":e<180?"left":"right"}function k1t(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function C1t(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function S1t(e,t,n){const{left:s,top:r,right:o,bottom:i}=n,{backdropColor:a}=t;if(!Ot(a)){const l=Wa(t.borderRadius),c=Ln(t.backdropPadding);e.fillStyle=a;const u=s-c.left,d=r-c.top,h=o-s+c.width,f=i-r+c.height;Object.values(l).some(p=>p!==0)?(e.beginPath(),th(e,{x:u,y:d,w:h,h:f,radius:l}),e.fill()):e.fillRect(u,d,h,f)}}function I1t(e,t){const{ctx:n,options:{pointLabels:s}}=e;for(let r=t-1;r>=0;r--){const o=e._pointLabelItems[r];if(!o.visible)continue;const i=s.setContext(e.getPointLabelContext(r));S1t(n,i,o);const a=nn(i.font),{x:l,y:c,textAlign:u}=o;fl(n,e._pointLabels[r],l,c+a.lineHeight/2,a,{color:i.color,textAlign:u,textBaseline:"middle"})}}function Iz(e,t,n,s){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,ye);else{let o=e.getPointPosition(0,t);r.moveTo(o.x,o.y);for(let i=1;i<s;i++)o=e.getPointPosition(i,t),r.lineTo(o.x,o.y)}}function $1t(e,t,n,s,r){const o=e.ctx,i=t.circular,{color:a,lineWidth:l}=t;!i&&!s||!a||!l||n<0||(o.save(),o.strokeStyle=a,o.lineWidth=l,o.setLineDash(r.dash||[]),o.lineDashOffset=r.dashOffset,o.beginPath(),Iz(e,n,i,s),o.closePath(),o.stroke(),o.restore())}function T1t(e,t,n){return ca(e,{label:n,index:t,type:"pointLabel"})}class Ju extends yg{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=Ln(K1(this.options)/2),n=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(n,s)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=Ae(t)&&!isNaN(t)?t:0,this.max=Ae(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/K1(this.options))}generateTickLabels(t){yg.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,s)=>{const r=ce(this.options.pointLabels.callback,[n,s],this);return r||r===0?r:""}).filter((n,s)=>this.chart.getDataVisibility(s))}fit(){const t=this.options;t.display&&t.pointLabels.display?g1t(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,s,r){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((s-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,s,r))}getIndexAngle(t){const n=ye/(this._pointLabels.length||1),s=this.options.startAngle||0;return En(t*n+yr(s))}getDistanceFromCenterForValue(t){if(Ot(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(Ot(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const s=n[t];return T1t(this.getContext(),t,s)}}getPointPosition(t,n,s=0){const r=this.getIndexAngle(t)-Be+s;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:s,right:r,bottom:o}=this._pointLabelItems[t];return{left:n,top:s,right:r,bottom:o}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const s=this.ctx;s.save(),s.beginPath(),Iz(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:s,grid:r,border:o}=n,i=this._pointLabels.length;let a,l,c;if(n.pointLabels.display&&I1t(this,i),r.display&&this.ticks.forEach((u,d)=>{if(d!==0||d===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const h=this.getContext(d),f=r.setContext(h),p=o.setContext(h);$1t(this,f,l,i,p)}}),s.display){for(t.save(),a=i-1;a>=0;a--){const u=s.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:h}=u;!h||!d||(t.lineWidth=h,t.strokeStyle=d,t.setLineDash(u.borderDash),t.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),c=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,s=n.ticks;if(!s.display)return;const r=this.getIndexAngle(0);let o,i;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!n.reverse)return;const c=s.setContext(this.getContext(l)),u=nn(c.font);if(o=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=u.string,i=t.measureText(a.label).width,t.fillStyle=c.backdropColor;const d=Ln(c.backdropPadding);t.fillRect(-i/2-d.left,-o-u.size/2-d.top,i+d.width,u.size+d.height)}fl(t,a.label,0,-o,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}}it(Ju,"id","radialLinear"),it(Ju,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:C0.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),it(Ju,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),it(Ju,"descriptors",{angleLines:{_fallback:"grid"}});const N0={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},is=Object.keys(N0);function dN(e,t){return e-t}function hN(e,t){if(Ot(t))return null;const n=e._adapter,{parser:s,round:r,isoWeekday:o}=e._parseOpts;let i=t;return typeof s=="function"&&(i=s(i)),Ae(i)||(i=typeof s=="string"?n.parse(i,s):n.parse(i)),i===null?null:(r&&(i=r==="week"&&(Wc(o)||o===!0)?n.startOf(i,"isoWeek",o):n.startOf(i,r)),+i)}function fN(e,t,n,s){const r=is.length;for(let o=is.indexOf(e);o<r-1;++o){const i=N0[is[o]],a=i.steps?i.steps:Number.MAX_SAFE_INTEGER;if(i.common&&Math.ceil((n-t)/(a*i.size))<=s)return is[o]}return is[r-1]}function N1t(e,t,n,s,r){for(let o=is.length-1;o>=is.indexOf(n);o--){const i=is[o];if(N0[i].common&&e._adapter.diff(r,s,i)>=t-1)return i}return is[n?is.indexOf(n):0]}function E1t(e){for(let t=is.indexOf(e)+1,n=is.length;t<n;++t)if(N0[is[t]].common)return is[t]}function pN(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:s,hi:r}=cS(n,t),o=n[s]>=t?n[s]:n[r];e[o]=!0}}function _1t(e,t,n,s){const r=e._adapter,o=+r.startOf(t[0].value,s),i=t[t.length-1].value;let a,l;for(a=o;a<=i;a=+r.add(a,1,s))l=n[a],l>=0&&(t[l].major=!0);return t}function mN(e,t,n){const s=[],r={},o=t.length;let i,a;for(i=0;i<o;++i)a=t[i],r[a]=i,s.push({value:a,major:!1});return o===0||!n?s:_1t(e,s,r,n)}class sh extends Nl{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const s=t.time||(t.time={}),r=this._adapter=new L0t._date(t.adapters.date);r.init(n),hd(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:hN(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,s=t.time.unit||"day";let{min:r,max:o,minDefined:i,maxDefined:a}=this.getUserBounds();function l(c){!i&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(o=Math.max(o,c.max))}(!i||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Ae(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),o=Ae(o)&&!isNaN(o)?o:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,o-1),this.max=Math.max(r+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],s=t[t.length-1]),{min:n,max:s}}buildTicks(){const t=this.options,n=t.time,s=t.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const o=this.min,i=this.max,a=lxt(r,o,i);return this._unit=n.unit||(s.autoSkip?fN(n.minUnit,this.min,this.max,this._getLabelCapacity(o)):N1t(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:E1t(this._unit),this.initOffsets(r),t.reverse&&a.reverse(),mN(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,s=0,r,o;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,o=this.getDecimalForValue(t[t.length-1]),t.length===1?s=o:s=(o-this.getDecimalForValue(t[t.length-2]))/2);const i=t.length<3?.5:.25;n=ln(n,0,i),s=ln(s,0,i),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const t=this._adapter,n=this.min,s=this.max,r=this.options,o=r.time,i=o.unit||fN(o.minUnit,n,s,this._getLabelCapacity(n)),a=It(r.ticks.stepSize,1),l=i==="week"?o.isoWeekday:!1,c=Wc(l)||l===!0,u={};let d=n,h,f;if(c&&(d=+t.startOf(d,"isoWeek",l)),d=+t.startOf(d,c?"day":i),t.diff(s,n,i)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+i);const p=r.ticks.source==="data"&&this.getDataTimestamps();for(h=d,f=0;h<s;h=+t.add(h,a,i),f++)pN(u,h,p);return(h===s||r.bounds==="ticks"||f===1)&&pN(u,h,p),Object.keys(u).sort(dN).map(m=>+m)}getLabelForValue(t){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(t,s.tooltipFormat):n.format(t,s.displayFormats.datetime)}format(t,n){const r=this.options.time.displayFormats,o=this._unit,i=n||r[o];return this._adapter.format(t,i)}_tickFormatFunction(t,n,s,r){const o=this.options,i=o.ticks.callback;if(i)return ce(i,[t,n,s],this);const a=o.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],d=c&&a[c],h=s[n],f=c&&d&&h&&h.major;return this._adapter.format(t,r||(f?d:u))}generateTickLabels(t){let n,s,r;for(n=0,s=t.length;n<s;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(t){const n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,s=this.ctx.measureText(t).width,r=yr(this.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(r),i=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*o+a*i,h:s*i+a*o}}_getLabelCapacity(t){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,o=this._tickFormatFunction(t,0,mN(this,[t],this._majorUnit),r),i=this._getLabelSize(o),a=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],n,s;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,s;if(t.length)return t;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)t.push(hN(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return M3(t.sort(dN))}}it(sh,"id","time"),it(sh,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function _p(e,t,n){let s=0,r=e.length-1,o,i,a,l;n?(t>=e[s].pos&&t<=e[r].pos&&({lo:s,hi:r}=To(e,"pos",t)),{pos:o,time:a}=e[s],{pos:i,time:l}=e[r]):(t>=e[s].time&&t<=e[r].time&&({lo:s,hi:r}=To(e,"time",t)),{time:o,pos:a}=e[s],{time:i,pos:l}=e[r]);const c=i-o;return c?a+(l-a)*(t-o)/c:a}class X1 extends sh{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=_p(n,this.min),this._tableRange=_p(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:s}=this,r=[],o=[];let i,a,l,c,u;for(i=0,a=t.length;i<a;++i)c=t[i],c>=n&&c<=s&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(i=0,a=r.length;i<a;++i)u=r[i+1],l=r[i-1],c=r[i],Math.round((u+l)/2)!==c&&o.push({time:c,pos:i/(a-1)});return o}_generate(){const t=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,o)=>r-o)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?t=this.normalize(n.concat(s)):t=n.length?n:s,t=this._cache.all=t,t}getDecimalForValue(t){return(_p(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return _p(this._table,s*this._tableRange+this._minPos,!0)}}it(X1,"id","timeseries"),it(X1,"defaults",sh.defaults);var R1t=Object.freeze({__proto__:null,CategoryScale:j1,LinearScale:G1,LogarithmicScale:H1,RadialLinearScale:Ju,TimeScale:sh,TimeSeriesScale:X1});const vS=[M0t,fbt,l1t,R1t];ks.register(...vS);function D1t({lossHistory:e}){const t=D.useRef(null),n=D.useRef(null);return D.useEffect(()=>{if(!t.current)return;n.current&&n.current.destroy();const s=t.current.getContext("2d");return n.current=new ks(s,{type:"line",data:{labels:e.map((r,o)=>o+1),datasets:[{label:"Meta Loss",data:e,borderColor:"hsl(217, 91%, 60%)",backgroundColor:"hsl(217, 91%, 60%, 0.1)",borderWidth:2,fill:!0,tension:.4,pointRadius:0,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"hsl(210, 40%, 92%)"}}},scales:{x:{title:{display:!0,text:"Meta Iteration",color:"hsl(210, 40%, 92%)"},ticks:{color:"hsl(215, 20%, 65%)"},grid:{color:"hsl(217, 32%, 17%)"}},y:{title:{display:!0,text:"Loss",color:"hsl(210, 40%, 92%)"},ticks:{color:"hsl(215, 20%, 65%)"},grid:{color:"hsl(217, 32%, 17%)"}}}}}),()=>{n.current&&n.current.destroy()}},[e]),N.jsxs(ao,{className:"p-6 floating-card",children:[N.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Loss Curves"}),N.jsx("div",{className:"h-80",children:N.jsx("canvas",{ref:t,"data-testid":"loss-chart"})})]})}ks.register(...vS);function A1t({currentTask:e}){const t=D.useRef(null),n=D.useRef(null);return D.useEffect(()=>{if(!t.current)return;n.current&&n.current.destroy();const s=t.current.getContext("2d");let r=[];if(e){const{x:o,y:i}=i3(e.amplitude,e.phase,100);r.push({label:"True Function",data:o.map((a,l)=>({x:a,y:i[l]})),borderColor:"hsl(217, 91%, 60%)",backgroundColor:"transparent",borderWidth:3,fill:!1,tension:.4,pointRadius:0,type:"line"}),e.trainX&&e.trainY&&r.push({label:"Training Points",data:e.trainX.map((a,l)=>({x:a,y:e.trainY[l]})),backgroundColor:"hsl(158, 64%, 52%)",borderColor:"hsl(222, 84%, 5%)",borderWidth:2,pointRadius:6,pointHoverRadius:8,showLine:!1,type:"scatter"})}return n.current=new ks(s,{type:"line",data:{datasets:r},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"hsl(210, 40%, 92%)"}}},scales:{x:{type:"linear",title:{display:!0,text:"x",color:"hsl(210, 40%, 92%)"},ticks:{color:"hsl(215, 20%, 65%)"},grid:{color:"hsl(217, 32%, 17%)"},min:-5,max:5},y:{title:{display:!0,text:"y = A  sin(x + )",color:"hsl(210, 40%, 92%)"},ticks:{color:"hsl(215, 20%, 65%)"},grid:{color:"hsl(217, 32%, 17%)"}}}}}),()=>{n.current&&n.current.destroy()}},[e]),N.jsxs(ao,{className:"p-6 floating-card",children:[N.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Current Task Approximation"}),N.jsx("div",{className:"h-80",children:N.jsx("canvas",{ref:t,"data-testid":"function-chart"})}),e&&N.jsx("div",{className:"mt-4 text-center text-sm text-muted-foreground",children:N.jsxs("p",{children:["A = ",e.amplitude.toFixed(2),",  = ",e.phase.toFixed(2)]})})]})}function O1t({currentBatch:e}){return N.jsxs(ao,{className:"p-6 floating-card",children:[N.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Sample Tasks in Current Batch"}),N.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:e.length===0?N.jsx("div",{className:"col-span-full text-center text-muted-foreground py-8",children:N.jsx("p",{children:"No tasks available. Start training to see sample tasks."})}):e.map((t,n)=>{const{x:s,y:r}=i3(t.amplitude,t.phase,20),o=s.map((i,a)=>{const l=(i+5)/10*100+10,c=40-r[a]/5*30;return`${a===0?"M":"L"} ${l} ${c}`}).join(" ");return N.jsxs("div",{className:"bg-muted rounded-lg p-4 space-y-3","data-testid":`task-sample-${n}`,children:[N.jsxs("div",{className:"text-center",children:[N.jsxs("h4",{className:"font-medium text-sm",children:["Task ",n+1]}),N.jsxs("p",{className:"text-xs text-muted-foreground",children:["A: ",t.amplitude.toFixed(1),", : ",t.phase.toFixed(1)]})]}),N.jsx("div",{className:"h-24 bg-background rounded border border-border",children:N.jsxs("svg",{width:"100%",height:"100%",viewBox:"0 0 120 80",className:"overflow-visible",children:[N.jsx("path",{d:o,className:"sine-wave-path stroke-chart-1 fill-none",strokeWidth:"2"}),[0,5,10,15].map(i=>N.jsx("circle",{cx:(s[i]+5)/10*100+10,cy:40-r[i]/5*30,r:"2",className:"data-points fill-chart-2 stroke-background stroke-2"},i))]})}),N.jsxs("div",{className:"text-xs text-center text-muted-foreground",children:["Loss: ",N.jsx("span",{className:"text-accent font-mono",children:t.loss.toFixed(3)})]})]},n)})})]})}ks.register(...vS);function F1t({evaluationResults:e}){const t=D.useRef(null),n=D.useRef(null);return D.useEffect(()=>{if(!t.current||e.beforeFineTuning===0)return;n.current&&n.current.destroy();const s=t.current.getContext("2d");return n.current=new ks(s,{type:"bar",data:{labels:["Random Init","Meta-Learned"],datasets:[{label:"MSE Loss",data:[e.beforeFineTuning,e.afterFineTuning],backgroundColor:["hsl(0, 62%, 30%)","hsl(158, 64%, 52%)"],borderColor:["hsl(0, 62%, 40%)","hsl(158, 64%, 62%)"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"hsl(210, 40%, 92%)"}}},scales:{x:{ticks:{color:"hsl(215, 20%, 65%)"},grid:{color:"hsl(217, 32%, 17%)"}},y:{title:{display:!0,text:"MSE Loss",color:"hsl(210, 40%, 92%)"},ticks:{color:"hsl(215, 20%, 65%)"},grid:{color:"hsl(217, 32%, 17%)"}}}}}),()=>{n.current&&n.current.destroy()}},[e]),N.jsxs(ao,{className:"p-6 floating-card",children:[N.jsx("h3",{className:"text-xl font-semibold mb-6",children:"Evaluation: Few-Shot Learning Performance"}),N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[N.jsxs("div",{children:[N.jsx("h4",{className:"text-lg font-medium mb-4",children:"Before vs After Fine-tuning"}),N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{className:"flex justify-between p-4 bg-muted rounded-lg",children:[N.jsxs("div",{children:[N.jsx("p",{className:"font-medium",children:"Random Initialization"}),N.jsx("p",{className:"text-sm text-muted-foreground",children:"MSE on test set"})]}),N.jsx("div",{className:"text-right",children:N.jsx("p",{className:"text-2xl font-bold text-destructive","data-testid":"random-init-mse",children:e.beforeFineTuning>0?e.beforeFineTuning.toFixed(3):"--"})})]}),N.jsxs("div",{className:"flex justify-between p-4 bg-muted rounded-lg",children:[N.jsxs("div",{children:[N.jsx("p",{className:"font-medium",children:"After Meta-Learning"}),N.jsx("p",{className:"text-sm text-muted-foreground",children:"MSE after 3 gradient steps"})]}),N.jsx("div",{className:"text-right",children:N.jsx("p",{className:"text-2xl font-bold text-accent","data-testid":"meta-learned-mse",children:e.afterFineTuning>0?e.afterFineTuning.toFixed(3):"--"})})]}),N.jsxs("div",{className:"text-center p-4 bg-primary/10 border border-primary/20 rounded-lg",children:[N.jsx("p",{className:"text-sm text-muted-foreground",children:"Improvement Factor"}),N.jsx("p",{className:"text-3xl font-bold text-primary","data-testid":"improvement-factor",children:e.improvementFactor>0?`${e.improvementFactor.toFixed(1)}`:"--"})]})]})]}),N.jsxs("div",{children:[N.jsx("h4",{className:"text-lg font-medium mb-4",children:"Test Task Performance"}),N.jsx("div",{className:"h-64 bg-muted/20 rounded-lg p-4",children:N.jsx("canvas",{ref:t,"data-testid":"evaluation-chart"})}),N.jsx("div",{className:"mt-4 text-sm text-muted-foreground text-center",children:N.jsx("p",{children:"Comparison of MSE loss before and after meta-learning"})})]})]})]})}function P1t(){const[e,t]=D.useState("reptile"),n={reptile:`// Reptile Meta-Learning Algorithm Implementation
class ReptileMetaLearner {
    constructor(model, metaLearningRate = 0.001) {
        this.model = model;
        this.metaLearningRate = metaLearningRate;
        this.metaParameters = model.getWeights();
    }

    async metaUpdate(tasks) {
        const parameterUpdates = [];
        
        // Process each task in the batch
        for (const task of tasks) {
            // Copy current meta-parameters to task-specific parameters
            const taskModel = tf.sequential({
                layers: this.model.layers.map(layer => tf.layers.dense({
                    units: layer.units,
                    activation: layer.activation
                }))
            });
            taskModel.setWeights(this.metaParameters);
            
            // Inner loop: task-specific optimization
            const optimizer = tf.train.sgd(0.01);
            for (let step = 0; step < 5; step++) {
                optimizer.minimize(() => {
                    const predictions = taskModel.predict(task.trainX);
                    return tf.losses.meanSquaredError(task.trainY, predictions);
                });
            }
            
            // Compute parameter difference ( - )
            const taskParameters = taskModel.getWeights();
            const paramDiff = taskParameters.map((param, i) => 
                param.sub(this.metaParameters[i])
            );
            parameterUpdates.push(paramDiff);
        }
        
        // Meta-update: average differences and update meta-parameters
        const avgUpdate = this.averageUpdates(parameterUpdates);
        this.metaParameters = this.metaParameters.map((param, i) => 
            param.add(avgUpdate[i].mul(this.metaLearningRate))
        );
        
        this.model.setWeights(this.metaParameters);
    }
}`,network:`// Neural Network Architecture
function createNeuralNetwork() {
    const model = tf.sequential({
        layers: [
            tf.layers.dense({
                inputShape: [1],
                units: 64,
                activation: 'relu',
                kernelInitializer: 'randomNormal'
            }),
            tf.layers.dense({
                units: 64,
                activation: 'relu',
                kernelInitializer: 'randomNormal'
            }),
            tf.layers.dense({
                units: 1,
                kernelInitializer: 'randomNormal'
            })
        ]
    });

    model.compile({
        optimizer: tf.train.sgd(0.01),
        loss: 'meanSquaredError'
    });

    return model;
}

// Model cloning for task-specific training
function cloneModel(model) {
    const newModel = createNeuralNetwork();
    newModel.setWeights(model.getWeights());
    return newModel;
}`,data:`// Synthetic Sine Wave Data Generation
function generateSineTask() {
    // Random amplitude between 0.1 and 5.0
    const amplitude = Math.random() * 4.9 + 0.1;
    // Random phase between 0 and 
    const phase = Math.random() * Math.PI;

    // Generate training data (10 points)
    const trainXValues = [];
    const trainYValues = [];
    for (let i = 0; i < 10; i++) {
        const x = Math.random() * 10 - 5; // Uniform from -5 to 5
        const y = amplitude * Math.sin(x + phase);
        trainXValues.push(x);
        trainYValues.push(y);
    }

    // Generate test data (10 points)
    const testXValues = [];
    const testYValues = [];
    for (let i = 0; i < 10; i++) {
        const x = Math.random() * 10 - 5;
        const y = amplitude * Math.sin(x + phase);
        testXValues.push(x);
        testYValues.push(y);
    }

    return {
        amplitude,
        phase,
        trainX: tf.tensor2d(trainXValues, [10, 1]),
        trainY: tf.tensor2d(trainYValues, [10, 1]),
        testX: tf.tensor2d(testXValues, [10, 1]),
        testY: tf.tensor2d(testYValues, [10, 1])
    };
}`};return N.jsxs(ao,{className:"p-6 floating-card",children:[N.jsxs("div",{className:"flex items-center justify-between mb-6",children:[N.jsx("h3",{className:"text-xl font-semibold",children:"Implementation"}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx(vi,{onClick:()=>t("reptile"),variant:e==="reptile"?"default":"outline",size:"sm","data-testid":"tab-reptile",children:"Reptile Algorithm"}),N.jsx(vi,{onClick:()=>t("network"),variant:e==="network"?"default":"outline",size:"sm","data-testid":"tab-network",children:"Network"}),N.jsx(vi,{onClick:()=>t("data"),variant:e==="data"?"default":"outline",size:"sm","data-testid":"tab-data",children:"Data Generation"})]})]}),N.jsx("div",{className:"code-block p-4 overflow-x-auto",children:N.jsx("pre",{className:"text-sm",children:N.jsx("code",{className:"text-foreground","data-testid":"code-content",children:n[e]})})})]})}function M1t(){const{trainingState:e,hyperParams:t,evaluationResults:n,startTraining:s,pauseTraining:r,resetTraining:o,updateHyperParameters:i,initializeModel:a}=Umt();D.useEffect(()=>{a()},[a]);const l=()=>{console.log("Export model functionality to be implemented")},c=()=>{if(e.currentBatch.length>0)return e.currentBatch[0]},u=()=>e.isTraining?e.isPaused?"Paused":"Training...":"Ready",d=()=>e.isTraining?e.isPaused?"text-yellow-500":"text-primary":"text-accent";return N.jsxs("div",{className:"min-h-screen w-full",children:[N.jsx("header",{className:"border-b border-border bg-card/50 backdrop-blur-sm sticky top-0 z-50",children:N.jsx("div",{className:"container mx-auto px-6 py-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Gronkosky - Reptile Meta-Learning"}),N.jsx("p",{className:"text-muted-foreground mt-1",children:"Interactive Visualization of Few-Shot Learning"})]}),N.jsx("div",{className:"flex items-center space-x-4",children:N.jsxs("div",{className:"text-sm text-muted-foreground",children:[N.jsx("span",{children:"Status: "}),N.jsx("span",{className:d(),"data-testid":"training-status",children:u()})]})})]})})}),N.jsxs("div",{className:"container mx-auto px-6 py-8",children:[N.jsx("section",{className:"mb-12",children:N.jsx(Xmt,{})}),N.jsx("section",{className:"mb-12",children:N.jsx(Sgt,{isTraining:e.isTraining,isPaused:e.isPaused,currentIteration:e.currentIteration,maxIterations:e.maxIterations,metaLoss:e.metaLoss,progressPercentage:e.progressPercentage,elapsedTime:e.elapsedTime,hyperParams:t,onStart:s,onPause:r,onReset:o,onExport:l,onUpdateHyperParams:i})}),N.jsx("section",{className:"mb-12",children:N.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[N.jsx(D1t,{lossHistory:e.lossHistory}),N.jsx(A1t,{currentTask:c()})]})}),N.jsx("section",{className:"mb-12",children:N.jsx(O1t,{currentBatch:e.currentBatch})}),N.jsx("section",{className:"mb-12",children:N.jsx(F1t,{evaluationResults:n})}),N.jsx("section",{className:"mb-12",children:N.jsx(P1t,{})})]}),N.jsx("footer",{className:"border-t border-border bg-card/30 backdrop-blur-sm",children:N.jsx("div",{className:"container mx-auto px-6 py-8",children:N.jsxs("div",{className:"text-center text-muted-foreground",children:[N.jsx("p",{className:"mb-2",children:"Gronkosky - Reptile Meta-Learning Visualization"}),N.jsx("p",{className:"text-sm",children:'Implementation of "On First-Order Meta-Learning Algorithms" by Nichol et al.'})]})})})]})}function L1t(){return N.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:N.jsx(ao,{className:"w-full max-w-md mx-4",children:N.jsxs(a3,{className:"pt-6",children:[N.jsxs("div",{className:"flex mb-4 gap-2",children:[N.jsx(oU,{className:"h-8 w-8 text-red-500"}),N.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),N.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function z1t(){return N.jsxs(O4,{children:[N.jsx(PI,{path:"/",component:M1t}),N.jsx(PI,{component:L1t})]})}function B1t(){return N.jsx(rW,{client:aW,children:N.jsxs(xG,{children:[N.jsx(HU,{}),N.jsx(z1t,{})]})})}M_(document.getElementById("root")).render(N.jsx(B1t,{}));
